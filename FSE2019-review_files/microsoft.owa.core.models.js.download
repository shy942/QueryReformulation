window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.core.models.js'] = (new Date()).getTime();
Type.registerNamespace("_c");_c.f=function(n,t,i){_a.c.b(n,"activityManager");_a.c.b(t,"chatManagerFactory");_a.c.b(i,"owaLayout");if(i!=="Mouse")this.a=new _c.p(n);else{var r=this;t.a(function(t){var i=t.a();r.a=i.f()?new _c.E(n,i):new _c.p(n)})}};_c.f.prototype={a:null};_c.g=function(n,t,i){this.g=Function.createDelegate(this,this.h);this.c=n;this.d=t;this.f=i;this.a=!0;this.b=!1;this.c.b(_a.fh,this.g)};_c.g.prototype={c:null,d:null,f:null,a:!1,b:!1,h:function(n){if(this.a&&!this.b){_j.e.a(_a.a.bL,"OnSessionTimeoutEvent: Sending refresh session request.");this.b=!0;var r=new _c.F(!0);var t=this;r.c(function(i){t.b=!1;var r=i.N;if(r.TokenResultCode){t.a=!1;t.e(n)}else t.a=!0;_j.e.a(_a.a.B,"RefreshSessionAction result: {0}",r.TokenResultCode)});var i=this;r.b(function(t){i.b=!1;i.a=!1;i.e(n);_j.e.b(_a.a.B,"RefreshSessionAction failed for user")});this.d.a(r)}else this.a||this.e(n)},e:function(n){var t=this;this.f.c(_a.a.bL,"RaiseEvent SessionTimeoutWarningEvent",function(){t.c.a(_a.dU,new _a.dU(n.b()))})}};_c.h=function(n){n.a(new _h.dy(!0))};_c.W=function(){};_c.W.prototype={success:0,warning:1,error:2};_c.W.registerEnum("_c.W",!1);_c.Y=function(){};_c.Y.prototype={Id:0,Dictionary:1,XmlData:2,BinaryData:3,All:4};_c.Y.registerEnum("_c.Y",!1);_c.r=function(n,t){_c.r.initializeBase(this);this.e=n;this.f=t};_c.r.prototype={e:null,f:null,K:function(n){n.dB(this.e,this.f,null,this.I,this.H)},cU:function(n,t,i){try{if(!n){i(Error.create(_bms.E.BA));return}t()}catch(r){i(r)}}};_c.w=function(n,t){_c.w.initializeBase(this);_a.c.b(n,"folderId");_a.c.b(t,"conversationCount");this.h=n;this.f=t};_c.w.prototype={h:null,f:0,e:null,K:function(n){n.fy(this.h,this.f,null,this.I,this.H)},cU:function(n,t,i){this.e=n.Conversations;t()}};_c.x=function(){_c.x.initializeBase(this)};_c.x.prototype={f:null,e:null,K:function(n){var t=new _gg.mg(this.L);t.actionName="GetRegionalConfiguration";this.e=_a.b.b(_a.a.eF,"GetRegionalConfiguration",!0,null);var i=new _gg.eh;n.E(i,t,this.I,this.H)},cU:function(n,t,i){if(this.e){this.e.o=this.P();_a.b.a(this.e);this.e=null}if(n.SupportedCultures&&n.SupportedCultures.length>0){this.f=n.SupportedCultures;t();return}i(Error.create("Get regional information failed to retrieve at least one valid language."))},bc:function(n){_h.fN.prototype.bc.call(this,Error.create(n.message));if(this.e){this.e.o=this.P();this.e.n=n.name.toString();_a.b.a(this.e);this.e=null}}};_c.z=function(){_c.z.initializeBase(this)};_c.z.prototype={e:null,K:function(n){var t=new _gg.ig(this.L);n.G(t,this.I,this.H)},cU:function(n,t,i){try{_a.c.b(n,"themeSelectionInfo");this.e=n;t()}catch(r){i(r)}}};_c.F=function(n){_c.F.initializeBase(this);this.e=new _gg.yF(this.L);this.e.isAutomated=n};_c.F.prototype={e:null,K:function(n){n.ht(this.e,this.I,this.H)},cU:function(n,t,i){t()}};_c.O=function(n,t){_c.O.initializeBase(this);this.e=n;this.f=t};_c.O.prototype={e:null,f:!1,K:function(n){var r=new _gg.mp(this.L);var t;var i=(t=new _gg.cK,t.ThemeId=this.e,t.SkipO365Call=this.f,t);n.dj(i,r,this.I,this.H)},cU:function(n,t,i){try{if(!n){i(Error.create(_bms.E.BA));return}t()}catch(r){i(r)}}};function CoreModelsComponent(){}CoreModelsComponent.$$cctor=function(){_a.t.a().a(CoreModelsComponent)};CoreModelsComponent.prototype={b:function(n,t,i){n.e(_c.D).b(_h.dF).a();var f=this;n.b(_c.f,function(){return new _c.f(n.a(_a.bp),n.c(_h.cf),i.a())}).a();var u=this;n.b(_c.g,function(){return new _c.g(n.a(_j.j),n.a(_a.q),n.a(_j.v))}).a();var r=this;n.b(_c.h,function(){return new _c.h(n.a(_a.q))}).a();n.e(_c.I).a().b(_db.cI);n.e(_c.J).a().b(_db.cJ);n.e(_c.K).a().b(_db.cL);n.e(_c.L).a().b(_db.cN);n.e(_c.M).a().b(_db.cO)},a:function(){return[new _j.y(_c.f,2,1),new _j.y(_c.g,2,1),new _j.y(_c.h,2,9)]}};_c.u=function(n,t,i){_c.u.initializeBase(this,[t,i]);this.f=n};_c.u.prototype={f:null,h:function(){return!0},o:function(n){n.ActionType=0},m:function(n,t){for(var i=0;i<this.f.x.length;i++){var r=this.f.x[i];if(_ff.e.b(n.c(),r.c())){this.f.n(i);break}}}};_c.v=function(){this.e=-1;_c.v.initializeBase(this)};_c.v.prototype={cU:function(n,t,i){this.e=n;t()},K:function(n){n.bV(null,this.I,this.H)}};_c.P=function(n,t,i){_c.P.initializeBase(this,[n,i]);this.f=t};_c.P.prototype={f:null,h:function(){return!0},o:function(n){var t=_a.d.f(this.f);n.ActionType=1;n.NewReminderTime=t},m:function(n,t){n.k(this.f)}};_c.B=function(n,t){_c.B.initializeBase(this);this.f=n;this.e=t};_c.B.prototype={f:null,e:null,j:null,K:function(n){var r=new _g.e(this.f);var u=new _gg.jh(r,this.e);var t=new _gg.jg(this.M(),u);var i=new _gg.ya(this.L);n.hp(t,i,this.I,this.H)},cJ:function(n){this.j=n}};_c.C=function(n){_c.C.initializeBase(this);this.e=n};_c.C.prototype={e:null,K:function(n){var r=new _gg.jf(this.e);var u=new _gg.gE(r);var t=new _gg.gD(this.M(),u);var i=new _gg.pW(this.L);n.ez(t,i,this.I,this.H)},cJ:function(n){}};_c.A=function(n){_c.A.initializeBase(this);this.e=n};_c.A.prototype={e:null,K:function(n){var t=new _gg.tP(0);t.timeZone=this.Y();n.cm(t,this.I,this.H)},cU:function(n,t,i){try{if(!n){i(Error.create(_nbs.a.WW));return}this.e.d(n.ExternalAudience);this.e.e(n.ExternalReply);this.e.f(n.InternalReply);this.e.b(n.IsOofOn);this.e.g(n.IsScheduled);this.e.c(_a.d.b(n.EndTime));t()}catch(r){i(r)}}};_c.T=function(n){_c.T.initializeBase(this);this.e=n};_c.T.prototype={e:null,h:null,K:function(n){var i=new _gg.ma(600);var t=new _gg.O(this.M(),new _gg.l(this.e.c().bH.MailboxGuid));n.cd(t,i,this.I,this.H)},cU:function(n,t,i){try{if(!n){i(Error.create(_nbs.a.WW));return}this.h=n;t()}catch(r){i(r)}}};_c.N=function(n){_c.N.initializeBase(this);this.e=n};_c.N.prototype={e:null,K:function(n){var t=new _gg.lj;t.ExternalAudience=this.e.h();t.ExternalReply=this.e.i();t.InternalReply=this.e.j();t.IsOofOn=this.e.a();n.iv(t,null,this.I,this.H)},cU:function(n,t,i){if(!n){i(Error.create(_bms.E.BA));return}t()}};_c.G=function(n){_c.G.initializeBase(this);this.e=n};_c.G.prototype={e:null,K:function(n){n.hB(this.e,null,this.I,this.H)},cU:function(n,t,i){try{if(!n){i(Error.create(_bms.E.BA));return}t()}catch(r){i(r)}}};_c.U=function(n,t){_c.U.initializeBase(this);_a.c.b(n,"remindersToPerformAction");_a.c.b(t,"nativeBridge");this.e=n;this.l=t};_c.U.prototype={e:null,l:null,K:function(n){var i=this.q();var t=new _gg.xT(this.L);t.shouldPrecedeOfflineSyncActions=this.h();n.cJ(i,t,this.k,this.j)},S:function(){_a.dn.prototype.S.call(this);for(var n=0;n<this.e.length;n++)this.m(this.e[n],this.l)},q:function(){var t=new _gg.eH;t.ReminderItemActions=this.p();var n=new _gg.jc(this.M());n.Body=t;return n},p:function(){for(var i=new Array(this.e.length),n=0;n<this.e.length;n++){var u=this.e[n];var r=new _g.e(u.c().Id);r.ChangeKey=u.c().ChangeKey;var t=new _gg.jp;t.ItemId=r;this.o(t);i[n]=t}return i}};_c.i=function(n,t){_c.i.initializeBase(this,[0]);this.j=n;var i=_g.b.a.nameToId("todosearch");t&&t!==i||(t=_g.b.a.nameToId("tasks"));this.bs=_g.l.c(t);this.bi="CreateTask"};_c.i.prototype={j:null,f:null,bo:function(){return[this.k()]},cJ:function(n){this.f=n.Items[0].ItemId},k:function(){for(var t=new _g.bR,f=this.j.d,o=this.j.e(),r=o,e=r.length,n=0;n<e;++n){var u=r[n];var i=_c.a.b(u);i&&i(t,f)}t.Owner=_g.a.a().c().bH.UserDisplayName;return t}};_c.s=function(n,t){_c.s.initializeBase(this);_a.c.b(n,"ParentGroup");this.h=n;var i=new _gg.bC;i.c(n.bH.GroupId);this.e=i;this.f=new _gg.fI;this.k=t};_c.s.prototype={e:null,f:null,h:null,k:null,l:function(n){if(!_j.h.b(n)){this.e.a(n);this.f.f(n)}},K:function(n){n.ee(this.e.bH.FolderName,this.e.bH.ParentGroupId,null,this.I,this.H)},m:function(n){var t=new _g.m(n.NewFolderId.Id);t.ChangeKey=n.NewFolderId.ChangeKey;this.f.j(t);this.f.t(_g.b.a.nameToId("tasks"));this.e.e(t);this.e.f(n.NewTaskFolderEntryId);var i=_h.a.b("msgfolderroot");i.bx.a(this.f);this.k.n(this.h,this.e,this.f)}};_c.t=function(n,t,i){_c.t.initializeBase(this);_a.c.b(n,"taskFolderToDelete");_a.c.b(t,"parentGroup");_a.c.b(i,"taskGroupsCache");this.e=n;this.f=t;this.h=i};_c.t.prototype={e:null,f:null,h:null,K:function(n){var t=new _g.e(this.e.bH.ItemId.Id);t.ChangeKey=this.e.bH.ItemId.ChangeKey;n.eu(t,null,this.I,this.H)},m:function(n){this.h.t(this.f,this.e)}};_c.n=function(n,t,i){_c.n.initializeBase(this,[n,t])};_c.n.prototype={bl:function(){this.be&&(this.D=new _g.F(_g.l.a(this.be)));var t=[];var r=this.bk(this.k);var n=new _g.s(new _g.d("TaskStatus"));n.Item=new _g.bR;n.Item.Status=r;Array.add(t,n);if(r==="InProgress"){var i=null;if(this.k.c()){n=new _g.s(new _g.d("TaskStartDate"));n.Item=new _g.bR;n.Item.StartDate=this.k.c().i();Array.add(t,n)}else{i=new _g.bd(new _g.d("TaskStartDate"));Array.add(t,i)}if(this.k.b()){n=new _g.s(new _g.d("TaskDueDate"));n.Item=new _g.bR;n.Item.DueDate=this.k.b().i();Array.add(t,n)}else{i=new _g.bd(new _g.d("TaskDueDate"));Array.add(t,i)}}if(r==="InProgress"||r==="Completed")if(this.k.e()){n=new _g.s(new _g.d("TaskCompleteDate"));n.Item=new _g.bR;n.Item.CompleteDate=this.k.e().i();Array.add(t,n)}else{var u=new _g.bd(new _g.d("TaskCompleteDate"));Array.add(t,u)}return t},t:function(){for(var r=this.bl(),t=new Array(this.o.length),n=0;n<this.o.length;n++){var i=new _g.e(this.o[n].bH.ItemId.Id);i.ChangeKey=this.o[n].bH.ItemId.ChangeKey;t[n]=new _g.bm;t[n].ItemId=i;t[n].Updates=r}return t},S:function(){var t=this.bk(this.k);var n=this.o;var l=this,c=this;_h.c.c(_dg.n,String,n,"Status",function(n){return n.b()},t,function(n,t){n.z(t)});var h=this,a=this;_h.c.c(_dg.n,Boolean,n,"IsComplete",function(n){return n.o()},t==="Completed",function(n,t){n.Q(t)});if(t==="InProgress"){if(this.k.c()){var p=this,y=this;_h.c.c(_dg.n,_a.d,n,"StartDate",function(n){return n.m()},this.k.c(),function(n,t){n.T(t)})}if(this.k.b()){var v=this,u=this;_h.c.c(_dg.n,_a.d,n,"DueDate",function(n){return n.f()},this.k.b(),function(n,t){n.P(t)})}if(this.k.e()){var r=this,i=this;_h.c.c(_dg.n,_a.d,n,"CompleteDate",function(n){return n.h()},this.k.e(),function(n,t){n.I(t)})}}else if(t==="Completed"){var f=this,s=this;_h.c.c(_dg.n,String,n,"PercentComplete",function(n){return n.bH.PercentComplete},"100",function(n,t){n.R(t)});var o=this,e=this;_h.c.c(_dg.n,_a.d,n,"CompleteDate",function(n){return n.h()},this.k.e().d(),function(n,t){n.I(t)})}},bk:function(n){var t="NotStarted";switch(n.a()){case"NotFlagged":throw Error.invalidOperation("ClearFlag cannot be called to a Task object.");case"Complete":t="Completed";break;case"Flagged":t="InProgress";break}return t}};_c.y=function(){_c.y.initializeBase(this)};_c.y.prototype={e:null,K:function(n){var t=new _gg.uL(this.L);n.gx(t,this.I,this.H)},cU:function(n,t,i){try{this.f(n)}catch(r){i(r);return}t()},f:function(n){n&&(this.e=n.TaskGroups)}};_c.o=function(n,t,i,r,u,f){_c.o.initializeBase(this,[n,t,null,"TaskListItem",i,r,u,f,!1,null,null,0,null,-1,null,!1])};_c.o.prototype={bC:function(){return _h.cJ.a(this.u.a,this.u.b,this.t)}};_c.H=function(n,t,i){_c.H.initializeBase(this);_a.c.b(n,"taskFolderToRename");_a.c.c(t,"newTaskFolderName");_a.c.b(i,"taskGroupsCache");this.e=n;this.f=t;this.h=i};_c.H.prototype={e:null,f:null,h:null,K:function(n){var t=new _g.e(this.e.bH.ItemId.Id);t.ChangeKey=this.e.bH.ItemId.ChangeKey;n.hI(t,this.f,null,this.I,this.H)},m:function(n){this.e.bH.ItemId.ChangeKey=n.NewTaskFolderEntryId.ChangeKey;this.e.a(this.f);if(this.h.b){var t=this.h.j(this.e.bH.TaskFolderId);if(t){t.bH.FolderId.ChangeKey=n.NewFolderId.ChangeKey;t.f(this.f)}}}};_c.X=function(){this.j=String.format(_nbs.a.dy,-1);_c.X.initializeBase(this)};_c.X.prototype={cU:function(n,t,i){if(!n.WasSuccessful){this.j=_c.Q.a(n.ErrorCode);i(Error.create(this.j));return}try{this.m(n)}catch(r){i(r);return}t()}};_c.Q=function(){};_c.Q.a=function(n){switch(n){case 11:return _nbs.a.gt;case 13:return _nbs.a.lK;case 7:return _nbs.a.Jd;default:return String.format(_nbs.a.dy,n)}};_c.b=function(n,t){this.b=n;this.a=t};_c.b.prototype={b:"FolderId",a:!1};_c.a=function(){};_c.a.b=function(n){_c.a.c();return _c.a.a[n]};_c.a.c=function(){if(!_c.a.a){_c.a.a={};_c.a.a.Subject=function(n,t){n.Subject=t.bH.Subject;return new _c.b("Subject",!1)};_c.a.a.DueDate=function(n,t){var i=!t.f();i||(n.DueDate=t.f().i());return new _c.b("TaskDueDate",i)};_c.a.a.Body=function(n,t){n.Body=new _g.t(t.X().a()==="HTML"?"HTML":"Text",t.X().bH.Value);return new _c.b("Body",!1)};_c.a.a.StartDate=function(n,t){var i=!t.m();i||(n.StartDate=t.m().i());return new _c.b("TaskStartDate",i)};_c.a.a.Importance=function(n,t){n.Importance=t.bg();return new _c.b("Importance",!1)};_c.a.a.Status=function(n,t){n.Status=t.b();return new _c.b("TaskStatus",!1)};_c.a.a.CompleteDate=function(n,t){var i=!t.h();i||(n.CompleteDate=t.h().i());return new _c.b("TaskCompleteDate",i)};_c.a.a.PercentComplete=function(n,t){n.PercentComplete=t.bH.PercentComplete;return new _c.b("TaskPercentComplete",!1)};_c.a.a.Sensitivity=function(n,t){n.Sensitivity=t.cp();return new _c.b("Sensitivity",!1)};_c.a.a.TotalWork=function(n,t){n.TotalWork=t.y();return new _c.b("TaskTotalWork",!1)};_c.a.a.ActualWork=function(n,t){n.ActualWork=t.t();return new _c.b("TaskActualWork",!1)};_c.a.a.Mileage=function(n,t){n.Mileage=t.bH.Mileage;return new _c.b("TaskMileage",!1)};_c.a.a.BillingInformation=function(n,t){n.BillingInformation=t.bH.BillingInformation;return new _c.b("TaskBillingInformation",!1)};_c.a.a.Companies=function(n,t){var r=!t.g()&&t.g().b()>0;if(!r){for(var u=new Array(t.g().b()),i=0;i<t.g().b();i++)u[i]=t.g().a(i);n.Companies=u}return new _c.b("TaskCompanies",r)};_c.a.a.ReminderIsSet=function(n,t){n.ReminderIsSet=t.bH.ReminderIsSet;return new _c.b("ReminderIsSet",!1)};_c.a.a.ReminderDueBy=function(n,t){var i=!t.fw();i||(n.ReminderDueBy=t.fw().i());return new _c.b("ReminderDueBy",i)};_c.a.a.Recurrence=function(n,t){var i=!t.D();i||(n.Recurrence=t.D().bH);return new _c.b("TaskRecurrence",i)};_c.a.a.ModernReminders=function(n,t){var i=!t.A();i||(n.ModernReminders=t.A().h.p);return new _c.b("ModernReminders",i)};_c.a.a.Charm=function(n,t){n.Charm=t.n();return new _c.b("TaskCharm",!1)}}};_c.e=function(n){_c.e.initializeBase(this,[0]);this.k=n;var t=n.d;t.bH.ParentFolderId&&(this.bp=_g.l.c(t.bH.ParentFolderId));this.r="UpdateTask"};_c.e.a=function(n,t,i){if(i){var f=new _g.bR;var e=i(f,t);var r=new _g.d(e.b);if(e.a){var o=new _g.bd(r);Array.add(n,o)}else{var u=new _g.s(r);u.Item=f;Array.add(n,u)}}};_c.e.prototype={k:null,t:function(){for(var i=[],u=this.k.d,o=this.k.e(),r=o,f=r.length,n=0;n<f;++n){var e=r[n];_c.e.a(i,u,_c.a.b(e))}var t=new _g.bm;t.ItemId=_g.e.a(u.bH.ItemId);t.Updates=i;return[t]}};_c.CalendarTimePeriodSchema=function(){};_c.p=function(n){_c.p.initializeBase(this,[n])};_c.p.prototype={c:function(){return"KeepAliveActivityMonitor"},a:function(){return 24e4},d:function(){return 3e5},h:function(n){var t=new Sys.Net.WebRequest;t.set_url(_j.h.a(_a.g.m)?"ping.owa":_a.g.m);t.set_timeout(6e4);t.invoke()}};_c.E=function(n,t){_c.E.initializeBase(this,[n]);this.f=t};_c.E.prototype={f:null,c:function(){return"PresenceActivityMonitor"},a:function(){return 24e4},d:function(){return 3e5},h:function(n){this.f.x()}};_c.d=function(n,t){this.b=n;this.a=t};_c.d.prototype={b:0,a:null};_c.m=function(){_c.m.initializeBase(this)};_c.m.prototype={k:0,l:null,m:null,n:!1,p:!1,o:null,h:function(){return this.k},d:function(n){if(n===this.k)return n;this.k=n;this.eJ("ExternalAudience");return n},i:function(){return this.l},e:function(n){if(n===this.l)return n;this.l=n;this.eJ("ExternalReply");return n},j:function(){return this.m},f:function(n){if(n===this.m)return n;this.m=n;this.eJ("InternalReply");return n},a:function(){return this.n},b:function(n){if(n===this.n)return n;this.n=n;this.eJ("IsOofOn");return n},g:function(n){if(n===this.p)return n;this.p=n;this.eJ("IsScheduled");return n},c:function(n){if(n===this.o)return n;this.o=n;this.eJ("EndTime");return n}};_c.D=function(){};_c.D.prototype={a:function(n,t,i,r){return new _c.j(n,t,new _g.dX(r),i,_g.k.b)}};_c.j=function(n,t,i,r,u){_c.j.initializeBase(this,[null,n,t,i,r]);this.a=u};_c.j.prototype={a:null,A:function(){return this.a},z:function(n,t,i){},u:function(n,t,i){},q:function(n){return n},E:function(n,t,i,r,u){_j.e.a(_c.j.a,"ExecuteWithActionQueue {0}",n);this.a.jB(n,t,i,r,u);return}};_c.V=function(){_c.V.initializeBase(this)};_c.V.prototype={callState:null};_c.S=function(n,t,i){_c.S.initializeBase(this,[n]);this.f=_j.E.a(t)?"All":t;this.e=i?i:new _h.q("TaskDueDate","Ascending");this.i=this.i+"_item_"+this.f+"_"+this.e.a.toString()+"_"+this.e.b.toString()+"_"};_c.S.prototype={f:"All",e:null,c:function(){return this.f},d:function(){return _h.cJ.a(this.e.a,this.e.b,this.j)}};_c.q=function(n){_c.q.initializeBase(this,[n,null,_c.q.a(n)])};_c.q.a=function(n){return[new _h.z(n,!1,n.d(),n.c())]};_c.q.prototype={bD:function(){return _a.a.fN},bW:function(){return this.bC.f},bJ:function(){return this.bC.e},r:function(){return null},K:function(){return!1},N:function(n,t){var i=this;n.k(function(){i.cp==="ErrorConnectionFailed"&&n.i()&&n.f()?t(6):t(1)})},cI:function(n){},ca:function(n){var t=Math.max(this.cM(),this.bx.x.length);this.cl(4);this.bP(this.cH(t,this.h()))},bN:function(n,t){if(!_h.o.isInstanceOfType(n))throw Error.argumentType("range",n?Object.getType(n):null,_h.o,"range needs to be an IndexedRange object");return this.cH(n.b,n.a)},T:function(n){return!1},cO:function(n,t){var i=n;i.dV(t)},dT:function(n,t){return!0},cx:function(n,t){return-2},cG:function(n,t,i){return new _c.o(this.e(),this.r(),n,!1,this.bW(),this.bJ())},cH:function(n,t){return new _c.o(this.e(),this.r(),_h.x.a(t,n),!1,this.bW(),this.bJ())}};_c.R=function(){this.g=Function.createDelegate(this,this.q);this.h=Function.createDelegate(this,this.r);this.i=Function.createDelegate(this,this.s);this.a={};this.e=[];_c.R.initializeBase(this)};_c.R.prototype={c:null,b:!1,d:!1,f:0,m:function(n){this.bB("CachePopulated",n)},u:function(n){if(n!==this.b){this.b=n;this.by("IsLoaded")}return n},p:function(){return _nbs.a.fK},j:function(n){return this.a?n.Id in this.a?this.a[n.Id]:null:null},k:function(n){if(this.b){n&&n();return!0}n&&Array.add(this.e,n);this.o();return!1},n:function(n,t,i){_a.c.a(n,"parentGroup");_a.c.a(t,"taskFolderEntry");_a.c.a(i,"folder");t.c(n.bH.GroupId);n.a().c(t);this.a[t.bH.TaskFolderId.Id]=i},t:function(n,t){_a.c.a(n,"parentGroup");_a.c.a(t,"taskFolder");delete this.a[t.bH.TaskFolderId.Id];n.a().k(t)},o:function(){if(!this.d){this.d=!0;this.l()}},l:function(){var n=new _c.y;n.c(this.i);n.b(this.h);n.a(this.g);_a.g.a.a(n)},s:function(n){var c=n;this.c=new _j.l;this.a={};for(var l=!1,s=0;s<c.e.length;s++){var i=new _gg.fH(c.e[s]);i.b()||i.c(_nbs.a.OR);for(var f=i.a().b()-1;f>=0;f--){var r=i.a().a(f);var t=null;if(r.b()===1){t=_g.j.a("todosearch");l=!0;r.a(_nbs.a.fa);t&&t.f(_nbs.a.fa)}else{t=_h.a.a(r.bH.TaskFolderId);r.b()===2&&r.a(t.f(this.p()))}t?this.a[r.bH.TaskFolderId.Id]=t:i.a().o(f)}this.c.a(i)}if(!l&&this.c.x.length>0){var h=this.c.x[0];var o=_g.j.a("todosearch");o.f(_nbs.a.fa);var u=new _gg.bC;u.a(_nbs.a.fa);u.g(1);u.e(o.bH.FolderId);u.c(h.bH.GroupId);h.a().r(0,u);this.a[u.bH.TaskFolderId.Id]=o}this.u(!0);this.d=!1;this.bL("CachePopulated",this,null);for(var e=0;e<this.e.length;e++)this.e[e]();this.e=[]},r:function(n){if(this.f<3){var t=this;_j.m.a().a(_a.a.bX,"GetTaskFoldersActionRetry",function(){t.l()},2e3);this.f++}else{this.f=0;this.d=!1}},q:function(n){n.U(this.i);n.T(this.h);n.n(this.g)}};_c.c=function(n,t,i,r){_c.c.initializeBase(this,[n,t,_c.c.b(),"None",i,r,null,null])};_c.c.b=function(){if(!_c.c.a){_c.c.a=new _g.V("IdOnly");_c.c.a.AddBlankTargetToLinks=!0;_c.c.a.ClientSupportsIrm=!0;_c.c.a.FilterHtmlContent=!0;_c.c.a.InlineImageUrlTemplate=_g.C.g();_c.c.a.MaximumBodySize=0;_c.c.a.AdditionalProperties=[new _g.d("UID"),new _g.d("ItemParentId"),new _g.d("InstanceKey"),new _g.d("Subject"),new _g.d("TaskDueDate"),new _g.d("Body"),new _g.d("NormalizedBody"),new _g.d("HasAttachments"),new _g.d("Attachments"),new _g.d("TaskStartDate"),new _g.d("Importance"),new _g.d("TaskStatus"),new _g.d("TaskCompleteDate"),new _g.d("TaskPercentComplete"),new _g.d("Sensitivity"),new _g.d("TaskOwner"),new _g.d("Categories"),new _g.d("TaskTotalWork"),new _g.d("TaskActualWork"),new _g.d("TaskMileage"),new _g.d("TaskBillingInformation"),new _g.d("TaskCompanies"),new _g.d("TaskRecurrence"),new _g.d("ReminderDueBy"),new _g.d("ReminderIsSet"),new _g.d("ReminderNextTime"),new _g.d("ReminderMinutesBeforeStart"),new _g.d("ItemLastModifiedTime"),new _g.d("TaskIsComplete"),new _g.d("TaskIsTaskRecurring"),new _g.d("ItemClass"),new _g.d("TaskDelegationState"),new _g.d("TaskDoItTime"),new _g.d("TaskCharm")]}return _c.c.a};_c.c.prototype={cJ:function(n){try{_h.cb.prototype.cJ.call(this,n)}catch(t){this.bO("ProcessResponseMessageFailed",this);throw t;}}};_c.k=function(n,t){_c.k.initializeBase(this,[n,t,_c.k.a])};_c.I=function(){};_c.I.prototype={a:function(n,t,i){return new _c.k(n,t)}};_c.CreateAttachmentResponseProcessor=function(n,t,i){_c.CreateAttachmentResponseProcessor.initializeBase(this,[n,t,_c.CreateAttachmentResponseProcessor.a]);_a.c.b(i,"nativeBridge");this.i=i};_c.CreateAttachmentResponseProcessor.prototype={i:null,j:function(n,t){var r=null;var i=null;if(t.ResponseClass==="Success"){r=t.Attachments[0].AttachmentId;i=new _g.e(r.RootItemId);i.ChangeKey=r.RootItemChangeKey;var f=this.g().Body.ParentItemId;this.e.u(this.b,f,i)}if(this.a()){var e=this.a().attachmentIds[n];this.t(t.ResponseClass,e,r,i);if(this.a().palContext&&this.a().palContext.palActionNeeded&&this.i.b(this.i.i())){var u=this.i.i().b();u.e(this.a().dataFile);this.i.i().a(u.c())}}_h.dS.prototype.j.call(this,n,t)},t:function(n,t,i,r){n==="Success"?this.y(t,i,r):this.u(t)},y:function(n,t,i){var u=new _g.bi(t.Id);this.e.z(this.b,n,u);if(this.l()&&this.a().clientStoreItem===2){this.b.b().b(!1);var r=this;this.d().a().d(this.b,this.d().h().b(i.Id),function(t){if(_j.E.a(t)){_j.e.b(r.f,"Message with id {0} not found in local store",i.Id);return}r.z(t,n,u)})}},u:function(n){if(this.l()&&this.a().clientStoreItem===2){this.b.b().b(!1);var r=this.c.request.parameters;var t=new _g.e(r.Body.Attachments[0].AttachmentId.RootItemId);var i=this;this.d().a().d(this.b,this.d().h().b(t.Id),function(r){if(!r){_j.e.b(i.f,"Message with id {0} not found in local store",t.Id);return}i.m(r,n)})}},z:function(n,t,i){var u=n;if(!u.HasAttachments){_j.e.c(this.f,"UpdateItemAttachmentId invoked with item that has no attachments.");return}if(!u.Attachments){_j.e.c(this.f,"UpdateItemAttachmentId invoked with item that has null attachment collection.");return}for(var e=u.Attachments,o=e.length,r=0;r<o;++r){var f=e[r];if(f.AttachmentId.Id===t.Id){f.AttachmentId.Id=i.Id;return}}_j.e.b(this.f,"Attachment with id {0} not found in local store",t.Id)},m:function(n,t){var i=n;if(i.HasAttachments&&i.Attachments){for(var r=0;r<i.Attachments.length;r++)if(i.Attachments[r].AttachmentId.Id===t.Id){Array.removeAt(i.Attachments,r);break}_j.e.b(this.f,"Attachment with id {0} not found in local store",t.Id)}}};_c.J=function(){};_c.J.prototype={a:function(n,t,i){return new _c.CreateAttachmentResponseProcessor(n,t,i)}};_c.DeleteAttachmentResponseProcessor=function(n,t){_c.DeleteAttachmentResponseProcessor.initializeBase(this,[n,t,_c.DeleteAttachmentResponseProcessor.a])};_c.DeleteAttachmentResponseProcessor.prototype={j:function(n,t){var i=this.a().itemContexts[n];if(t.ResponseClass==="Success"){var f=this.e.q(i.parentItemId);var r=new _g.e(t.RootItemId.RootItemId);r.ChangeKey=t.RootItemId.RootItemChangeKey;this.e.u(this.b,f,r)}else if(this.l()&&i.clientStoreItem===2){this.b.b().b(!1);var u=this.e.q(i.parentItemId);this.d().a().g(this.b,this.d().h().b(u.Id),i.deletedAttachment)}_h.dS.prototype.j.call(this,n,t)}};_c.K=function(){};_c.K.prototype={a:function(n,t,i){return new _c.DeleteAttachmentResponseProcessor(n,t)}};_c.l=function(n,t){_c.l.initializeBase(this,[n,t,_c.l.a])};_c.L=function(){};_c.L.prototype={a:function(n,t,i){return new _c.l(n,t)}};_c.PerformReminderActionResponseProcessor=function(n,t){_c.PerformReminderActionResponseProcessor.initializeBase(this,[n,t,_c.PerformReminderActionResponseProcessor.a])};_c.M=function(){};_c.M.prototype={a:function(n,t,i){return new _c.PerformReminderActionResponseProcessor(n,t)}};_c.f.registerClass("_c.f");_c.g.registerClass("_c.g");_c.h.registerClass("_c.h");_c.r.registerClass("_c.r",_h.fN,_a.fF);_c.w.registerClass("_c.w",_h.fN);_c.x.registerClass("_c.x",_h.fN);_c.z.registerClass("_c.z",_h.fN,_a.fF);_c.F.registerClass("_c.F",_h.fN);_c.O.registerClass("_c.O",_h.fN);CoreModelsComponent.registerClass("CoreModelsComponent",null,_a.kh,_j.ce);_c.U.registerClass("_c.U",_h.fO);_c.u.registerClass("_c.u",_c.U);_c.v.registerClass("_c.v",_h.fN);_c.P.registerClass("_c.P",_c.U);_c.B.registerClass("_c.B",_h.dx.$$(_gg.yb,_gg.yc));_c.C.registerClass("_c.C",_h.dx.$$(_gg.pX,_gg.pY));_c.A.registerClass("_c.A",_h.fN);_c.T.registerClass("_c.T",_h.fN);_c.N.registerClass("_c.N",_h.fN);_c.G.registerClass("_c.G",_h.fN,_a.fF);_c.i.registerClass("_c.i",_h.fk);_c.X.registerClass("_c.X",_h.fN);_c.s.registerClass("_c.s",_c.X);_c.t.registerClass("_c.t",_c.X);_c.n.registerClass("_c.n",_h.bt);_c.y.registerClass("_c.y",_h.fN);_c.o.registerClass("_c.o",_h.bm);_c.H.registerClass("_c.H",_c.X);_c.e.registerClass("_c.e",_h.cK);_c.p.registerClass("_c.p",_a.jO);_c.E.registerClass("_c.E",_a.jO);_c.d.registerClass("_c.d");_c.m.registerClass("_c.m",_a.co);_c.D.registerClass("_c.D",null,_h.dF);_c.j.registerClass("_c.j",_g.k);_c.V.registerClass("_c.V",_no.k);_c.V.prototype.toString=_no.k.prototype.toString;_c.S.registerClass("_c.S",_h.dZ.$$(_c.q),_h.fA);_c.q.registerClass("_c.q",_lm.c);_c.R.registerClass("_c.R",_j.S);_c.c.registerClass("_c.c",_h.cb);_c.k.registerClass("_c.k",_h.dT.$$(_cz.ff,Boolean));_c.I.registerClass("_c.I",null,_db.cI,_h.eY);_c.CreateAttachmentResponseProcessor.registerClass("_c.CreateAttachmentResponseProcessor",_h.dS.$$(_gg.lN,_gg.dI,_gg.gd,_gg.fQ));_c.J.registerClass("_c.J",null,_db.cJ,_h.eY);_c.DeleteAttachmentResponseProcessor.registerClass("_c.DeleteAttachmentResponseProcessor",_h.dS.$$(_gg.pu,_gg.gp,_gg.gq,_gg.gs));_c.K.registerClass("_c.K",null,_db.cL,_h.eY);_c.l.registerClass("_c.l",_h.dT.$$(_cz.eQ,_pc.a));_c.L.registerClass("_c.L",null,_db.cN,_h.eY);_c.PerformReminderActionResponseProcessor.registerClass("_c.PerformReminderActionResponseProcessor",_h.dS.$$(_gg.xT,_gg.jc,_gg.jd,_g.gB));_c.M.registerClass("_c.M",null,_db.cO,_h.eY);CoreModelsComponent.$$cctor();_c.a.a=null;_c.CalendarTimePeriodSchema.c=new _a.f("Start",_a.d,_dg.ICalendarTimePeriod);_c.CalendarTimePeriodSchema.a=new _a.f("End",_a.d,_dg.ICalendarTimePeriod);_c.CalendarTimePeriodSchema.b=new _a.f("Recurrence",_dg.y,_dg.ICalendarTimePeriod);_c.j.a=_a.a.fs;_c.c.a=null;_c.k.a=_a.a.dK;_c.CreateAttachmentResponseProcessor.a=_a.a.c;_c.DeleteAttachmentResponseProcessor.a=_a.a.c;_c.l.a=_a.a.eK;_c.PerformReminderActionResponseProcessor.a=_a.a.fp;
window.scriptsLoaded['microsoft.owa.core.models.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.core.models.js'] = (new Date()).getTime();
