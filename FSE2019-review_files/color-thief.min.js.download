window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['color-thief.min.js'] = (new Date()).getTime();
/*!
 * Color Thief v2.0
 * by Lokesh Dhakar - http://www.lokeshdhakar.com
 *
 * Thanks
 * ------
 * Nick Rabinowitz - For creating quantize.js.
 * John Schulz - For clean up and optimization. @JFSIII
 * Nathan Spady - For adding drag and drop support to the demo page.
 *
 * License
 * -------
 * Copyright 2011, 2015 Lokesh Dhakar
 * Released under the MIT license
 * https://raw.githubusercontent.com/lokesh/color-thief/master/LICENSE
 *
 */
var CanvasImage=function(n){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),document.body.appendChild(this.canvas),this.width=this.canvas.width=n.width,this.height=this.canvas.height=n.height,this.context.drawImage(n,0,0,this.width,this.height)};CanvasImage.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},CanvasImage.prototype.update=function(n){this.context.putImageData(n,0,0)},CanvasImage.prototype.getPixelCount=function(){return this.width*this.height},CanvasImage.prototype.getImageData=function(){return this.context.getImageData(0,0,this.width,this.height)},CanvasImage.prototype.removeCanvas=function(){this.canvas.parentNode.removeChild(this.canvas)};var ColorThief=function(){};
/*!
 * quantize.js Copyright 2008 Nick Rabinowitz.
 * Licensed under the MIT license: http://www.opensource.org/licenses/mit-license.php
 */
/*!
 * Block below copied from Protovis: http://mbostock.github.com/protovis/
 * Copyright 2010 Stanford Visualization Group
 * Licensed under the BSD License: http://www.opensource.org/licenses/bsd-license.php
 */
if(ColorThief.prototype.getColor=function(n,t){var i=this.getPalette(n,5,t);return i==null?null:i[0]},ColorThief.prototype.getPalette=function(n,t,i){"undefined"==typeof t&&(t=10),("undefined"==typeof i||1>i)&&(i=10);for(var r,o,h,s,a,f=new CanvasImage(n),p=f.getImageData(),u=p.data,y=f.getPixelCount(),c=[],e=0;y>e;e+=i)r=4*e,o=u[r+0],h=u[r+1],s=u[r+2],a=u[r+3],a>=125&&(o>250&&h>250&&s>250||c.push([o,h,s]));var l=MMCQ.quantize(c,t),v=l?l.palette():null;return f.removeCanvas(),v},!pv)var pv={map:function(n,t){var i={};return t?n.map(function(n,r){return i.index=r,t.call(i,n)}):n.slice()},naturalOrder:function(n,t){return t>n?-1:n>t?1:0},sum:function(n,t){var i={};return n.reduce(t?function(n,r,u){return i.index=u,n+t.call(i,r)}:function(n,t){return n+t},0)},max:function(n,t){return Math.max.apply(null,t?pv.map(n,t):n)}};var MMCQ=function(){function t(n,t,r){return(n<<2*i)+(t<<i)+r}function r(n){function r(){t.sort(n),i=!0}var t=[],i=!1;return{push:function(n){t.push(n),i=!1},peek:function(n){return i||r(),void 0===n&&(n=t.length-1),t[n]},pop:function(){return i||r(),t.pop()},size:function(){return t.length},map:function(n){return t.map(n)},debug:function(){return i||r(),t}}}function u(n,t,i,r,u,f,e){var o=this;o.r1=n,o.r2=t,o.g1=i,o.g2=r,o.b1=u,o.b2=f,o.histo=e}function f(){this.vboxes=new r(function(n,t){return pv.naturalOrder(n.vbox.count()*n.vbox.volume(),t.vbox.count()*t.vbox.volume())})}function h(r){var f,s,e,o,h=1<<3*i,u=new Array(h);return r.forEach(function(i){s=i[0]>>n,e=i[1]>>n,o=i[2]>>n,f=t(s,e,o),u[f]=(u[f]||0)+1}),u}function s(t,i){var e,f,r,c=1e6,l=0,a=1e6,o=0,s=1e6,h=0;return t.forEach(function(t){e=t[0]>>n,f=t[1]>>n,r=t[2]>>n,c>e?c=e:e>l&&(l=e),a>f?a=f:f>o&&(o=f),s>r?s=r:r>h&&(h=r)}),new u(c,l,a,o,s,h,i)}function l(n,i){function y(n){var c,a,e,v,t,f=n+"1",u=n+"2",h=0;for(r=i[f];r<=i[u];r++)if(s[r]>o/2){for(e=i.copy(),v=i.copy(),c=r-i[f],a=i[u]-r,t=a>=c?Math.min(i[u]-1,~~(r+a/2)):Math.max(i[f],~~(r-1-c/2));!s[t];)t++;for(h=l[t];!h&&s[t-1];)h=l[--t];return e[u]=t,v[f]=e[u]+1,[e,v]}}if(i.count()){var v=i.r2-i.r1+1,a=i.g2-i.g1+1,p=i.b2-i.b1+1,c=pv.max([v,a,p]);if(1==i.count())return[i.copy()];var r,f,u,e,h,o=0,s=[],l=[];if(c==v)for(r=i.r1;r<=i.r2;r++){for(e=0,f=i.g1;f<=i.g2;f++)for(u=i.b1;u<=i.b2;u++)h=t(r,f,u),e+=n[h]||0;o+=e,s[r]=o}else if(c==a)for(r=i.g1;r<=i.g2;r++){for(e=0,f=i.r1;f<=i.r2;f++)for(u=i.b1;u<=i.b2;u++)h=t(f,r,u),e+=n[h]||0;o+=e,s[r]=o}else for(r=i.b1;r<=i.b2;r++){for(e=0,f=i.r1;f<=i.r2;f++)for(u=i.g1;u<=i.g2;u++)h=t(f,u,r),e+=n[h]||0;o+=e,s[r]=o}return s.forEach(function(n,t){l[t]=o-n}),y(c==v?"r":c==a?"g":"b")}}function c(n,t){function a(n,t){for(var i,o=1,r=0;e>r;)if(i=n.pop(),i.count()){var s=l(c,i),u=s[0],f=s[1];if(!u)return;if(n.push(u),f&&(n.push(f),o++),o>=t)return;if(r++>e)return}else n.push(i),r++}if(!n.length||2>t||t>256)return!1;var c=h(n),y=0;c.forEach(function(){y++});var p=s(n,c),u=new r(function(n,t){return pv.naturalOrder(n.count(),t.count())});u.push(p),a(u,o*t);for(var i=new r(function(n,t){return pv.naturalOrder(n.count()*n.volume(),t.count()*t.volume())});u.size();)i.push(u.pop());a(i,t-i.size());for(var v=new f;i.size();)v.push(i.pop());return v}var i=5,n=8-i,e=1e3,o=.75;return u.prototype={volume:function(n){var t=this;return(!t._volume||n)&&(t._volume=(t.r2-t.r1+1)*(t.g2-t.g1+1)*(t.b2-t.b1+1)),t._volume},count:function(n){var i=this,o=i.histo;if(!i._count_set||n){for(var r,u,e=0,f=i.r1;f<=i.r2;f++)for(r=i.g1;r<=i.g2;r++)for(u=i.b1;u<=i.b2;u++)index=t(f,r,u),e+=o[index]||0;i._count=e,i._count_set=!0}return i._count},copy:function(){var n=this;return new u(n.r1,n.r2,n.g1,n.g2,n.b1,n.b2,n.histo)},avg:function(n){var r=this,y=r.histo;if(!r._avg||n){for(var s,o,f,a,e=0,u=1<<8-i,c=0,l=0,v=0,h=r.r1;h<=r.r2;h++)for(o=r.g1;o<=r.g2;o++)for(f=r.b1;f<=r.b2;f++)a=t(h,o,f),s=y[a]||0,e+=s,c+=s*(h+.5)*u,l+=s*(o+.5)*u,v+=s*(f+.5)*u;r._avg=e?[~~(c/e),~~(l/e),~~(v/e)]:[~~(u*(r.r1+r.r2+1)/2),~~(u*(r.g1+r.g2+1)/2),~~(u*(r.b1+r.b2+1)/2)]}return r._avg},contains:function(t){var i=this,r=t[0]>>n;return gval=t[1]>>n,bval=t[2]>>n,r>=i.r1&&r<=i.r2&&gval>=i.g1&&gval<=i.g2&&bval>=i.b1&&bval<=i.b2}},f.prototype={push:function(n){this.vboxes.push({vbox:n,color:n.avg()})},palette:function(){return this.vboxes.map(function(n){return n.color})},size:function(){return this.vboxes.size()},map:function(n){for(var i=this.vboxes,t=0;t<i.size();t++)if(i.peek(t).vbox.contains(n))return i.peek(t).color;return this.nearest(n)},nearest:function(n){for(var u,r,f,i=this.vboxes,t=0;t<i.size();t++)r=Math.sqrt(Math.pow(n[0]-i.peek(t).color[0],2)+Math.pow(n[1]-i.peek(t).color[1],2)+Math.pow(n[2]-i.peek(t).color[2],2)),(u>r||void 0===u)&&(u=r,f=i.peek(t).color);return f},forcebw:function(){var n=this.vboxes;n.sort(function(n,t){return pv.naturalOrder(pv.sum(n.color),pv.sum(t.color))});var i=n[0].color;i[0]<5&&i[1]<5&&i[2]<5&&(n[0].color=[0,0,0]);var r=n.length-1,t=n[r].color;t[0]>251&&t[1]>251&&t[2]>251&&(n[r].color=[255,255,255])}},{quantize:c}}();
window.scriptsLoaded['color-thief.min.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['color-thief.min.js'] = (new Date()).getTime();
