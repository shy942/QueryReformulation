window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.ariaanalytics.js'] = (new Date()).getTime();
Type.registerNamespace("_ar");function AriaAnalyticsComponent(){}AriaAnalyticsComponent.$$cctor=function(){_a.t.a().a(AriaAnalyticsComponent)};AriaAnalyticsComponent.prototype={b:function(n,t,i){var r=this;n.b(_a.eU,function(){return new _ar.a(i,n.a(_g.h),n.a(_a.e),n.a(_j.j))}).a()},a:function(){return[]}};_ar.a=function(n,t,i,r){this.h=Function.createDelegate(this,this.m);this.d=[];this.e=n;this.g=t.c();this.f=i;r.b(_a.el,this.h);if(AWTLogManager&&AWTLogManager.getLogger){AWTLogManager.initialize(_ar.c.a);this.n();this.k()}};_ar.a.b=function(n,t){try{t.a().logEvent(n);return!0}catch(i){_j.e.b(_a.a.cS,"Aria SDK rejected event '{1}' with exception: {1}",n.getName(),i.message);return!1}};_ar.a.prototype={e:null,f:null,g:null,a:function(n,t){for(var u=null,f=this.d,e=f.length,i=0;i<e;++i){var r=f[i];if(n.j&r.e&&r.d(this.f,n,null)){if(!u){n.o(this.e.r());u=this.i(n.g(),n.i,t)}if(!_ar.a.b(u,r))break}}},c:function(n){for(var c=n,h=c,l=h.length,o=0;o<l;++o){var t=h[o];if(t.Id==="PerfTraceCTQ"){for(var s=null,u={},i=0;i<t.Keys.length;i++){var f=t.Keys[i];switch(f){case"S":s=t.Values[i];break;case"T":case"set":case"E":u[f]=t.Values[i];break;case"cd":for(var e=f.split(new RegExp("_|\\|")),r=0;r<e.length;r=r+2)u[e[r]]=e[r+1];break;default:break}}this.o(s,u)}}},b:function(){for(var t=new _ar.f(this.f.a().cj().AriaTenant||"536210ce7a1a4bd986125e27e23a00e0-2486518a-2bf6-43c8-9c21-f5482fbeff73-7283"),r=!1,i=this.d,f=i.length,n=0;n<f;++n){var u=i[n];Object.getType(u)===_ar.f&&(r=!0)}r||this.d.push(t);t.g(this.f)&&t.c.logSession(0,null)},o:function(n,t){for(var r=null,f=this.d,e=f.length,i=0;i<e;++i){var u=f[i];if(u.b(n)){r||(r=this.i(n,t,0));if(!_ar.a.b(r,u))return}}},i:function(n,t,i){for(var e=this.j(n,i),o=Object.keys(t),s=o.length,r=0;r<s;r++){var u=o[r];var f=this.l(u,i===1);try{e.setProperty(f,t[u],0)}catch(h){_j.e.b(_a.a.cS,"Aria SDK rejected event property name '{0}' (sanitized to {1}) for event '{2}'",u,f,n)}}return e},k:function(){this.d.push(new _ar.c);this.d.push(new _ar.e);this.d.push(new _ar.b);this.d.push(new _ar.d);for(var i=this.d,r=i.length,n=0;n<r;++n){var t=i[n];t.g(this.f)&&t.c.logSession(0,null)}},n:function(){var t=AWTLogManager.getSemanticContext();t.setAppVersion(this.e.h());t.setAppLanguage(this.e.y());var i=new RegExp(";[^;]*UC[^;]*=([^;]*)");var n=i.exec(document.cookie);n&&n.length>=2&&t.setUserId(n[1])},m:function(n){for(var r=this.d,u=r.length,t=0;t<u;++t){var i=r[t];i.g(this.f)&&i.c.logSession(1,null)}AWTLogManager&&AWTLogManager.flush()},l:function(n,t){var i=n.replace(_ar.a.a,"_");return t?i:"owa_"+i},j:function(n,t){var i=new AWTEventProperties(n.replace(_ar.a.a,"_"));var r=this.e.h().split(".");var u=r.length>2?r[0]+"."+r[1]:this.e.h();if(t===1){i.setProperty("MajorVersion",u,0);i.setProperty("TenantName",this.g.bH.TenantDomain,0);i.setProperty("TenantId",this.g.bH.ExternalDirectoryTenantGuid,0);i.setProperty("IFrame",this.e.i().toString(),0);i.setProperty("DeploymentRing",this.f.a().cj().DeploymentRing||"TDS",0)}else{i.setProperty("owadef_ut",_g.a.a().E?"1":"0",0);i.setProperty("owadef_layout",_y.c.a.a(),0);i.setProperty("owadef_tenantg",this.g.bH.TenantGuid,0);i.setProperty("owadef_mbxg",this.g.bH.MailboxGuid,0);i.setProperty("owadef_mbxp",this.g.bH.UserPuid,0);i.setProperty("owadef_be",window.navBackEndServer,0);i.setProperty("owa_majorver",u,0)}return i}};_ar.g=function(n,t,i){this.f={};_j.s.h(n,0,"tenantType");_j.s.a(t,"tenantToken");if(i)for(var f=i,e=f.length,r=0;r<e;++r){var u=f[r];this.f[u]=u}this.c=AWTLogManager.getLogger(t);this.e=n};_ar.g.prototype={c:null,a:function(){return this.c},e:0,b:function(n){return!_j.h.b(n)&&n in this.f},d:function(n,t,i){var r=!1;var u=t?t.g():i;switch(u){case"Usage":r=n.a().dR().Enabled||_a.bm.c(n,null,_y.c.a.a(),!1);break;case"CorePerf":r=n.a().dO().Enabled;break;case"SamplePerf":r=n.a().dQ().Enabled;break;case"owaclienterror":r=n.a().dP().Enabled;break;case"session":r=n.a().dO().Enabled||n.a().dP().Enabled||n.a().dQ().Enabled||n.a().dR().Enabled;break;default:break}return r},g:function(n){return this.d(n,null,"session")}};_ar.f=function(n){_ar.f.initializeBase(this,[32,n,null])};_ar.f.prototype={d:function(n,t,i){return n.a().cj().Enabled&&(i==="session"||!!t&&t.j===32)}};_ar.b=function(){_ar.b.initializeBase(this,[8,_ar.b.a,_ar.b.b])};_ar.e=function(){_ar.e.initializeBase(this,[2,_ar.e.a,null])};_ar.e.prototype={d:function(n,t,i){var r=!1;var u=t?t.g():i;switch(u){case"Usage":case"CorePerf":case"SamplePerf":r=n.a().jV().Enabled;break;default:break}return r}};_ar.d=function(){_ar.d.initializeBase(this,[16,_ar.d.a,null])};_ar.d.prototype={d:function(n,t,i){var r=t?t.g():i;return r==="CorePerf"?!0:!1}};_ar.c=function(){_ar.c.initializeBase(this,[1,_ar.c.a,null])};AriaAnalyticsComponent.registerClass("AriaAnalyticsComponent",null,_a.kh,_j.ce);_ar.g.registerClass("_ar.g",null,_y.kj);_ar.f.registerClass("_ar.f",_ar.g);_ar.b.registerClass("_ar.b",_ar.g);_ar.e.registerClass("_ar.e",_ar.g);_ar.d.registerClass("_ar.d",_ar.g);_ar.c.registerClass("_ar.c",_ar.g);AriaAnalyticsComponent.$$cctor();_ar.a.a=new RegExp("[^a-zA-Z0-9_]+","g");_ar.b.a="978f0a4574614d73b316043d2ee6ec94-888f068a-4993-4ad7-8ecb-50ad875cfed8-7307";_ar.b.b=["FL.GN","FL.GUCL","ClickGroupsDiscoveryEndToEnd","NavigateFromMeToWeSpaceMail","GroupHeaderModuleSwitch","SwitchGroup","SwitchGroupConversation","Group_Conversation_E2E_Post"];_ar.e.a="23bf92431eeb425b85357b276ea236fb-f1061998-013f-4307-94b0-a711da4fe80e-7012";_ar.d.a=" cc1920a404f34459bfd3df750aaebf97-033ebeb1-ebd8-4e8f-9ee1-f620a30cd05e-7162";_ar.c.a="10f398a784604301b583d289d31ac608-e6197a1d-8df3-48b2-bc01-25057dd8e015-7020";
window.scriptsLoaded['microsoft.owa.ariaanalytics.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.ariaanalytics.js'] = (new Date()).getTime();
