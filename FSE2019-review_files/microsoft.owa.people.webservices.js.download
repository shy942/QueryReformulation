window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.people.webservices.js'] = (new Date()).getTime();
Type.registerNamespace("_pw");_pw.t=function(n){_pw.t.initializeBase(this);this.Application=n};_pw.k=function(n){_pw.k.initializeBase(this,[n])};_pw.c=function(n,t){_pw.c.initializeBase(this,[n]);this.__type=_pw.c._dataContractName;this.Body=t};_pw.d=function(){_pw.d.initializeBase(this);this.__type=_pw.d._dataContractName;this.Body=new _pw.b};_pw.e=function(n){_pw.e.initializeBase(this,[n]);this.__type=_pw.e._dataContractName};_pw.e._TZ=function(n,t,i,r){t!==i&&n&&r.a(!1,n,i,t,["InsightWindowStartTime","InsightWindowEndTime"],null)};_pw.b=function(){_pw.b.initializeBase(this);this.__type=_pw.b._dataContractName};_pw.s=function(){_pw.s.initializeBase(this);this.__type=_pw.s._dataContractName;this.Name=_name;this.Val=_val};_pw.a=function(n){_pw.a.initializeBase(this);this.__type=_pw.a._dataContractName;this.InsightId=n};_pw.a._TZ=function(n,t,i,r){t!==i&&n&&r.a(!1,n,i,t,["StartTimeUtc","EndTimeUtc"],null)};_pw.j=function(n){_pw.j.initializeBase(this);this.__type=_pw.j._dataContractName;this.ViewType=n};_pw.u=function(){_pw.u.initializeBase(this)};_pw.g=function(n){_pw.g.initializeBase(this);this.__type=_pw.g._dataContractName;this.PersonEmailAddress=n};_pw.n=function(){_pw.n.initializeBase(this);this.__type=_pw.n._dataContractName};_pw.l=function(n){_pw.l.initializeBase(this,[n])};_pw.m=function(){_pw.m.initializeBase(this);this.__type=_pw.m._dataContractName;this.Body=new _pw.n};_pw.f=function(n,t){_pw.f.initializeBase(this,[n]);this.__type=_pw.f._dataContractName;this.Body=t};_pw.r=function(){_pw.r.initializeBase(this);this.__type=_pw.r._dataContractName};_pw.i=function(n){_pw.i.initializeBase(this);this.__type=_pw.i._dataContractName;this.StartDate=n};_pw.i._TZ=function(n,t,i,r){t!==i&&n&&r.a(!1,n,i,t,["StartDate"],null)};_pw.q=function(n){_pw.q.initializeBase(this,[n])};_pw.p=function(){_pw.p.initializeBase(this);this.__type=_pw.p._dataContractName};_pw.h=function(){_pw.h.initializeBase(this);this.__type=_pw.h._dataContractName};_pw.o=function(n){_pw.o.initializeBase(this,[n])};function FakeGetPeopleUserMeetsWithAction(n,t,i){this.l=Function.createDelegate(this,this.D);this.m=Function.createDelegate(this,this.be);FakeGetPeopleUserMeetsWithAction.resolveInheritance();this.e=this.cX;FakeGetPeopleUserMeetsWithAction.initializeBase(this);this.f=n;this.p=t;this.j=i}FakeGetPeopleUserMeetsWithAction.prototype={f:null,p:null,j:null,K:function(n){this.h={};this.u()},cU:function(n,t,i){t()},bh:function(n,t){_h.fN.prototype.bh.call(this,n,t)},h:null,o:null,u:function(){var t=_g.j.a("calendar").bH.FolderId;var n=new _cc.bz;n.bi=new _j.l;n.bg=t;n.be=new _h.m(_a.d.a(),_a.d.a().d().c(1));n.bj=5;n.c(this.m);n.b(this.l);this.f.a(n)},D:function(n){var t=n;this.bc(t.G)},be:function(n){var r=n;var t=new _j.l;var i=new _j.l;var u=this;r.bi.o(function(n){var r=n;r&&!_j.z.a(r.bH.IsAllDayEvent)&&r.bH.IsAllDayEvent?i.a(r):t.a(r)});t.j(i.f());this.r(t)},r:function(n){if(!n||n.x.length<=0)this.k(new _j.l,null);else for(var r=n.x.length,u=new Array(r),i=this,f=function(n){return function(t){var e=t;var o=new _cc.bO(e.bH.ItemId,"Best","defaultMode");var f=new _cc.R(400,o,!0,!1);f.c(function(t){r--;var o=t.p;u[n]=o;if(!r){var f=new _j.l;f.j(u);var e=i.t(f);i.s(e,f)}});i.f.a(f)}},t=0;t<n.x.length;t++)f(t)(n.x[t])},t:function(n){var t=new _j.l;if(n){var i=this;n.o(function(n){var r=n;r&&r.v()&&r.v().n(function(n){var u=n;if(t.x.length<18&&u.b()!=="Decline"&&!_g.a.a().c().b().j(u.bH.Mailbox.EmailAddress)&&!t.w(u.bH.Mailbox,function(n,t){return n.EmailAddress===t.EmailAddress})){i.h[u.bH.Mailbox.EmailAddress]=r;t.a(u.bH.Mailbox)}})})}return t},s:function(n,t){var r=new _j.l;if(!n||n.x.length<=0)this.k(r,null);else{for(var e=n.x.length,f=0;f<n.x.length;f++)r.a(null);for(var u=this,o=function(n){return function(i){var o=i;var f=u.j.a(o);f.a(function(i){if(!i.G){var o=i;var f=o.N.Body.Persona;r.q(n,f)}e--;e||u.k(r,t)});u.f.a(f)}},s=n.f(),i=0;i<n.x.length;i++)o(i)(n.x[i])}},k:function(n,t){for(var i=n.x.length-1;i>=0;i--){var u=n.x[i];u&&u.PersonaTypeString===_bc.c.toString(1)||n.n(i)}this.bg(n,t);var f=new _gg.N;var r=new _dg.Q;r.ResultSet=n.f();this.o=new _j.q(r.ResultSet);f.Body=r;this.bh(this.Q,f)},bg:function(n,t){var i=this.q(t);if(n){var r=this;n.o(function(n){var r=n;var t=r.EmailAddress.EmailAddress;t in i&&(r.UnreadCount=i[t])})}},q:function(n){var t={};if(n){var i=this;n.o(function(n){var r=n;r.v().n(function(n){var u=n;var f=i.h[u.bH.Mailbox.EmailAddress];if(f&&f.bH.ItemId&&r.bH.ItemId&&u.b()!=="Decline"&&f.bH.ItemId.Id!==r.bH.ItemId.Id){u.bH.Mailbox.EmailAddress in t||(t[u.bH.Mailbox.EmailAddress]=0);var e=t[u.bH.Mailbox.EmailAddress];t[u.bH.Mailbox.EmailAddress]=e+1}})})}return t}};function FakeGetPeopleWaitingOnMeAction(n,t,i,r,u){this.u=Function.createDelegate(this,this.bo);this.D=Function.createDelegate(this,this.bp);FakeGetPeopleWaitingOnMeAction.resolveInheritance();this.e=this.cX;FakeGetPeopleWaitingOnMeAction.initializeBase(this);this.k=n;this.be=t;this.t=i;this.s=u;this.r=r}FakeGetPeopleWaitingOnMeAction.b=function(n,t){var u=new _j.q;if(n&&n.length>0)for(var i=0;i<n.length;i++){var r=n[i];t(r)&&u.c(r)}return u};FakeGetPeopleWaitingOnMeAction.prototype={k:null,be:null,t:null,s:null,r:null,q:null,j:null,p:null,l:null,h:0,K:function(n){this.m={};this.q=new _j.l;this.j=new _j.q;this.p=new _j.q;var t=_g.b.a.nameToId("msgfolderroot");this.bl(this.r)},cU:function(n,t,i){t()},bh:function(n,t){var i=!!t&&!!t.Body&&!!t.Body.ResultSet;var r=!i||t.Body.ResultSet.length<=5;if(r&&this.h<5){i&&this.h<=2&&(this.h=2);this.h++;this.h<=2?this.K(null):this.br()}else _h.fN.prototype.bh.call(this,n,t)},bc:function(n){this.h<5?this.bh(this.Q,null):_h.fN.prototype.bc.call(this,n)},o:null,f:function(n){this.o=n;return n},bg:function(){if(!this.l){var n=this.o?this.o.bx:null;if(n&&n.x.length>0){this.l={};for(var t=0;t<n.x.length;t++){var i=n.x[t].a().EmailAddress;this.l[i]=n.x[t]}}}return this.l},m:null,bl:function(n){var r,i;var u=(i=new _gg.R,i.FolderScope=(r=new _gg.J,r.BaseFolderId=_g.b.a.nameToId("inbox"),r),i);var f=String.format("to:{0} AND received>={1}",this.t.c().bH.UserDisplayName,_a.d.a().c(-7).d().z());var t=n.g(_a.C.a(),f,null,"MailConversations",null,!1,0,0,25,25,0,[u],1,"DateTime",2);t.c(this.D);t.b(this.u);this.k.a(t)},bo:function(n){var t=n;this.bc(t.G)},bp:function(n){var u=n;var f=u.e.Conversations;var r=this;var t=FakeGetPeopleWaitingOnMeAction.b(f,function(n){var t=n;return(t.FlagStatus==="Flagged"||t.UnreadCount>0)&&r.bq(t.From.Mailbox)});var i=this.bj(t);this.bi(i)},bj:function(n){if(!n||n.d.length<=0)return new _j.q;for(var r=new _j.q,u=0;u<n.d.length&&r.d.length<18;u++){var t=n.d[u];if(t&&t.From&&t.From.Mailbox){var i=t.From.Mailbox;var f=this;if(this.q.w(i,function(n,t){return n.EmailAddress===t.EmailAddress}))this.m[i.EmailAddress].UnreadCount++;else{this.m[i.EmailAddress]=t;t.UnreadCount=0;r.c(i);this.q.a(i)}}}return r},bi:function(n){if(!n||n.d.length<=0){var i,f;var s=(f=new _gg.N,f.Body=(i=new _dg.Q,i.ResultSet=new Array(0),i),f);this.bh(this.Q,s);return}for(var o=n.d.length,r=new _j.q,e=0;e<n.d.length;e++)r.c(null);for(var u=this,h=function(n){return function(t){var f=t;var i=u.s.a(f);i.a(function(t){if(!t.G){var f=t;var i=f.N.Body.Persona;r.o(n,i)}o--;o||u.bs(r)});u.k.a(i)}},c=n.i(),t=0;t<n.d.length;t++)h(t)(n.d[t])},bs:function(n){for(var i=n.d.length-1;i>=0;i--){var r=n.d[i];r?this.h<=2?this.j.c(r):this.p.c(r):n.j(i)}var t=this.j.i();if(this.h<=2){var o=this;t.sort(function(n,t){return n.EmailAddress.RelevanceScore-t.EmailAddress.RelevanceScore});this.j.f();this.j.h(t)}else{var f=this.p.i();var s=this;f.sort(function(n,t){return n.EmailAddress.RelevanceScore-t.EmailAddress.RelevanceScore});t=t.concat.apply(t,f)}var u=new _gg.N;var e=new _dg.Q;e.ResultSet=t;u.Body=e;this.bh(this.Q,u)},bq:function(n){return!this.bg()||n.EmailAddress in this.bg()},br:function(){var t;var n;switch(this.h){case 3:t="Mentioned";var u=this;n=function(n){var t=n;var r=_a.d.b(t.DateTimeReceived);var i=r.k(FakeGetPeopleWaitingOnMeAction.a)>=0;return t.IconIndex!=="MailReplied"&&i};break;case 4:t="Flagged";var r=this;n=function(n){var t=n;var r=_a.d.b(t.DateTimeReceived);var i=r.k(FakeGetPeopleWaitingOnMeAction.a)>=0;return t.Flag.FlagStatus==="Flagged"&&i};break;case 5:t="ToOrCcMe";var i=this;n=function(n){var t=n;var r=_a.d.b(t.DateTimeReceived);var i=r.k(FakeGetPeopleWaitingOnMeAction.a)>=0;return t.IconIndex!=="MailReplied"&&i};break;default:return}this.bk(t,n)},bk:function(n,t){var r;var i=new _h.bm(_g.b.a.nameToId("inbox"),null,(r=new _g.V("AllProperties"),r.AdditionalProperties=[new _g.d("IconIndex")],r),"None",_h.x.a(0,25),!0,n,new _h.q("ConversationLastDeliveryTime","Descending"),!1,null,null,400,null,-1,null,!1);var u=this;i.c(function(n){var f=n;var r=FakeGetPeopleWaitingOnMeAction.b(f.f(),t);var i=u.bj(r);u.bi(i)});var f=this;i.b(function(n){f.bc(n.G)});this.k.a(i)}};function GetPeopleUserMeetsWithAction(n,t,i){GetPeopleUserMeetsWithAction.resolveInheritance();this.e=this.cX;GetPeopleUserMeetsWithAction.initializeBase(this);this.l=n;this.m=t;this.o=i}GetPeopleUserMeetsWithAction.prototype={l:null,m:null,o:null,j:null,K:function(n){this.h={};var i=new _pw.o(this.L);var t=new _pw.h;t.RangeStart=this.k(_a.d.a().i(),this.Y(),"UTC");t.RangeEnd=this.k(_a.d.a().d().c(1).i(),this.Y(),"UTC");n.gb(t,i,this.I,this.H)},cU:function(n,t,i){this.f=new _j.q;if(n.AttendeeEventMap.length>0){var u=new _j.q;var c=new _j.q;this.j={};for(var h=n.Attendees,l=h.length,e=0;e<l;++e){var f=h[e];f&&f.EmailAddress&&(this.j[f.EmailAddress.EmailAddress]=f)}for(var s=n.Events,a=s.length,o=0;o<a;++o){var r=s[o];if(r){r.Start=this.k(r.Start,"UTC",this.Y());r.End=this.k(r.End,"UTC",this.Y());(r.FreeBusyType==="Busy"||r.FreeBusyType==="Tentative")&&(!_j.z.a(r.IsAllDayEvent)&&r.IsAllDayEvent?c.c(new _dg.a(r)):u.c(new _dg.a(r)))}}u.h(c.i());this.r(u.i());this.q(this.f,u.i())}t()},bh:function(n,t){_h.fN.prototype.bh.call(this,n,t)},h:null,f:null,r:function(n){var f={};if(n)for(var u=n,e=u.length,r=0;r<e;++r){var i=u[r];if(i&&i.v()){var t=this;i.v().n(function(n){var r=n;if(t.f.d.length<30&&r.b()!=="Decline"&&!_g.a.a().c().b().j(r.bH.Mailbox.EmailAddress)&&!f[r.bH.Mailbox.EmailAddress]){t.h[r.bH.Mailbox.EmailAddress]=i;if(r.bH.Mailbox.EmailAddress in t.j){t.f.c(t.j[r.bH.Mailbox.EmailAddress]);f[r.bH.Mailbox.EmailAddress]=!0}}})}}},q:function(n,t){var f=this.p(t);if(n)for(var e=n.i(),o=e.length,i=0;i<o;++i){var u=e[i];var r=u.EmailAddress.EmailAddress;r in f&&(u.UnreadCount=f[r])}},p:function(n){var t={};if(n)for(var u=n,e=u.length,i=0;i<e;++i){var r=u[i];var f=this;r.v().n(function(n){var i=n;var u=f.h[i.bH.Mailbox.EmailAddress];if(u&&u.ItemId&&r.bH.ItemId&&i.b()!=="Decline"&&u.ItemId.Id!==r.bH.ItemId.Id){i.bH.Mailbox.EmailAddress in t||(t[i.bH.Mailbox.EmailAddress]=0);var e=t[i.bH.Mailbox.EmailAddress];t[i.bH.Mailbox.EmailAddress]=e+1}})}return t},k:function(n,t,i){return t!==i&&n?_a.v.c().u().b(t,i,n):n}};function PeopleYouMayHaveMissedAction(n,t,i,r,u){this.D=Function.createDelegate(this,this.bo);this.be=Function.createDelegate(this,this.bp);PeopleYouMayHaveMissedAction.resolveInheritance();this.e=this.cX;PeopleYouMayHaveMissedAction.initializeBase(this);this.m=n;this.bi=t;this.bk=i;this.t=u;this.bg=r}PeopleYouMayHaveMissedAction.b=function(n,t){var u=new _j.q;if(n&&n.length>0)for(var i=0;i<n.length;i++){var r=n[i];t(r)&&u.c(r)}return u};PeopleYouMayHaveMissedAction.prototype={m:null,bi:null,bk:null,t:null,bg:null,l:null,o:null,p:null,q:null,h:1,K:function(n){this.k={};this.l=new _j.l;this.o=new _j.q;this.p=new _j.q;this.bl()},cU:function(n,t,i){t()},bh:function(n,t){var i=!!t&&!!t.Body&&!!t.Body.ResultSet;var r=!i||t.Body.ResultSet.length<3;if(r&&this.h<5){if(this.h<=2)if(i||this.h===2){this.h=2;try{this.bt()}catch(u){_j.e.c(_a.a.q,u.message)}}else this.K(null)}else this.z()!==3&&_h.fN.prototype.bh.call(this,n,t);this.h++},bc:function(n){this.h<5?this.bh(this.Q,null):_h.fN.prototype.bc.call(this,n)},r:null,f:function(n){this.r=n;return n},j:function(){if(!this.q){var n=this.r?this.r.bx:null;if(n&&n.x.length>0){this.q={};for(var t=0;t<n.x.length;t++){var i=n.x[t].a().EmailAddress;this.q[i]=n.x[t]}}}return this.q},k:null,bl:function(){var n=new GetPeopleWaitingOnUserAction(null);n.c(this.be);n.b(this.D);this.m.a(n)},bo:function(n){var t=n;this.bc(t.G)},bp:function(n){var p=n;var i=p?p.N:null;var a=new _j.q;if(i&&i.SenderMap&&i.SenderMap.length>0){for(var o={},s={},v=i.Messages,d=v.length,e=0;e<d;++e){var y=v[e];o[y.ItemId.Id]=y}for(var w=i.Senders,b=w.length,u=0;u<b;++u){var c=w[u];s[c.EmailAddress.EmailAddress]=c}for(var l=i.SenderMap,k=l.length,f=0;f<k;++f){var r=l[f];if(r.Sender in s&&r.Messages.length>0&&r.Messages[0].Id in o){var t=s[r.Sender];var h=o[r.Messages[0].Id];if(this.bs(t.EmailAddress)){var g=this;if(this.l.w(t,function(n,t){return n.EmailAddress===t.EmailAddress}))this.k[t.EmailAddress.EmailAddress].UnreadCount++;else{this.k[t.EmailAddress.EmailAddress]=h;h.UnreadCount=0;this.l.a(t.EmailAddress);a.c(t)}}}}}this.u(a)},br:function(n){if(!n||n.d.length<=0)return new _j.q;for(var r=new _j.q,u=0;u<n.d.length&&r.d.length<30;u++){var t=n.d[u];if(t&&t.From&&t.From.Mailbox){var i=t.From.Mailbox;var f=this;if(this.l.w(i,function(n,t){return n.EmailAddress===t.EmailAddress}))this.k[i.EmailAddress].UnreadCount++;else{this.k[i.EmailAddress]=t;t.UnreadCount=0;r.c(i);this.l.a(i)}}}return r},bq:function(n){if(!n||n.d.length<=0){var f,e;var s=(e=new _gg.N,e.Body=(f=new _dg.Q,f.ResultSet=new Array(0),f),e);this.bh(this.Q,s);return}for(var r=n.d.length,i=new _j.q,o=0;o<n.d.length;o++)i.c(null);for(var t=this,h=function(n){return function(u){var o=u;var e=t.j()?t.j()[o.EmailAddress]:null;if(e){i.o(n,e.dv.bH);r--;r||t.u(i)}else{var f=t.t.a(o);f.a(function(u){if(!u.G){var e=u;var f=e.N.Body.Persona;i.o(n,f)}r--;r||t.u(i)});t.m.a(f)}}},c=n.i(),u=0;u<n.d.length;u++)h(u)(n.d[u])},u:function(n){for(var t=n.d.length-1;t>=0;t--){var r=n.d[t];r?this.h<=2?this.o.c(r):this.p.c(r):n.j(t)}this.h<=2?this.bj(this.o):this.bj(this.p);var i=new _j.q;i.h(this.o.i());i.h(this.p.i());var f=new _gg.N;var u=new _dg.Q;u.ResultSet=i.i();f.Body=u;this.bh(this.Q,f)},bj:function(n){var i=n.i();var t=this;i.sort(function(n,i){var u=n.EmailAddress;var f=i.EmailAddress;var r=0;if(t.j()){u.EmailAddress in t.j()&&(r-=t.j()[u.EmailAddress].fE());f.EmailAddress in t.j()&&(r+=t.j()[f.EmailAddress].fE())}r||(r=u.RelevanceScore-f.RelevanceScore);return r});n.f();n.h(i)},bs:function(n){return!this.j()||n.EmailAddress in this.j()},bt:function(){var i=this;this.s("Mentioned",function(n){var t=n;var r=_a.d.b(t.DateTimeReceived);var i=r.k(PeopleYouMayHaveMissedAction.a)>=0;return t.IconIndex!=="MailReplied"&&i});var t=this;this.s("Flagged",function(n){var t=n;var r=_a.d.b(t.DateTimeReceived);var i=r.k(PeopleYouMayHaveMissedAction.a)>=0;return t.Flag.FlagStatus==="Flagged"&&i});var n=this;this.s("ToOrCcMe",function(n){var t=n;var r=_a.d.b(t.DateTimeReceived);var i=r.k(PeopleYouMayHaveMissedAction.a)>=0;return t.IconIndex!=="MailReplied"&&i})},s:function(n,t){var u;var r=new _h.bm(_g.b.a.nameToId("inbox"),null,(u=new _g.V("AllProperties"),u.AdditionalProperties=[new _g.d("IconIndex")],u),"None",_h.x.a(0,50),!0,n,new _h.q("ConversationLastDeliveryTime","Descending"),!1,null,null,400,null,-1,null,!1);var i=this;r.c(function(n){var f=n;if(i.z()!==3){var u=PeopleYouMayHaveMissedAction.b(f.f(),t);var r=i.br(u);i.bq(r)}});var f=this;r.b(function(n){f.z()!==3&&f.bc(n.G)});this.m.a(r)}};function FindInsightsActionFactory(n,t){this.d=n;this.c=t}FindInsightsActionFactory.prototype={d:null,c:null,b:function(n,t,i,r){_j.s.c(!n||!!t&&!!t.length,"itemLinkIds must be set for non-Persona InsightsByViews");_j.s.c(!!n||!!t&&!!t.length||!!i||!_j.h.a(r),"at least one filter parameter must be set for Persona InsightsByViews");var u=new _pw.j(n);u.ItemLinkIds=t;u.PersonaId=i?i.d():null;u.EmailAddress=r;return new FindInsightsAction(u)},a:function(n,t){return new FakeFindInsightsAction(n,t,this.d,this.c)}};function GetNextMeetingWithPersonAction(n){GetNextMeetingWithPersonAction.initializeBase(this);this.h=n}GetNextMeetingWithPersonAction.prototype={h:null,f:null,e:function(){return this.f},M:function(){return this.W("Exchange2013_SP1")},K:function(n){var r=new _pw.l(this.L);var i=new _pw.g(this.h);var t=new _pw.f(this.M(),i);n.fV(t,r,this.I,this.H)},cU:function(n,t,i){try{n.Body.NextMeeting&&(this.f=n.Body.NextMeeting)}catch(r){i(r);return}t()}};function GetNextMeetingWithPersonActionFactory(){}GetNextMeetingWithPersonActionFactory.prototype={a:function(n){return new GetNextMeetingWithPersonAction(n)}};function GetPeopleWaitingOnUserAction(n){GetPeopleWaitingOnUserAction.initializeBase(this);this.e=n?n.z():_a.d.a().c(-7).d().z()}GetPeopleWaitingOnUserAction.prototype={e:null,K:function(n){var i=new _pw.q(this.L);var t=new _pw.i;t.StartDate=this.e;n.gc(t,i,this.I,this.H)},cU:function(n,t,i){t()},M:function(){return this.W("Exchange2013_SP1")}};function FakeFindInsightsAction(n,t,i,r){this.p=Function.createDelegate(this,this.be);this.q=Function.createDelegate(this,this.bg);FakeFindInsightsAction.initializeBase(this,[null]);this.r=n;this.f=t;this.l=i;this.k=r}FakeFindInsightsAction.prototype={r:null,f:null,l:null,m:null,k:null,j:null,K:function(n){this.h=new _j.l;if(!this.f.a()||_j.h.b(this.f.a().EmailAddress)){this.bh(this.Q,new _j.l);return}var i=_g.b.a.nameToId("msgfolderroot");var t=this;this.l.a(function(n){t.m=n;t.j=t.m.a(2,i,null);t.D()})},cU:function(n,t,i){t()},bh:function(n,t){this.j&&this.j.b();if(_j.h.b(this.f.c())){_h.fN.prototype.bh.call(this,n,t);return}for(var s=["Soon it will be {0}'s 2-year anniversary with {1}.","{0}'s new manager is {1}.","{0}'s title changed to {1}."],e=[[this.f.c(),"Contoso"],[this.f.c(),"Patricia Sangley"],[this.f.c(),"Program Manager 2"]],r=0;r<3;r++){var i=new _pw.a;var o=["XRM"];i.ApplicationIds=o;i.EndTimeUtc="2015-10-10T02:16:43Z";i.InsightId="2e47b5c1-0444-438f-aa72-499782962a71";i.ItemId=null;i.StartTimeUtc="2015-10-09T20:16:43Z";i.Status="Active";i.Text=_j.h.c(s[r],e[r][0],e[r][1]);i.Type="Highlight";i.Version="0.0";this.h.a(i)}var f=new _pw.b;f.Insights=this.h.f();var u=new _pw.d;u.Body=f;_h.fN.prototype.bh.call(this,n,u)},D:function(){var t=_g.b.a.nameToId("inbox");var i=String.format("from:{0} isread:false received>{1}",this.f.a().EmailAddress,_a.d.a().c(-14).d().z());var n=this.j.a(i,t,null,null,null,!1,this.k,_a.g.c());n.d().c(this.q);n.c()},bg:function(n){var u=n;var r=u.N.Payload;var t=r.Conversations;if(t&&t.length>0){var i=this.t(t);i&&this.h.a(i)}this.u()},u:function(){var t=_g.b.a.nameToId("sentitems");var i=String.format("to:({0}) from:({1}) received>{2}",this.f.a().EmailAddress,_g.a.a().c().bH.UserEmailAddress,_a.d.a().c(-14).d().z());var n=this.j.a(i,t,null,null,null,!1,this.k,_a.g.c());n.d().c(this.p);n.c()},be:function(n){var u=n;var r=u.N.Payload;var t=r.Conversations;if(t&&t.length>0){var i=this.s(t);i&&this.h.a(i)}this.bh(this.Q,new _j.l)},t:function(n){var t=null;if(n&&n.length>0){t=new _pw.a;var i=["XRM"];t.ApplicationIds=i;t.EndTimeUtc="2015-10-10T02:16:43Z";t.InsightId="2e47b5c1-0444-438f-aa72-499782962a71";t.ItemId=new _g.e(this.f.a().EmailAddress);t.StartTimeUtc="2015-10-09T20:16:43Z";t.Status="Active";t.Text=_j.h.c("Recent unread messages from {0}: {1}",this.f.c(),n.length);t.Type="RecentUnreadEmails";t.Version="0.0"}return t},s:function(n){var t=null;if(n)for(var r=0;r<n.length;r++){var i=n[r];if(Array.contains(i.UniqueSenders,_g.a.a().c().bH.UserDisplayName)){t=new _pw.a;var f=this.bi(i.ConversationTopic,26);var u=["XRM"];t.ApplicationIds=u;t.EndTimeUtc="2015-10-10T02:16:43Z";t.InsightId="2e47b5c1-0444-438f-aa72-499782962a71";t.ItemId=i.ItemIds[0];t.StartTimeUtc="2015-10-09T20:16:43Z";t.Status="Active";t.Text=_j.h.c("{0} hasn't yet responded to your emails about {1}",this.f.c(),f);t.Type="UnrespondedEmail";t.Version="0.0";break}}return t},bi:function(n,t){if(n.length<=t)return _j.h.c("{0}.",n);var i=n.split(" ");var r=0;var u=i[0].length;if(i.length<3)return _j.h.c("{0}…",n.slice(0,t));for(var e=i[1],f=u+1+e.length;r+1<i.length&&f<t;){r++;u=f;if(r+1<i.length){e=i[r+1];f=u+1+e.length}}var o=i.slice(0,r+1).join(" ");return u<n.length?_j.h.c("{0}…",o):_j.h.c("{0}.",o)}};function FindInsightsAction(n){FindInsightsAction.initializeBase(this);this.o=n}FindInsightsAction.prototype={o:null,h:null,e:function(){return this.h},M:function(){return this.W("V2015_12_21")},K:function(n){var t=new _pw.e("OWA");t.AppContexts="PeopleCard";t.InsightsByView=this.o;var r=new _pw.c(this.M(),t);var i=new _pw.k(this.L);i.useEmptyPost=!0;n.eL(r,i,this.I,this.H)},cU:function(n,t,i){try{this.h=new _j.l;n.Body.Insights&&this.h.j(n.Body.Insights)}catch(r){i(r);return}t()}};function PeopleWebServicesComponent(){}PeopleWebServicesComponent.$$cctor=function(){_a.t.a().a(PeopleWebServicesComponent)};PeopleWebServicesComponent.prototype={b:function(n,t,i){var u=this;n.b(FindInsightsActionFactory,function(){return new FindInsightsActionFactory(n.c(_y.cC),n.a(_a.e))}).b(_pc.p).a();var r=this;n.b(GetNextMeetingWithPersonActionFactory,function(){return new GetNextMeetingWithPersonActionFactory}).b(_pc.k).a()},a:function(){return[]}};_pw.t.registerClass("_pw.t",_g.ku,0,0);_pw.k.registerClass("_pw.k",_g.hM,0,0);_pw.c.registerClass("_pw.c",_g.hZ,0,0);_pw.d.registerClass("_pw.d",_g.kr);_pw.e.registerClass("_pw.e",_pw.t,0,0,0);_pw.b.registerClass("_pw.b",_g.gB);_pw.s.registerClass("_pw.s",_ff.e);_pw.a.registerClass("_pw.a",_g.kH,0,0);_pw.j.registerClass("_pw.j",_ff.e);_pw.u.registerClass("_pw.u",_g.gB);_pw.g.registerClass("_pw.g",_g.ku);_pw.n.registerClass("_pw.n",_pw.u);_pw.l.registerClass("_pw.l",_g.hM,0,0);_pw.m.registerClass("_pw.m",_g.kr);_pw.f.registerClass("_pw.f",_g.hZ,0,0);_pw.r.registerClass("_pw.r",_ff.e,0);_pw.i.registerClass("_pw.i",_ff.e,0);_pw.q.registerClass("_pw.q",_g.hM,0,0);_pw.p.registerClass("_pw.p",_ff.e);_pw.h.registerClass("_pw.h",_ff.e,0);_pw.o.registerClass("_pw.o",_g.hM,0,0);FakeGetPeopleUserMeetsWithAction.registerClass("FakeGetPeopleUserMeetsWithAction",_h.fN,IGetPeopleUserMeetsWithAction,IActionBase);FakeGetPeopleWaitingOnMeAction.registerClass("FakeGetPeopleWaitingOnMeAction",_h.fN,IPeopleYouMayHaveMissedAction,IActionBase);GetPeopleUserMeetsWithAction.registerClass("GetPeopleUserMeetsWithAction",_h.fN,IGetPeopleUserMeetsWithAction,IActionBase);PeopleYouMayHaveMissedAction.registerClass("PeopleYouMayHaveMissedAction",_h.fN,IPeopleYouMayHaveMissedAction,IActionBase);FindInsightsActionFactory.registerClass("FindInsightsActionFactory",null,_pc.p);GetNextMeetingWithPersonAction.registerClass("GetNextMeetingWithPersonAction",_h.fN,IGetNextMeetingWithPersonAction,IActionBase);GetNextMeetingWithPersonActionFactory.registerClass("GetNextMeetingWithPersonActionFactory",null,_pc.k);GetPeopleWaitingOnUserAction.registerClass("GetPeopleWaitingOnUserAction",_h.fN);FindInsightsAction.registerClass("FindInsightsAction",_h.fN,IFindInsightsAction,IActionBase);FakeFindInsightsAction.registerClass("FakeFindInsightsAction",FindInsightsAction);PeopleWebServicesComponent.registerClass("PeopleWebServicesComponent",null,_a.kh,_j.ce);_pw.c._dataContractName="FindInsightsJsonRequest:#Exchange";_pw.d._dataContractName="FindInsightsJsonResponse:#Exchange";_pw.e._dataContractName="FindInsightsRequest:#Exchange";_pw.b._dataContractName="FindInsightsResponseMessage:#Exchange";_pw.s._dataContractName="InsightContextItem:#Exchange";_pw.a._dataContractName="InsightItemType:#Exchange";_pw.j._dataContractName="InsightsByView:#Exchange";_pw.g._dataContractName="GetNextMeetingWithPersonRequest:#Exchange";_pw.n._dataContractName="GetNextMeetingWithPersonResponseMessage:#Exchange";_pw.m._dataContractName="GetNextMeetingWithPersonJsonResponse:#Exchange";_pw.f._dataContractName="GetNextMeetingWithPersonJsonRequest:#Exchange";_pw.r._dataContractName="GetPeopleWaitingOnUserResponse:#Exchange";_pw.i._dataContractName="GetPeopleWaitingOnUserRequest:#Exchange";_pw.p._dataContractName="GetPeopleUserMeetsWithResponse:#Exchange";_pw.h._dataContractName="GetPeopleUserMeetsWithRequest:#Exchange";FakeGetPeopleWaitingOnMeAction.a=_a.d.a().c(-14).d();PeopleYouMayHaveMissedAction.a=_a.d.a().c(-14).d();PeopleWebServicesComponent.$$cctor();
window.scriptsLoaded['microsoft.owa.people.webservices.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.people.webservices.js'] = (new Date()).getTime();
