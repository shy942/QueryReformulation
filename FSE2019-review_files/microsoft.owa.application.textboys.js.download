window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.application.textboys.js'] = (new Date()).getTime();
function TextBoysComponents(){}TextBoysComponents.$$cctor=function(){_a.t.a().a(TextBoysComponents)};TextBoysComponents.prototype={b:function(n,t,i){var r=this;n.b(_tb.b,function(){return new _tb.b}).a()},a:function(){return[]}};Type.registerNamespace("_tb");_tb.c=function(n,t,i){_tb.c.initializeBase(this,[n]);this.n=t;this.r=i;var r=this.z.style;r["background-size"]=r["-webkit-background-size"]=r["-ms-background-size"]=r["-moz-background-size"]="cover";this.z.style.backgroundPosition="center"};_tb.c.prototype={h:null,b:null,n:null,r:null,u:!1,s:function(n){if(this.h!==n){this.h=n;this.by("ImgUrl");this.n.h(this.b);this.b=null;this.m();if(this.h){var t=this;this.n.j(this.h,function(n,i){if(t.h===n){t.b=i;t.t();t.y();t.bi()}})}}return n},bg:function(n){this.u=n;this.y();return n},i:!1,m:function(){if(!this.h||!this.b){this.z.style.backgroundImage="";this.z.style.color=""}},t:function(){if(this.b){this.z.style.backgroundImage="url('"+this.b+"')";this.z.style.color="transparent";this.z.textContent=""}else this.m()},bi:function(){this.b&&this.i&&(this.z.style.backgroundColor="white")},y:function(){if(this.u&&this.b){var n=this;_j.m.a().d(_a.a.h,"CalculateDominantColor",function(){var f=_j.n.b(n.I(),2,"ServerImageControl.CalculateDominantColor");var r=null;var t=null;try{if(n.z){var i=document.createElement("img");i.setAttribute("src",n.b);n.z.appendChild(i);t=n.z.lastChild;if(_j.k.h(t)>0){var u=new ColorThief;r=u.getColor(t)}}}finally{t&&_j.k.f(t);n.r.a(_a.dv,new _a.dv(r))}_j.n.a(f)})}}};_tb.a=function(n,t,i,r){this.v=Function.createDelegate(this,this.w);_tb.a.initializeBase(this,[n,t,r]);this.q=i};_tb.a.prototype={c:null,j:null,a:null,g:null,d:null,k:!1,l:!1,q:null,p:function(n){if(this.c!==n){this.c=n;this.x();this.by("DisplayName")}return n},e:function(n){if(this.g!==n){_j.h.b(this.g)||this.bt(this.g);this.g=n;_j.h.b(this.c)&&this.o();this.by("DoughBoyCssClassName")}return n},f:function(n){if(this.d!==n){_j.h.b(this.d)||this.bt(this.d);this.d=n;_j.h.b(this.c)&&this.o();this.by("FadeInTransitionCssClassName")}return n},bd:function(n){if(this.l!==n){this.l=n;this.x()}return n},t:function(){_tb.c.prototype.t.call(this);this.w()},m:function(){_tb.c.prototype.m.call(this);if(!this.k){this.k=!0;this.q.a(this.I(),"AnimatedShowPersonImage",this.v,1500);this.z.style.opacity="0";_j.h.b(this.d)||this.bt(this.d)}},w:function(){if(this.k){this.k=!1;this.z.style.opacity="";_j.h.b(this.d)||this.bo(this.d)}},be:function(){this.bt(this.g);this.z.style.backgroundColor=this.j;this.z.textContent=this.a},o:function(){this.z.style.backgroundColor="";this.z.textContent="";_j.h.b(this.g)||this.bo(this.g)},H:function(){if(this.l){this.a="?";return}if(!this.c){this.a="";return}var n=this.B(this.c);_tb.a.d.test(n)?this.a="":_tb.a.b.test(n)?this.a="":_tb.a.f.test(n)?this.a="":_tb.a.c.test(n)?this.a=_tb.a.e.test(n)?"":"":this.bc(n)},B:function(n){n=n.replace(_tb.a.i,"");n=n.replace(_tb.a.g," ");return n.trim()},bc:function(n){var t=n.split(" ");if(t.length===2){this.a=t[0].charAt(0).toUpperCase().toString();this.a+=t[1].charAt(0).toUpperCase().toString()}else if(t.length===3){this.a=t[0].charAt(0).toUpperCase().toString();this.a+=t[2].charAt(0).toUpperCase().toString()}else t.length&&(this.a=t[0].charAt(0).toUpperCase().toString())},E:function(){if(this.l){this.j=_tb.a.h;return}this.j="";var r=0;if(this.c)for(var n=this.c.length-1;n>=0;n--){var i=this.c.charCodeAt(n);var t=n%8;r^=(i<<t)+(i>>8-t)}this.j=_tb.a.a[r%_tb.a.a.length]},x:function(){this.H();this.E();_j.h.b(this.a)||this.b?this.o():this.be()}};_tb.b=function(){this.c={};this.f={};this.b={};this.a=new Array(0);this.e=[]};_tb.b.prototype={d:0,h:function(n){if(_tb.b.a&&!Array.contains(this.a,n)){Array.add(this.a,n);var r=window.URL||window.webkitURL;if(this.a.length>_tb.b.b){var t=this.a[0];Array.removeAt(this.a,0);r.revokeObjectURL(t);var i=this.f[t];delete this.c[i];delete this.f[t]}}},j:function(n,t){if(n in this.c){var i=this.c[n];_tb.b.a&&Array.remove(this.a,i);t(n,this.c[n])}else this.i(n,t)},i:function(n,t){var i;if(n in this.b)i=this.b[n];else{i=[];Array.enqueue(this.e,n);this.b[n]=i}i[i.length]=t;this.g()},g:function(){if(!(this.d>=3)&&this.e.length){var t=Array.dequeue(this.e);this.d++;try{var n=new XMLHttpRequest;n.open("GET",t,!0);_tb.b.a&&(n.responseType="blob");var i=this;n.onreadystatechange=function(){if(n.readyState===4){i.d--;var u=0;var f=null;try{if(n.status===200){var c=n.getResponseHeader("Content-Type");var l=n.getResponseHeader("Content-Length");var a=!!c&&c.toLowerCase().startsWith("image");a?l&&(u=parseInt(n.getResponseHeader("Content-Length"))):u=0;if(_tb.b.a){f=n.response;f&&(u=f.size)}}else{var e=null;try{var h=new _a.P(t);e=_j.h.c("Textboys ServerImageDownloadService request failed. status = {0} , url authority = {1}, absolute path = {2}",n.status,h.e,h.d)}catch(p){e=_j.h.c("Textboys ServerImageDownloadService Invalid url. status = {0} , url = {1}",n.status,t)}_j.e.b(_a.a.bU,e)}}catch(y){}var r=null;if(u>100)if(_tb.b.a){var v=window.URL||window.webkitURL;r=v.createObjectURL(f)}else r=t;i.c[t]=r;var s=i.b[t];delete i.b[t];_tb.b.a&&r&&(i.f[r]=t);for(var o=0;o<s.length;o++)s[o](t,r);i.g()}};n.send(null)}catch(r){}}}};TextBoysComponents.registerClass("TextBoysComponents",null,_a.kh,_j.ce);_tb.c.registerClass("_tb.c",_j.i);_tb.a.registerClass("_tb.a",_tb.c);_tb.b.registerClass("_tb.b");TextBoysComponents.$$cctor();_tb.a.i=new RegExp("\\([^)]*\\)|[\\0-\\u001F\\!-/:-@\\[-`\\{-\\u00BF\\u0250-\\u036F\\uD800-\\uFFFF]","g");_tb.a.g=new RegExp("\\s+","g");_tb.a.d=new RegExp("[\\u0590-\\u05FF]");_tb.a.b=new RegExp("[\\u0600-\\u06FF\\u0750-\\u077F\\u08A0-\\u08FF]");_tb.a.f=new RegExp("[\\u1100-\\u11FF\\u3130-\\u318F\\uA960-\\uA97F\\uAC00-\\uD7AF\\uD7B0-\\uD7FF]");_tb.a.e=new RegExp("\\u3040-\\u309F\\u30A0-\\u30FF");_tb.a.c=new RegExp("[\\u3400-\\u4DBF\\u4E00-\\u9FFF\\uF900-\\uFAFF]|[\\uD840-\\uD869][\\uDC00-\\uDED6]");_tb.a.j=new RegExp("^(\\u6B27\\u9633|\\u592A\\u53F2|\\u7AEF\\u6728|\\u4E0A\\u5B98|\\u53F8\\u9A6C|\\u4E1C\\u65B9|\\u72EC\\u5B64|\\u5357\\u5BAB|\\u4E07\\u4FDF|\\u95FB\\u4EBA|\\u590F\\u4FAF|\\u8BF8\\u845B|\\u5C09\\u8FDF|\\u516C\\u7F8A|\\u8D6B\\u8FDE|\\u6FB9\\u53F0|\\u7687\\u752B|\\u5B97\\u653F|\\u6FEE\\u9633|\\u516C\\u51B6|\\u592A\\u53D4|\\u7533\\u5C60|\\u516C\\u5B59|\\u6155\\u5BB9|\\u4EF2\\u5B59|\\u949F\\u79BB|\\u957F\\u5B59|\\u5B87\\u6587|\\u53F8\\u5F92|\\u9C9C\\u4E8E|\\u53F8\\u7A7A|\\u95FE\\u4E18|\\u5B50\\u8F66|\\u4E93\\u5B98|\\u53F8\\u5BC7|\\u5DEB\\u9A6C|\\u516C\\u897F|\\u989B\\u5B59|\\u58E4\\u9A77|\\u516C\\u826F|\\u6F06\\u96D5|\\u4E50\\u6B63|\\u5BB0\\u7236|\\u8C37\\u6881|\\u62D3\\u8DCB|\\u5939\\u8C37|\\u8F69\\u8F95|\\u4EE4\\u72D0|\\u6BB5\\u5E72|\\u767E\\u91CC|\\u547C\\u5EF6|\\u4E1C\\u90ED|\\u5357\\u95E8|\\u7F8A\\u820C|\\u5FAE\\u751F|\\u516C\\u6237|\\u516C\\u7389|\\u516C\\u4EEA|\\u6881\\u4E18|\\u516C\\u4EF2|\\u516C\\u4E0A|\\u516C\\u95E8|\\u516C\\u5C71|\\u516C\\u575A|\\u5DE6\\u4E18|\\u516C\\u4F2F|\\u897F\\u95E8|\\u516C\\u7956|\\u7B2C\\u4E94|\\u516C\\u4E58|\\u8D2F\\u4E18|\\u516C\\u7699|\\u5357\\u8363|\\u4E1C\\u91CC|\\u4E1C\\u5BAB|\\u4EF2\\u957F|\\u5B50\\u4E66|\\u5B50\\u6851|\\u5373\\u58A8|\\u8FBE\\u595A|\\u891A\\u5E08)$");_tb.a.a=["rgb(153, 180, 51)","rgb(107, 165, 231)","rgb(231, 115, 189)","rgb(0, 163, 0)","rgb(30, 113, 69)","rgb(255, 0, 151)","rgb(126, 56, 120)","rgb(96, 60, 186)","rgb(94, 75, 139)","rgb(0, 171, 169)","rgb(45, 137, 239)","rgb(43, 87, 151)","rgb(218, 83, 44)","rgb(185, 29, 71)"];_tb.a.h="rgb(238, 17, 17)";_tb.b.a=!_a.o.a().I||_a.o.a().T;_tb.b.b=100;
window.scriptsLoaded['microsoft.owa.application.textboys.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.application.textboys.js'] = (new Date()).getTime();
