window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.clientnext.framework.js'] = (new Date()).getTime();
Type.registerNamespace("_cnf");_cnf.b=function(n,t,i){var r={resourcesBaseUrl:t.x(),userLanguage:i.c().bH.UserLanguage,timeZone:i.a().bH.TimeZone};OwaNext.application.bootstrap(r)};function ClientNextFrameworkComponent(){}ClientNextFrameworkComponent.$$cctor=function(){_a.t.a().a(ClientNextFrameworkComponent)};ClientNextFrameworkComponent.prototype={b:function(n,t,i){var e=this;n.b(_cnf.c,function(){return new _cnf.c(n.a(_a.e))}).a();var o=this;n.b(_cnf.a,function(){return new _cnf.a(n.a(_j.j),n.a(_cnf.c),n.a(_y.a),n.a(_a.e))}).a();var f=this;n.b(_cnf.e,function(){return new _cnf.e(n.c(_h.db))}).a();var r=this;n.b(_cnf.d,function(){return new _cnf.d(_a.a.cV)}).a();var u=this;n.b(_cnf.b,function(){return new _cnf.b(n.a(_y.a),i,n.a(_g.h))}).a()},a:function(){return[new _j.y(_cnf.d,0,-1),new _j.y(_cnf.b,0,-1)]}};_cnf.e=function(n){this.c=Function.createDelegate(this,this.d);this.b=n;OwaNext.initializeActionDispatcher(this.c)};_cnf.e.prototype={b:null,a:null,d:function(n,t,i){if(!this.a){var r=this;this.b.a(function(u){r.a=u;r.d(n,t,i)});return}var u=this.a.a(n,i,t,!0);_a.g.a.a(u)}};_cnf.d=function(n){this.b=Function.createDelegate(this,this.g);this.a=Function.createDelegate(this,this.e);this.c=Function.createDelegate(this,this.h);this.d=n;OwaNext.application.initializeCtq(this.c,this.a,this.b,this.f())};_cnf.d.prototype={d:null,h:function(n,t){t=t?t:_a.a.cV;return _a.b.b(t,n,!1,null)},e:function(n,t,i,r){n.m=t;n.n=i;n.p=r;_a.b.a(n)},g:function(n,t,i){i=i?i:_a.a.cV;_a.b.c(i,n,t,0)},f:function(){var n={};n.calendar=_a.a.b;n.extensibility=_a.a.i;n.oxford=_a.a.cV;return n}};_cnf.c=function(n){this.a=n.a().kG().Enabled};_cnf.c.prototype={a:!1,b:function(n,t){this.a&&OwaNext.application.raiseEvent(n,t)}};_cnf.a=function(n,t,i,r){this.d=Function.createDelegate(this,this.l);this.b={};this.a=t;this.f=r;this.c=i;n.b(_h.dn,this.d)};_cnf.a.prototype={a:null,f:null,c:null,l:function(n){var t={};t.queryKey=n.a.c().a();t.folderIdObject=n.a.e();this.a.b("TABLE_ADDED",t);var i=this;n.a.a().d(function(t,r){i.k(n.a.c().a(),r)})},k:function(n,t){var r=!1;var o=this.i(n);var i={};i.queryKey=n;i.action=_j.NotifyCollectionChangedAction.toString(t.c);i.changeIndex=t.d;i.toIndex=t.e;var s,e;i.oldItems=(e=this.g(t.b,s={val:r},o,!1),r=s.val,e);var u,f;i.newItems=(f=this.g(t.a,u={val:r},o,!0),r=u.val,f);r||this.a.b("TABLE_COLLECTION_CHANGED",i)},g:function(n,t,i,r){if(!n)return null;for(var e=[],o=n,s=o.length,f=0;f<s;++f){var u=o[f];if(_g.o.isInstanceOfType(u)){e.push(this.e(u));r?u.J(i):u.F(i)}else{t.val=!0;return null}}return e},i:function(n){if(!(n in this.b)){var t=this;this.b[n]=function(i,r){if(Array.indexOf(_cnf.a.a,r)>-1){var u={item:t.e(i),queryKey:n};t.a.b("ITEM_CHANGED",u)}}}return this.b[n]},h:function(n){var t;var i=!0;t=i&&!n.bo()?n.n():n.h();return this.c.a()==="Mouse"?(new _b.U).a(t,null):(new _b.M).a(t,null)},j:function(n){return _h.bi.b(n,!1)},e:function(n){var r=0;switch(n.M()){case"Complete":r=1;break;case"Flagged":r=2;break;case"NotFlagged":r=0;break}var i=0;switch(n.bg()){case"Low":i=0;break;case"Normal":i=1;break;case"High":i=2;break}var f=this.j(n);var u=null;if(n&&n.n()){u=new Date(n.n().n.getTime());u.setMinutes(n.n().n.getMinutes()+n.n().n.getTimezoneOffset())}var t={};t.conversationObject=n;t.topPropertyIconsToShow=f.c(3);t.smallIcon=f.b();t.dateTimeToDisplay=this.h(n);t.lastDeliveryOrRenewTime=u;t.importance=i;t.smimeType=n.bC();t.conversationId=n.bH.ConversationId.Id;t.unreadCount=n.bH.UnreadCount;t.conversationTopic=n.bH.ConversationTopic;t.globalMessageCount=n.bH.GlobalMessageCount;t.messageCount=n.bH.MessageCount;t.preview=n.bH.Preview;t.uniqueRecipients=n.v()?n.v().e():[];t.uniqueSenders=n.g()?n.g().e():[];t.flagStatus=r;t.isSmimeClass=n.bA();t.isPinned=n?n.D:!1;return t}};_cnf.b.registerClass("_cnf.b");ClientNextFrameworkComponent.registerClass("ClientNextFrameworkComponent",null,_a.kh,_j.ce);_cnf.e.registerClass("_cnf.e");_cnf.d.registerClass("_cnf.d");_cnf.c.registerClass("_cnf.c");_cnf.a.registerClass("_cnf.a");ClientNextFrameworkComponent.$$cctor();_cnf.a.a=["ConversationId","ConversationTopic","FlagStatus","GlobalMessageCount","Importance","IsPinned","LastDeliveryTime","LastDeliveryOrRenewTime","Preview","UniqueRecipients","UniqueSenders","UnreadCount"];
window.scriptsLoaded['microsoft.owa.clientnext.framework.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.clientnext.framework.js'] = (new Date()).getTime();
