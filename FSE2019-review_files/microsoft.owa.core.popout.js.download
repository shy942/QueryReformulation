window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.core.popout.js'] = (new Date()).getTime();
Type.registerNamespace("_po");_po.a=function(n,t,i){this.h=Function.createDelegate(this,this.q);this.g=Function.createDelegate(this,this.p);_po.a.initializeBase(this,[n]);this.d=t;this.c=i;this.j(_bc.d.a().a);this.k(_bc.d.a().b);this.f(150);this.e(150);this.u(!1);this.v(!0);this.x(!1);this.w(!0);this.E(!0);this.bc(!1);this.t(!1);this.s(!0)};_po.a.r=function(n,t,i,r,u){i.wid=n;if(_po.a.a in i)return i[_po.a.a];else{var f="";var s=i;for(var h in s){var o={key:h,value:s[h]};f=f+"&"+encodeURIComponent(o.key)+"="+(o.value?encodeURIComponent(o.value.toString()):"")}var e=window.location.pathname;t==="ReadMessageItem"&&u&&(e+=_po.a.q);if(!_j.h.b(t)){var c=f.indexOf("features")===-1&&f.indexOf("flights")===-1&&f.indexOf("plus")===-1&&f.indexOf("minus")===-1&&!r&&!u?"#":"?";e=e+c+"viewmodel="+t+f+"&"+"ispopout"+"=1"}return e}};_po.a.prototype={d:null,c:null,j:function(n){this.eK(_po.a.b,n);return n},k:function(n){this.eK(_po.a.n,n);return n},f:function(n){this.eK(_po.a.m,n);return n},e:function(n){this.eK(_po.a.k,n);return n},u:function(n){this.eK(_po.a.e,n);return n},v:function(n){this.eK(_po.a.f,n);return n},x:function(n){this.eK(_po.a.h,n);return n},w:function(n){this.eK(_po.a.g,n);return n},E:function(n){this.eK(_po.a.i,n);return n},bc:function(n){this.eK(_po.a.j,n);return n},t:function(n){this.eK(_po.a.d,n);return n},s:function(n){this.eK(_po.a.c,n);return n},n:function(){return this.a("height",_po.a.b)+this.a("width",_po.a.n)+this.a("top",_po.a.m)+this.a("left",_po.a.k)+this.a("menubar",_po.a.e)+this.a("resizable",_po.a.f)+this.a("status",_po.a.h)+this.a("scrollbars",_po.a.g)+this.a("titlebar",_po.a.i)+this.a("toolbar",_po.a.j)+this.a("location",_po.a.d)+this.a("directories",_po.a.c)},Y:function(){_j.i.prototype.Y.call(this);if(this.V()){var t=this.V();if(_y.dk.isInstanceOfType(t)){var n=this.V();n.b(this.g);n.a(this.h)}}},bz:function(){if(this.V()&&_y.dk.isInstanceOfType(this.V())){var n=this.V();n.b(null);n.a(null)}_j.c.prototype.bz.call(this)},r:function(n,t){this.l(t.popOutSize);var i=t.viewModelParams;try{var u=this.bd(t.context);var r=_po.a.r(n,t.viewModel,i,t.preserveViewModelQueryParam,u);return this.i(r,!(_po.a.a in i),t.target)}catch(f){_j.e.b(_a.a.z,"Exception when open popout: {0}, {1}",f.message,f.stack);return null}},m:function(){return _y.cs.b()},i:function(n,t,i){!n.startsWith("/")&&t&&(n="/"+n);this.be(n,t);var r=window.open(n,i,this.n());r||_j.e.a(_a.a.z,"window.open returns null instance");return r},a:function(n,t){var i=this.eM(t);var r;r=Boolean.isInstanceOfType(i)?i?"yes":"no":i===null||i===undefined?"":i.toString();return n+"="+r+","},p:function(n,t){var o=t.viewModel;if(_j.h.b(o))throw Error.invalidOperation("The ViewModel of pop out request should not be null.");var u=this.m();var r=this.r(u,t);var i=t.context;if(!this.b(r)){var s=null;i&&i.be()&&(s=_y.gW.a(r,i.be()));if(!this.b(r)){var c=_y.cG.c(o,i,t.popOutContextSymbol);try{this.d.registerPopOut(u,r,s,c,!1)}catch(a){_j.e.b(_a.a.z,"Exception when register popout: {0}, {1}",a.message,a.stack)}}if(i&&i.bD()){window.popOutErrorCallbacks||(window.popOutErrorCallbacks={});var v=this;var l=function(n){i.bD()(n);delete window.popOutErrorCallbacks[u]};window.popOutErrorCallbacks[u]=l}}this.b(r)&&i&&i.bD()&&i.bD()("PopOutBlocked");if(_po.a.l in t.viewModelParams){var f=t.viewModelParams[_po.a.l];if(f)if(this.b(r))f();else{var e=null;var h=this;e=_j.m.a().e(_a.a.z,"PopOut",function(){if(h.b(r)){e&&_j.m.a().b(e);f()}},1e3)}}return r},q:function(n,t,i){this.l(t);var u=window.location.pathname+"projection.aspx";return this.i(u,!0,i)},l:function(n){var t=n||_bc.d.a();this.j(t.a);this.k(t.b);if(t.c!==-1&&t.d!==-1){this.f(t.d);this.e(t.c)}else{this.f(150);this.e(150)}},be:function(n,t){!t},b:function(n){try{return!n||n.closed}catch(t){_j.e.a(_a.a.z,"Exception is thrown when checking window.closed: {0}",t.message);return!0}},bd:function(n){var u=!1;if(_g.a.a().bH.LeanPopoutEnabled&&this.c.a().kO().Enabled&&_y.fb.isInstanceOfType(n)){var f=n;var t=f.k();t&&!t.bH.ItemClass&&_h.d.a().d(t.bH.ItemId.Id)&&(t=_h.d.a().a(t.bH.ItemId.Id));var r=this.o(f,t);if(r===""){u=!0;_h.g.a(_a.a.z,_po.a.p,-1,0,null)}else{var i=new _a.l;i.a("reason",r);_h.g.a(_a.a.z,_po.a.o,11,0,i)}}return u},o:function(n,t){var i="Unknown";t&&(i=t.bH.ItemClass&&t.bH.ItemClass.startsWith("IPM.Note.SMIME")?"Smime":t.bH.ItemClass&&!t.bH.ItemClass.startsWith("IPM.Note")?"NotNoteItem":n.o()?"SharedFolder":n.n()?"DiscoveryMode":t.bH.ItemClass&&t.bH.ItemClass.endsWith(".Compliance")?"Compliance":t.ei()?"IrmRestricted":n.j()?"PrintView":_a.g.b?"GenericMailMode":t.bH.ParentFolderId&&t.bH.ParentFolderId.Id===_g.b.a.nameToId("deleteditems").Id?"DeletedFolder":t.bH.ParentFolderId&&t.bH.ParentFolderId.Id===_g.b.a.nameToId("junkemail").Id?"JunkFolder":t.bH.HasAttachments&&!this.c.a().kL().Enabled?"Attachment":"");return i}};function PopOutComponent(){}PopOutComponent.$$cctor=function(){_a.t.a().a(PopOutComponent)};PopOutComponent.prototype={b:function(n,t,i){var u=this;n.b(_po.c,function(){return new _po.c(n.a(_y.iA),i)}).b(_y.bL).a();var r=this;n.b(_po.b,function(){return new _po.b(n.a(_y.a),n.a(_y.bL),n.a(_j.Z),n.a(_a.e),n.a(_y.K),n.a(_j.j),n.a(_a.z),n.a(_y.P))}).b(_y.dk).a()},a:function(){return null}};_po.c=function(n,t){this.n={};this.k=new Array(0);this.l=n;this.o=t;this.a(_y.n,"ItemReadingPaneContext");this.a(_db.J,"ChatPopOutContext")};_po.c.c=function(n,t,i){if(i&&"react"in i&&i.react==="1")return 5;if(_po.c.a)return 4;var r=_po.c.b(n,t);return r?_y.cG.e(r)?3:2:1};_po.c.b=function(n,t){return!_j.h.b(t)&&n?n.getContext(t):null};_po.c.prototype={j:null,m:null,l:null,o:null,f:function(){return"ReadMessageItem"},r:function(){if(!this.j){this.j={};this.j.ReadMessageItem=_y.I;this.j.ItemReadingPaneViewModelPopOutFactory=_y.I;this.j.Chat=_y.fW;this.j.ItemAttachment=_y.gv;this.j.OwaOptionRichPeoplePickerViewModelFactory=_y.ix;this.j.IComposeCalendarItemViewModelFactory=_bc.k;this.j.OwaOptionPeoplePickerViewModelFactory=_y.iw;this.j.ICalendarItemDetailsViewModelFactory=_db.n;this.j.ISharingCalendarViewModelFactory=_y.bG;this.j.IMailComposeViewModelFactory=_y.V;this.j.PersonaCardViewModelFactory=_db.dm;this.j.TaskReadingPaneViewModelPopOutFactory=_y.fp;this.j.IAttachmentViewModelPopoutFactory=_y.gl;this.j.IUserDiagnosticsViewModel=_y.dX;this.j.IDumpsterPopOutViewModelFactory=_y.ey;this.j.IBirthdayFactory=_db.bm;this.j.ModernReadMessageItem=_y.el;this.j.ManagePersonalSchedulingPageFactory=_db.bY}return this.j},s:function(){if(!this.m){_j.e.a(_a.a.z,"Create SymbolToPopOutContextTypeMapping table");this.m={}}return this.m},c:function(n){return Type.isClass(n)&&(_a.bw===n||n.inheritsFrom(_a.bw)||n.implementsInterface(_bc.bm))||Type.isInterface(n)},b:function(n){var r=this.r();for(var i in r){var t={key:i,value:r[i]};var u=t.value;if(n===u)return t.key}return n.getName()},h:function(n){return this.r()[n]},g:function(n){var r=this.s();for(var i in r){var t={key:i,value:r[i]};var u=t.value;if(n===u)return t.key}throw Error.invalidOperation("Type "+n.toString()+" must be found in SymbolToPopOutContextTypeMappingTable");},a:function(n,t){this.p();_j.e.a(_a.a.z,"Register popout context symbole {0} for type {1}",t,n.getName());var r=this;var i=function(){return new n};this.m[t]=n;this.n[t]=i;this.t()},w:function(n,t){this.p();var i=new _po.c.d;i.b=n;i.a=t;Array.add(this.k,i);this.t()},t:function(){if(this.k.length>0){for(var r=new Array(0),n=0;n<this.k.length;n++){var t=this.k[n];var i=this.n[t.b];if(i){var u=i();t.a(u)}else Array.add(r,t)}this.k=r}},p:function(){return!!this.s()},x:function(n){if(!this.c(n))throw Error.argument("The pop out control only supports creating ViewModels by passing in a IParameterizeableViewModelFactory");var t=this.l.a(n);if(!t)throw Error.argument(String.format("Could not instantiate IParameterizeableViewModelFactory {0}. The type is not registered in the IoC container.",n));return t},i:function(n,t,i,r,u,f,e){var o=null;var h=this.x(i);var s=r.wid;var c=_po.c.b(t,s);_a.Y.b=s;var v=_po.c.c(t,s,r);switch(v){case 4:o=this.d(h,_po.c.a,u,f);_po.c.a=null;break;case 1:o=this.e(h,r,u,f);break;case 2:this.u(n,t,s);_y.cG.a(c,this.l);o=this.e(h,r,u,f);break;case 3:this.u(n,t,s);_y.cG.a(c,this.l);var l=this;this.w(c.popOutContextSymbol,function(i){_y.cG.d(c,i);l.v(t,i);o=l.d(h,i,u,f);l.q(o,n,e)});return;case 5:var a=window.opener;if(!a)throw Error.create("The window must be opened from OWA React!");try{var y=a.extPopOutContexts[s];o=this.e(h,y,u,f)}catch(p){_j.e.b(_a.a.z,"Exception when accessing parent window: {0}, {1}",p.message,p.stack);throw p;}break;default:_a.c.d(!0,"Unknown PopOutMode "+v);break}this.q(o,n,e)},q:function(n,t,i){if(!n||!n.length)throw Error.argument("The ViewModel provided in the url is not valid!");t.L(n[0],t.q());i(n)},d:function(n,t,i,r){var u;if(_bc.y.isInstanceOfType(n)){var f=n;u=f.i(t)}else u=[n.a(t,i,r)];return u},e:function(n,t,i,r){var u;if(_bc.y.isInstanceOfType(n)){var f=n;u=f.j(t)}else u=[n.b(t,i,r)];return u},v:function(n,t){if(t.be()&&t.be().length>0){n.get_mainWindowInstance()&&!n.get_mainWindowInstance().closed&&new _y.gW(n.get_mainWindowInstance(),t.be());for(var u=t.be(),f=u.length,i=0;i<f;++i){var r=u[i];_h.d.a().b(r.p(),r)}}},u:function(n,t,i){var r=this;n.w(function(){_a.Y.a(t.get_mainWindowInstance(),function(n){t.deRegisterWindow(i)})})}};_po.c.d=function(){};_po.c.d.prototype={b:null,a:null};_po.b=function(n,t,i,r,u,f,e,o){_po.b.initializeBase(this);this.j=n;this.f=t;this.o=i;this.u=r;this.s=u;this.q=f;this.i=e;this.p=o};_po.b.a=function(n,t,i){var r=n.a[i];_j.h.b(r)||(t[i]=r)};_po.b.prototype={j:null,f:null,g:null,h:null,o:null,u:null,s:null,q:null,i:null,l:0,p:null,x:function(){return this.p.o()},n:null,b:function(n){this.n=n;return n},m:null,a:function(n){this.h;this.h=n;return n},c:function(){if(!this.g){this.g=new _y.jJ(this.s,this.q);window.popOutProjectionManager=this.g}return this.g},r:function(n,t,i,r,u){if(!this.f.c(n))throw Error.argumentType("The parameter vmType should be ViewModel type!");var e=this.n;if(!e)if(this.l<60){++this.l;var s=this;_j.m.a().a(_a.a.z,"PopOutViewModel.PopOut",function(){s.r(n,t,i,r,u)},1e3);return}else throw Error.invalidOperation("No pop-out event handler was added for"+n.getName());this.l=0;var h=this.f.b(n);var f=null;r&&(f=this.f.g(Object.getType(r)));u=u?u:"_blank";var o=e(this,new _y.jF(h,t,i,r,f,u,this.x()));this.m&&this.m(o)},d:function(n,t,i,r){this.e(n,t,i,r,null,!1,null)},e:function(n,t,i,r,u,f,e){if(!this.f.c(n))throw Error.argumentType("The parameter vmType should be ViewModel or IParameterableViewModelFactory type!");if(this.j.a()==="Mouse")this.D(u,n)?this.C(n,t,i,r,u,e):this.A(n,i,r,u);else{_j.e.a(_a.a.g,"Open popout as popup in touch environment");try{this.B(t,i,u,f,n)}catch(s){var o=n?Object.getTypeName(n):"<empty>";_j.e.d(_a.a.g,s,"PopOutViewModel.PopOutOrPopUpWithContext -- exception calling OpenPopUpForTouch with vmType: {0}",o);throw s;}}},D:function(n,t){if(this.v(t))if(_y.fb.isInstanceOfType(n)){var i=n;return!(i.j()||i.k().bA())}else return!0;return!1},t:function(n,t,i,r,u,f){var o;var e=n();if(!e)throw Error.argumentNull("factory","Factory object created from "+n.toString()+" is null");if(i){o=this.f.d(e,i,u,f);i.ch()&&!this.v(r)&&(window.document.title=i.ch())}else o=this.f.e(e,t,u,f);return o},w:function(){return window.navigator.userAgent.indexOf("Edge/")>0?!1:this.o.a()!==1},v:function(n){return this.w()&&(this.z(n)||this.y(n))},z:function(n){return Array.contains(_po.b.b,this.f.b(n))},y:function(n){return this.f.b(n)==="IMailComposeViewModelFactory"},A:function(n,t,i,r){var u=this.i.b();_po.b.a(u,t,"flights");_po.b.a(u,t,"plus");_po.b.a(u,t,"minus");_po.b.a(u,t,"features");_po.b.a(u,t,"traceMessageMaxLength");_po.b.a(u,t,"traceComponents");_po.b.a(u,t,"traceLevel");_po.b.a(u,t,"perfTraceLevel");_po.b.a(u,t,"analyticsEnabled");this.r(n,t,i,r,"_blank")},C:function(n,t,i,r,u,f){if(!this.f.c(n))throw Error.argumentType("The parameter vmType should be ViewModel type!");var h=!!f;var e=null;if(h){this.g.onBeforeProjectionUnload(f);this.g.onProjectionUnload(f);e=f}else{if(!this.h)throw Error.invalidOperation("No pop-out event handler was added, the system can not handle the pop out request!");e=this.h(this,r,"_blank")}if(e&&!e.closed){var c=_y.cs.b();_a.Y.b=c;var o=new _y.A;var s=this.t(t,i,u,n,e,o);if(s.length>1)throw Error.invalidOperation("Popping up more than one view model is not currently supported for projection popout.");var l=this.g.e(s[0],e,u?u.ch():null,c,o,this.i);h&&l.q()}},B:function(n,t,i,r,u){var f=this.t(n,t,i,u,null,null);if(f.length>1)throw Error.invalidOperation("Popping up more than one view model is not supported in touch environments. Please contact the Shell team if you have this requirement.");this.j.f(f[0],0,r)}};_po.d=function(){};_po.d.$$cctor=function(){_po.d._I()};_po.d.c=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <div></div> </div>";_j.i.a().appendChild(n);return n};_po.d._I=function(){var n="Wrapper.PopOut";new _j.d(n,function(){_po.d.a[n]===undefined&&(_po.d.a[n]=[null]);var t=_po.d.b.childNodes[0].cloneNode(!0);var i=new _po.a(t.children[0],_j.b.Instance.a(_y.K),_j.b.Instance.a(_a.e));return new _j.a(t,[i])},"",_y.dk,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_po.d.a)};_po.a.registerClass("_po.a",_j.c);PopOutComponent.registerClass("PopOutComponent",null,_a.kh,_j.ce);_po.c.registerClass("_po.c",null,_y.bL);_po.c.d.registerClass("_po.c.d");_po.b.registerClass("_po.b",_a.bw,_y.dk);_po.a.a="AuthenticationEndpointUrl";_po.a.l="PopOutClosedCallback";_po.a.q="readingpane.aspx";_po.a.p="RPLeanPopoutOpened";_po.a.o="RPFullPopoutOpened";_po.a.b=new _a.f("Height",Number,_po.a);_po.a.n=new _a.f("Width",Number,_po.a);_po.a.m=new _a.f("Top",Number,_po.a);_po.a.k=new _a.f("Left",Number,_po.a);_po.a.e=new _a.f("IsMenubarVisible",Boolean,_po.a);_po.a.f=new _a.f("IsResizeable",Boolean,_po.a);_po.a.h=new _a.f("IsStatusVisible",Boolean,_po.a);_po.a.g=new _a.f("IsScrollbarVisible",Boolean,_po.a);_po.a.i=new _a.f("IsTitlebarVisible ",Boolean,_po.a);_po.a.j=new _a.f("IsToolbarVisible",Boolean,_po.a);_po.a.d=new _a.f("IsLocationVisible",Boolean,_po.a);_po.a.c=new _a.f("IsDirectoriesVisible",Boolean,_po.a);PopOutComponent.$$cctor();_po.c.a=null;_po.b.b=["ReadMessageItem","ItemAttachment","ModernReadMessageItem"];_po.d.b=_po.d.c();_po.d.a={};_po.d.$$cctor();
window.scriptsLoaded['microsoft.owa.core.popout.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.core.popout.js'] = (new Date()).getTime();
