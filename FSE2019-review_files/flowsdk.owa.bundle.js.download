window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['flowsdk.owa.bundle.js'] = (new Date()).getTime();
/*!
* @overview es6-promise - a tiny implementation of Promises/A+.
* @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
* @license   Licensed under MIT license
*            See https://raw.githubusercontent.com/jakearchibald/es6-promise/master/LICENSE
* @version   3.2.1
*/
(function(){"use strict";function t(t){return"function"==typeof t||"object"==typeof t&&null!==t}function e(t){return"function"==typeof t}function n(t){G=t}function r(t){Q=t}function o(){return function(){process.nextTick(a)}}function i(){return function(){B(a)}}function s(){var t=0,e=new X(a),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}function u(){var t=new MessageChannel;return t.port1.onmessage=a,function(){t.port2.postMessage(0)}}function c(){return function(){setTimeout(a,1)}}function a(){for(var t=0;J>t;t+=2){var e=tt[t],n=tt[t+1];e(n),tt[t]=void 0,tt[t+1]=void 0}J=0}function f(){try{var t=require,e=t("vertx");return B=e.runOnLoop||e.runOnContext,i()}catch(n){return c()}}function l(t,e){var n=this,r=new this.constructor(p);void 0===r[rt]&&k(r);var o=n._state;if(o){var i=arguments[o-1];Q(function(){x(o,r,i,n._result)})}else E(n,r,t,e);return r}function h(t){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var n=new e(p);return g(n,t),n}function p(){}function _(){return new TypeError("You cannot resolve a promise with itself")}function d(){return new TypeError("A promises callback cannot return that same promise.")}function v(t){try{return t.then}catch(e){return ut.error=e,ut}}function y(t,e,n,r){try{t.call(e,n,r)}catch(o){return o}}function m(t,e,n){Q(function(t){var r=!1,o=y(n,e,function(n){r||(r=!0,e!==n?g(t,n):S(t,n))},function(e){r||(r=!0,j(t,e))},"Settle: "+(t._label||" unknown promise"));!r&&o&&(r=!0,j(t,o))},t)}function b(t,e){e._state===it?S(t,e._result):e._state===st?j(t,e._result):E(e,void 0,function(e){g(t,e)},function(e){j(t,e)})}function w(t,n,r){n.constructor===t.constructor&&r===et&&constructor.resolve===nt?b(t,n):r===ut?j(t,ut.error):void 0===r?S(t,n):e(r)?m(t,n,r):S(t,n)}function g(e,n){e===n?j(e,_()):t(n)?w(e,n,v(n)):S(e,n)}function A(t){t._onerror&&t._onerror(t._result),T(t)}function S(t,e){t._state===ot&&(t._result=e,t._state=it,0!==t._subscribers.length&&Q(T,t))}function j(t,e){t._state===ot&&(t._state=st,t._result=e,Q(A,t))}function E(t,e,n,r){var o=t._subscribers,i=o.length;t._onerror=null,o[i]=e,o[i+it]=n,o[i+st]=r,0===i&&t._state&&Q(T,t)}function T(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r,o,i=t._result,s=0;s<e.length;s+=3)r=e[s],o=e[s+n],r?x(n,r,o,i):o(i);t._subscribers.length=0}}function M(){this.error=null}function P(t,e){try{return t(e)}catch(n){return ct.error=n,ct}}function x(t,n,r,o){var i,s,u,c,a=e(r);if(a){if(i=P(r,o),i===ct?(c=!0,s=i.error,i=null):u=!0,n===i)return void j(n,d())}else i=o,u=!0;n._state!==ot||(a&&u?g(n,i):c?j(n,s):t===it?S(n,i):t===st&&j(n,i))}function C(t,e){try{e(function(e){g(t,e)},function(e){j(t,e)})}catch(n){j(t,n)}}function O(){return at++}function k(t){t[rt]=at++,t._state=void 0,t._result=void 0,t._subscribers=[]}function Y(t){return new _t(this,t).promise}function q(t){var e=this;return new e(I(t)?function(n,r){for(var o=t.length,i=0;o>i;i++)e.resolve(t[i]).then(n,r)}:function(t,e){e(new TypeError("You must pass an array to race."))})}function F(t){var e=this,n=new e(p);return j(n,t),n}function D(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function K(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function L(t){this[rt]=O(),this._result=this._state=void 0,this._subscribers=[],p!==t&&("function"!=typeof t&&D(),this instanceof L?C(this,t):K())}function N(t,e){this._instanceConstructor=t,this.promise=new t(p),this.promise[rt]||k(this.promise),I(e)?(this._input=e,this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?S(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&S(this.promise,this._result))):j(this.promise,U())}function U(){return new Error("Array Methods must be provided an Array")}function W(){var t;if("undefined"!=typeof global)t=global;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var n=t.Promise;(!n||"[object Promise]"!==Object.prototype.toString.call(n.resolve())||n.cast)&&(t.Promise=pt)}var z;z=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var B,G,H,I=z,J=0,Q=function(t,e){tt[J]=t,tt[J+1]=e,J+=2,2===J&&(G?G(a):H())},R="undefined"!=typeof window?window:void 0,V=R||{},X=V.MutationObserver||V.WebKitMutationObserver,Z="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),$="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,tt=new Array(1e3);H=Z?o():X?s():$?u():void 0===R&&"function"==typeof require?f():c();var et=l,nt=h,rt=Math.random().toString(36).substring(16),ot=void 0,it=1,st=2,ut=new M,ct=new M,at=0,ft=Y,lt=q,ht=F,pt=L;L.all=ft,L.race=lt,L.resolve=nt,L.reject=ht,L._setScheduler=n,L._setAsap=r,L._asap=Q,L.prototype={constructor:L,then:et,"catch":function(t){return this.then(null,t)}};var _t=N;N.prototype._enumerate=function(){for(var t=this.length,e=this._input,n=0;this._state===ot&&t>n;n++)this._eachEntry(e[n],n)},N.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,r=n.resolve;if(r===nt){var o=v(t);if(o===et&&t._state!==ot)this._settledAt(t._state,e,t._result);else if("function"!=typeof o)this._remaining--,this._result[e]=t;else if(n===pt){var i=new n(p);w(i,t,o),this._willSettleAt(i,e)}else this._willSettleAt(new n(function(e){e(t)}),e)}else this._willSettleAt(r(t),e)},N.prototype._settledAt=function(t,e,n){var r=this.promise;r._state===ot&&(this._remaining--,t===st?j(r,n):this._result[e]=n),0===this._remaining&&S(r,this._result)},N.prototype._willSettleAt=function(t,e){var n=this;E(t,void 0,function(t){n._settledAt(it,e,t)},function(t){n._settledAt(st,e,t)})};var dt=W,vt={Promise:pt,polyfill:dt};"function"==typeof define&&define.amd?define(function(){return vt}):"undefined"!=typeof module&&module.exports?module.exports=vt:"undefined"!=typeof this&&(this.ES6Promise=vt),dt()}).call(this);
!function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return t[i].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var n={};return e.m=t,e.c=n,e.p="../out",e(0)}([function(t,e,n){"use strict";var i=n(10),r=n(39),o=n(42),s=n(41),a=n(40),p=n(43),c=n(1),u=function(){function t(t){if(this.sdkOption=t,!this.sdkOption)throw new i.MsFlowError("Sdk options are required");if(this.sdkOption.hostName&&"string"!=typeof this.sdkOption.hostName)throw new i.MsFlowError("The host name can only be of type string");this.sdkOption.hostName=this.sdkOption.hostName||"https://flow.microsoft.com",this.sdkOption.locale=this.sdkOption.locale||"en-us"}return t.prototype.renderWidget=function(t,e){var n;switch(t){case r.ApprovalCenterWidget.widgetType:n=new r.ApprovalCenterWidget(e,this.sdkOption);break;case s.FlowsRuntimeWidget.widgetType:n=new s.FlowsRuntimeWidget(e,this.sdkOption);break;case o.FlowsWidget.widgetType:n=new o.FlowsWidget(e,this.sdkOption);break;case a.FlowCreationWidget.widgetType:n=new a.FlowCreationWidget(e,this.sdkOption);break;case p.TemplatesWidget.widgetType:n=new p.TemplatesWidget(e,this.sdkOption)}if(!n)throw new i.MsFlowError("please provide a valid supported widget type.");return n},t}();e.MsFlowSdk=u,window.MsFlowSdk=u,window.WidgetTypes=c.WidgetTypes,window.OAuthHandlers=c.OAuthHandlers,window.WellKnownHostIds=c.WellKnownHostIds,window.msFlowSdkLoaded&&window.msFlowSdkLoaded()},function(t,e,n){"use strict";var i=n(38),r=n(10),o=n(14),s=n(3),a=n(44),p=n(34),c=n(35),u=n(37),d=n(6);e.WidgetTypes={approvalCenter:"approvalCenter",flowCreation:"flowCreation",flowsRuntime:"flowsRuntime",flows:"flows",templates:"templates"},e.WellKnownHostIds={DYNAMICS_CRM:"DynCRM",DYNAMICS_NAV:"DynNAV",EXCEL:"Excel",IOT:"IOT",LOGICAPPS:"LogicApps",OUTLOOKWEB:"OWA",POWERAPPS:"PowerApps",SHAREPOINT:"SPO",STAFFHUB:"StaffHub",TEAMS:"Teams",TREASURY:"Treasury",WIDGETTEST:"WidgetTest",UNSPECIFIED:"Unknown"},e.WidgetHostAction={FLOW_CREATION_FAILED:"FLOW_CREATION_FAILED",FLOW_CREATION_SUCCEEDED:"FLOW_CREATION_SUCCEEDED",GET_ACCESS_TOKEN:"GET_ACCESS_TOKEN",GET_IMPLICIT_DATA:"GET_IMPLICIT_DATA",SIDE_PANE_VISIBILITY_SET:"SIDE_PANE_VISIBILITY_SET",LAUNCH_OAUTH_POPUP:"LAUNCH_OAUTH_POPUP",ON_ADD_CONNECTION_CLICKED:"ON_ADD_CONNECTION_CLICKED",ON_DELETE_CUSTOM_API_CLICKED:"ON_DELETE_CUSTOMAPI_CLICKED",RUN_FLOW_CANCEL_BUTTON_CLICKED:"RUN_FLOW_CANCEL_BUTTON_CLICKED",RUN_FLOW_DONE_BUTTON_CLICKED:"RUN_FLOW_DONE_BUTTON_CLICKED",RUN_FLOW_STARTED:"RUN_FLOW_STARTED",RUN_FLOW_COMPLETED:"RUN_FLOW_COMPLETED",TEMPLATE_LOAD_FAILED:"TEMPLATE_LOAD_FAILED",WIDGET_CLOSE:"WIDGET_CLOSE",WIDGET_READY:"WIDGET_READY",WIDGET_RENDERED:"WIDGET_RENDERED",RECEIVED_APPROVAL_STATUS_CHANGED:"RECEIVED_APPROVAL_STATUS_CHANGED",SENT_APPROVAL_STATUS_CHANGED:"SENT_APPROVAL_STATUS_CHANGED"};var l={myFlows:"/manage{environment}/flows",sharedFlows:"/manage{environment}/flows/shared",receivedApprovals:"/manage{environment}/approvals/received",sentApprovals:"/manage{environment}/approvals/sent",flowCreation:"/manage{environment}/templates/flowCreation",flowsRuntime:"/manage{environment}/flow/run",templates:"/templates"};e.PathAliasesByWidgetType={flows:["myFlows","sharedFlows"],approvalCenter:["receivedApprovals","sentApprovals"],flowCreation:["flowCreation"],flowsRuntime:["flowsRuntime"],templates:["templates"]},e.OAuthHandlers={oAuth:"oAuth",teamsOAuth:"teamsOAuth"};var h="SIDE_PANE_VISIBILITY_SET",g="GET_ACCESS_TOKEN",f=function(){function t(n,i){if(this.widgetOption=n,this.sdkOption=i,this.callbacks={},this.notifyCallback="NOTIFY",this.widgetReady=!1,!this.widgetOption)throw new r.MsFlowError("Widget requires a widget option.");if(!this.sdkOption)throw new r.MsFlowError("Widget requires a sdk option.");if(this.widgetOption.oAuthHandler&&!s.equalsIgnoreCase(this.widgetOption.oAuthHandler,e.OAuthHandlers.oAuth)&&!s.equalsIgnoreCase(this.widgetOption.oAuthHandler,e.OAuthHandlers.teamsOAuth))throw new r.MsFlowError("Invalid OAuth handler specified: "+this.widgetOption.oAuthHandler);if(!this.sdkOption.hostName||this.sdkOption.hostName.length<1)throw new r.MsFlowError("hostName is required in sdk option.");if("string"==typeof this.sdkOption.hostName&&"/"===this.sdkOption.hostName.charAt(this.sdkOption.hostName.length-1)&&(this.sdkOption.hostName=this.sdkOption.hostName.substring(0,this.sdkOption.hostName.length-1)),s.isNullOrUndefined(this.sdkOption.hostId)&&(this.sdkOption.hostId=this.deriveHostId(document.location)),s.isString(this.widgetOption.container)&&(this.widgetOption.container=document.getElementById(this.widgetOption.container)),!this.widgetOption.container)throw new r.MsFlowError("Widget requires a container element.");s.isNullOrUndefined(this.widgetOption.widgetId)&&(this.widgetOption.widgetId=o.uuid()),n.debugMode&&t.allowedDomains.push(d.SdkSettings.portalTestDomain),this.widgetOption.enableRegionalPortal||this.initializeIframe(this.widgetOption.environmentId,this.sdkOption.hostName)}return t.prototype.notify=function(t,e){var n=this;return this.widgetReady?new Promise(function(i,r){var o=n.createRequestParam(),s={actionName:t,actionData:e};o.data=s,n.rpcClient.call(n.notifyCallback,[o]).then(function(t){i(t&&t.data?t.data:null)})["catch"](function(t){t&&t.innerException&&(t=t.innerException.data?t.innerException.data:{code:"UnknownError",message:t.innerException.message}),r(t)})}):Promise.reject({code:"WidgetNotReady",message:"Notify() called before widget has fired WIDGET_READY"})},t.prototype.listen=function(t,e){this.callbacks[t]||(this.callbacks[t]=e,s.equalsIgnoreCase(t,g)&&this.widgetOption.enableRegionalPortal&&this.onGetAccessTokenCallbackAdded())},t.prototype.dispose=function(){this.iframe&&(this.widgetOption.container.removeChild(this.iframe),i.removeEventListener("message",this.onReceivedMessageHandler))},t.prototype.onGetAccessTokenCallbackAdded=function(){var t=this,e=this.callbacks[g];if(e){var n={data:{resource:d.SdkSettings.authResource},callInfo:{widgetId:this.widgetOption.widgetId}},i=function(e,n){var i=n.token;t.lookupRegionalPortalUrlAndInitializeIframe(i)};try{e(n,i)}catch(r){throw new Error("failed to get access token")}}},t.prototype.lookupRegionalPortalUrlAndInitializeIframe=function(t){var e=this;c.getEnvironmentInfo(this.sdkOption.hostName,this.widgetOption.environmentId,t).then(function(t){var n=u.getRegionalPortalUrl(t.location,e.sdkOption.hostName);e.initializeIframe(t.name,n)})["catch"](function(t){e.regionalPortalInitFailed=!0,e.initializeIframe(e.widgetOption.environmentId,e.sdkOption.hostName)})},t.prototype.initializeIframe=function(t,e){this.sdkOption.hostName=e,this.widgetOption.environmentId=this.widgetOption.environmentId||t,this.url=this.constructUrl(),this.renderIframe(),this.rpcClient=new a.Rpc({signature:this.widgetOption.widgetId,targetOrigin:"*",rpcMessageHandler:new a.WindowPostMessageRpcHandler({targetWindow:this.iframe.contentWindow})})},t.prototype.createRequestParam=function(){var t={widgetId:this.widgetOption.widgetId};return{callInfo:t}},t.prototype.renderIframe=function(){var t=this;this.iframe=document.createElement("iframe"),this.iframe.setAttribute("src",this.url),this.iframe.setAttribute("id",this.widgetOption.widgetId),this.iframe.setAttribute("name","widgetIFrame"),this.iframe.setAttribute("tabIndex","0");var e=this.widgetOption.container;this.iframe.scrolling=e.getAttribute("data-mswidget-scrolling")||"yes",e.appendChild(this.iframe),this.onReceivedMessageHandler=function(e){return t.onMessageReceived(e)},i.addEventListener("message",this.onReceivedMessageHandler,!0),this.listen(h,function(e){t.iframe.scrolling=e.data&&e.data.visible?"no":"auto"})},t.prototype.onMessageReceived=function(t){if(!this.isValidRpcEvent(t))return void console.error("Widget dropping received message because its RPC event is invalid");if(t.data.method)switch(t.data.method){case"__PING__":this.rpcAckHandler(t);break;default:this.invokeCallbackHandler(t.data.method,t)}},t.prototype.isValidRpcEvent=function(e){var n=s.endsWithIgnoreCase(e.origin,"/")?e.origin.replace("/",""):e.origin;return s.equalsIgnoreCase(e.data.signature,this.widgetOption.widgetId)&&t.allowedDomains.some(function(t){return s.endsWithIgnoreCase(n,t)})},t.prototype.rpcAckHandler=function(t){var e={id:t.data.id,signature:t.data.signature,result:"__PONG__",error:null};t.source.postMessage(e,t.origin)},t.prototype.invokeCallbackHandler=function(t,n){var i;n&&n.data&&n.data.params&&n.data.params.length>0&&(i=n.data.params[0]),t===e.WidgetHostAction.WIDGET_READY&&this.setIsReady();var r=this.callbacks[t];if(r){var o={id:n.data.id,signature:n.data.signature},s=function(t,e){o.result=e,o.error=t,n.source.postMessage(o,n.origin)};try{r(i,s)}catch(a){o.result=null,o.error=a,n.source.postMessage(o,n.origin)}}},t.prototype.constructUrl=function(){return(""+this.constructBaseUrl()+this.getWidgetPath()+this.constructWidgetQueryString()).replace("{environment}",this.widgetOption.environmentId?"/environments/"+this.widgetOption.environmentId:"")},t.prototype.setIsReady=function(){this.widgetReady=!0},t.prototype.getRpcClient=function(){return this.rpcClient},t.prototype.constructBaseUrl=function(){return"string"==typeof this.sdkOption.hostName?this.sdkOption.hostName+"/"+this.sdkOption.locale+"/widgets":this.sdkOption.hostName[0]+"/"+this.sdkOption.locale+"/widgets"},t.prototype.constructBaseQueryString=function(){var t="?widgetId="+this.widgetOption.widgetId+("&sdkVersion="+p.config.version)+("&widgetType="+this.getWidgetType())+"&utm_medium=widget&utm_source="+this.sdkOption.hostId;return this.widgetOption.environmentId&&(t+="&environment="+this.widgetOption.environmentId),s.isNullOrUndefined(this.widgetOption.enableOnBehalfOfTokens)||(t+="&enableOnBehalfOfTokens="+this.widgetOption.enableOnBehalfOfTokens),s.isNullOrUndefined(this.widgetOption.groupId)||(t+="&groupId="+this.widgetOption.groupId),s.isNullOrUndefined(this.widgetOption.enableRegionalPortal)||(t+="&enableRegionalPortal="+this.widgetOption.enableRegionalPortal),s.isNullOrUndefined(this.widgetOption.oAuthHandler)&&(this.widgetOption.oAuthHandler=e.OAuthHandlers.oAuth),t+="&oAuthHandler="+this.widgetOption.oAuthHandler},t.prototype.constructHideTabsQueryParam=function(t){return t===!0?"&hideTabs="+t:"&hideTabs=false"},t.prototype.constructWidgetQueryString=function(){var t=this.constructBaseQueryString();if(this.widgetOption.widgetStyleSettings&&(t+=this.getDynamicParamsUrl(this.widgetOption.widgetStyleSettings)),this.widgetOption.flowsSettings){if(this.widgetOption.flowsSettings.createFromBlankTemplateId&&(t+="&defaultTemplate="+this.widgetOption.flowsSettings.createFromBlankTemplateId),this.widgetOption.flowsSettings.flowsFilter){var e="&flowsFilter="+encodeURIComponent(this.widgetOption.flowsSettings.flowsFilter);t+=e}t+=this.constructHideTabsQueryParam(this.widgetOption.flowsSettings.hideTabs),this.widgetOption.flowsSettings.isMini&&(t+="&isMini=true"),this.widgetOption.flowsSettings.hideFlowCreation&&(t+="&hideFlowCreation=true")}if(this.widgetOption.approvalCenterSettings){if(t+=this.constructHideTabsQueryParam(this.widgetOption.approvalCenterSettings.hideTabs),this.widgetOption.approvalCenterSettings.approvalsFilter){var n="&approvalsFilter="+encodeURIComponent(this.widgetOption.approvalCenterSettings.approvalsFilter);t+=n}this.widgetOption.approvalCenterSettings.autoNavigateToDetails&&(t+="&autoNavigateToDetails=true"),this.widgetOption.approvalCenterSettings.hideInfoPaneCloseButton&&(t+="&hideInfoPaneCloseButton=true"),this.widgetOption.approvalCenterSettings.hideFlowCreation&&(t+="&hideFlowCreation=true"),this.widgetOption.approvalCenterSettings.showSimpleEmptyPage&&(t+="&showSimpleEmptyPage=true"),this.widgetOption.approvalCenterSettings.hideLink&&(t+="&hideLink=true")}return this.widgetOption.templatesSettings&&(this.widgetOption.templatesSettings.defaultParams&&(t+=this.getDynamicParamsUrl(this.widgetOption.templatesSettings.defaultParams)),this.widgetOption.templatesSettings.destination&&(t+="&destination="+this.widgetOption.templatesSettings.destination),this.widgetOption.templatesSettings.templateCategory&&(t+="&category="+this.widgetOption.templatesSettings.templateCategory),this.widgetOption.templatesSettings.pageSize&&(t+="&pageSize="+this.widgetOption.templatesSettings.pageSize),this.widgetOption.templatesSettings.useServerSideProvisioning&&(t+="&useServerSideProvisioning="+this.widgetOption.templatesSettings.useServerSideProvisioning),this.widgetOption.templatesSettings.searchTerm&&(t+="&q="+this.widgetOption.templatesSettings.searchTerm),this.widgetOption.templatesSettings.showGoBack&&(t+="&showGoBack=true"),this.widgetOption.templatesSettings.enableDietDesigner&&(t+="&enableDietDesigner="+this.widgetOption.templatesSettings.enableDietDesigner),this.widgetOption.templatesSettings.allowCustomFlowName&&(t+="&allowCustomFlowName="+this.widgetOption.templatesSettings.allowCustomFlowName)),this.widgetOption.runtimeSettings&&(t+=this.getDynamicParamsUrl(this.widgetOption.runtimeSettings)),t+="&pathAlias="+this.getWidgetPathAlias(),this.regionalPortalInitFailed&&(t+="&regionalPortalInitFailed=true"),this.widgetOption.historyDisabled&&(t+="&historyDisabled=true"),t},t.prototype.getWidgetPathAlias=function(){var t;switch(this.getWidgetType()){case e.WidgetTypes.flows:t=this.widgetOption.flowsSettings?this.widgetOption.flowsSettings.tab:null;break;case e.WidgetTypes.approvalCenter:t=this.widgetOption.approvalCenterSettings?this.widgetOption.approvalCenterSettings.tab:null}var n=e.PathAliasesByWidgetType[this.getWidgetType()];if(t&&-1===n.indexOf(t))throw new r.MsFlowError("Please provide a valid widget tab identifier for the specified widget type. "+("Widget type '"+this.getWidgetType()+"' does not support tab '"+t+"'. Supported tabs for ")+("this widget type are: '"+JSON.stringify(n)+"'."));return t?t:n[0]},t.prototype.getWidgetPath=function(){return l[this.getWidgetPathAlias()]},t.prototype.getDynamicParamsUrl=function(t){var e="";if(Object.keys(t).length>0)try{e="&"+Object.keys(t).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(t[e])}).join("&")}catch(n){throw new Error("Failed to create url params out of dynamic params data. Exception: "+n)}return e},t.prototype.deriveHostId=function(t){if(s.isNullOrUndefined(t)||s.isNullOrUndefined(t.pathname)||s.isNullOrUndefined(t.hostname))return e.WellKnownHostIds.UNSPECIFIED;var n=t.pathname.toLowerCase(),i=t.hostname.toLowerCase(),r=/crm[\d]+\.dynamics.com/;return s.endsWithIgnoreCase(i,".powerapps.com")?e.WellKnownHostIds.POWERAPPS:s.endsWithIgnoreCase(i,".sharepoint.com")||s.endsWithIgnoreCase(i,".sharepoint-df.com")||s.endsWithIgnoreCase(i,"msft.spoppe.com")?e.WellKnownHostIds.SHAREPOINT:s.endsWithIgnoreCase(i,".financials.dynamics.com")?e.WellKnownHostIds.DYNAMICS_NAV:s.endsWithIgnoreCase(i,".crm.dynamics.com")||s.endsWithIgnoreCase(i,"crmdynint.com")||r.exec(i)?e.WellKnownHostIds.DYNAMICS_CRM:s.endsWithIgnoreCase(i,"outlook.office.com")||s.endsWithIgnoreCase(i,"outlook-sdf.office.com")?e.WellKnownHostIds.OUTLOOKWEB:s.endsWithIgnoreCase(i,".flow.microsoft.com")||s.endsWithIgnoreCase(i,"dev.azure-flows.net")?e.WellKnownHostIds.WIDGETTEST:s.endsWithIgnoreCase(i,".hosting.portal.azure.net")?e.WellKnownHostIds.LOGICAPPS:s.endsWithIgnoreCase(i,".azureiotcentral-dev.com")||s.endsWithIgnoreCase(i,"azureiotcentral.com")?e.WellKnownHostIds.IOT:s.endsWithIgnoreCase(i,"staffhub.office.com")||s.endsWithIgnoreCase(i,"staffhub.ms")?e.WellKnownHostIds.STAFFHUB:s.endsWithIgnoreCase(i,"bankadmin.azurewebsites.net")||s.endsWithIgnoreCase(i,"maui-uat.azurewebsites.net")||s.endsWithIgnoreCase(i,"maui-int.azurewebsites.net")?e.WellKnownHostIds.TREASURY:n.indexOf("widgethosts/teams")>=0?e.WellKnownHostIds.TEAMS:n.indexOf("widgethosts/excel")>=0?e.WellKnownHostIds.EXCEL:e.WellKnownHostIds.UNSPECIFIED},t.widgetPrefix="msflowsdk",t.allowedDomains=[d.SdkSettings.portalDomain],t}();e.Widget=f},function(t,e,n){"use strict";function i(t,e){var n,i=""+t;return i&&e&&(n=r.equalsIgnoreCase(i.substring(0,e.length),e)),n}var r=n(5);e.startsWithIgnoreCase=i},function(t,e,n){"use strict";function i(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}i(n(5)),i(n(22)),i(n(23)),i(n(2)),i(n(8)),i(n(24)),i(n(25))},function(t,e,n){"use strict";function i(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}i(n(7)),i(n(19)),i(n(20)),i(n(21))},function(t,e){"use strict";function n(t,e){return t=(""+t).toUpperCase(),e=(""+e).toUpperCase(),t===e}e.equalsIgnoreCase=n},function(t,e){"use strict";e.SdkSettings={authResource:"https://management.core.windows.net/",apiVersion:"2016-11-01",portalDomain:"flow.microsoft.com",providerName:"microsoft.processsimple",apiUrl:"https://api.flow.microsoft.com",tip1ApiUrl:"https://tip1.api.flow.microsoft.com",tip1ApiVersion:"2016-11-01-beta",tip1PortalDomain:"tip1.flow.microsoft.com",portalTestDomain:"flows.azure-test.net"}},function(t,e){"use strict";function n(t,e,n){for(var i in t)t.hasOwnProperty(i)&&e.call(n,{key:i,value:t[i]})}e.forEach=n},function(t,e,n){"use strict";function i(t,e){var n,i=""+t;return i&&e&&(n=r.equalsIgnoreCase(i.substr(i.length-e.length),e)),n}var r=n(5);e.endsWithIgnoreCase=i},function(t,e,n){"use strict";function i(t){var e={};return t?(o.startsWithIgnoreCase(t,"?")&&(t=t.substring(1)),t.split("&").forEach(function(t){var n=t.split("="),i=n[0],r=n[1];e[decodeURIComponent(i||"")]=decodeURIComponent(r||"")}),e):e}function r(t){return Object.keys(t||{}).map(function(e){var n=encodeURIComponent(e),i=encodeURIComponent(t[e]);return n+"="+i}).join("&")}var o=n(2);e.parseQueryString=i,e.createQueryString=r},function(t,e){"use strict";var n=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},i=function(t){function e(n){t.call(this,e.errorName+": message"),this.message=n,this.name=e.errorName}return n(e,t),e.errorName="MsFlowSdk",e}(Error);e.MsFlowError=i},function(t,e){"use strict";function n(t){return t?new Date(t):null}e.getDate=n},function(t,e,n){"use strict";function i(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}i(n(13)),i(n(11))},function(t,e){"use strict";function n(t){var e="";if(t.hasOwnProperty("toISOString"))e=t.toISOString();else{var n=t.getUTCFullYear(),r=i(t.getUTCMonth()+1,2),o=i(t.getUTCDate(),2),s=i(t.getUTCHours(),2),a=i(t.getUTCMinutes(),2),p=i(t.getUTCSeconds(),2),c=i(t.getUTCMilliseconds(),3);e=n+"-"+r+"-"+o+"T"+s+":"+a+":"+p+"."+c+"Z"}return e}function i(t,e){for(var n=""+t,i=n.length,r=i;e>r;r++)n="0"+n;return n}e.toISOString=n},function(t,e,n){"use strict";function i(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}var r=n(12);e.date=r;var o=n(15);e.json=o;var s=n(4);e.object=s;var a=n(3);e.string=a;var p=n(28);e.url=p,i(n(18)),i(n(33))},function(t,e,n){"use strict";function i(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}i(n(16)),i(n(17))},function(t,e){"use strict";function n(t,e){var n=[],i=function(t,e){if(null!==e&&"object"==typeof e){if(n.indexOf(e)>=0)return;n.push(e)}return e};return t?JSON.stringify(t,i,e?"	":4):""}e.prettyStringify=n},function(t,e,n){"use strict";function i(t){if(r.isObject(t)){"function"==typeof t.toJSON&&(t=t.toJSON());var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push({key:n,value:t[n]});e.sort(function(t,e){return t.key<e.key?-1:1});var o=e.map(function(t){return'"'+t.key+'":'+i(t.value)});return"{"+o.join(",")+"}"}if(Array.isArray(t)){"function"==typeof t.toJSON&&(t=t.toJSON());var s=t.map(function(t){return i(t)});return"["+s.join(",")+"]"}return JSON.stringify(t)}var r=n(4);e.stableStringify=i},function(t,e){"use strict";var n=function(){function t(t){this.initialized=!1,this.func=t}return Object.defineProperty(t.prototype,"value",{get:function(){if(this.initialized){if(this.cachedError)throw this.cachedError;return this.cachedValue}try{return this.cachedValue=this.func(),this.cachedValue}catch(t){throw this.cachedError=t,t}finally{this.initialized=!0}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isValueCreated",{get:function(){return this.initialized},enumerable:!0,configurable:!0}),t}();e.Lazy=n},function(t,e){"use strict";function n(t,e){return t[e]}e.getEnumValue=n},function(t,e){"use strict";function n(t){return!(!t||"object"!=typeof t||t instanceof Date||t instanceof RegExp||Array.isArray(t))}e.isObject=n},function(t,e,n){"use strict";function i(t,e,n){var i=[];return r.forEach(t,function(t){var r=e.call(n,t);null!==r&&void 0!==r&&i.push(r)}),i}var r=n(7);e.map=i},function(t,e){"use strict";function n(){var t,e=Array.prototype.slice.apply(arguments),n=e[0]||"",i=e.slice(1),r=/\{[a-zA-Z$_\d]*\}/g,o=/\{(\d+)\}/g,s=!1;if(i&&1===i.length&&i[0]&&"object"==typeof i[0]){var a=i[0];t=n.replace(r,function(t){var e=t.substring(1,t.length-1);return a.hasOwnProperty(e)?(s=!0,a[e]):t})}return s||(t=n.replace(o,function(t,n){return void 0!==e[n]?e[n]:t})),t}e.format=n},function(t,e){"use strict";function n(t){return null===t||void 0===t}e.isNullOrUndefined=n},function(t,e){"use strict";function n(t){return"string"==typeof t||t instanceof String}e.isString=n},function(t,e){"use strict";function n(t,e,n){return"undefined"==typeof n&&(n=0),String.prototype.indexOf.call(t,e,n)>=0}e.stringIncludes=n},function(t,e,n){"use strict";function i(t,e){return o.endsWithIgnoreCase(t,"/")&&r.startsWithIgnoreCase(e,"/")?t.substring(0,t.length-1)+e:o.endsWithIgnoreCase(t,"/")||r.startsWithIgnoreCase(e,"/")?t+e:t+"/"+e}var r=n(2),o=n(8);e.concatParts=i},function(t,e,n){"use strict";function i(t,e,n,i){var r=new o(t,e);return r.format(n,i)}var r=n(4);e.formatDottedUrl=i;var o=function(){function t(t,e){this._dottedUrlTemplate=[t,e].join("/")}return t.prototype.format=function(t,e){var n=this;t=t||{},e=e||{};var i={},o=this._dottedUrlTemplate.replace(/:(\w+?)(\W|$)/g,function(r,o,s){if(!t[o])return""+s;var a=t[o];return"string"==typeof a&&"@"===a[0]&&(a=n._lookupDottedPath(e||{},a)),angular.isFunction(a)&&(a=a()),i[o]=a,a+s}),s={};r.forEach(t,function(t){i[t.key]||(s[t.key]=angular.isFunction(t.value)?t.value():t.value)}),o=o.split("://").map(function(t){return t.replace(/[\/]{2,}/g,"/")}).join("://"),o=this._encodeUri(o);var a=this._getQueryString(s);return a&&(o=o+(/\?/.test(o)?"&":"?")+a),o},t.prototype._lookupDottedPath=function(t,e){try{return""+(e||"").split(".").reduce(function(t,e){return t[e]},t)}catch(n){return""}},t.prototype._getQueryString=function(t){var e=this,n=r.map(t,function(t){var n=e._camelCaseToHypens(t.key);return e._encodeQueryStringComponent(n)+"="+e._encodeQueryStringComponent(t.value)});return n.join("&")},t.prototype._camelCaseToHypens=function(t){return t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()},t.prototype._encodeUri=function(t){return encodeURI(t).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+").replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")},t.prototype._encodeQueryStringComponent=function(t){return encodeURIComponent(t).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")},t}()},function(t,e,n){"use strict";function i(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}i(n(26)),i(n(27)),i(n(29)),i(n(30)),i(n(9)),i(n(31)),i(n(32))},function(t,e,n){"use strict";function i(t){return s.startsWithIgnoreCase(t,"http://")}function r(t){return s.startsWithIgnoreCase(t,"https://")}function o(t){return r(t)||i(t)}var s=n(2);e.isHttpUrl=i,e.isHttpsUrl=r,e.isAbsoluteUrl=o},function(t,e,n){"use strict";function i(t){var e=document.createElement("a");e.href=t;var n=e.pathname||"";return o.startsWithIgnoreCase(n,"/")||(n="/"+n),{raw:t,protocol:e.protocol?e.protocol.replace(/:/g,""):"",host:e.host||"",hostname:e.hostname||"",port:e.port?Number(e.port):void 0,path:n,parameters:r.parseQueryString(e.search||""),hash:decodeURIComponent(e.hash||"")}}var r=n(9),o=n(2);e.parseUri=i},function(t,e){"use strict";function n(t){return t.replace(/^\/+/,"")}e.stripLeadingSlashes=n},function(t,e){"use strict";function n(t){return t.replace(/\/+$/,"")}e.stripTrailingSlashes=n},function(t,e){"use strict";function n(){var t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0,o=i[255&t]+i[t>>8&255]+i[t>>16&255]+i[t>>24&255],s=i[255&e]+i[e>>8&255]+"-"+i[e>>16&15|64]+i[e>>24&255],a=i[63&n|128]+i[n>>8&255]+"-"+i[n>>16&255]+i[n>>24&255],p=i[255&r]+i[r>>8&255]+i[r>>16&255]+i[r>>24&255];return o+"-"+s+"-"+a+"-"+p}for(var i=[],r=0;256>r;r++)i[r]=(16>r?"0":"")+r.toString(16);e.uuid=n},function(t,e){"use strict";e.config={version:"1.1"}},function(t,e,n){"use strict";function i(t,e){(s.isNullOrUndefined(e)||""===e.trim())&&(e="~default");var n=o.SdkSettings.apiVersion,i=o.SdkSettings.apiUrl;return t=t.toLowerCase(),t&&(s.stringIncludes(t,o.SdkSettings.tip1PortalDomain,0)||s.stringIncludes(t,o.SdkSettings.portalTestDomain,0))&&(n=o.SdkSettings.tip1ApiVersion,i=o.SdkSettings.tip1ApiUrl),i+"/providers/"+o.SdkSettings.providerName+"/environments/"+e+"?api-version="+n}function r(t,e,n){var r=i(t,e);return a.getJson(r,n).then(function(t){return{name:t.name,location:t.location}})}var o=n(6),s=n(3),a=n(36);e.getEnvironmentUrl=i,e.getEnvironmentInfo=r},function(t,e){"use strict";function n(t,e){return new Promise(function(n,i){var r=new XMLHttpRequest;r.open("GET",t),r.onload=function(){if(this.status>=200&&this.status<300)try{n(JSON.parse(r.responseText))}catch(t){i({status:this.status,statusText:t})}else i({status:this.status,statusText:r.statusText})},r.onerror=function(){i({status:this.status,statusText:r.statusText})},r.open("GET",t),r.setRequestHeader("Accept","application/json"),r.setRequestHeader("Authorization","Bearer "+e),r.send()})}e.getJson=n},function(t,e,n){"use strict";function i(t){if(!t)return null;var e=t.toLowerCase();switch(e){case"unitedstatesfirstrelease":return"preview";case"unitedstates":return"us";case"unitedkingdom":return"uk";case"europe":return"emea";default:return e}}function r(t,e){if(o.isNullOrUndefined(t)||""===t.trim())return e;var n,r=i(t);return e=e.toLowerCase(),n=o.stringIncludes(e,s.SdkSettings.portalTestDomain,0)?s.SdkSettings.portalTestDomain:o.stringIncludes(e,s.SdkSettings.tip1PortalDomain,0)?s.SdkSettings.tip1PortalDomain:s.SdkSettings.portalDomain,"https://"+r+"."+n}var o=n(3),s=n(6);e.getHostNamePrefixFromGeoLocation=i,e.getRegionalPortalUrl=r},function(t,e){"use strict";function n(t,e,n){window.addEventListener?window.addEventListener(t,e,n):window.attachEvent(t,e)}function i(t,e,n){window.removeEventListener?window.removeEventListener(t,e,n):window.detactEvent(t,e)}e.addEventListener=n,e.removeEventListener=i},function(t,e,n){"use strict";var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},r=n(1),o=function(t){function e(e,n){t.call(this,e,n),this.widgetOption=e,this.sdkOption=n}return i(e,t),e.prototype.getWidgetType=function(){return e.widgetType},e.widgetType=r.WidgetTypes.approvalCenter,e}(r.Widget);e.ApprovalCenterWidget=o},function(t,e,n){"use strict";var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},r=n(1),o=function(t){function e(e,n){t.call(this,e,n),this.widgetOption=e,this.sdkOption=n}return i(e,t),e.prototype.getWidgetType=function(){return e.widgetType},e.widgetType=r.WidgetTypes.flowCreation,e}(r.Widget);e.FlowCreationWidget=o},function(t,e,n){"use strict";var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},r=n(1),o=function(t){function e(e,n){t.call(this,e,n),this.widgetOption=e,this.sdkOption=n}return i(e,t),e.prototype.getWidgetType=function(){return e.widgetType},e.widgetType=r.WidgetTypes.flowsRuntime,e}(r.Widget);e.FlowsRuntimeWidget=o},function(t,e,n){"use strict";var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},r=n(1),o=function(t){function e(e,n){t.call(this,e,n),this.widgetOption=e,this.sdkOption=n}return i(e,t),e.prototype.getWidgetType=function(){return e.widgetType},e.widgetType=r.WidgetTypes.flows,e}(r.Widget);e.FlowsWidget=o},function(t,e,n){"use strict";var i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},r=n(1),o=function(t){function e(e,n){t.call(this,e,n),this.widgetOption=e,this.sdkOption=n}return i(e,t),e.prototype.getWidgetType=function(){return e.widgetType},e.widgetType=r.WidgetTypes.templates,e}(r.Widget);e.TemplatesWidget=o},function(t,e,n){var i;i=function(){return function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return t[i].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){var i,r;i=[n,e,n(1),n(2)],r=function(t,e,n,i){"use strict";function r(){var t={};return t.promise=new Promise(function(e,n){t.resolve=e,t.reject=n}),t}var o="__PING__",s="__PONG__",a=function(){function t(t){var e=this;if(this._deferredResponses={},this._rpcMethods={},this._ready=!1,this._queuedRequestMessages=[],this._onRpcMessageRecieved=function(t){if(t&&t.signature===e._rpcOptions.signature){var n=t;n.method?e._onRpcRequestMessageReceived(n):e._onRpcResponseMessageReceived(t)}},this._onRpcRequestMessageReceived=function(t){var n=e._rpcMethods[t.method];if(n){var i={signature:t.signature,id:t.id,error:null};try{var r=n.apply(e,t.params);e._rpcOptions.Promise.resolve(r).then(function(t){i.result=t,e._rpcOptions.rpcMessageHandler.postMessage(i,e._rpcOptions.targetOrigin)})["catch"](function(t){i.error=e._serializeError(t),e._rpcOptions.rpcMessageHandler.postMessage(i,e._rpcOptions.targetOrigin)})}catch(o){i.error=e._serializeError(o),e._rpcOptions.rpcMessageHandler.postMessage(i,e._rpcOptions.targetOrigin)}}},this._onRpcResponseMessageReceived=function(t){var n=e._deferredResponses[t.id];n&&(t.error?n.reject(e._deserializeError(t.error)):n.resolve(t.result),delete e._deferredResponses[t.id])},!t)throw new Error("rpcOptions required");t.Promise||(t.Promise={defer:r,resolve:function(t){return Promise.resolve(t)},reject:function(t){return Promise.reject(t)}}),this._rpcOptions=t,this._rpcOptions.rpcMessageHandler.addListener(this._onRpcMessageRecieved),this.register(o,this._onPing)}return t.prototype.ack=function(){var t=this;return this.unregister(o),this.call(o).then(function(e){return e!==s?Promise.reject(new Error("Invalid PONG message"+e)):(t._ready=!0,void t._processQueue())})["catch"](function(e){return t.register(o,t._onPing),console.error("PING failed to receive PONG message",e),Promise.reject(e)})},t.prototype.call=function(t,e){var n=i["default"](),r={signature:this._rpcOptions.signature,id:n,method:this._normalizeMethodName(t),params:e},s=this._rpcOptions.Promise.defer();return this._deferredResponses[n]=s,this._ready||t===o?this._call(r):this._queuedRequestMessages.push(r),s.promise},t.prototype.register=function(t,e){var n=this._normalizeMethodName(t);if(this._rpcMethods[n])throw new Error("Rpc method with name '"+t+"' already registered.");this._rpcMethods[n]=e},t.prototype.unregister=function(t){var e=this._normalizeMethodName(t);if(!this._rpcMethods[e])throw new Error("Rpc method with name "+t+" failed to unregister. Method not found");delete this._rpcMethods[e]},t.prototype.dispose=function(){var t=this;this._rpcMethods={},Object.keys(this._deferredResponses).forEach(function(e){return t._deferredResponses[e].reject(new Error("rpc disposed"))}),this._deferredResponses={},this._rpcOptions.rpcMessageHandler.removeListener(this._onRpcMessageRecieved)},t.prototype._call=function(t){
try{this._rpcOptions.rpcMessageHandler.postMessage(t,this._rpcOptions.targetOrigin)}catch(e){this._deferredResponses[t.id].reject(e),delete this._deferredResponses[t.id]}},t.prototype._onPing=function(){return this.unregister(o),this._ready=!0,this._processQueue(),s},t.prototype._processQueue=function(){var t=this;this._queuedRequestMessages.forEach(function(e){return t._call(e)}),this._queuedRequestMessages=[]},t.prototype._normalizeMethodName=function(t){return t.toUpperCase()},t.prototype._serializeError=function(t){if(t instanceof Error){var e={name:t.name,message:t.message,_stack:t.stack};return Object.keys(t).forEach(function(n){e[n]=t[n]}),{value:e}}return{value:t}},t.prototype._deserializeError=function(t){return new n.RpcException("ReceiverFailed","Receiver failed",n.convertToException(t.value))},t}();e.Rpc=a;var p=function(){function t(t){if(this._listeners={},!t)throw new Error("options required");if(!t.targetWindow)throw new Error("targetWindow required");t.sourceWindow=t.sourceWindow||window,t.messageSerializer=t.messageSerializer||function(t){return t},t.messageDeserializer=t.messageDeserializer||function(t){return t},this._options=t}return t.prototype.postMessage=function(t,e){this._options.targetWindow.postMessage(this._options.messageSerializer(t),e)},t.prototype.addListener=function(t){var e=this;this._listeners[t]&&console.error("duplicate rpc listener added"),this._listeners[t]=function(n){var i=e._options.messageDeserializer(n.data);i&&t(i.method?{signature:i.signature,id:i.id,method:i.method,params:i.params}:{signature:i.signature,id:i.id,result:i.result,error:i.error})},this._options.sourceWindow.addEventListener("message",this._listeners[t])},t.prototype.removeListener=function(t){this._options.sourceWindow.removeEventListener("message",this._listeners[t]),delete this._listeners[t]},t}();e.WindowPostMessageRpcHandler=p}.apply(e,i),!(void 0!==r&&(t.exports=r))},function(t,e,n){var i,r,o=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};i=[n,e],r=function(t,e){"use strict";function n(t){return t instanceof Error||t.name&&t.message&&!t.hasOwnProperty("_stackTrace")?new i("ErrorException","Error",t.message,t):t.type&&t.code&&t.message&&t.hasOwnProperty("_stackTrace")?t:new r(t)}var i=function(){function t(t,e,n,i,r){void 0===i&&(i=null),void 0===r&&(r=null);var o=i&&i instanceof Error?i:new Error(n);if(!t)throw new a("Type cannot be empty for exception");if(this._type=t,!e)throw new a("Code cannot be empty for exception");if(this._code=e,!n)throw new a("Message cannot be empty for exception");this._message=n,this._data=i,this._stackTrace=o.stack,this._innerException=r}return Object.defineProperty(t.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"code",{get:function(){return this._code},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"stackTrace",{get:function(){return this._stackTrace},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"message",{get:function(){return this._message},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"innerException",{get:function(){return this._innerException},enumerable:!0,configurable:!0}),t}();e.Exception=i;var r=function(t){function e(e){return t.call(this,"UnknownException","UnknownException","Unknown error.",e)||this}return o(e,t),e}(i);e.UnknownException=r;var s=function(t){function e(e,n,i){return void 0===i&&(i=null),t.call(this,"RpcException",e,n,null,i)||this}return o(e,t),e}(i);e.RpcException=s;var a=function(t){function e(e){return t.call(this,"ArgumentException","ArgumentException",e,null,null)||this}return o(e,t),e}(i);e.ArgumentException=a,e.convertToException=n}.apply(e,i),!(void 0!==r&&(t.exports=r))},function(t,e,n){var i,r;i=[n,e],r=function(t,e){"use strict";function n(){for(var t,e="",n=0;4>n;n++)t=4294967296*Math.random()|0,e+=i[15&t]+i[t>>4&15]+i[t>>8&15]+i[t>>12&15]+i[t>>16&15]+i[t>>20&15]+i[t>>24&15]+i[t>>28&15];var o=i[8+4*Math.random()|0];return e.substr(0,8)+r+e.substr(9,4)+r+"4"+e.substr(13,3)+r+o+e.substr(16,3)+r+e.substr(19,12)}var i=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"],r="-";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=n}.apply(e,i),!(void 0!==r&&(t.exports=r))}])}.call(e,n,e,t),!(void 0!==i&&(t.exports=i))}]);
//# sourceMappingURL=msflowsdk.js.map;
window.scriptsLoaded['flowsdk.owa.bundle.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['flowsdk.owa.bundle.js'] = (new Date()).getTime();
