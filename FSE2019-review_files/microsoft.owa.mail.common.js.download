window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.mail.common.js'] = (new Date()).getTime();
Type.registerNamespace("_mco");var ISchedulingGridSurfaceItemViewModel=function(){};ISchedulingGridSurfaceItemViewModel.registerInterface("ISchedulingGridSurfaceItemViewModel");_mco.v=function(n,t){this.a=n;this.b=t};_mco.v.prototype={b:0,a:null};_mco.C=function(){};_mco.C.a=function(n){var t=!1;var r=_a.d.a().h();var i=r-n.RequestStartTimeMilliseconds;t=i>1e4;t;return t};_mco.d=function(n){_mco.d.initializeBase(this);if(!n)throw Error.argumentNull("getLinkPreviewRequest");this.e=n};_mco.d.n=function(){return!(_g.a.a().bH.LinkPreviewEnabled&&_g.a.a().a().bH.LinkPreviewEnabled)};_mco.d.e=function(n){var i=n?n.a().iR().Enabled:!1;var t=_mco.d.f;return i&&!t};_mco.d.g=function(n){n.RequestStartTimeMilliseconds=_a.d.a().h()};_mco.d.q=function(n,t,i,r,u,f,e,o){var s=n;var h=null;if(s.G)h=s.G.message;else if(s.N)if(s.N.IsDisabled){_mco.d.f=!0;i();h="Get link preview response returned disabled"}else if(s.N.LinkPreview&&!s.N.ErrorMessage){var c=s.N.LinkPreview;_mco.C.a(c)?h="Link preview generation timeout interval exceeded":t(c);h=_mco.d.v(s)}else s.N.ErrorMessage&&(h=s.N.Error?s.N.Error:"null");else h="Get link preview response returned null result";if(u){u.m=_mco.d.c(s,r,e,o);u.n=u.n||h;u.o=s.P();_a.b.a(u)}};_mco.d.l=function(n,t,i,r,u,f){var e=n;var s=_mco.d.c(e,t,u,f);var h=e.P();var o;o=e.G?e.G.message:"GetLinkPreviewAction failed callback";if(i){i.n=o;i.o=e.P();i.m=s;_a.b.a(i)}};_mco.d.b=function(n,t,i){var u="U";var r;n&&!_j.h.a(r=n.getAttribute(t))&&(u=_mco.d.d(r,i));return u};_mco.d.d=function(n,t){if(_j.h.a(n))return"";var r;try{r=new _a.P(n)}catch(f){return n.substring(0,t)}var i=r.a;i.startsWith("www.")&&(i=i.substr(4));var u;u=r.b==="http"?i:r.b==="https"?"s/"+i:r.b+"/"+i;u+=r.d;return u.substring(0,t)};_mco.d.v=function(n){var t=null;if((n.N.DataProviderType&32)==32){var i=n.N.LinkPreview;_j.h.a(i.PreviewImageInBase64)&&(t="NoDocVizPreviewImage")}return t};_mco.d.w=function(n,t){(n&4)==4?t.a("PT","F"):(n&1)==1?t.a("PT","G"):(n&32)==32?t.a("PT","SP"):(n&64)==64?t.a("PT","BW"):(n&128)==128?t.a("PT","ODC"):n&0||t.a("PT","N")};_mco.d.c=function(n,t,i,r){var u=new _a.l;if(n){n.N&&_mco.d.w(n.N.DataProviderType,u);if(n.N&&n.N.LinkPreview){var f=n.N.LinkPreview;if(f.__type===_gg.bp._dataContractName)u.a("T","Y");else if(f.__type===_gg.bk._dataContractName)u.a("T","V");else if(f.__type===_gg.Q._dataContractName)u.a("T","P");else if(f.__type===_gg.lJ._dataContractName)u.a("T","B");else if(f.__type===_gg.p._dataContractName){u.a("T","ODB");_mco.d.x(n,u)}else if(f.__type===_gg.ja._dataContractName){u.a("T","ODC");_mco.d.y(n,u)}else u.a("T","G");u.b("R",n.N.ElapsedTimeToRegExStepCompletion);u.b("W",n.N.ElapsedTimeToWebPageStepCompletion);u.b("C",n.N.WebPageContentLength);u.b("I",n.N.ImageTagCount);u.b("D",n.N.DescriptionTagCount);u.b("S",t);u.b("P",i.length);u.a("U",_mco.d.d(f.Url,100));u.b("B",n.N.ElapsedTimeToBlockListStepCompletion)}else if(n.e.Url&&i){u.b("S",t);u.b("P",i.length);u.a("U",_mco.d.d(n.e.Url,100))}}else{u.b("S",t);u.b("P",i.length)}u.b("M",r);u.toString().length<1;return u.toString()};_mco.d.x=function(n,t){if((n.N.DataProviderType&32)==32){var o=n.N.DescriptionTagCount>0?"Y":"N";t.a("DD",o);var l=n.N.ImageTagCount>0?"Y":"N";t.a("DT",o);var r=n.N.LinkPreview;t.b("LT",r.LinkType);t.a("FT",r.FileType);var f=r.SPCalls;if(!_j.h.a(f))for(var h=f.split("|"),e=h,c=e.length,u=0;u<c;++u){var s=e[u];var i=s.match(_mco.d.s);i&&i.length===4&&!t.d(i[1])&&t.a(i[1],i[2])}t.b("SPT",r.TotalSPCallTime)}};_mco.d.y=function(n,t){if((n.N.DataProviderType&128)==128){var u=n.N.DescriptionTagCount>0?"Y":"N";t.a("DD",u);var f=n.N.ImageTagCount>0?"Y":"N";t.a("DT",u);var i=n.N.LinkPreview;t.b("LT",i.LinkType);if(!_j.h.a(i.Title)){var r=i.Title.match(_mco.d.m);if(r&&r.length>1)t.a("FT",r[1]);else if(i.ViewTypePreferred){t.a("FT","folder");t.b("IC",i.TotalPhotos)}else t.a("FT","unknown")}}};_mco.d.r=function(n,t){var u="http://";var f="https://";var i=!1;if(n&&n.bH.Preview&&t!=="junkemail"&&!n.bH.IsDraft){var r=n.bH.Preview.toLowerCase();i=r.indexOf(u)>-1||r.indexOf(f)>-1}return i};_mco.d.t=function(n,t,i,r,u,f){var e=0;if(_mco.d.n()){i();return}n&&n.length>0&&Array.forEach(n,function(o){var l=o;if(!(e>=1)){e++;var s=_a.b.b(_a.a.f,"GetLinkPreview",!1,null);var a=!!f&&f.a().jo().Enabled;var h=null;var c=a?1:0;if(a){var y,v;h=(v=_mco.w.a(u,l,y={val:c}),c=y.val,v)}if(h){if(_j.h.a(h.ErrorInfo)){t(h);s.q(_mco.d.i);s.m=_mco.d.c(null,1,n,c)}else{c|=64;_j.e.b(_a.a.f,"Cached metadata contains error info: "+h.ErrorInfo);s.n="ErrorInfoStamped";s.p=h.ErrorInfo}_a.b.a(s)}else a&&_mco.w.c(u,l.Url)?_mco.d.z(u,n,l,t,i,r,s,c):_mco.d.h(n,l,t,i,r,s,c)}})};_mco.d.z=function(n,t,i,r,u,f,e,o){o|=16;e.q(_mco.d.j);var s=new _mco.w(n.bH.ItemId);s.c(function(s){o|=32;var c,l;var h=(l=_mco.w.a(n,i,c={val:o}),o=c.val,l);if(h){if(_j.h.a(h.ErrorInfo))r(h);else{o|=64;_j.e.b(_a.a.f,"Cached metadata contains error info: "+h.ErrorInfo);e.n="ErrorInfoStamped";e.p=h.ErrorInfo}e.m=_mco.d.c(null,1,t,o);_a.b.a(e)}else{_j.e.b(_a.a.f,"GetCachedLinkPreviewsAction didn't result in cached metadata, falling back to online GetLinkPreviewAction");_mco.d.h(t,i,r,u,f,e,o)}});s.b(function(n){_j.e.b(_a.a.f,"GetCachedLinkPreviewsAction failed, falling back to online GetLinkPreviewAction");_mco.d.h(t,i,r,u,f,e,o)});f.a(s)};_mco.d.h=function(n,t,i,r,u,f,e){f.q(_mco.d.k);t.Autoplay=!0;var o=new _mco.d(t);o.c(function(t){_mco.d.q(t,i,r,1,f,"GetLinkPreview",n,e)});o.b(function(t){_mco.d.l(t,1,f,"GetLinkPreview",n,e)});u.a(o)};_mco.d.o=function(n,t,i,r,u,f){_a.c.a(n,"previewAnchorClicked");_a.c.a(t,"item");_a.c.a(r,"inferenceTracker");var e=n.a.i();var o=_a.b.b(_a.a.f,"GetLinkPreviewClickEvent",!1,null);i(e.href)&&n.a.c();_mco.d.p(o,e.href,"G",f,_b.k.c(e.id));r.d(t,u)};_mco.d.a=function(n,t,i,r,u){_a.c.a(n,"videoPlayerAnchorClicked");_a.c.a(i,"showVideoCallback");var o=_a.b.b(_a.a.f,"GetLinkPreviewClickEvent",!1,null);n.a.c();var f=n.a.i();var e=f.href;i(e);_mco.d.p(o,e,"Y",0,_b.k.c(f.id));r&&r.d(t,u)};_mco.d.u=function(n,t,i,r){var e=20;var u=new _a.l;u.a("T",t);if(n.toLocaleLowerCase().startsWith("https://")||n.toLocaleLowerCase().startsWith("http://")){var f=n.indexOf("//")+2;e>n.length-f&&(e=n.length-f);n=n.substring(f,e)}u.b("ODT",i);u.a("LPT",r);u.a("U",n);return u.toString()};_mco.d.p=function(n,t,i,r,u){if(n){t?n.m=_mco.d.u(t,i,r,u):n.n=i==="Y"?"VideoUrl was null":"GenericUrl was null";_a.b.a(n)}};_mco.d.prototype={e:null,K:function(n){var t=new _g.iR(this.L);n.cc(this.e,t,this.I,this.H)},cU:function(n,t,i){try{if(!n){i(Error.create("GetLinkPreview result is null"));return}t()}catch(r){i(r)}}};_mco.bt=function(){};_mco.bu=function(){};_mco.bu.registerInterface("_mco.bu");_mco.T=function(){};_mco.T.b=function(n,t){n.a(Object,3,function(n){t(n.automaticHighlightsEnabled)},_mco.T.a)};_mco.T.a=function(){var n={};n.automaticHighlightsEnabled=!0;return n};_mco.U=function(){};_mco.U.b=function(n){return n.querySelector("div[id$='AddToCalendarButtonLink']")};_mco.U.a=function(n){return n.querySelector("div[id$='SharingAcceptButtonRow']")};_mco.bl=function(){};_mco.bl.a=function(n){for(var i=n.querySelectorAll("a[id^='OWAHT']"),t=0;i&&t<i.length;t++)i[t].className="hashtag ms-bgc-nlr ms-fcl-b ms-bgc-nta-h ms-fcl-black-h ms-bgc-tp-f"};_mco.i=function(){};_mco.i.a=function(n,t){var r;if(n&&n.b()>0){var i;if(t&&t.Mailbox)i=t.Mailbox;else{var u=_g.a.a().c();i=new _g.g;i.EmailAddress=u.bH.UserEmailAddress;i.Name=u.bH.UserDisplayName}var f=_mco.i.b(i);r=new Array(0);n.n(function(n){var t=n;t.CreatedBy=f;Array.add(r,t)})}else r=new Array(0);return r};_mco.i.b=function(n){var t;return t=new _dg.bX,t.PrimaryEmailAddress=n.EmailAddress,t.Name=n.Name,t.EmailAddress=n.EmailAddress,t.RoutingType=n.RoutingType,t.MailboxType=n.MailboxType,t.ItemId=n.ItemId,t.SipUri=n.SipUri,t.Submitted=n.Submitted,t.OriginalDisplayName=n.OriginalDisplayName,t.EmailAddressIndex=n.EmailAddressIndex,t.RelevanceScore=n.RelevanceScore,t};_mco.i.c=function(n,t){for(var u=n.querySelectorAll("a[id^='OWAAM']"),o=_g.a.a().c().bH.UserEmailAddress,e="mention mentionme ms-bgc-tl ms-fcl-td ms-bgc-tl-h ms-fcl-tb-h ms-bgc-tp-f ms-fcl-w-f",s="mention ms-bgc-nlr ms-fcl-b ms-bgc-nta-h ms-fcl-b-h ms-bgc-tp-f ms-fcl-w-f",f=[],r=0;u&&r<u.length;r++){var i=u[r];if(i.getAttribute("href").toString()==="mailto:"+o){i.className=e;f.push(i)}else i.className=s}t&&t(f)};_mco.u=function(){_mco.u.initializeBase(this,[["img","a","style"],!1])};_mco.u.a=function(n){_j.k.e(n,"ms-bg-color-neutralLighter");_j.k.d(n,"ms-bg-color-neutralLight")};_mco.u.c=function(n){_j.k.e(n,"ms-bg-color-neutralLight");_j.k.d(n,"ms-bg-color-neutralLighter")};_mco.u.b=function(n){return _j.k.p(n,"ms-bg-color-neutralLight")};_mco.u.prototype={b:function(){return"contextualExtensionHighlight ms-border-color-neutralTertiary ms-bg-color-neutralLighter"},i:function(n,t){_j.k.e(t,this.b())},e:function(n,t){n.id="KP"+t.i}};_mco.bm=function(){};_mco.bm.a=function(n,t,i){return new _mco.bc(n,i)};_mco.bc=function(n,t){this.e=Function.createDelegate(this,this.f);this.c=n;this.d=t;this.a=[];this.b={};_j.k.b(n,"copy",this.e,_mco.k.b)};_mco.bc.a=function(n,t){var r=new _j.q;var i=_mco.k.g(t);if(i&&!i.collapsed)try{i.commonAncestorContainer.tagName==="IMG"?r.c(i.commonAncestorContainer):i.commonAncestorContainer.childNodes.length>0&&_j.B.a(i.commonAncestorContainer.getElementsByTagName("img"),function(n,t){r.c(t)})}catch(u){}return r};_mco.bc.prototype={c:null,d:null,a:null,b:null,dispose:function(){_j.k.c(this.c,"copy",_mco.k.b);this.c=null;for(var n;this.a.length>0;){n=this.a.pop();n.a=null}this.a=null;this.b=null},f:function(n){for(var t,r,u,o=null,s=null,e=null,l=-1,c=_mco.bc.a(this.c,this.d),f=0;f<c.d.length;f++){t=c.d[f];r=t.src;if(_mco.k.e(r)&&!r.startsWith("data:")){_j.h.a(this.b[r])?this.b[r]=u=_mco.k.f(this.c,t):u=this.b[r];if(!_j.h.a(u)){t.src=u;if(t.attributes.hasOwnProperty("data-downloadImage")){o=t.attributes.getNamedItem("data-downloadImage").value;t.removeAttribute("data-downloadImage")}if(t.attributes.hasOwnProperty("data-thumbnailImage")){s=t.attributes.getNamedItem("data-thumbnailImage").value;t.removeAttribute("data-thumbnailImage")}if(t.attributes.hasOwnProperty("explicitLogon")){e=t.attributes.getNamedItem("explicitLogon").value;t.removeAttribute("explicitLogon")}var i;this.a.push((i=new _mco.bc.b,i.a=t,i.f=r,i.b=o,i.c=s,i.d=e,i.e=l,i));o=s=e=null;l=-1}}}if(this.a.length>0){var h=this;_j.m.a().a(_a.a.o,"LegacyRPCopyHandler_OnContentCopied",function(){while(h.a.length>0){var n=h.a.pop();n.g();n.a=null}},500)}}};_mco.bc.b=function(){this.e=-1};_mco.bc.b.prototype={a:null,f:null,e:0,b:null,c:null,d:null,dispose:function(){this.a=null},g:function(){_j.h.a(this.b)||this.a.setAttribute("data-downloadImage",this.b);_j.h.a(this.c)||this.a.setAttribute("data-thumbnailImage",this.c);_j.h.a(this.d)||this.a.setAttribute("explicitLogon",this.d);this.a.src=this.f}};_mco.k=function(){};_mco.k.e=function(n){return!_j.h.a(n)&&(!!_mco.k.a&&n.startsWith(_mco.k.a)||n.startsWith(_mco.k.c)||n==="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAEALAAAAAABAAEAAAIBTAA7")};_mco.k.f=function(n,t){var f=null;var u=n.ownerDocument.createElement("canvas");if(t){var e=t.getBoundingClientRect();var i=e.width;var r=e.height;if(i<=0||r<=0){i=t.naturalWidth;r=t.naturalHeight}if(i>0&&r>0){u.width=i;u.height=r;u.getContext("2d").drawImage(t,0,0,i,r);try{f=u.toDataURL()}catch(o){}}}return f};_mco.k.g=function(n){var t=_mco.k.d(n);var i=null;t&&t.rangeCount>0?i=t.getRangeAt(0):_j.e.a(_a.a.o,"[RPCopyHandlerUtil: TryGetSelectionRange] - no selection range");return i};_mco.k.d=function(n){var t;t=n?n.getSelection():document.selection?document.selection:window.getSelection();return t};_mco.S=function(n,t){this.b=n;this.a=t};_mco.S.prototype={b:null,a:null,dispose:function(){this.b=null;this.a=null},c:function(){return new _mco.S(this.b,this.a)}};_mco.bo=function(n,t,i){this.l=Function.createDelegate(this,this.w);this.j=Function.createDelegate(this,this.u);this.k=Function.createDelegate(this,this.v);this.h=Function.createDelegate(this,this.x);this.e=n;this.a=t;this.b=new _j.q;this.b.c(i);this.d=new _j.q;this.p()};_mco.bo.prototype={c:null,f:null,e:null,g:!1,a:null,d:null,b:null,r:function(n,t,i,r,u){if(this.c){var s=this.c.cv[0];s.i(2);s.j(!0);s.i(1)}else{var h=this.a;var e=document.createElement("span");h.parentNode.insertBefore(e,this.a);e.innerHTML="&#x200b;";var o=new _j.c(e);var f=new _b.E(n,t,i,r);f.bv=!0;var c=new _mco.br;f.f(c);f.bj(new _mco.P(u));f.e("HighlightPopupView");f.i(2);f.c(e);f.t=1;f.s=3;f.apcl("IsShown",this.h);o.kG(f);o.bm();this.c=o;f.j(!0)}},q:function(){if(this.c){var n=this.c.cv[0];n.i(2);this.c.cv[0].j(!1);n.i(1);return!0}return!1},i:function(){if(this.c){this.c.cv[0].j(!1);this.c.cv[0].rpcl("IsShown",this.h);this.c.bx();this.d.c(this.c);this.c=null}},dispose:function(){this.g=!0;this.o();this.a=null;for(var n=0;n<this.b.d.length;n++){this.b.d[n].dispose();this.b.o(n,null)}this.b=null;var i;_a.h.a(i={val:this.c}),this.c=i.val;for(var t=0;t<this.d.d.length;t++)this.d.d[t].dispose();this.d.f();this.d=null;this.e=null;this.f=null},m:function(n){for(var i=n.b,t=0;t<i.d.length;t++)this.t(i.d[t])||this.b.c(i.d[t].c());n.dispose()},z:function(n){for(var t=0;t<this.b.d.length;t++)this.b.d[t].b.d(n)},s:function(n){for(var r=this.n(),u=n.n(),t=0;t<r.length;t++)for(var i=0;i<u.length;i++)if(r[t]===u[i])return r[t];return null},y:function(){this.a.className="";this.a.style.cursor="";this.a.id="";this.o()},n:function(){for(var t=new Array(0),n=0;n<this.b.d.length;n++)this.b.d[n].b.c().length>0&&Array.addRange(t,this.b.d[n].b.c());return t},t:function(n){for(var i=!1,r=n.b.b(),t=0;t<this.b.d.length;t++)if(this.b.d[t].b.b()===r&&this.b.d[t].a.a()===n.a.a()){i=!0;break}return i},p:function(){_j.k.b(this.a,"mouseenter",this.k);_j.k.b(this.a,"click",this.j);_j.k.b(this.a,"mouseleave",this.l)},u:function(n){for(var e=!1,u=0;u<this.b.d.length;u++){var t=this.b.d[u];if(t.a&&t.a&&t.a.e()){t.a.c(t.b,n);e=!0;break}}if(!e){for(var o=new _j.q,r=0;r<this.b.d.length;r++){var i=this.b.d[r];if(i.a){var f=i.a.i(i.b,n);f&&o.c(f)}}this.f&&this.f(this,o)}},w:function(n){_j.k.e(n.b(),"ms-bg-color-neutralLight");_j.k.d(n.b(),"ms-bg-color-neutralLighter")},v:function(n){_j.k.e(n.b(),"ms-bg-color-neutralLighter");_j.k.d(n.b(),"ms-bg-color-neutralLight")},o:function(){if(this.a){_j.k.c(this.a,"mouseenter");_j.k.c(this.a,"mouseleave");_j.k.c(this.a,"click")}},x:function(n,t){if(!n.k()){if(!this.b)return;for(var i=0;i<this.b.d.length;i++)this.b.d[i].a.j()}}};_mco.l=function(n,t){this.q=Function.createDelegate(this,this.A);this.r=Function.createDelegate(this,this.i);this.g=0;this.h=0;this.f=n;this.k=!1;this.a=[];this.p=t;for(var i=0;i<this.f.length;i++)this.f[i]=this.f[i].toUpperCase()};_mco.l.prototype={n:null,f:null,l:null,m:!1,p:!1,g:0,h:0,k:!1,o:0,a:null,w:function(n){this.c(n.d(),n.h(),n.b(),n,n.f())},c:function(n,t,i,r,u){var f=[];this.n=i;this.g=0;this.h=0;this.k=!1;t||(t=new Array(0));this.o=t.length;this.l=_a.d.a();for(var h=this.y(n,t,u),s,o,c=(o=this.s(n,h,s={val:f},r),f=s.val,o),e=0;e<f.length;e++){this.h++;_j.B.a(n.querySelectorAll("."+f[e]),this.r)}return c},dispose:function(){this.l=null;this.n=null;this.a=null;this.m=!0},s:function(n,t,i,r){if(_a.d.a().e(this.l)>=100){t[0]&&!t[0].e&&Array.add(i.val,t[0].h);return!1}if(this.m)return!1;for(var f=n.childNodes[0],e=0,s=0,l=0,c=0,u=t[0];f;){s=f.nodeType!==8?f.textContent.length:0;for(var o=[];u&&u.e>=e&&u.e<=e+s;)if(u.f<=e+s){u.e=u.e-e;u.f=u.f-e;u.k=c;Array.add(o,u);u=t[++l];c=0}else{var a=new _mco.W(u.e-e,s,u.g,u.h,u.i,0);Array.add(o,a);c+=e+s-u.e;u.e=e+s;break}if(o.length){if(Array.indexOf(this.f,f.nodeName.toUpperCase())!==-1)for(var h=0;h<o.length;h++)Array.add(i.val,o[h].h);f.nodeType===3?this.p?this.v(f,o,r):this.u(f,o):this.s(f,o,i,r)}e+=s;f=f.nextSibling}return!0},u:function(n,t){for(var u=0,f=0;f<t.length;f++){var i=t[f];var s=n.textContent.substring(0,i.e-u);var e=n.textContent.substring(i.e-u,i.f-u);var h=n.textContent.substring(i.f-u,n.textContent.length);if(!e.trim().length)return;if(!this.x(n,this.b())){n.parentNode.insertBefore(document.createTextNode(s),n);var r=document.createElement("span");r.tabIndex=0;r.setAttribute("role","button");r.className=String.format("{0} {1}",this.b(),i.h);r.innerText=e;var o=n.parentNode.insertBefore(r,n);n.textContent=h;this.e(o,t[f]);Array.add(this.a,o)}u+=s.length+e.length}},v:function(n,t,i){for(var u=0,l=[],e=0;e<t.length;e++){var r=t[e];var h=n.textContent.substring(0,r.e-u);var o=n.textContent.substring(r.e-u,r.f-u);var c=n.textContent.substring(r.f-u,n.textContent.length);if(!o.trim().length)break;n.parentNode.insertBefore(document.createTextNode(h),n);var f=document.createElement("span");f.tabIndex=0;f.setAttribute("role","button");f.className=String.format("{0} {1}",this.b(),r.h);f.innerText=o;var s=n.parentNode.insertBefore(f,n);n.textContent=c;this.e(s,t[e]);Array.add(this.a,new _mco.bo(i.b(),s,new _mco.S(r,i)));u+=h.length+o.length}},i:function(n,t){var i=t;if(i.previousSibling&&i.previousSibling.nodeType===3&&i.nextSibling&&i.nextSibling.nodeType===3){i.previousSibling.textContent+=i.textContent;i.previousSibling.textContent+=i.nextSibling.textContent;i.parentNode.removeChild(i.nextSibling);i.parentNode.removeChild(i)}else if(i.previousSibling&&i.previousSibling.nodeType===3){i.previousSibling.textContent+=i.textContent;i.parentNode.removeChild(i)}else if(i.nextSibling&&i.nextSibling.nodeType===3){i.nextSibling.textContent+=i.textContent;i.parentNode.removeChild(i)}else{i.parentNode.insertBefore(document.createTextNode(i.textContent),i);i.parentNode.removeChild(i)}},y:function(n,t,i){var e=[];var u=null;if(this.m)return e;for(var h=n.textContent,f,r=0;t&&r<t.length;r++)if(!_j.h.a(t[r])){f=this.t(t[r],i);u=f.exec(h);if(u){var o;var s;do{s=u[0].length;o=f.lastIndex;Array.add(e,new _mco.W(o-s,o,[t[r]],null,r,0));u=f.exec(h)}while(u)}else{this.g++;continue}}this.z(e);return e},t:function(n,t){n=n.replace(_mco.l.a,_mco.l.b);n=n.replace(_mco.l.c,_mco.l.d);t&&(n=String.format(_mco.l.e,n));return new RegExp(n,"g")},z:function(n){n.sort(this.q);for(var t=n.length;t--;)if(n[t-1]&&n[t-1].f>n[t].e){n[t-1].f<n[t].f&&(n[t-1].f=n[t].f);for(var i=0;i<n[t].g.length;i++)n[t-1].m(n[t].g[i]);n[t-1].l();n.splice(t,1)}},A:function(n,t){var r=n;var i=t;if(r.e<i.e)return-1;else if(r.e>i.e)return 1;if(r.f<i.f)return-1;else if(r.f>i.f)return 1;return 0},x:function(n,t){for(var r=t.split(" "),u=n.parentNode.className,i=0;i<r.length;i++)if(u.indexOf(r[i])<0)return!1;return!0}};_mco.bp=function(n){_mco.bp.initializeBase(this,[["img","a","style"],!0])};_mco.bp.prototype={b:function(){return"ms-border-color-neutralTertiary ms-bg-color-neutralLighter"},e:function(n,t){n.id="TextHighlighterForHighlightPopupV2"+t.i;n.style.cursor="pointer"}};_mco.q=function(n,t,i,r,u){this.l=Function.createDelegate(this,this.w);this.j=n;this.i=r;this.g=t;this.h=u;this.e=[];this.f=[]};_mco.q.a=function(n){for(var i=[],t=0;t<n.length;t++)n[t]&&!n[t].g&&Array.add(i,n[t]);return i};_mco.q.c=function(n,t){for(var u=[],r=0;r<n.length;r++)u.push(n[r]);for(var i=0;i<t.length;i++)u.push(t[i]);return u};_mco.q.b=function(n,t){var i=[];Array.addRange(i,n);Array.addRange(i,t);return i};_mco.q.prototype={e:null,f:null,h:null,j:null,i:null,g:null,dispose:function(){this.h=null;this.g=null;this.j=null;this.i=null;var t;this.n(t={val:this.e}),this.e=t.val;var n;this.n(n={val:this.f}),this.f=n.val},a:function(n){return this.u(n)},b:function(n){for(var t=null,r=0;r<this.e.length;r++){t=this.e[r];t.e===n&&t.dispose()}for(var i=0;i<this.f.length;i++){t=this.f[i];t.e===n&&t.dispose()}this.e=_mco.q.a(this.e);this.f=_mco.q.a(this.f)},c:function(n){for(var i,t=0;t<this.e.length;t++){i=this.e[t];if(i.a.innerText===n)return i.q()}return!1},d:function(n){for(var t,i=0;i<this.e.length;i++){t=this.e[i];if(t.a.innerText===n){t.i();t.y();Array.add(this.f,t);Array.remove(this.e,t);return!0}}return!1},w:function(n,t){n.r(this.h,this.g,this.j,this.i,t)},u:function(n){var t=new _mco.bp(n.g());t.w(n);t.a.length>0&&this.o(t.a);return t.a.length},o:function(n){if(this.e.length){this.y(n);n=_mco.q.a(n);this.e=_mco.q.a(this.e);var i=_mco.q.c(this.e,n);var t=_mco.q.b(this.e,n);this.t(i,t);Array.clear(this.e);this.e=t;this.m()}else{Array.addRange(this.e,n);this.m()}},t:function(n,t){for(var r,i;n.length>0;){r=n.pop();if(r.g)continue;else{i=this.s(r,t);i&&n.push(i)}}},y:function(n){for(var i,r,u=0;u<this.e.length;u++){i=this.e[u];for(var t=0;t<n.length;t++)if(n[t]){r=n[t];if(r.a.parentNode===i.a&&this.k(r.a)&&this.k(i.a)){i.i();this.x(r,i);n[t]=null}}}},x:function(n,t){var i=n.a;var u=i.innerText;var r=document.createTextNode(i.innerText);i.parentNode.replaceChild(r,i);t.m(n);t.z(u)},r:function(n,t){t.i();var o=n.a;var i=t.a;var f=this.p(o,i);var u=this.q(i);var r="";f&&(r+=f.wholeText);r+=i.innerText;var e=document.createTextNode(r);n.a.appendChild(e);i.parentNode.removeChild(i);u&&_j.k.s(u,n.a);n.m(t)},q:function(n){return n.nextSibling!==n.nextElementSibling&&n.nextSibling.nodeType===3&&n.nextSibling.textContent.trim()===""&&n.nextSibling.wholeText.length>0?n.nextSibling:null},p:function(n,t){return n.nextSibling!==n.nextElementSibling&&t.previousSibling!==t.previousElementSibling&&n.nextSibling.nodeType===3&&n.nextSibling.textContent.trim()===""&&n.nextSibling.wholeText.length>0?n.nextSibling:null},s:function(n,t){for(var i,r=0;r<t.length;r++){i=t[r];if(i===n)continue;else if(this.v(n,i)){this.r(n,i);Array.remove(t,i);return n}}return null},v:function(n,t){var i=n.s(t);return!!i&&n.a.innerText!==i&&t.a.innerText!==i&&n.a.nextElementSibling===t.a&&this.k(n.a)&&this.k(t.a)},k:function(n){return n.id.indexOf("TextHighlighterForHighlightPopupV2")>=0},m:function(){for(var t,n=0;n<this.e.length;n++){t=this.e[n];t.f=this.l}},n:function(n){for(var i,t=0;t<n.val.length;t++){i=n.val[t];i.dispose()}Array.clear(n.val);n.val=null}};_mco.K=function(n){this.e=Function.createDelegate(this,this.i);this.f=Function.createDelegate(this,this.j);this.d=Function.createDelegate(this,this.h);this.a=n;if(this.a.b)var t=this.g();else this.a.apcl("IsMailModule",this.d)};_mco.K.prototype={a:null,c:null,b:0,h:function(n,t){if(this.a.b){var i=this.g();this.a.rpcl("IsMailModule",this.d)}},g:function(){if(this.c)return!0;for(var i=_h.h.a().a(_g.b.a.nameToId("inbox")),t=0;t<i.length;t++){var n=i[t];if(_h.I.isInstanceOfType(n)&&n.B()!==1){this.c=n;break}}if(this.c){document.addEventListener("visibilitychange",this.f,!1);return!0}return!1},j:function(n){if(document.visibilityState==="hidden"){this.b=0;this.c.A(this.e)}else{this.c.t(this.e);this.b=0;this.a.d()}return!0},i:function(n,t){this.b++;this.k()},k:function(){if(this.a.b&&this.b>0){this.b>99&&this.a.e(_j.h.c("{0}+",99));this.a.e(this.b.toString())}}};_mco.A=function(n,t,i,r,u,f,e){this.l=n;this.i=_mco.bl.a;this.k=_mco.i.c;this.h=t;this.j=i;this.o=r;this.n=u;this.q=f;this.f={};this.r=e};_mco.A.b=function(n){_mco.A.a(n,!0);for(var i=n.querySelectorAll("div,span,font,p"),t=0;t<i.length;t++)_mco.A.a(i[t],!1)};_mco.A.a=function(n,t){var i=null;t?i=_j.k.i(n,"font-family"):n.nodeType===1&&n.style["font-family"]&&(i=n.style["font-family"]);if(i&&i.indexOf("EmojiFont")===-1){var r=String.format("{0},{1},'{2}'",i,"serif","EmojiFont");_j.k.a(n,"font-family",r)}};_mco.A.prototype={l:null,f:null,n:null,q:null,m:null,g:null,e:null,k:null,r:null,i:null,h:null,j:null,o:null,p:!1,dispose:function(){this.h=null;this.i=null;this.j=null;this.k=null;this.n=null;this.f=null;if(this.e){for(var n=0;n<this.e.d.length;n++)this.e.d[n]&&this.e.d[n].dispose();this.e.f();this.e=null}var t;_a.h.a(t={val:this.g}),this.g=t.val},c:function(n,t,i,r){var e=n.getAttribute("id")||"";_j.h.a(e)&&_j.e.c(_a.a.a,"MessageHTMLLabel must contain an id attribute to use the ContentHandler");var f=!!this.f&&!(e in this.f)||!!this.n&&this.n();if(f){this.j&&t.a()==="Mouse"&&(this.m=this.j(n));_mco.A.b(n);if(this.l){this.i&&this.l.a().K().Enabled&&this.i(n);this.k&&this.l.a().u().Enabled&&this.k(n,this.r);this.o&&this.o(n)}}(f||!this.p)&&this.h&&this.s(n,t,!0,i,r);f&&this.f&&(this.f[e]=n);if(this.e)for(var u=0;u<this.e.d.length;u++){var o=this.e.d[u];o&&o.a(n)}!this.g&&this.m&&this.m.d.length>0&&(this.g=_mco.bm.a(n,this.m,this.q))},d:function(n,t,i,r){this.h&&this.s(n,t,!1,i,r);var u;_a.h.a(u={val:this.g}),this.g=u.val},a:function(n,t){if(this.e&&!this.e.g(n)&&this.f){this.e.c(n);for(var f=this.t(t),u=f,e=u.length,i=0;i<e;++i){var r=u[i];r in this.f&&n.a(this.f[r])}}},b:function(n){this.f&&n in this.f&&delete this.f[n]},s:function(n,t,i,r,u){var f=[];var e=this;_j.B.a(n.querySelectorAll("A"),function(n,t){var e=t;try{var s=e.protocol;Array.add(f,e)}catch(o){}r&&u(e,t,i)});this.h(f,n,t,i);this.p=i},t:function(n){var t=new Array(0);if((n&1)==1){t.push("Item.MessageNormalizedBody");t.push("Item.MessageUniqueBody")}(n&2)==2&&t.push("Item.MessageQuotedBody");(n&4)==4&&t.push("Conversation.FossilizedTextBody");return t}};_mco.n=function(){};_mco.n.b=function(){return _fm.b.a(_fm.a.ff,_fm.WebfontSizes.a.c)};_mco.n.a=function(){return _fm.b.a(_fm.a.ed,_fm.WebfontSizes.a.c)};_mco.n.e=function(){return _fm.b.a(_fm.a.G,_fm.WebfontSizes.a.b,"ms-fcl-ts-b")};_mco.n.c=function(){return _fm.b.a(_fm.a.Trash,_fm.WebfontSizes.a.b,"ms-fcl-ts-b")};_mco.n.d=function(){return _fm.b.a(_fm.a.g,_fm.WebfontSizes.a.b,"ms-fcl-ts-b")};_mco.O=function(n,t,i){this.c=Function.createDelegate(this,this.e);this.d=Function.createDelegate(this,this.f);this.b=n;this.a=i;t.a(_a.a.T,"FP",this.d,3e5)};_mco.O.prototype={b:null,a:!1,f:function(){this.b.a("https://r4.res.office365.com/footprint/v2.7/scripts/fp.js",this.c)},e:function(){try{var t=this.a?"OWA":"OWAE";var n=_g.a.a().c().bH.ExternalDirectoryTenantGuid;eval(String.format('Footprint.start("{0}", [], 1000, "[{{\\"TenantId\\":\\"{1}\\"}}]")',t,n))}catch(i){_j.e.c(_a.a.T,'Failed to run Footprint.start("OWA", 1000): '+i.stack)}}};_mco.L=function(n,t){this.w=Function.createDelegate(this,this.G);this.u=Function.createDelegate(this,this.E);this.v=Function.createDelegate(this,this.F);this.y=Function.createDelegate(this,this.I);this.x=Function.createDelegate(this,this.H);this.r=Function.createDelegate(this,this.B);this.p=Function.createDelegate(this,this.z);this.q=Function.createDelegate(this,this.A);this.t=Function.createDelegate(this,this.D);this.s=Function.createDelegate(this,this.C);this.o=_a.C.a();this.a="?guid="+this.o+"&PartID=ExoProd";this.h="https://1.perf.msedge.net/cold.gif"+this.a;this.i="https://4.perf.msedge.net/cold.gif"+this.a;this.m="https://1.perf.msedge.net/hot.gif"+this.a;this.n="https://4.perf.msedge.net/hot.gif"+this.a;this.f="https://outlook.office365.com/owa/auth/current/themes/resources/lgnexlogo.gif"+this.a;this.e="https://outlook.live.com/owa/auth/current/themes/resources/lgnexlogo.gif"+this.a;this.g="https://edge.outlook.office365.com/owa/auth/current/themes/resources/lgnexlogo.gif"+this.a;this.k="https://outlook.office365.com/owa/auth/current/themes/resources/lgnbotm.gif"+this.a;this.j="https://outlook.live.com/owa/auth/current/themes/resources/lgnbotm.gif"+this.a;this.l="https://edge.outlook.office365.com/owa/auth/current/themes/resources/lgnbotm.gif"+this.a;this.c={};var f=new Image;f.onload=this.s;f.src=this.h;var e=new Image;e.onload=this.t;e.src=this.i;var u=new Image;u.onload=this.q;u.src=this.f;var i=new Image;i.onload=this.p;i.src=this.e;var r=new Image;r.onload=this.r;r.src=this.g};_mco.L.prototype={o:null,a:null,h:null,i:null,m:null,n:null,f:null,e:null,g:null,k:null,j:null,l:null,c:null,C:function(){var n=new Image;n.onload=this.x;n.src=this.m;this.b(this.h,"t-a-cold")},D:function(){var n=new Image;n.onload=this.y;n.src=this.n;this.b(this.i,"t-b-cold")},H:function(){this.b(this.m,"t-a-hot");this.d()},I:function(){this.b(this.n,"t-b-hot");this.d()},A:function(){var n=new Image;n.onload=this.v;n.src=this.k;this.b(this.f,"t-cafe-cold")},z:function(){var n=new Image;n.onload=this.u;n.src=this.j;this.b(this.e,"t-live-cold")},B:function(){var n=new Image;n.onload=this.w;n.src=this.l;this.b(this.g,"t-edgecafe-cold")},F:function(){this.b(this.k,"t-cafe-hot");this.d()},E:function(){this.b(this.j,"t-live-hot");this.d()},G:function(){this.b(this.l,"t-edgecafe-hot");this.d()},b:function(n,t){if(_a.X.e()){var i=_a.X.j(n);this.c[t]=i?Math.floor(i.responseEnd-i.startTime).toString():""}},d:function(){Object.keys(this.c).length===10&&this.J()},J:function(){var n="{";n=n+String.format('"Guid":"{0}"',this.o);n=n+String.format(',"PartID":"ExoProd"');var u=this.c;for(var i in u){var r={key:i,value:u[i]};n=n+String.format(',"{0}":"{1}"',r.key,r.value)}n+="}";var f=encodeURIComponent(n);var t=new Sys.Net.WebRequest;t.set_url("https://1.perf.msedge.net/exoprodci?p="+f);t.set_httpVerb("Get");t.invoke()}};_mco.bk=function(){};_mco.bk.a=function(n,t){var e=new Array(0);var o=JsonParser.deserialize(n);if(o&&o.length>0)for(var s=o,h=s.length,i=0;i<h;++i){var c=s[i];var r=c.entities;if(r)for(var u=0;u<r.length;u++){var f=r[u];f&&f["@type"]===t&&Array.add(e,f)}}return e.length>0?e:null};_mco.W=function(n,t,i,r,u,f){this.e=n;this.f=t;this.g=i;this.j=new Array(0);this.h=r;this.i=u;this.k=f;_j.h.a(r)&&this.l()};_mco.W.prototype={e:0,f:0,g:null,j:null,h:null,c:function(){return this.g},a:function(){var n=new Array(0);Array.addRange(n,this.g);Array.addRange(n,this.j);return n},b:function(){return this.h},i:0,k:0,m:function(n){Array.contains(this.g,n)||Array.add(this.g,n)},d:function(n){if(Array.contains(this.g,n)){Array.remove(this.g,n);Array.add(this.j,n)}},l:function(){this.h=String.format("ident_{0}_{1}",this.e,this.f)},dispose:function(){this.g=null;this.j=null}};_mco.X=function(){};_mco.X.a=function(n,t){if(n&&n.e()){var u=n.e().x.length;if(u>0){var f=_a.b.b(_a.a.cx,"InfoBarCount",!1,null);f.q(new _a.y(t));var o=n.e();var i=new _a.l;i.b("T",u);var r="";var e=0;o.o(function(n){var t=n;r+=t.d.toString();e!==u-1&&(r+=",");e++});i.a("IDs",r);f.m=i.toString();_a.b.a(f)}}};function MailCommonComponent(){}MailCommonComponent.$$cctor=function(){_a.t.a().a(MailCommonComponent)};MailCommonComponent.prototype={b:function(n,t,i){var e=this;n.b(_mco.L,function(){return i.e().a().kf().Enabled&&i.f()?new _mco.L(n.a(_a.z),n.a(_a.e)):null}).a();var o=this;n.b(_mco.O,function(){return i.e().a().jN().Enabled&&i.f()?new _mco.O(n.a(_j.bb),n.a(_j.v),i.c()):null}).a();var f=this;n.b(_mco.K,function(){return i.e().a().ls().Enabled?new _mco.K(n.a(_t.d)):null}).a();var r=this;n.b(_mco.B,function(){return new _mco.B(n.a(IBposUrlProvider),i.e())}).a();var u=this;n.b(_b.br,function(){return new _mco.q(n.a(_j.j),n.a(_b.a),n.a(_y.a),n.a(_ff.b),n.a(_b.f))}).a()},a:function(){return[new _j.y(_mco.L,2,1),new _j.y(_mco.K,2,1),new _j.y(_mco.O,4,1)]}};_mco.j=function(){};_mco.j.g=function(n,t){return n.bH.ParentInternetMessageId!==t.bH.InternetMessageId};_mco.j.e=function(n,t){if(n.E()&&n.E().b()>0)return!1;var r=_mco.j.b(n);var i=_mco.j.b(t);i.c(t.bH.Sender.Mailbox);return _mco.j.c(r,i)};_mco.j.d=function(n,t){if(n.c()&&n.c().b()>0)return!1;var i=new _a.j;i.g(n.g().f());i.g(n.j().f());var r=_mco.j.b(t);r.c(t.bH.Sender.Mailbox);return _mco.j.c(i,r)};_mco.j.c=function(n,t){for(var r=n.b(),i=0;i<r;i++)if(t.D(n.a(i),_mco.j.f)<0)return!1;return!0};_mco.j.a=function(n,t,i){var r=new _a.l;r.c("Succ",n);r.c("Re",i);r.a("Fail",t);_a.b.c(_a.a.o,"RPDraftRehydration",r.toString(),0)};_mco.j.f=function(n,t){var r=n;var i=t;return!!r&&!!i&&!_j.h.a(r.EmailAddress)&&!_j.h.a(i.EmailAddress)&&r.EmailAddress.toLowerCase()===i.EmailAddress.toLowerCase()};_mco.j.b=function(n){var t=new _a.j;t.g(n.q()?n.q().e():new Array(0));t.g(n.A()?n.A().e():new Array(0));return t};_mco.bd=function(n,t){this.h=n;this.i=t};_mco.bd.prototype={h:null,i:null,a:function(){return!!this.h&&this.h.f()&&this.h.c.b},c:function(n){this.h&&(this.h.w=n)},g:function(n){this.i&&!this.i.b()&&this.h&&(this.h.s=n)},d:function(n){this.i?this.i.b()?this.i.i(n,!0,!1):this.h.c.a():this.h.C(n,!0)},b:function(n,t){this.i?this.m(n,t):this.h?this.l(n,t):_j.e.c(_a.a.C,"Unable to reply with quote")},e:function(n,t){if(this.i)if(this.i.b()){_j.e.a(_a.a.C,"[ReplyWithContentHandler_ReplyWithAttachment] Compose form already created.");n?this.i.l():this.i.h(t)}else{this.h.c.a();_j.e.a(_a.a.C,"[ReplyWithContentHandler_ReplyWithAttachment] ReplyAllCommand executed. Uploading attachment via QueueIdleTask.");var i=this;_j.m.a().d(_a.a.o,"ReplyWithAttachment",function(){_j.e.a(_a.a.C,"[ReplyWithContentHandler_ReplyWithAttachment] QueueIdleTask delegate executing.");n?i.i.l():i.i.h(t)})}else if(this.h){_j.e.a(_a.a.U,"[ReplyWithContentHandler_ReplyWithAttachment] Creating ReplyAll Compose form via MailResponseCommandViewModel.");n?this.h.bo():this.h.bl(t)}else _j.e.c(_a.a.C,"[ReplyWithContentHandler_ReplyWithAttachment] Unable to reply with attachment.")},f:function(){this.e(!0,null)},dispose:function(){this.h=null;this.i=null},l:function(n,t){var i=this.k(n,t);this.h.C(i,!0)},m:function(n,t){if(this.i.b())this.j(n,t,!0);else{this.h.c.a();var i=this;_j.m.a().d(_a.a.o,"ReplyInReadingPaneViewModel",function(){i.j(n,t,!1)})}},j:function(n,t,i){var r=this.k(n,t);this.i.i(r,!0,i)},k:function(n,t){var r=document.createElement("span");var f=document.createElement("br");var e=document.createElement("br");var i=document.createElement("div");i.className="__TEE_Quote__";i.innerText=n;i.style.borderLeft="3px solid";i.style.borderColor="#C8C8C8";i.style.paddingLeft="10px";i.style.color="#666666";i.style.fontSize="17px";r.appendChild(f);r.appendChild(i);if(!_j.h.a(t)){var u=document.createElement("p");u.innerText=t;r.appendChild(u)}r.appendChild(e);return r.innerHTML}};_mco.be=function(n,t,i,r,u,f){this.k=Function.createDelegate(this,this.r);this.l=Function.createDelegate(this,this.s);this.j=Function.createDelegate(this,this.q);this.f=Function.createDelegate(this,this.m);this.n=t;this.g=i;this.c=t.length;this.h=n;this.i=r;this.d=u;this.e=f};_mco.be.prototype={h:null,i:null,d:null,e:null,n:null,g:null,a:0,c:0,m:function(){if(this.i()){while(this.h()>0&&this.a<this.c){this.n[this.a]();++this.a}while(this.h()<=0&&this.a>0){--this.a;this.g[this.a]()}}},b:function(){if(this.i()){for(var n=0;n<this.c;++n)this.g[n]();this.a=0;this.m()}},o:function(){if(_y.c.a.b())if(this.e){var t=_j.x.b(this.e);var n=this;t.b("resize",function(t){n.m()})}else{_y.c.a.n(this.f);this.d.b(_a.dA,this.j);this.d.b(_a.cI,this.l);_g.a.a().b().o(this.k)}else _y.c.a.n(this.f)},p:function(){if(_y.c.a.b())if(this.e){var n=_j.x.b(this.e);n.c("resize",null)}else{_y.c.a.p(this.f);this.d.c(_a.dA,this.j);this.d.c(_a.cI,this.l);_g.a.a().b().v(this.k)}else _y.c.a.p(this.f)},q:function(n){this.b()},s:function(n){this.b()},r:function(n,t){this.b()}};_mco.be.b=function(){};_mco.be.a=function(n){this.a=n};_mco.be.a.prototype={a:null};_mco.B=function(n,t){this.c=n;this.f=!!t&&t.a().hl().Enabled};_mco.B.prototype={c:null,f:!1,b:null,a:function(n){if(!n)return!1;this.b||(this.b=this.i());for(var t=0;t<this.b.d.length;t++)if(n.startsWith(this.b.d[t]))return n.length>this.b.d[t].length+1;return!1},i:function(){var t=new _j.q;if(!this.c)return t;var r=this.c.b();if(r)for(var i=0;i<r.length;i++){var n=r[i];if(n&&!_j.h.a(n.bH.Url)&&(n.bH.Id&&n.bH.Id.toLowerCase()==="shellsites"||n.bH.Id.toLowerCase()==="shelldocuments")){var u=new _a.P(n.bH.Url);t.c(u.b+"://"+u.a)}}if(this.f){t.c("https://microsoft.sharepoint.com");t.c("https://microsoft-my.sharepoint.com")}return t},d:function(n){return!_j.h.d(n)&&(n.indexOf("docs.google.com/presentation/d/")>0||n.indexOf("docs.google.com/spreadsheets/d/")>0||n.indexOf("docs.google.com/document/d/")>0)},e:function(n){return!_j.h.d(n)&&n.indexOf("drive.google.com")>0},g:function(n){return!_j.h.d(n)&&(n.indexOf("onedrive.live.com")>0||n.indexOf("1drv.ms")>0)},k:function(n){return!_j.h.d(n)&&(n.toLowerCase().indexOf("?nav=")>0||n.toLowerCase().indexOf("&nav=")>0)},h:function(n){return!_j.h.d(n)&&(n.toLowerCase().indexOf("?at=")>0||n.toLowerCase().indexOf("&at=")>0)},j:function(n){if(!n)return!1;var t=null;try{t=new _a.P(n)}catch(r){return!1}if(!t.a)return!1;var i=t.a.toLowerCase();return i.endsWith(".sharepoint.com")||i.endsWith(".sharepoint.de")}};_mco.bn=function(n,t,i){this.d=n;this.e=t;this.f=i};_mco.bn.prototype={d:null,a:function(){return this.d},e:null,b:function(){return this.e},f:null,c:function(){return this.f}};_mco.f=function(){};_mco.f.a=function(n,t){var i=Math.pow(2,32);if(n>i||t>i){var u=n%i;var r=t%i;n-=u;t-=r;var s=u&r;var h=n/i;var o=t/i;var f=h&o;return f*i+s}else return n&t};_mco.e=function(){};_mco.e.n=function(n,t){_mco.e.h(n,t);_mco.e.a(_mco.e.j,n.a().lH(),n.a().lG());_mco.e.a(_mco.e.l,n.a().gF(),n.a().lJ())};_mco.e.m=function(n,t){_mco.e.h(n,t);_mco.e.a(_mco.e.i,n.a().du(),n.a().lI())};_mco.e.h=function(n,t){(t.cl()&2)==2&&_mco.e.a(_mco.e.d,n.a().dt(),n.a().lE());(t.cl()&32)==32&&_mco.e.a(_mco.e.e,n.a().ds(),n.a().lB());(t.cl()&64)==64&&_mco.e.a(_mco.e.g,n.a().ca(),n.a().lF());_mco.e.a(_mco.e.k,n.a().lD(),n.a().lC())};_mco.e.a=function(n,t,i){var r=new _a.l;r.a(_mco.e.f,n);if(t.Enabled){r.a(_mco.e.c,"T");_a.b.c(_a.a.V,_mco.e.b,r.toString(),0)}else if(i.Enabled){r.a(_mco.e.c,"C");_a.b.c(_a.a.V,_mco.e.b,r.toString(),0)}};_mco.D=function(n,t){this.b=n;this.a=t};_mco.D.prototype={b:null,a:null};_mco.p=function(n){this.a=n};_mco.p.prototype={a:null};_mco.M=function(n){this.n=Function.createDelegate(this,this.s);this.o=Function.createDelegate(this,this.t);_mco.M.initializeBase(this,[n]);this.y("HighlightPopupTabView")};_mco.M.prototype={k:null,g:null,b:null,f:null,e:null,d:null,i:!1,j:!1,a:!1,c:!1,h:!1,x:function(n){if(this.e!==n){this.e=n;this.by("ShowSentenceLevelHighlightControlsCommand")}return n},w:function(n){if(this.d!==n){this.d=n;this.by("ShowConceptControlsCommand")}return n},r:function(n){if(this.a!==n){this.a=n;this.by("HideTabButtons")}return n},m:function(n){if(this.j!==n){this.j=n;this.by("HideSentenceLevelHighlightControls")}return n},l:function(n){if(this.i!==n){this.i=n;this.by("HideConceptControls")}return n},q:function(n){if(this.h!==n){this.h=n;this.by("HasConcepts")}return n},I:function(){return _a.a.C},H:function(){_j.c.prototype.H.call(this);this.B&&this.p()},Y:function(){_j.i.prototype.Y.call(this);this.V()&&this.B&&this.p()},bz:function(){_j.c.prototype.bz.call(this);var t;_a.h.a(t={val:this.e}),this.e=t.val;var n;_a.h.a(n={val:this.d}),this.d=n.val;this.b=null;this.f=null;this.k=null;this.g=null},p:function(){this.x(new _j.g(this.o,this.I(),!0));this.w(new _j.g(this.n,this.I(),!0));this.k=this.B.a("SentenceLevelHighlightsControlHolder");this.g=this.B.a("ConceptsControlHolder");this.b=this.B.a("SentenceLevelHighlightsButton");this.f=this.B.a("ConceptsButton");var t=this.v();var n=this.u();if(t&&n){this.q(!0);this.E()}else{this.r(!0);if(t)this.t();else if(n){this.q(!0);this.s()}}},v:function(){for(var t=this.V().b,n=0;n<t.d.length;n++)this.k.z.appendChild(t.d[n].z);return t.d.length>0},u:function(){for(var t=this.V().a,n=0;n<t.d.length;n++)this.g.z.appendChild(t.d[n].z);return t.d.length>0},E:function(){this.r(!1);this.m(!1);this.l(!0);this.c=!0;this.b.bo("ms-fontWeight-semibold")},t:function(){this.l(!0);this.m(!1);if(!this.a&&!this.c){this.b.bo("ms-fontWeight-semibold");this.f.bt("ms-fontWeight-semibold");this.c=!0}},s:function(){this.m(!0);this.l(!1);if(!this.a&&this.c){this.f.bo("ms-fontWeight-semibold");this.b.bt("ms-fontWeight-semibold");this.c=!1}}};_mco.a=function(n,t,i,r){this.s=Function.createDelegate(this,this.bx);this.t=Function.createDelegate(this,this.bC);_mco.a.initializeBase(this,[2]);this.k=n;this.bR=n;this.D=i;this.bi="CreateMessageForCompose";t&&(this.bs=_g.l.c(t));r&&(this.u=r)};_mco.a.c=function(n){if(!n||!n.Mailbox){var i=_mco.a.g(null);if(i){n=new _g.R;n.Mailbox=new _g.g;n.Mailbox.EmailAddress=i}}if(!n||!n.Mailbox)return null;var t=_mco.a.f(n);if(t){n.Mailbox.Name=t.DisplayName;n.Mailbox.RoutingType="SMTP"}return n};_mco.a.g=function(n){var f=_g.a.a().c().bH.UserEmailAddress;var e=_g.a.a().E;var t;t=e?n?null:_g.a.a().c().bH.DefaultFromAddress:_g.a.a().a().bH.SendAddressDefault;if(!_j.h.a(t)){var u=_mco.a.j(t);u||(u=_mco.a.q(t));if(u)return u.EmailAddress;if(e){var a=_g.a.a().c().b();var v=_g.a.a().c().a();if(a&&a.j(t)||v&&v.j(t))return t}if(t===f)return null}if(n){var i=_g.i.isInstanceOfType(n)?n:null;if(i&&(_mco.a.d(i.q(),f)||_mco.a.d(i.A(),f)))return null;var p=_mco.a.j(n.jc());if(p)return p.EmailAddress;var w=_g.a.a().c().b();var b=_g.a.a().c().a();var k=_g.a.a().c().e();var r;var o,h,l,c,s,y;if(e&&i&&((h=_mco.a.o(i,w,o={val:r}),r=o.val,h)||(c=_mco.a.o(i,b,l={val:r}),r=l.val,c)||(y=_mco.a.s(i,k,s={val:r}),r=s.val,y)))return r}return null};_mco.a.e=function(n,t){var r=_mco.a.f(n);if(r){var i=new _g.T;i.ExtendedFieldURI=_g.c.w();i.Value=r.SubscriptionGuid;_mco.a.b(t,i)}else _mco.a.r(t,_g.c.w())};_mco.a.b=function(n,t){if(n.ExtendedProperty){for(var i=0;i<n.ExtendedProperty.length;i++)if(n.ExtendedProperty[i].ExtendedFieldURI.PropertySetId===t.ExtendedFieldURI.PropertySetId&&n.ExtendedProperty[i].ExtendedFieldURI.PropertyTag===t.ExtendedFieldURI.PropertyTag&&n.ExtendedProperty[i].ExtendedFieldURI.PropertyId===t.ExtendedFieldURI.PropertyId&&n.ExtendedProperty[i].ExtendedFieldURI.PropertyName===t.ExtendedFieldURI.PropertyName&&n.ExtendedProperty[i].ExtendedFieldURI.DistinguishedPropertySetId===t.ExtendedFieldURI.DistinguishedPropertySetId){n.ExtendedProperty[i]=t;return}var r=[];Array.addRange(r,n.ExtendedProperty);Array.add(r,t);n.ExtendedProperty=r}else{n.ExtendedProperty=new Array(1);n.ExtendedProperty[0]=t}};_mco.a.r=function(n,t){var r=!1;if(n.ExtendedProperty){for(var u=[],i=0;i<n.ExtendedProperty.length;i++){if(n.ExtendedProperty[i].ExtendedFieldURI.PropertySetId===t.PropertySetId&&n.ExtendedProperty[i].ExtendedFieldURI.PropertyTag===t.PropertyTag&&n.ExtendedProperty[i].ExtendedFieldURI.PropertyId===t.PropertyId&&n.ExtendedProperty[i].ExtendedFieldURI.DistinguishedPropertySetId===t.DistinguishedPropertySetId){r=!0;continue}Array.add(u,n.ExtendedProperty[i])}r&&(n.ExtendedProperty=u)}};_mco.a.j=function(n){if(!n)return null;for(var i=_g.a.a().c().e(),r=i?i.b():0,t=0;t<r;t++)if(n===i.a(t).SubscriptionGuid)return i.a(t);return null};_mco.a.q=function(n){if(!n)return null;for(var i=_g.a.a().c().e(),r=i?i.b():0,t=0;t<r;t++)if(n===i.a(t).EmailAddress)return i.a(t);return null};_mco.a.f=function(n){if(!n||!n.Mailbox)return null;for(var i=_g.a.a().c().e(),r=i?i.b():0,t=0;t<r;t++)if(i.a(t).EmailAddress===n.Mailbox.EmailAddress)return i.a(t);return null};_mco.a.p=function(n,t,i,r){if(_g.bl.isInstanceOfType(n)){var o=n;var e=new _g.dc;e.Subject=o.bH.Subject;e.Body=new _g.t(o.X().a()==="HTML"?"HTML":"Text",o.X().bH.Value);if(e.Body.BodyType==="HTML"){e.Body.DataUriCount=o.X().f();e.Body.CustomDataUriCount=o.X().e()}e.Importance=o.bg();var c=_mco.a.c(o.bH.From);e.From=c;_mco.a.e(c,e);e.Sensitivity=o.cp();_mco.a.e(c,e);_mco.a.i(e,o);return e}else{var u=n;var f=new _g.J;f.Subject=u.bH.Subject;f.Body=new _g.t(u.X().a()==="HTML"?"HTML":"Text",u.X().bH.Value);u.fL()&&(f.DocLinks=u.fL().e());if(f.Body.BodyType==="HTML"){f.Body.Value=_a.C.d(f.Body.Value,!0);f.Body.DataUriCount=u.X().f();f.Body.CustomDataUriCount=u.X().e()}if(u.bA()){f.ItemClass=u.bH.ItemClass;f.MimeContent=u.bH.MimeContent}else _db.e.b(u,f);f.Importance=u.bg();var l=_mco.a.c(u.bH.From);f.From=l;u.bH.Sender&&(f.Sender=u.bH.Sender);_mco.a.e(l,f);f.ToRecipients=_db.e.a(u.q());f.CcRecipients=_db.e.a(u.A());f.BccRecipients=_db.e.a(u.E());f.Sensitivity=u.cp();f.IsDeliveryReceiptRequested=u.bH.IsDeliveryReceiptRequested;f.IsReadReceiptRequested=u.bH.IsReadReceiptRequested;if(t.a().cT().Enabled){if(u.cC()){var s=new _g.bM(u.cC().bH.Value);s.IsExplicit=u.cC().e();s.Value=u.cC().bH.Value;f.ArchiveTag=s}if(u.cs()){var h=new _g.bM(u.cs().bH.Value);h.IsExplicit=u.cs().e();h.Value=u.cs().bH.Value;f.PolicyTag=h}}u.bH.InternetMessageId&&(f.InternetMessageId=u.bH.InternetMessageId);if(t){if(r===1){t.d()&&(f.AtAllMention=u.bH.AtAllMention);t.c()&&u.cD()&&(f.MentionsEx=_mco.i.a(u.cD(),u.bH.From));t.e()&&u.cQ()&&(f.AppliedHashtags=u.cQ().e())}!r&&t.h()&&(f.PendingSocialActivityTagIds=u.dI().e())}_mco.a.i(f,u);_mco.a.k(f,u);_mco.a.m(f,u);_mco.a.n(f,u);_mco.a.l(f,u);_mco.a.h(f,u);return f}};_mco.a.i=function(n,t){if(t.eh()){_mco.a.a(n,_g.c.S(),t.eh().toString());_mco.a.a(n,_g.c.O(),t.fq());_mco.a.a(n,_g.c.M(),t.fn());_mco.a.a(n,_g.c.N(),t.fp())}};_mco.a.m=function(n,t){var i=t.bV()?_g.c.a(t.bV().e(),_g.c.d()):null;if(i){_mco.a.a(n,_g.c.d(),i.bH.Value);i.dispose()}};_mco.a.n=function(n,t){var i=t.bV()?_g.c.a(t.bV().e(),_g.c.c()):null;if(i){_mco.a.a(n,_g.c.c(),i.bH.Value);i.dispose()}};_mco.a.k=function(n,t){t.dR()&&_mco.a.a(n,_g.c.R(),t.dR());t.dH()&&_mco.a.a(n,_g.c.Q(),t.dH());t.eg()&&_mco.a.a(n,_g.c.P(),t.eg())};_mco.a.h=function(n,t){if(t.bV())for(var r=0,o=t.bV().b();r<o;r++){var e=t.bV().a(r);var i;var u,f;(f=_h.J.c(e,u={val:i}),i=u.val,f)&&_mco.a.b(n,i);e.dispose()}};_mco.a.l=function(n,t){if(t.bV()){var r=_g.c.a(t.bV().e(),_g.c.i());if(r){var i=new _g.T;i.ExtendedFieldURI=new _g.O;i.ExtendedFieldURI.DistinguishedPropertySetId=r.a().a();i.ExtendedFieldURI.PropertyType=r.a().b();i.ExtendedFieldURI.PropertyName=r.a().bH.PropertyName;i.Value=r.bH.Value;_mco.a.b(n,i);r.dispose()}}};_mco.a.a=function(n,t,i){var r=new _g.T;r.ExtendedFieldURI=t;r.Value=i;_mco.a.b(n,r)};_mco.a.o=function(n,t,i){i.val=null;if(t)for(var r=0;r<t.b();r++){i.val=t.a(r);if(_mco.a.d(n.q(),i.val)||_mco.a.d(n.A(),i.val))return!0}return!1};_mco.a.s=function(n,t,i){i.val=null;if(t)for(var u=0;u<t.b();u++){var r=t.a(u);if(_mco.a.d(n.q(),r.EmailAddress)||_mco.a.d(n.A(),r.EmailAddress)){i.val=r.EmailAddress;return!0}}return!1};_mco.a.d=function(n,t){t=t?t.toLowerCase():null;if(t&&n)for(var i=0;i<n.b();i++)if(n.a(i).EmailAddress&&n.a(i).EmailAddress.toLowerCase()===t)return!0;return!1};_mco.a.prototype={l:null,k:null,D:null,u:null,bw:function(n){if(!this.l){this.l=n;this.bB("ResponseSuccess",n);_h.CreateItemResponseProcessor.e(this.t);_h.CreateItemResponseProcessor.d(this.s)}},bl:function(n){if(this.l){this.bF("ResponseSuccess",this.l);_h.CreateItemResponseProcessor.c(this.t);_h.CreateItemResponseProcessor.b(this.s);this.l=null}},bo:function(){if(!this.bk)switch(this.be){case 0:this.bk=_g.b.a.nameToId("drafts");break;default:this.bk=_g.b.a.nameToId("outbox");break}var n;_db.e.d(this.k.X(),n={val:this.bD},this.bt),this.bD=n.val;return[_mco.a.p(this.k,this.D,this.u,this.be)]},bj:function(){var n=_db.e.prototype.bj.call(this);var t=this.k.bY();t&&(n.rightsManagementLicenseData=_db.e.c(t));n.explicitLogonUser=this.R;n.itemPartsOrderDescending=_g.a.a().a().n()!=="ChronologicalNewestOnBottom";this.be===1&&(n.actionName=this.bi+"Send");n.setServiceUnavailableOnTransientError=!0;return n},bC:function(n,t){var i=n.a;var f=t;var u=new _g.fb;var r=i.itemIds[n.b];this.bO("ResponseSuccess",this)},bx:function(n){var t=n.id;if(this.Q.id===t){this.bl(this.l);_h.CreateItemResponseProcessor.c(this.t);_h.CreateItemResponseProcessor.b(this.s)}}};_mco.g=function(n,t,i,r,u){this.ck=Function.createDelegate(this,this.cV);this.cl=Function.createDelegate(this,this.cW);this.cr=-1;_mco.g.initializeBase(this,[2]);this.bZ=n;this.bZ.ReferenceItemId=_g.e.a(t);this.ct=i;this.cs=r;this.cu=u;this.bi="CreateResponse"};_mco.g.a=function(n){var t=null;if(_g.cQ.isInstanceOfType(n))t=new _g.bL;else if(_g.cE.isInstanceOfType(n))t=new _g.bQ;else if(_g.cD.isInstanceOfType(n))t=new _g.bw;else throw Error.invalidOperation("SmartResponseItem type is not supported.");return t};_mco.g.b=function(n,t,i,r,u,f,e){if(t){if(_g.i.isInstanceOfType(t)){t.X()&&!_j.h.a(t.X().bH.Value)&&t.X().a()==="HTML"&&t.X().b(_a.C.d(t.X().bH.Value,!1));var o=t;var s=n;if(o.bH.ItemId)if(i)s.UpdateResponseItemId=_bc.OutboxItemContext.a(o.bH.ItemId,_a.a.B);else if(r)s.UpdateResponseItemId=_bc.OutboxItemContext.a(r,_a.a.B);else{s.UpdateResponseItemId=new _g.e(o.bH.ItemId.Id);s.UpdateResponseItemId.ChangeKey=o.bH.ItemId.ChangeKey}o.bH.InternetMessageId&&(s.InternetMessageId=o.bH.InternetMessageId);var l=_mco.a.c(o.bH.From);_mco.a.e(l,s);s.From=l;o.bH.Sender&&(s.Sender=o.bH.Sender);o.q()&&(s.ToRecipients=_db.e.a(o.q()));o.A()&&(s.CcRecipients=_db.e.a(o.A()));o.E()&&(s.BccRecipients=_db.e.a(o.E()));if(u){if(e===1){u.d()&&(s.AtAllMention=o.bH.AtAllMention);u.c()&&o.cD()&&(s.MentionsEx=_mco.i.a(o.cD(),o.bH.From));u.e()&&o.cQ()&&(s.AppliedHashtags=o.cQ().e())}!e&&u.h()&&(s.PendingSocialActivityTagIds=o.dI().e())}s.IsDeliveryReceiptRequested=o.bH.IsDeliveryReceiptRequested;s.IsReadReceiptRequested=o.bH.IsReadReceiptRequested;var h=_g.bx.isInstanceOfType(t)?t.f():t.X();s.NewBodyContent=new _g.t(h.a()==="HTML"?"HTML":"Text",h.bH.Value);if(h.a()==="HTML"){s.NewBodyContent.DataUriCount=h.f();s.NewBodyContent.CustomDataUriCount=h.e()}!u.b()&&s.UpdateResponseItemId&&s.NewBodyContent.BodyType==="HTML"&&_j.h.a(s.NewBodyContent.Value)&&(s.NewBodyContent.Value="<BR />");s.UpdateResponseItemId;_db.e.b(o,s);_mco.a.l(n,o);_mco.a.h(n,o)}else if(_g.bl.isInstanceOfType(t)){var a=n;var c=_g.bx.isInstanceOfType(t)?t.f():t.X();a.NewBodyContent=new _g.t(c.a()==="HTML"?"HTML":"Text",c.bH.Value)}n.Subject=t.bH.Subject;n.Importance=t.bg();n.Sensitivity=t.cp();_mco.a.i(n,t);e===1&&_mco.a.k(n,t)}return n};_mco.g.prototype={ct:null,cs:null,bZ:null,bw:null,bl:null,bC:0,bN:null,bx:null,bU:!1,cu:!1,l:function(n){if(!this.bN){this.bN=n;this.bB("ResponseSuccess",n);_h.CreateItemResponseProcessor.e(this.cl);_h.CreateItemResponseProcessor.d(this.ck)}},u:function(n){if(this.bN){this.bF("ResponseSuccess",this.bN);_h.CreateItemResponseProcessor.c(this.cl);_h.CreateItemResponseProcessor.b(this.ck);this.bN=null}},bP:function(n){this.bw=n;this.bR=n;return n},k:function(){return this.cr},D:function(n){this.cr=n;return n},s:function(){var n=this.bp();var t=n.Body;n=null;return t},t:function(n){this.cJ(n)},bj:function(){var n=_db.e.prototype.bj.call(this);var t=this.bw.bY();t&&(n.rightsManagementLicenseData=_db.e.c(t));if(!!(!!this.bx&!!this.bq)){n.parentConversationNodeId=this.bx;n.conversationId=new _g.e(this.bq.Id)}var i=_g.b.a.nameToId("inbox");n.inboxFolderId=new _g.m(i.Id);n.explicitLogonUser=this.R;this.be===1&&(n.actionName=this.bi+"Send");n.setServiceUnavailableOnTransientError=!0;return n},bo:function(){if(!this.bk)switch(this.be){case 0:this.bk=_g.b.a.nameToId("drafts");break;default:this.bk=_g.b.a.nameToId("outbox");break}var n;_db.e.d(this.bw.X(),n={val:this.bD},this.bt),this.bD=n.val;this.bZ.ReferenceItemDocumentId=this.bC;!this.bC;return[_mco.g.b(this.bZ,this.bw,this.bv,this.bS,this.ct,this.cs,this.be)]},bp:function(){var n=_db.e.prototype.bp.call(this);this.bU&&_g.a.a().a().q()!=="AlwaysSend"&&(n.Body.ShouldSuppressReadReceipt=!0);this.cu&&(n.Body.RemoteExecute=!0);n.Body.SendOnNotFoundError=!0;return n},cJ:function(n){_db.e.prototype.cJ.call(this,n);var t=n.Items[0];if(this.be)this.be===1&&this.bw.bH.ItemId&&_db.bT.a(this.bw.bH.ItemId,!1);else if(this.br)(t.Body||t.NormalizedBody)&&this.cB(t);else{var i=t.ItemId;_h.c.z(i)}},cB:function(n){var t=_g.f.a(n);this.bl=t},cW:function(n,t){var r=n.a;var f=t;var u=new _g.fb;var i=r.itemIds[n.b];if(i&&this.bg&&u.a(this.bg,i)){this.cB(f.Items[0]);this.bO("ResponseSuccess",this)}},cV:function(n){var i=n.id;var t=this.Q;if(t&&t.id===i){this.u(this.bN);_h.CreateItemResponseProcessor.c(this.cl);_h.CreateItemResponseProcessor.b(this.ck)}}};_mco.bi=function(n,t,i){_mco.bi.initializeBase(this,[t]);this.j=n;this.e=n.bH.ItemId;this.f=i};_mco.bi.prototype={e:null,j:null,f:null,M:function(){return this.W("V2015_10_15")},K:function(n){var t=new _g.bv(_h.b.f());t.ItemIds=[new _g.e(this.e.Id)];t.ItemShape.AdditionalProperties=[new _g.d("AppliedHashtags")];var i=new _g.bz(this.L);i.clientStoreItem=0;var r=new _g.bu(this.M(),t);n.a(r,i,this.I,this.H)},cJ:function(n){if(n.ResponseClass==="Success"&&n.Items&&!(n.Items.length<1)){var f=n.Items[0];if(f){var t=f.AppliedHashtags;var e=t?t.length:0;if(e>0){for(var u=new _a.j,i=0;i<e;i++)u.c(t[i]);var r=_h.d.a().a(this.e.Id);r&&r.gB(u)}}}}};_mco.w=function(n){_mco.w.initializeBase(this);this.f=n;this.e=new _g.bz(this.L)};_mco.w.c=function(n,t){var u=!1;if(n.bH.EntityExtractionResult&&n.bH.EntityExtractionResult.Urls)for(var r=n.bH.EntityExtractionResult.Urls,e=r.length,i=0;i<e;++i){var f=r[i];if(t.startsWith(f.Url)){u=!0;break}}return u};_mco.w.a=function(n,t,i){var e=null;var f=n.iZ();if(f)for(var u=0;u<f.b();u++){var s=f.a(u);if(!_j.h.b(s)){i.val|=2;var o=null;try{o=JsonParser.deserialize(s)}catch(c){_j.e.c(_a.a.f,"[GetCachedLinkPreviewsAction.ItemHasCachedLinkPreview] exception deserializing link preview metadata: "+c.message);continue}var r=o;if(r){i.val|=4;var h=_mco.w.b(r.Url);if(t.Url.startsWith(h)){i.val|=8;r.Id=t.Id;e=r;break}}}}return e};_mco.w.d=function(n,t){for(var r=n.bV().h.p,i=0;i<r.length;i++)if(r[i].ExtendedFieldURI.DistinguishedPropertySetId===t.ExtendedFieldURI.DistinguishedPropertySetId&&r[i].ExtendedFieldURI.PropertyName===t.ExtendedFieldURI.PropertyName&&r[i].ExtendedFieldURI.PropertyTag===t.ExtendedFieldURI.PropertyTag&&r[i].ExtendedFieldURI.PropertyId===t.ExtendedFieldURI.PropertyId){r[i]=t;return}var u=[];Array.addRange(u,r);Array.add(u,t);n.bV().z(u)};_mco.w.b=function(n){var t=document.createElement("div");t.innerHTML=n;return _j.k.t(t)};_mco.w.prototype={f:null,e:null,K:function(n){var t;var i=new _g.bv((t=new _g.V,t.BaseShape="IdOnly",t.AdditionalProperties=[_g.c.bw()],t));i.ItemIds=[_g.e.a(this.f)];var r=new _g.bu(this.M(),i);n.a(r,this.e,this.I,this.H)},cJ:function(n){var t=n.Items[0];if(t&&t.ExtendedProperty&&t.ExtendedProperty.length>0){var i=_h.d.a().a(t.ItemId.Id);if(i&&i.bV()){_mco.w.d(i,t.ExtendedProperty[0]);_h.c.g(i)}else _j.e.b(_a.a.f,"[GetCachedLinkPreviewsAction.ProcessResponseMessage] Item could not be found in the cache, id = '{0}'.",t.ItemId.Id)}else _j.e.b(_a.a.f,"[GetCachedLinkPreviewsAction.ProcessResponseMessage] No extended properties were returned on the item, id = '{0}'.",t.ItemId.Id)}};_mco.J=function(n){_mco.J.initializeBase(this);this.f=n;this.e=new _g.bz(this.L);this.e.owsVersion="V2_72"};_mco.J.prototype={f:null,e:null,K:function(n){var t=new _g.bv(this.j());t.ItemIds=[_g.e.a(this.f)];var i=new _g.bu(this.M(),t);n.a(i,this.e,this.I,this.H)},cJ:function(n){var i=n.Items[0];var t=_h.d.a().a(i.ItemId.Id);if(t){t.bU()===1&&t.jo(i.EntityDocument);_h.c.g(t)}},j:function(){var n;return n=new _g.V,n.BaseShape="IdOnly",n.AdditionalProperties=[new _g.d("EntityDocument")],n}};_mco.bj=function(n){_mco.bj.initializeBase(this);if(!n)throw Error.argumentNull("replyToBotMessageRequest");this.e=n};_mco.bj.prototype={e:null,K:function(n){var t=new _gg.zz(this.L);n.hJ(this.e,t,this.I,this.H)},cU:function(n,t,i){try{if(n){if(n.ErrorType){i(Error.create(n.ErrorMessage));return}}else{i(Error.create("ReplyToBotMessage result is null"));return}t()}catch(r){i(r)}}};_mco.c=function(n,t,i){this.bx=Function.createDelegate(this,this.cd);this.bC=Function.createDelegate(this,this.cf);_mco.c.initializeBase(this,[2]);this.l=n;this.be=t;this.bW=i;this.s=0;this.bG=n.X().bH.Value;this.bo="AutoResolve";this.bu=_g.b.a.nameToId("outbox");this.r="UpdateMessageForCompose"};_mco.c.a=function(n,t,i,r){var f=new _g.s(i);var u=new _g.J;r(u,t);f.Item=u;Array.add(n,f)};_mco.c.k=function(n,t){n.Sensitivity=t.cp()};_mco.c.i=function(n,t){n.IsDeliveryReceiptRequested=t.bH.IsDeliveryReceiptRequested};_mco.c.j=function(n,t){n.IsReadReceiptRequested=t.bH.IsReadReceiptRequested};_mco.c.h=function(n,t){_mco.a.a(n,_g.c.S(),t.eh().toString())};_mco.c.d=function(n,t){_mco.a.a(n,_g.c.O(),t.fq())};_mco.c.b=function(n,t){_mco.a.a(n,_g.c.M(),t.fn())};_mco.c.c=function(n,t){_mco.a.a(n,_g.c.N(),t.fp())};_mco.c.g=function(n,t){_mco.a.a(n,_g.c.R(),t.dR())};_mco.c.f=function(n,t){_mco.a.a(n,_g.c.Q(),t.dH())};_mco.c.e=function(n,t){_mco.a.a(n,_g.c.P(),t.eg())};_mco.c.prototype={bW:null,l:null,bl:null,bj:null,m:null,bU:!1,bS:null,bq:null,br:null,bD:!1,bk:null,be:null,k:function(n){this.bj=n;return n},bR:null,bZ:function(n){if(!this.bk){this.bk=n;this.bB("ResponseSuccess",n);_db.UpdateItemResponseProcessor.e(this.bC);_db.UpdateItemResponseProcessor.d(this.bx)}},bY:function(n){if(this.bk){this.bF("ResponseSuccess",this.bk);_db.UpdateItemResponseProcessor.c(this.bC);_db.UpdateItemResponseProcessor.b(this.bx);this.bk=null}},bi:function(){_h.cK.prototype.bi.call(this);var n=this.u;var t=this.l.bY();if(t){n.rightsManagementLicenseData=_db.e.c(t);n.isUpdatingRightsManagementLicenseData=!0}if(_g.i.isInstanceOfType(this.l)&&this.m){n.outboxItemId=new _g.e(this.m.Id);n.outboxItemId.ChangeKey=this.m.ChangeKey;var r=_g.b.a.nameToId("drafts");n.parentFolderId=new _g.m(r.Id)}if(_g.i.isInstanceOfType(this.l)&&this.bj){n.resendItemId=new _g.e(this.bj.Id);n.resendItemId.ChangeKey=this.bj.ChangeKey}if(!!(!!this.br&!!this.bq)){n.parentConversationNodeId=this.br;n.conversationId=new _g.e(this.bq.Id)}var i=_g.b.a.nameToId("inbox");n.inboxFolderId=new _g.m(i.Id);n.bodySubstring=this.bS;n.itemPartsOrderDescending=_g.a.a().a().n()!=="ChronologicalNewestOnBottom";this.s===1&&(n.actionName=this.r+"Send");n.setServiceUnavailableOnTransientError=!0},cJ:function(n){if(this.bU)throw Error.invalidOperation("Expected only one response message.");this.bU=!0;if(this.s)this.s===1&&_db.bT.a(this.l.bH.ItemId,!1);else{this.bl=n.Items[0].ItemId;this.bR=_g.f.a(n.Items[0]);_h.c.z(this.bl)}this.m&&_h.c.e([this.m],!1)},t:function(){var u=new _g.bm;var f;f=this.m?_bc.OutboxItemContext.a(this.m,_a.a.B):this.bj?_bc.OutboxItemContext.a(this.bj,_a.a.B):this.l.bH.ItemId;u.ItemId=new _g.e(f.Id);u.ItemId.ChangeKey=f.ChangeKey;this.l.X().a()==="HTML"&&this.l.X().b(_a.C.d(this.l.X().bH.Value,!1));if(this.bD&&this.l.X().a()==="HTML"){this.bK=!0;var p=_a.B.e(this.l.X().bH.Value);this.l.X().b(p)}var n=[];if(this.l.bA()){var k=this;_mco.c.a(n,this.l,new _g.d("MimeContent"),function(n,t){n.MimeContent=t.bH.MimeContent})}else if(this.l.bi()&&this.l.bi().b()>0){var c=_db.e.g(this.l.bi());if(c.length>0){var vt=this;_mco.c.a(n,this.l,new _g.d("Attachments"),function(n,t){n.Attachments=c})}}if(this.l.fL()){var et=this;_mco.c.a(n,this.l,new _g.d("DocLinks"),function(n,t){n.DocLinks=t.fL().e()})}if(this.l.bH.ItemClass){var ft=this;_mco.c.a(n,this.l,new _g.d("ItemClass"),function(n,t){n.ItemClass=t.bH.ItemClass})}var t=null;t=_g.i.isInstanceOfType(this.l)?this.l.bH.From:this.l.bH.From;t=_mco.a.c(t);var y=_mco.a.f(t);if(y){var ot=this;_mco.c.a(n,this.l,_g.c.w(),function(n,i){_mco.a.e(t,n)})}else Array.add(n,new _g.bd(_g.c.w()));if(_g.i.isInstanceOfType(this.l)){if(t){var it=this;_mco.c.a(n,this.l,new _g.d("From"),function(n,i){n.From=t})}else Array.add(n,new _g.bd(new _g.d("From")));var rt=this;_mco.c.a(n,this.l,new _g.d("CcRecipients"),function(n,t){n.CcRecipients=_db.e.a(t.A())});var ut=this;_mco.c.a(n,this.l,new _g.d("BccRecipients"),function(n,t){n.BccRecipients=_db.e.a(t.E())});var st=this;_mco.c.a(n,this.l,new _g.d("ToRecipients"),function(n,t){n.ToRecipients=_db.e.a(t.q())});if(this.be){if(this.s===1){if(this.be.d()){var at=this;_mco.c.a(n,this.l,new _g.d("AtAllMention"),function(n,t){n.AtAllMention=t.bH.AtAllMention})}if(this.be.c()){var g=this;_mco.c.a(n,this.l,new _g.d("MentionsEx"),function(n,t){var i=t;n.MentionsEx=_mco.i.a(i.cD(),i.bH.From)})}if(this.be.e()){var yt=this;_mco.c.a(n,this.l,new _g.d("AppliedHashtags"),function(n,t){n.AppliedHashtags=t.cQ().e()})}}if(this.be&&this.be.a().cT().Enabled){if(this.l.cC()){var ht=this;_mco.c.a(n,this.l,_g.c.bk(),function(n,t){if(t.cC()){var i=new _g.bM(t.cC().bH.Value);i.IsExplicit=t.cC().e();i.Value=t.cC().bH.Value;n.ArchiveTag=i}})}if(this.l.cs()){var ct=this;_mco.c.a(n,this.l,_g.c.bl(),function(n,t){if(t.cs()){var i=new _g.bM(t.cs().bH.Value);i.IsExplicit=t.cs().e();i.Value=t.cs().bH.Value;n.PolicyTag=i}})}}if(!this.s&&this.be.h()){var lt=this;_mco.c.a(n,this.l,new _g.d("PendingSocialActivityTagIds"),function(n,t){n.PendingSocialActivityTagIds=t.dI().e()})}}_mco.c.a(n,this.l,new _g.d("IsReadReceiptRequested"),_mco.c.j);_mco.c.a(n,this.l,new _g.d("IsDeliveryReceiptRequested"),_mco.c.i);this.l.bV()&&_g.c.a(this.l.bV().e(),_g.c.d())&&_mco.c.a(n,this.l,_g.c.d(),_mco.a.m);this.l.bV()&&_g.c.a(this.l.bV().e(),_g.c.c())&&_mco.c.a(n,this.l,_g.c.c(),_mco.a.n)}var tt=this;_mco.c.a(n,this.l,new _g.d("Subject"),function(n,t){n.Subject=t.bH.Subject});var b=this;_mco.c.a(n,this.l,new _g.d("Importance"),function(n,t){n.Importance=t.bg()});var w=this;_mco.c.a(n,this.l,new _g.d("Body"),function(n,t){n.Body=new _g.t(t.X().a()==="HTML"?"HTML":"Text",t.X().bH.Value);if(n.Body.BodyType==="HTML"){n.Body.DataUriCount=t.X().f();n.Body.CustomDataUriCount=t.X().e()}});_mco.c.a(n,this.l,new _g.d("Sensitivity"),_mco.c.k);if(this.l.eh()){_mco.c.a(n,this.l,_g.c.S(),_mco.c.h);_mco.c.a(n,this.l,_g.c.O(),_mco.c.d);_mco.c.a(n,this.l,_g.c.M(),_mco.c.b);_mco.c.a(n,this.l,_g.c.N(),_mco.c.c)}if(this.s===1){_j.h.d(this.l.dR())||_mco.c.a(n,this.l,_g.c.R(),_mco.c.g);_j.h.d(this.l.dH())||_mco.c.a(n,this.l,_g.c.Q(),_mco.c.f);this.l.eg()&&_mco.c.a(n,this.l,_g.c.P(),_mco.c.e)}if(this.l.bV()){var r=_g.c.a(this.l.bV().e(),_g.c.i());if(r){var i=new _g.T;i.ExtendedFieldURI=new _g.O;i.ExtendedFieldURI.DistinguishedPropertySetId=r.a().a();i.ExtendedFieldURI.PropertyType=r.a().b();i.ExtendedFieldURI.PropertyName=r.a().bH.PropertyName;i.Value=r.bH.Value;var nt=this;_mco.c.a(n,this.l,i.ExtendedFieldURI,function(n,t){_mco.a.b(n,i)});r.dispose()}for(var s=0,v=this.l.bV().b();s<v;s++){var a=this.l.bV().a(s);var e;var h,l;if(l=_h.J.c(a,h={val:e}),e=h.val,l){var d=this;_mco.c.a(n,this.l,e.ExtendedFieldURI,function(n,t){_mco.a.b(n,e)})}a.dispose()}}u.Updates=new Array(n.length);for(var o=0;o<n.length;o++)u.Updates[o]=n[o];return[u]},bJ:function(){var n=_h.cK.prototype.bJ.call(this);n.Body.PromoteInlineAttachments=this.l.X().a()==="Text";n.Body.SendOnNotFoundError=!0;return n},cf:function(n,t){var i=n.a;var f=t;var u=new _g.fb;var r=i.itemIds[n.b];this.bO("ResponseSuccess",this)},cd:function(n){var t=n.id;if(this.Q.id===t){this.bY(this.bk);_db.UpdateItemResponseProcessor.c(this.bC);_db.UpdateItemResponseProcessor.b(this.bx)}}};_mco.E=function(){};_mco.E.registerInterface("_mco.E");_mco.bB=function(){};_mco.bB.registerInterface("_mco.bB");_mco.bC=function(){};_mco.bC.registerInterface("_mco.bC");_mco.z=function(){};_mco.z.registerInterface("_mco.z");_mco.Q=function(){};_mco.Q.registerInterface("_mco.Q");_mco.r=function(){};_mco.r.registerInterface("_mco.r");var IAddToCalendarMessageViewModel=function(){};IAddToCalendarMessageViewModel.registerInterface("IAddToCalendarMessageViewModel");_mco.F=function(){};_mco.F.registerInterface("_mco.F");_mco.bD=function(){};_mco.bD.registerInterface("_mco.bD");_mco.bE=function(){};_mco.bE.registerInterface("_mco.bE");_mco.s=function(){};_mco.s.registerInterface("_mco.s");_mco.t=function(){};_mco.t.registerInterface("_mco.t");_mco.bG=function(){};_mco.bG.registerInterface("_mco.bG");_mco.bF=function(){};_mco.bF.registerInterface("_mco.bF");_mco.R=function(){};_mco.R.prototype={unknown:0,calendarPeek:1,upNext:2,calendarForm:3,mail:4,loadingDialog:5,tagSetContainer:6};_mco.R.registerEnum("_mco.R",!1);_mco.bq=function(n,t,i,r){this.m=Function.createDelegate(this,this.v);this.n=Function.createDelegate(this,this.w);this.o=Function.createDelegate(this,this.x);_mco.bq.initializeBase(this);this.f=n;this.h=t;this.l=i;this.i=r};_mco.bq.prototype={d:null,j:null,g:null,h:null,l:null,f:null,c:null,i:null,b:null,e:null,s:function(){if(!this.d){this.d=new _j.q;this.g=new Array(0);this.j=new Array(0)}return this.d},eX:function(){if(this.d){this.d.f();this.d=null}if(this.g)for(var i=this.g,r=i.length,n=0;n<r;++n){var t=i[n];t.V().dispose();_j.k.f(t.z);t.dispose()}this.e&&_j.B.d(this.e);this.q();this.h=null;this.l=null;this.i=null;this.b=null;_a.gd.prototype.eX.call(this)},a:function(n){this.e=n.querySelectorAll("div[id*='SAContainer']");if(this.e.length>0){this.b=_a.b.b(_a.a.o,"AvailableTimeReadingPane",!1,null);if(_j.h.a(this.f.bH.EntityDocument)){this.c=new _mco.J(this.f.bH.ItemId);this.c.c(this.o);this.c.b(this.n);this.c.a(this.m);this.i.a(this.c)}else{this.p();_a.b.a(this.b)}}},x:function(n){_mco.J.isInstanceOfType(n)&&this.f.bH.EntityDocument?this.p():this.b.n="EntityDocumentNotFound"},w:function(n){this.b.n="GetEntityDocumentActionFailed";this.b.p=n.G.toString()},v:function(n){this.q();_a.b.a(this.b)},q:function(){if(this.c){this.c.U(this.o);this.c.T(this.n);this.c.n(this.m);this.c=null}},p:function(){this.y(this.f.bH.EntityDocument);if(this.d)for(var n=0;n<this.e.length;n++){var t=this.e[n];t.parentNode&&this.d.d.length>n&&this.r(t,this.d.d[n],this.j[n])}else this.b.n="AvailableTimeEntitiesNotFound"},y:function(n){var o=new Array(0);if(this.h){var i=_mco.bk.a(n,"EmailMessage");if(i&&i.length>0)for(var f=i,e=f.length,t=0;t<e;++t){var u=f[t];var r=this.t(u);if(r){this.s().c(r);Array.add(this.j,this.u(u))}}}},u:function(n){var i="unknown";if(n){var t=n.creator;t&&(i=t.name)}return i},t:function(n){var i=null;if(n){var t=n["potentialAction/availableTimes"];t&&(i=t.actionOption)}return i},r:function(n,t,i){var s=new _a.l;s.a("creator",i);this.b.m=s.toString();for(var r=new _j.q,h=t,l=h.length,f=0;f<l;++f){var u=h[f];if(_j.h.a(u.startDate)||_j.h.a(u.endDate))this.b.n="NullOrEmptyStartOrEndDate";else{var o=_a.d.b(u.startDate).E();var e=_a.d.b(u.endDate).E();o&&e?r.c([o,e]):this.b.n="UnableToParseTimeEntities"}}if(r.d.length>0){n.innerText="";n.style.height="320px";var c=this;this.h.a(function(t){var i=t.a(r.d[0][0],null,3);i.c(1);i.E(r);c.z(n,i)})}else this.b.n="NoTimeEntitiesParsed"},z:function(n,t){var u=new _mco.bf(this.f,t,this.l);var r=document.createElement("div");var i=new _j.c(r);i.y("AvailableTimeSchedulingView");i.ba(u);Array.add(this.g,i);if(n.parentNode){n.parentNode.replaceChild(r,n);i.bm()}}};_mco.bf=function(n,t,i){this.e=Function.createDelegate(this,this.f);_mco.bf.initializeBase(this);this.d=n;this.b=i;this.a=t};_mco.bf.prototype={b:null,a:null,c:null,d:null,g:function(){this.c||(this.c=new _j.g(this.e,_a.a.o));return this.c},eX:function(){var t;_a.h.a(t={val:this.c}),this.c=t.val;var n;_a.h.a(n={val:this.a}),this.a=n.val;this.b=null;_a.gd.prototype.eX.call(this)},f:function(){var n=_a.b.b(_a.a.o,"AvailableTimeAddToCalendar",!1,null);if(this.a.b())if(_g.i.isInstanceOfType(this.d)){var t=new _a.l;t.b("A",this.d.q().b());t.b("N",this.a.a().x.length);n.m=t.toString();if(this.b){this.b.c(this.a.b().a());this.b.b(this.a.e()*6e4);this.b.a(!1)}else n.n="NullReplyByMeetingHandler"}else n.n="ItemUnexpectedType";else n.n="NoSelectedTime";_a.b.a(n)}};_mco.br=function(){_mco.br.initializeBase(this)};_mco.br.prototype={b:!1,c:function(){return this.b},a:function(n){this.b=n;return n},p:function(){return 500},q:function(){return 225},h:function(){return!0}};_mco.P=function(n){_mco.P.initializeBase(this);this.b=new _j.q;this.a=new _j.q;for(var t=0;t<n.d.length;t++)n.d[t].bw==="ConceptPopupViewforTabbedPopup"?this.a.c(n.d[t]):this.b.c(n.d[t])};_mco.P.prototype={b:null,a:null,eL:function(){_a.gd.prototype.eL.call(this);for(var t=0;t<this.b.d.length;t++)this.b.o(t,null);this.b=null;for(var n=0;n<this.a.d.length;n++)this.a.o(n,null);this.a=null}};_mco.G=function(n,t){this.a=!1;this.b=n;this.c=t};_mco.G.prototype={b:null,c:null,a:!1};_mco.H=function(n,t){this.a=!1;this.b=n;this.c=t};_mco.H.prototype={b:null,c:null,a:!1};_mco.bh=function(n,t,i,r,u){this.u=Function.createDelegate(this,this.D);this.v=Function.createDelegate(this,this.E);this.w=Function.createDelegate(this,this.G);_mco.bh.initializeBase(this);this.h=u;this.p=n;this.j=t;this.l=i;this.q=r;this.d=_a.C.a();this.r=new _fm.f(this.A(),_nbs.a.wU,_mco.n.c(),0,null,null,!1,!1,!1,!1,null);this.t=new _fm.f(this.C(),_nbs.a.wN,_mco.n.e(),0,null,null,!1,!1,!1,!1,null);this.s=new _fm.f(this.B(),_nbs.a.sq,_mco.n.d(),0,null,null,!1,!1,!1,!1,null);this.f=new _fm.k;this.f.a(this.t);this.f.a(this.s);this.f.a(this.r)};_mco.bh.prototype={j:null,l:null,a:null,b:null,g:null,i:null,m:null,n:null,h:null,p:null,c:null,q:null,d:null,f:null,r:null,t:null,s:null,C:function(){this.i||(this.i=new _j.g(this.w,_a.a.a));return this.i},B:function(){if(!this.n){var n=this;this.n=new _j.g(function(){if(n.h){var t=n.b.a().f()[0];n.h.c(t.a());n.h.b(t.b().e(t.a()));n.h.a(!1);n.a=_a.b.b(_a.a.a,"ScheduleMeetingPopupEditDetailsClicked",!1,null);n.a.m="FCI: "+n.d;_a.b.a(n.a);n.e()}},_a.a.a)}return this.n},A:function(){if(!this.m){var n=this;this.m=new _j.g(function(){n.a=_a.b.b(_a.a.a,"ScheduleMeetingPopupDiscarded",!1,null);n.a.m="FCI: "+n.d;_a.b.a(n.a);n.e()},_a.a.a)}return this.m},G:function(){if(this.l){var n=this;this.l.a(function(t){var u=n.b.a();if(u.x.length){var r=n.b.a().f()[0];n.c.bx(r.a());n.c.T(r.b())}var i=t.a(n.c,"",n.d);i.b(n.v);i.a(n.u);n.q.a(i)})}else this.z();this.e()},bU:function(){this.g||(this.g=new _y.A);return this.g},bt:function(n){this.g=n;return n},H:function(n){if(this.b!==n){this.b=n;this.eJ("ConsensusSchedulingViewModel")}return n},eL:function(){var t;_a.h.a(t={val:this.i}),this.i=t.val;var n;_a.h.a(n={val:this.b}),this.b=n.val;this.g=null;_a.gd.prototype.eL.call(this)},bx:function(){return 11},x:function(){return null},e:null,y:function(){return this.e},o:function(n){this.e=n;return n},bz:function(){return!0},I:function(n){this.c=n;if(this.b)this.p(this);else if(this.j){var t=this;this.j.a(function(n){t.H(n.a(_a.d.a(),null,0));t.b.c(1);t.b.f(t.c);t.b.g(t.c.a(),t.c.b());t.p(t)})}this.a=_a.b.b(_a.a.a,"ScheduleMeetingPopupOpened",!1,null);this.a.m="FCI: "+this.d;_a.b.a(this.a);this.a=_a.b.b(_a.a.a,"UnifiedForms_CreateItemByConversation",!1,null);this.a.m="FCI_"+this.d;this.a.m+="|InReplyTo_"+n.bH.InReplyTo;_a.b.a(this.a)},E:function(n){var t=n.G?n.G.message:"";this.a.p="Get message failed: "+t;this.z()},z:function(){this.a=_a.b.b(_a.a.a,"ScheduleMeetingPopupSendFailed",!1,null);this.a.m="FCI: "+this.d;_a.b.a(this.a)},D:function(n){}};_mco.I=function(n,t,i,r,u){this.j=Function.createDelegate(this,this.k);_mco.I.initializeBase(this);this.m(n);this.i=t;this.d=i;this.h=r;this.e=u;this.l(new _j.g(this.j,_a.a.C))};_mco.I.prototype={g:null,i:null,d:null,e:null,f:null,a:function(){return this.g},m:function(n){this.g=n;this.eJ("Text");return n},c:function(){return this.i},h:0,b:function(){return this.h},l:function(n){this.f=n;this.eJ("OnClickCommand");return n},eL:function(){var n;_a.h.a(n={val:this.f}),this.f=n.val;this.d=null;this.e=null;_a.gd.prototype.eL.call(this)},k:function(){this.e&&this.e(this.h,this.i);if(this.d){this.d.g(this.g);this.d.d(this.g)}}};_mco.bs=function(n){this.d=n.a()==="Mouse"?"ConversationViewGlobalReplyBox":n.a()==="TouchNarrow"?"TouchNarrow":"TouchWide"};_mco.bs.prototype={d:null,a:function(){return this.d},c:function(n,t,i,r,u){return!_j.h.a(n)&&i?new _mco.I(n,t,i,r,u):null},b:function(n,t){return new _mco.bn(n,t,this.d)}};var ICalendarReactComponent=function(){};ICalendarReactComponent.registerInterface("ICalendarReactComponent");_mco.Y=function(){};_mco.Y.registerInterface("_mco.Y");_mco.x=function(){};_mco.x.$$=function(n){var i=_mco.__tc=_mco.__tc||{};var t="x"+"$"+n.getName().replace(/\./g,"_");if(!i[t]){var r=i[t]=function(){};r.registerInterface("_mco.__tc."+t)}return i[t]};_mco.y=function(){};_mco.y.registerInterface("_mco.y");_mco.Z=function(){};_mco.Z.registerInterface("_mco.Z");_mco.m=function(){};_mco.m.registerInterface("_mco.m");_mco.ba=function(){};_mco.ba.registerInterface("_mco.ba");_mco.h=function(){};_mco.h.registerInterface("_mco.h");_mco.by=function(){};_mco.by.registerInterface("_mco.by");_mco.bv=function(){};_mco.bv.registerInterface("_mco.bv");_mco.bw=function(){};_mco.bw.registerInterface("_mco.bw");_mco.o=function(){};_mco.o.registerInterface("_mco.o");_mco.bx=function(){};_mco.bx.registerInterface("_mco.bx");_mco.bz=function(){};_mco.bz.registerInterface("_mco.bz");_mco.N=function(){};_mco.N.registerInterface("_mco.N");_mco.bA=function(){};_mco.bA.registerInterface("_mco.bA");_mco.bb=function(){};_mco.bb.registerInterface("_mco.bb");_mco.V=function(){};_mco.V.prototype={a:function(n,t){var u=n;var f=t;var i=!1;var r=!1;switch(f){case 3:i=!0;r=!0;break;case 2:i=!0;r=!1;break;case 1:i=!1;r=!0;break;case 0:i=!1;r=!1;break}return _n.l.a(u,i,r)},b:function(n,t){throw Error.notImplemented();}};_mco.bg=function(){};_mco.bg.registerInterface("_mco.bg");_mco.b=function(){};_mco.b.$$cctor=function(){_mco.b._I()};_mco.b.p=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <div class='customScrollBar'></div> </div><div>  <div class='_mco_5'> <span class='ms-font-s ms-font-color-neutralSecondary _mco_4'></span> <div></div> </div>  <div class='_mco_7'> <div class='ms-border-color-neutralTertiaryAlt _mco_6'></div> </div> </div><div> <div class='_mco_2 ms-border-color-neutralTertiaryAlt'> <div class='_mco_3'></div>  <div class='_mco_8 ms-border-color-neutralTertiaryAlt'> <button type='button' class='_mco_9'></button> </div> </div>  <span class='ms-font-m ms-font-color-themePrimary _mco_a'></span> </div><div> <div></div> </div><div>  <div class='_mco_c'></div> <div></div> <div class='_mco_h'> <button type='button' class='_mco_g ms-fontSize-m ms-fontColor-neutralPrimary--hover'></button> <button type='button' class='_mco_g ms-fontSize-m ms-fontColor-neutralPrimary--hover'></button> </div> </div><div> <div class='_mco_m'> <div class='_mco_n'></div> </div> <div class='_mco_i'>  <div class='_mco_j'> <div class='ms-border-color-neutralTertiaryAlt _mco_k'></div> </div> </div> </div><div> <button type='button' class='_mco_p ms-font-s ms-bcl-tp ms-bgc-tp-h ms-fcl-tp ms-fcl-w-h'></button> </div>";_j.i.a().appendChild(n);return n};_mco.b.w=function(n){return n.a()};_mco.b.m=function(n){return n.a};_mco.b.y=function(n){return n.g()};_mco.b.x=function(n){return n.b()};_mco.b.t=function(n){return n.j};_mco.b.k=function(n){return n.h};_mco.b.s=function(n){return n.i};_mco.b.l=function(n){return n.a};_mco.b.v=function(n){return n.e};_mco.b.u=function(n){return n.d};_mco.b.z=function(n){return n.f};_mco.b.A=function(n){return n.b};_mco.b.B=function(n){return n};_mco.b.j=function(n){return n.a()};_mco.b.C=function(n){return _mco.I.isInstanceOfType(n)?n.f:null};_mco.b.i=function(n,t){n.a(t)};_mco.b.r=function(n,t){n.bl(t)};_mco.b.g=function(n,t){n.ba(t)};_mco.b.e=function(n,t){n.T(t)};_mco.b.q=function(n,t){n.o(t)};_mco.b.f=function(n,t){n.k(t)};_mco.b.h=function(n,t){n.K(t)};_mco.b.n=function(){_mco.b.c||(_mco.b.c=new _fc.t);return _mco.b.c};_mco.b.o=function(){_mco.b.d||(_mco.b.d=new _fc.m);return _mco.b.d};_mco.b._I=function(){var u="AvailableTimeSchedulingView._tid1._tid2";new _j.d(u,function(){_mco.b.a[u]===undefined&&(_mco.b.a[u]=[null]);var t=_mco.b.b.childNodes[0].cloneNode(!0);var n=new _fce.d(t.children[0]);return new _j.a(t,[n]).l({ListPanel:n})},"",_mco.Z,_fce.a,function(n){return new _fce.a(n,_j.b.Instance.a(_ff.a))},!1,!0,!1,0,_mco.b.a);var f="AvailableTimeSchedulingView._tid1";new _j.d(f,function(){_mco.b.a[f]===undefined&&(_mco.b.a[f]=[null,[[-1,4,null,null,null,"Text",null,_mco.b.i,0,null,null,null,_nbs.a.pk]],[[-1,0,["ConsensusItems"],[_mco.b.w],null,"DataSource",null,_mco.b.r,1,null,null,null]],null]);var n=_mco.b.b.childNodes[1].cloneNode(!0);var i=new _j.c(_j.a.a(n,[1,0]));i.y("ConsensusSchedulingView.Wrapper");var t=new _fce.a(_j.a.a(n,[0,1]),_j.b.Instance.a(_ff.a));t.v("ConsensusSchedulingView.ConsensusOptionView");t.y("AvailableTimeSchedulingView._tid1._tid2");var u=new _fc.a(_j.a.a(n,[0,0]));var r=new _j.i(n.children[0]);return new _j.a(n,[r,u,t,i])},"",_mco.Z,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mco.b.a);var e="AvailableTimeSchedulingView";new _j.d(e,function(){_mco.b.a[e]===undefined&&(_mco.b.a[e]=[[[-1,0,["ConsensusSchedulingViewModel"],[_mco.b.m],null,"DataContext",null,_mco.b.g,1,null,null,null]],[[-1,4,null,null,null,"Text",null,_mco.b.f,0,null,null,null,_nbs.a.Ja],[-1,0,["AddToCalendarCommand"],[_mco.b.y],null,"ClickCommand",null,_mco.b.e,1,null,null,null],[-1,0,["ConsensusSchedulingViewModel","SelectedSurfaceItem"],[_mco.b.m,_mco.b.x],null,"IsEnabled",null,_mco.b.q,1,_mco.b.n(),null,!1]],[[-1,4,null,null,null,"Text",null,_mco.b.i,0,null,null,null,_nbs.a.GF]]]);var n=_mco.b.b.childNodes[2].cloneNode(!0);var r=new _fc.a(n.children[1]);var t=new _fc.b(_j.a.a(n,[0,1,0]));t.d(4);var i=new _j.c(_j.a.a(n,[0,0]));i.y("AvailableTimeSchedulingView._tid1");return new _j.a(n,[i,t,r])},"",_mco.bf,_j.c,function(n){return new _j.c(n)},!0,!1,!1,0,_mco.b.a);var r="HighlightPopupView";new _j.d(r,function(){_mco.b.a[r]===undefined&&(_mco.b.a[r]=[null]);var n=_mco.b.b.childNodes[3].cloneNode(!0);var t=new _mco.M(n.children[0]);return new _j.a(n,[t])},"",_mco.P,_j.c,function(n){return new _j.c(n)},!0,!1,!1,0,_mco.b.a);var n="HighlightPopupTabView";new _j.d(n,function(){_mco.b.a[n]===undefined&&(_mco.b.a[n]=[[[-1,1,["HideSentenceLevelHighlightControls"],[_mco.b.t],null,"IsHidden",null,_mco.b.h,1,null,null,!0],[-1,5,["HasConcepts"],[_mco.b.k],null,"_mco_f:_mco_e",null,null,1,null,null,null]],[[-1,1,["HideConceptControls"],[_mco.b.s],null,"IsHidden",null,_mco.b.h,1,null,null,!0],[-1,5,["HideTabButtons"],[_mco.b.l],null,"_mco_c:_mco_d",null,null,1,null,null,null],[-1,5,["HasConcepts"],[_mco.b.k],null,"_mco_f:_mco_e",null,null,1,null,null,null]],[[-1,1,["HideTabButtons"],[_mco.b.l],null,"IsHidden",null,_mco.b.h,1,null,null,!0]],[[-1,4,null,null,null,"Text",null,_mco.b.f,0,null,null,null,_nbs.a.mo],[-1,1,["ShowSentenceLevelHighlightControlsCommand"],[_mco.b.v],null,"ClickCommand",null,_mco.b.e,1,null,null,null]],[[-1,4,null,null,null,"Text",null,_mco.b.f,0,null,null,null,_nbs.a.er],[-1,1,["ShowConceptControlsCommand"],[_mco.b.u],null,"ClickCommand",null,_mco.b.e,1,null,null,null]]]);var t=_mco.b.b.childNodes[4].cloneNode(!0);var u=new _fc.b(_j.a.a(t,[2,1]));var f=new _fc.b(_j.a.a(t,[2,0]));var e=new _j.i(t.children[2]);var i=new _j.i(t.children[1]);var r=new _j.i(t.children[0]);return new _j.a(t,[r,i,e,f,u]).l({SentenceLevelHighlightsControlHolder:r,ConceptsControlHolder:i,SentenceLevelHighlightsButton:f,ConceptsButton:u})},"",_mco.P,_mco.M,function(n){return new _mco.M(n)},!1,!1,!1,0,_mco.b.a);var t="ScheduleMeetingPopupView";new _j.d(t,function(){_mco.b.a[t]===undefined&&(_mco.b.a[t]=[[[-1,0,["CommandingBarViewModel"],[_mco.b.z],null,"DataContext",null,_mco.b.g,1,null,null,null]],[[-1,0,["ConsensusSchedulingViewModel"],[_mco.b.A],null,"DataContext",null,_mco.b.g,1,null,null,null]]]);var i=_mco.b.b.childNodes[5].cloneNode(!0);var n=new _j.c(_j.a.a(i,[1,0,0]));n.y("ConsensusSchedulingView.Wrapper");n.L(!0);var r=new _fce.s(_j.a.a(i,[0,0]),_j.b.Instance.a(_ff.b));r.L(!0);return new _j.a(i,[r,n])},"",_mco.bh,_j.c,function(n){return new _j.c(n)},!0,!1,!1,0,_mco.b.a);var i="SmartReplyView.SmartReplyTemplate";new _j.d(i,function(){_mco.b.a[i]===undefined&&(_mco.b.a[i]=[[[-1,0,["DataContext"],[_mco.b.B],null,"DataContext",null,_mco.b.g,1,null,null,null],[0,0,["Text"],[_mco.b.j],null,"Text",null,_mco.b.f,1,null,null,null],[0,0,["OnClickCommand"],[_mco.b.C],null,"ClickCommand",null,_mco.b.e,1,null,null,null],[0,0,["Text"],[_mco.b.j],null,"IsHidden",null,_mco.b.h,1,_mco.b.o(),null,!0]]]);var t=_mco.b.b.childNodes[6].cloneNode(!0);var n=new _fc.b(t.children[0]);n.h("_mco_o");return new _j.a(t,[n])},"",_mco.I,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_mco.b.a)};_mco.v.registerClass("_mco.v");_mco.d.registerClass("_mco.d",_h.fN);_mco.l.registerClass("_mco.l",null,Sys.IDisposable);_mco.u.registerClass("_mco.u",_mco.l);_mco.bc.b.registerClass("_mco.bc.b",null,Sys.IDisposable);_mco.bo.registerClass("_mco.bo",null,Sys.IDisposable);_mco.bp.registerClass("_mco.bp",_mco.l);_mco.K.registerClass("_mco.K");_mco.A.registerClass("_mco.A",null,_db.el,Sys.IDisposable);_mco.O.registerClass("_mco.O");_mco.L.registerClass("_mco.L");_mco.W.registerClass("_mco.W",null,_b.co,Sys.IDisposable);MailCommonComponent.registerClass("MailCommonComponent",null,_a.kh,_j.ce);_mco.be.registerClass("_mco.be");_mco.be.b.registerClass("_mco.be.b");_mco.be.a.registerClass("_mco.be.a");_mco.B.registerClass("_mco.B");_mco.D.registerClass("_mco.D");_mco.p.registerClass("_mco.p");_mco.M.registerClass("_mco.M",_j.c);_mco.a.registerClass("_mco.a",_db.e);_mco.g.registerClass("_mco.g",_db.e,_h.fb,_h.eZ,IActionBase,_h.bR,_h.fa);_mco.bi.registerClass("_mco.bi",_h.dx.$$(_g.ez,_g.dE));_mco.w.registerClass("_mco.w",_h.dx.$$(_g.ez,_g.dE));_mco.J.registerClass("_mco.J",_h.dx.$$(_g.ez,_g.dE));_mco.bj.registerClass("_mco.bj",_h.fN);_mco.c.registerClass("_mco.c",_h.cK,_h.fe,_h.fd);_mco.bq.registerClass("_mco.bq",_a.bw,_b.cp,Sys.IDisposable);_mco.bf.registerClass("_mco.bf",_a.bw);_mco.br.registerClass("_mco.br",_a.bw,_y.gp,_a.kU,_j.bs,Sys.IDisposable);_mco.P.registerClass("_mco.P",_a.bw);_mco.G.registerClass("_mco.G");_mco.H.registerClass("_mco.H");_mco.bh.registerClass("_mco.bh",_a.bw,_bc.j,_bc.s,_bc.w,_a.kU,_j.bs,Sys.IDisposable);_mco.I.registerClass("_mco.I",_a.gd,_y.lv,Sys.IDisposable);_mco.V.registerClass("_mco.V",null,_j.bP);_mco.d.f=!1;_mco.d.m=new RegExp("^.*?[\\.]([^.]*$)");_mco.d.s=new RegExp("(.*[^_])_(.*[^_])_(.*[^_])");_mco.d.k=new _a.y("OL");_mco.d.i=new _a.y("CM");_mco.d.j=new _a.y("FM");_mco.k.b="RPCopyHandler";_mco.k.c=String.format("{0}//{1}",window.location.protocol,window.location.hostname);_mco.k.a=_g.a.a().n()?_g.a.a().n().bH.DownloadUrlBase:null;_mco.l.a=new RegExp("[.*+?^${}()|[\\]\\\\]","g");_mco.l.b="\\$&";_mco.l.c=new RegExp("\\s+","g");_mco.l.d="\\s*";_mco.l.e="\\b{0}\\b";_mco.q.d=_a.a.C;MailCommonComponent.$$cctor();_mco.e.d="dining";_mco.e.e="event";_mco.e.g="invoice";_mco.e.i="shareEvent";_mco.e.j="txpItemView";_mco.e.l="viewCalendar";_mco.e.k="txpInEUR";_mco.e.b="TxpExperimentTrigger";_mco.e.f="EX";_mco.e.c="FL";_mco.g.c=_a.a.B;_mco.b.b=_mco.b.p();_mco.b.c=null;_mco.b.d=null;_mco.b.a={};_mco.b.$$cctor();
window.scriptsLoaded['microsoft.owa.mail.common.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.mail.common.js'] = (new Date()).getTime();
