window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.mail.compose.js'] = (new Date()).getTime();
Type.registerNamespace("_mcp");_mcp.N=function(n,t,i,r){_mcp.N.initializeBase(this,[2]);_a.c.a(n,"approvalMessage");this.be=r;this.bu=!0;this.bi="CreateApprovalResponse";this.l=n;this.k=t;this.s=i};_mcp.N.prototype={l:null,k:null,s:!1,S:function(){_a.dn.prototype.S.call(this);this.be===1&&_h.c.k(this.l.bH.ItemId,this.l.bH.ConversationId.Id)},bo:function(){var n;n=this.s?new _gg.bc:new _gg.bV;this.bk=this.be?_g.b.a.nameToId("outbox"):_g.b.a.nameToId("drafts");n.ReferenceItemId=_g.e.a(this.l.bH.ItemId);this.t(n);return[n]},cJ:function(n){!this.be&&n.Items&&n.Items[0]?this.bg=n.Items[0].ItemId:this.be===1&&_h.c.h(this.l.bH.ItemId,this.l.bH.ConversationId.Id)},V:function(){_a.dn.prototype.V.call(this);this.be===1&&_h.c.h(this.l.bH.ItemId,this.l.bH.ConversationId.Id)},t:function(n){if(!this.k){var u=this.s?_nbs.a.se:_nbs.a.PW;var r=String.format(_nbs.a.nW,u,this.l.de());n.Subject=r;if(this.l.bH.Sender){var t=new _a.j;t.c(this.l.bH.Sender.Mailbox);n.ToRecipients=_db.e.a(t)}return}var i;_db.e.d(this.k.X(),i={val:this.bD},this.bt),this.bD=i.val;n.Importance=this.k.bg();this.k.q()&&this.k.q().b()>0&&(n.ToRecipients=_db.e.a(this.k.q()));this.k.A()&&this.k.A().b()>0&&(n.CcRecipients=_db.e.a(this.k.A()));this.k.E()&&this.k.E().b()>0&&(n.BccRecipients=_db.e.a(this.k.E()));n.Sensitivity=this.k.cp();n.IsDeliveryReceiptRequested=this.k.bH.IsDeliveryReceiptRequested;n.IsReadReceiptRequested=this.k.bH.IsReadReceiptRequested;this.k.X()&&(n.Body=new _g.t(this.k.X().a()==="HTML"?"HTML":"Text",this.k.X().bH.Value));n.Subject=this.k.bH.Subject}};_mcp.bx=function(n,t){_mcp.bx.initializeBase(this);this.f=n;this.e=t};_mcp.bx.prototype={f:null,e:null,h:null,K:function(n){var t=new _gg.pd(this.L);n.bq(this.f,this.e,t,this.I,this.H)},cU:function(n,t,i){this.h=n;t()}};_mcp.V=function(){this.f=Function.createDelegate(this,this.j);_mcp.V.initializeBase(this);if(!model)throw Error.argumentNull("model");this.e=model};_mcp.V.a=function(n){_a.c.b(n,"UserAgent shouldn't be null.");return n.o()?_nbs.a.Xz:n.q()?_nbs.a.Hl:n.e()?_nbs.a.vy:_nbs.a.cw};_mcp.V.prototype={e:null,d:null,bb:function(){try{var n=_a.bn.a();var t=n.b("MOWA.IsSignatureChanged")==="true"?!0:!1;this.e.a(t?Boolean.parse(n.b("MOWA.AutoAddSignature")):!0);this.e.c(t?n.b("MOWA.SignatureText"):_mcp.V.a(_a.o.a()));this.e.e(t?Boolean.parse(n.b("MOWA.UseDesktopSignature")):!1);this.d=new _h.cw;this.d.c(this.f);_a.g.a.a(this.d)}catch(i){this.h(i)}return 1},k:function(){this.X(null)},h:function(n){this.X(n)},j:function(n){this.e.b(this.d.e.UserOptions.SignatureText);this.k()}};_mcp.bi=function(n,t){_mcp.bi.initializeBase(this);this.e=n;this.f=t};_mcp.bi.prototype={e:null,j:null,f:"EwsLegacyId",k:function(){return this.j},K:function(n){var i=new _gg.dH(this.f);i.DestinationFormat=this.f;i.SourceIds=new Array(this.e.length);for(var t=0;t<this.e.length;t++){var f=new _gg.bb(this.e[t].Format,this.e[t].Id,this.e[t].Mailbox);i.SourceIds[t]=f}var u=new _gg.dG(this.M(),i);var r=new _gg.lM(this.L);n.bg(u,r,this.I,this.H)},cJ:function(n){this.j=n.AlternateId}};function MailComposeComponent(){}MailComposeComponent.$$cctor=function(){_a.t.a().a(MailComposeComponent)};MailComposeComponent.a=function(n,t,i){var o=n==="Mouse";var s=!(t.b()&&t.d().b()<9);var r=i.c().bH.UserCulture;var e=!!r&&r.startsWith("en");var f=!!i.n()&&i.n().bH.CheckForForgottenAttachmentsEnabled;var u=!!i.a()&&i.a().bH.CheckForForgottenAttachments;return o&&f&&u&&s&&e};MailComposeComponent.prototype={b:function(n,t,i){var g=this;n.b(_mcp.C,function(){return new _mcp.C(n.d(_y.t),n.a(_y.bf),n.a(_a.I),n.a(_a.x))}).b(_y.hv).a();var p=this;n.b(_mcp.H,function(){return new _mcp.H(n.a(_a.x),n.c(_db.bX),n.a(_j.j))}).b(_db.bd).a();var w=this;n.b(_mcp.bt,function(){return new _mcp.bt(n.a(_h.n),n.a(_g.a),n.a(_y.t),n.a(_mcp.H),n.c(_db.A),n.c(_db.X),n.c(_y.dx),n.a(_a.x))}).b(_y.is).a();var b=this;n.b(_mcp.bo,function(){return new _mcp.bo(n.a(_y.fw),n.a(_a.x),n.a(_y.a))}).b(_y.t).a();var e=n.a(_j.o);var o=n.a(_g.h);var u=MailComposeComponent.a(i.a(),e,o);var f=n.a(_a.e);var r=i.a()==="Mouse"&&_g.a.a().bH.AsyncSendEnabled;var d=this;n.b(_mcp.x,function(){return new _mcp.x(n.a(_a.q),n.a(_j.j),n.a(_g.h))}).a();var k=this;n.b(_mcp.bq,function(){return new _mcp.bq(n.c(_y.bB),n.a(_rw.i),u?n.c(_y.dW):null,n.c(_y.cx),n.a(_y.t),n.a(_mcp.H),n.a(_pe.g),n.a(_y.a),n.c(_y.dz),n.a(_mcp.D),n.a(_y.K),n.a(_j.j),n.c(_y.be),f,n.a(_a.x),n.d(_y.bS),n.a(_h.n),n.a(_g.ck),n.a(_a.E),n.c(_y.cV),n.c(_y.dt),n.c(_y.du),i.a()==="Mouse"?n.a(_cmc.E):null,r?n.c(_y.dR):null,r?n.c(_y.dm):null,n.c(_y.cy),n.d(_db.bp),n.a(_g.a).bH.AttachmentPolicy,n.c(_y.bC),n.d(_b.I),n.c(_y.dA),n.c(_db.X),n.c(_y.dx),n.c(_db.Y),n.c(_y.cw),n.c(_db.T),n.a(_g.a).a(),n.a(_j.o),i,n.a(_y.q),n.a(_h.br),n.a(_mcp.x),i.a()==="TouchNarrow"?n.a(_y.r):null,n.c(_y.ca),n.c(_mco.m),n.c(_mco.r),n.d(_mco.y),n.a(_g.h).c(),n.c(_mco.E),n.a(_mco.B))}).b(_y.V).a();var y=this;n.b(_mcp.br,function(){return new _mcp.br(n.c(_y.bB),n.a(_rw.i),u?n.c(_y.dW):null,n.c(_y.cx),n.a(_y.t),n.a(_mcp.H),n.a(_pe.g),n.a(_y.a),n.c(_y.dz),n.a(_mcp.D),n.a(_y.K),n.a(_j.j),n.c(_y.be),f,n.a(_a.x),n.d(_y.bS),n.a(_h.n),n.a(_g.ck),n.a(_a.E),n.c(_y.cV),n.c(_y.dt),n.c(_y.du),i.a()==="Mouse"?n.a(_cmc.E):null,r?n.c(_y.dR):null,r?n.c(_y.dm):null,n.c(_y.cy),n.d(_db.bp),n.a(_g.a).bH.AttachmentPolicy,n.c(_y.bC),n.d(_b.I),n.c(_y.dA),n.c(_db.X),n.c(_y.dx),n.c(_db.Y),n.c(_y.cw),n.c(_db.T),n.a(_g.a).a(),n.a(_j.o),i,n.a(_y.q),n.a(_h.br),n.a(_mcp.x),i.a()==="TouchNarrow"?n.a(_y.r):null,n.c(_y.ca),n.c(_mco.m),n.c(_mco.r),n.d(_mco.y),n.a(_g.h).c(),n.c(_mco.E),n.a(_mco.B))}).b(_y.iq).a();var c=this;n.b(_mcp.D,function(){return new _mcp.D(n.a(_db.bd))}).b(_y.io).a();var h=this;n.b(_mcp.W,function(){return new _mcp.W(n.a(_y.a),n.a(_j.v),n.a(_g.h),n.a(_j.j),n.a(_y.V))}).a();var s=this;n.b(_mcp.i,function(){return new _mcp.i(window.document.createElement("div"),i.a(),n.a(_j.o),n.a(_a.x),n.a(_a.e),n.a(_j.j),n.a(_a.E),n.a(_b.d))});var v=this;n.b(_mcp.n,function(){return new _mcp.n(window.document.createElement("div"),n.a(_j.o),n.a(_a.x),n.a(_a.e),n.a(_j.j),n.a(_a.E),n.a(_b.d),n.a(_g.a))});var a=this;n.b(_mcp.U,function(){return new _mcp.U(window.document.createElement("div"),n.a(_j.o))});var l=this;n.b(_mcp.X,function(){return new _mcp.X(n.d(_y.bL),i.a())}).a();_a.b.m("MailComposeNew");_a.p.a(_a.bB.f)},a:function(){return[new _j.y(_mcp.X,1,1),new _j.y(_mcp.x,1,73),new _j.y(_mcp.W,4,1)]}};_mcp.W=function(n,t,i,r,u){this.h=Function.createDelegate(this,this.p);this.g=Function.createDelegate(this,this.n);this.j=n;this.f=t;this.l=i;this.c=r;this.d=u;this.c.b(IDelayedSendEvent,this.g);this.c.b(_cmc.bn,this.h)};_mcp.W.prototype={j:null,f:null,l:null,c:null,d:null,a:null,b:null,n:function(n){_j.s.a(n.a(),"SendEvent.DelayedSendCallback is null.");_j.s.a(n.b(),"SendEvent.MailComposeContext is null.");var u=n.c()*1e3;var t=n.b();var f=n.a();var i=this,o=this;var r=new _mcp.bC(this.c,u,function(){_j.e.a(_a.a.a,"UndoDelayedSendAction.undoDelegate - cancelling the queued delayed-send task.");_g.i.isInstanceOfType(t.K())&&_h.c.A(t.K(),!1);i.k()||_j.e.b(_a.a.a,"TryCancelQueuedTask failed on undo delayed send. Continuing to navigate to the draft.");_j.e.a(_a.a.a,"UndoDelayedSendAction.undoDelegate - popping the cancelled undo action from the undo stack.");i.e();i.o(t)},function(){_j.e.a(_a.a.a,"UndoDelayedSendAction.flushDelegate - cancelling the queued delayed-send task.");if(o.k()){_j.e.a(_a.a.a,"Flushing the delayed-send task by firing the send callback.");f()}});_j.e.a(_a.a.a,"HandleDelayedSendEvent - pushing the undo action to the undo stack.");this.q(r);_j.e.a(_a.a.a,"HandleDelayedSendEvent - queueing the delayed-send task.");var e=this;this.a=_j.m.a().a(_a.a.a,"SubmitDelayedComposeAction",function(){e.m(f,r)},u)},m:function(n,t){_j.e.a(_a.a.a,"DelayedSendTaskDelegate - executing the delayed-send task callback.");t.a();this.a=null;if(t===this.b){_j.e.a(_a.a.a,"DelayedSendTaskDelegate - action flushed; now popping the action from the undo stack.");this.e()}},k:function(){_j.e.a(_a.a.a,"TryCancelQueuedTask - attempting to cancel the queued delayed-send task...");var n=!1;if(this.a){this.a=this.f.b(this.a);_j.e.a(_a.a.a,"TryCancelQueuedTask - delayed-send task has been cancelled.");n=!this.a}else _j.e.b(_a.a.a,"TryCancelQueuedTask- queuedTaskHandle is null on flush, skipping...");return n},o:function(n){_j.e.a(_a.a.a,"NavigateToDelayedMessage - navigating to the cancelled draft message.");n.f(!1);var t=this.d.a(n,null,null);t.cp=!1;t.ct=!1;t.bm().d(new _y.bs);var i=this;t.o(function(){t.dispose()});t.bm().b().a()},p:function(n){this.i()},q:function(n){this.i();this.b=n},i:function(){var n=this.e();n&&n.a()},e:function(){var n=this.b;this.b=null;return n}};_mcp.X=function(n,t){if(t==="Mouse"){var i=this;n.c(function(n){n.a(_mcp.b,"MailComposeContext")},!1)}};_mcp.x=function(n,t,i){this.e=Function.createDelegate(this,this.i);this.f=Function.createDelegate(this,this.j);_mcp.x.initializeBase(this);this.d=n;this.h=t;this.c=i.a();this.a=0;var r=this.c.bH.SignatureHtml;r===""||r||this.k()};_mcp.x.prototype={d:null,h:null,c:null,a:0,b:null,k:function(){this.b=new _cmc.h(_a.a.a,"MailComposeSigPreload",!1);this.a=1;var n=new _mcp.bz;n.c(this.f);n.b(this.e);this.d.a(n)},j:function(n){this.c.bq(n.e.bH.AutoAddSignature);this.c.bF(n.e.bH.SignatureHtml);this.c.bG(n.e.bH.SignatureText);this.a=2;this.eJ("CurrentStatus");this.g(n,!1)},i:function(n){this.a=3;_j.e.b(_a.a.a,"SignaturePreloadService.OnPreloadFailed - error: '{0}'",n.G?n.G.message:"");this.eJ("CurrentStatus");this.g(n,!0)},g:function(n,t){if(this.b)if(t){this.b.k(n.P());this.b.d(n.O(),null)}else this.b.b()}};_mcp.O=function(){};_mcp.bB=function(){};_mcp.bA=function(n){_mcp.bA.initializeBase(this);this.f=n;this.k=_a.a.bp;this.h="GetSuggestedGroupsFromRecipientsAction"};_mcp.bA.prototype={e:null,m:0,j:!1,f:null,h:null,k:null,K:function(n){var i=new _gg.hW(this.M());var t=new _gg.ux(this.L);t.actionName="GetSuggestedGroupsFromRecipientsAction";i.Body.Recipients=this.f;_a.p.b(this.k,this.h,!0);n.gt(i,t,this.I,this.H)},cU:function(n,t,i){try{if(n.Body.ResponseCode==="NoError"){this.e=n.Body.SuggestedUnifiedGroups;this.m=n.Body.SuggestedUnifiedGroupCount;this.j=n.Body.ShouldCreateNewGroup;this.l(null);t()}else{var r=Error.create("GetSuggestedGroupsFromRecipientsAction: group suggestions could not be retrieved.ResponseCode: "+n.Body.ResponseCode+"."+"MessageText: "+n.Body.MessageText+".");this.l(r);i(r)}}catch(u){this.l(u);i(u)}},l:function(n){var i=null;n&&(i=n.message?n.message:n.name?n.name.toString():"UnknownError");var r=_a.p.c(this.h);if(r){var t=new _a.l;this.f&&t.b("rc",this.f.length);if(this.e){t.b("sgc",this.e.length);if(this.e[0].TopRelevantMembers){t.b("sgmc",this.e[0].TopRelevantMembers.length);t.b("mrp",this.e[0].TopRelevantMembers.length*100/this.f.length)}}this.j?t.c("scng",!0):t.c("scng",!1);r.m=t.toString();r.n=i;r.o=this.P();_a.p.a(this.h)}}};_mcp.P=function(){};_mcp.bC=function(n,t,i,r){this.p=Function.createDelegate(this,this.a);this.l=n;this.o=i;this.n=r;var u=this;this.l.a(_a.bl,new _a.bl(11,_u.P.d,_u.P.v,_u.P.M,this.p,function(){u.g()},null))};_mcp.bC.prototype={l:null,o:null,n:null,m:!1,toString:function(){return _u.n.NT},g:function(){this.m=!0;this.o();this.m=!1;this.k();return!0},a:function(){this.n();this.l.a(_a.bl,new _a.bl(13,"","","",null,null,null))},j:function(){this.l.a(_a.bl,new _a.bl(4,"","","",null,null,null))},k:function(){this.l.a(_a.bl,new _a.bl(12,"","","",null,null,null))},f:function(){return this.m},c:function(){return null},e:function(n){return!1},d:function(n){return!1},b:function(n){return!0},i:function(n){},h:function(){}};_mcp.w=function(n){_mcp.w.initializeBase(this);this.e=n};_mcp.w.prototype={e:null,K:function(n){var i=this.f();var t=new _gg.pe(this.L);t.explicitLogonUser=this.e.E();this.e.e()&&!t.actionName&&(t.actionName=this.e.e());n.dZ(i,t,this.I,this.H)},f:function(){var t=this.e.s();var i=new _gg.gk(this.M());var n=new _gg.dM;n.Items=t.Items;n.ItemShape=t.ItemShape;n.ShapeName=t.ShapeName;n.SubjectPrefix=t.SubjectPrefix;n.ClientSupportsIrm=t.ClientSupportsIrm;n.ComplianceId=t.ComplianceId;n.ComposeOperation=t.ComposeOperation;n.IsNonDraft=t.IsNonDraft;n.MessageDisposition=t.MessageDisposition;n.OutboundCharset=t.OutboundCharset;n.SavedItemFolderId=t.SavedItemFolderId;n.SendOnNotFoundError=t.SendOnNotFoundError;n.ShouldSuppressReadReceipt=t.ShouldSuppressReadReceipt;n.UseGB18030=t.UseGB18030;n.UseISO885915=t.UseISO885915;n.TimeFormat=t.TimeFormat;this.e.k()>=0&&(n.AttachmentIndex=this.e.k());i.Body=n;return i},bc:function(n){_h.fN.prototype.bc.call(this,n)},cJ:function(n){this.e.t(n)}};_mcp.by=function(){_mcp.by.initializeBase(this)};_mcp.by.prototype={e:null,f:null,h:null,K:function(n){var i=new _gg.eb(this.M());var t=new _gg.lV(200);n.z(i,t,this.I,this.H)},cU:function(n,t,i){if(n.Options){this.e=n.Options.EmailAddresses;this.f=n.Options.NotManagedEmailAddresses;this.h=n.Options.SendEnabledConnectedAccounts;t&&t()}else!_j.h.a(n.ErrorMessage)&&i&&i(Error.create(n.ErrorMessage))}};_mcp.bz=function(){_mcp.bz.initializeBase(this)};_mcp.bz.prototype={e:null,K:function(n){var t=new _gg.mc(this.L);n.C(t,this.I,this.H)},cU:function(n,t,i){this.e=new _gg.c(n.Options);t()}};var IMailComposeOverridable=function(){};IMailComposeOverridable.registerInterface("IMailComposeOverridable");_mcp.bc=function(){};_mcp.bc.a=function(n){var t=null;_db.e.isInstanceOfType(n)?t=n.bg:_mco.c.isInstanceOfType(n)?t=n.bl:_mcp.w.isInstanceOfType(n)&&(t=n.e.f());return t};_mcp.bc.b=function(n){var t=null;_db.e.isInstanceOfType(n)?t=_g.f.a(n.cp):_mco.c.isInstanceOfType(n)?t=n.bR:_mcp.w.isInstanceOfType(n)&&(t=n.e.bl);return t};_mcp.Q=function(n,t,i,r){_mcp.Q.initializeBase(this,["AddOriginalAttachmentInfoBarView"]);this.a=n;this.d=t;this.b=new _j.g(i,_a.a.a);this.c=new _j.g(r,_a.a.a)};_mcp.Q.prototype={d:0,a:null,f:function(){return this.a.length===1?String.format(_u.R.ML,this.a[0].Name):String.format(_u.n.Qo,this.a.length)},e:function(){return this.d>1?_u.n.Cc:_u.n.Cr},b:null,c:null};_mcp.cc=function(n,t,i){this.e=n;this.f=t;this.d=i};_mcp.cc.prototype={e:0,c:function(){return this.e},f:null,b:function(){return this.f},d:null,a:function(){return this.d}};_mcp.ce=function(){};_mcp.cg=function(n,t){this.c=n;this.d=t};_mcp.cg.prototype={c:null,d:null,a:function(){return this.c},b:function(){return this.d}};_mcp.bv=function(n){this.a=n};_mcp.bv.prototype={a:null};_mcp.cj=function(n){this.b=n};_mcp.cj.prototype={b:null,a:function(){return this.b}};_mcp.T=function(n,t,i,r){this.g=n;this.e=t;this.h=i;this.f=r};_mcp.T.prototype={g:!1,e:null,h:!1,f:null,c:function(){return this.g},a:function(){return this.e},d:function(){return this.h},b:function(){return this.f}};_mcp.bw=function(n){this.b=n};_mcp.bw.prototype={b:!1,a:function(){return this.b}};_mcp.ck=function(n){this.b=n};_mcp.ck.prototype={b:null,a:function(){return this.b}};_mcp.H=function(n,t,i){this.f=n;this.j=t;this.g=i};_mcp.H.prototype={f:null,j:null,g:null,h:function(n,t){var i=n.ba;var r=i.a();var s=3===r||2===r||1===r;var e=this.f.b()&&i.l();(n.bO().j()||i.dx()&&(i.dl()||n.bg().n()>0))&&(e=!!(e&i.bm()));var f=null;if(s&&!e||14===r||n.bF)f=this.l(i,t);else if(i.bv()){_j.e.a(_a.a.a,"Creating UpdateMessageForComposeAction; disposition={0}",t);var h=this.m(t,i);f=h}else if(8===i.a()){_j.e.a(_a.a.a,"Creating CancelCalendarItemAction; disposition={0}",t);f=this.o(i,t)}else if(r!==5&&r!==6&&r!==7)if(r===9||r===10){_j.e.a(_a.a.a,"CreateComposeAction: ApprovalRequestAction");f=this.n(i,t)}else{_j.e.a(_a.a.a,"Creating CreateMessageForComposeAction; disposition={0}",t);var u=null;if(r===11||r===12){u=new _mco.a(i.bF(!1),i.bR(),this.f,this.g);u.be=0}else{var o=this.k(i);u=new _mco.a(o,null,this.f,this.g);u.be=t}u.bt=!this.f.b();i.x()&&(u.bG=i.x());u.ci=i.bZ(100,u.bt);u.cj=_y.m.toString(i.a());f=u}f.ba=i.d();return f},i:function(n,t,i){var r=new _h.cY(200,n);r.j=t||_h.b.d();r.r=_j.u.a(i)?"MailCompose":i;return r},a:function(n,t){var r=t?"HardDelete":"MoveToDeletedItems";return new _db.dJ([n],r,2)},d:function(n,t){var r=null;r=n.R()?n.bF(!0):n.G(!0);var i=this.c(n,r);i.br=t;i.bH=!this.f.b()&&n.h()==="HTML"?"MailComposeNormalizedBody":"MailCompose";i.cf=_g.a.a().a().bH.TimeFormat;return i},o:function(n,t){var i=null;var r=this;this.j.b(function(t){i=t.a(n.A(),1,n.dg());i.l(n.G(!1));n.x()&&i.k(n.x())});return i},c:function(n,t){var f=n.cu()?new _db.s(n.A()):n.A();var u=!1;if(_h.a.k&&_h.a.n&&n.b()&&_g.i.isInstanceOfType(n.b())&&n.b().cP){var r=_a.bL.c(n.b().cP.Id);_j.h.a(r)||r===_g.a.a().c().bH.MailboxGuid||(_h.l.a(n.b().cP)||_h.a.r(n.b().cP))&&(u=!0)}var i=null;i=new _mco.g(this.q(n.a()),f,this.f,this.g,u);i.bP(t);i.bC=n.dr();i.bt=!this.f.b();n.x()&&(i.bG=n.x());i.bq=n.bi();i.bx=n.ds();i.ba=n.d();n.b()&&_g.i.isInstanceOfType(n.b())&&n.b().bH.IsReadReceiptRequested&&(i.bU=!0);switch(n.a()){case 1:case 2:i.bW=_u.n.OC;break;case 3:i.bW=_nbs.a.cZ;break}return i},e:function(n,t,i){return new _mco.c(n,t,i)},b:function(n,t,i){var r;r=_g.bx.isInstanceOfType(n)?this.p(n,this.f):new _mco.a(n,null,this.f,this.g);return r},l:function(n,t){var r;_j.e.a(_a.a.a,"Creating CreateResponseAction; layout={0}; disposition={1}",_y.c.a.a(),t);var f=n.G(!1);var i=this.c(n,f);i.be=t;i.ci=n.bZ(100,!this.f.b());i.cj=_y.m.toString(n.a());if(n.bL()){var u=new _mcp.w(i);r=u}else r=i;return r},k:function(n){return n.G(!1)},m:function(n,t){var i=null;if(t.R()){i=new _mco.c(t.bF(!1),this.f,this.g);i.bp=_g.l.c(t.bR());i.s=0}else{i=new _mco.c(t.G(!1),this.f,this.g);i.s=n}i.bD=!this.f.b();t.x()&&(i.bg=t.x());i.bS=t.bZ(100,i.bD);i.bo="AlwaysOverwrite";i.bs=_y.m.toString(t.a());return i},q:function(n){switch(n){case 1:return new _g.bQ;case 2:return new _g.bw;case 3:return new _g.bL;case 12:return new _g.eK;case 14:return new _g.dK;case 16:return new _g.bw;default:throw Error.invalidOperation("Unable to get SmartResponseType from MailComposeOperation "+_y.m.toString(n));}},n:function(n,t){var r=n.b();var i=new _mcp.N(r,n.G(!1),n.a()===9,t);i.bt=!this.f.b();return i},p:function(n,t){var r=_mco.g.a(n);var i=new _mco.g(r,n.bH.ReferenceItemId,this.f,this.g,!1);i.bt=!t.b();i.bP(n);i.bC=n.t();i.bU=!0;return i}};_mcp.bo=function(n,t,i){this.e=n;this.d=t;this.f=i};_mcp.bo.prototype={d:null,e:null,f:null,a:function(n,t){var i=new _mcp.b;if(this.d){i.er(this.d.b());i.er(this.d.b())}i.p(n?0:this.e.a());return i},b:function(n,t,i,r){var u=this.a(!1,!1);u.p(this.e.a());u.e(4);u.f(!1);u.E(n);u.cI(t);r&&!r.a()?u.i(r.h()):u.i(i===1?"Text":"HTML");return u},c:function(n,t,i,r,u,f){var e=this.a(!1,!1);e.p(this.e.a());e.e(16);e.f(!1);e.E(n.bH.ItemId);e.cI(!1);i&&!i.a()?e.i(i.h()):e.i(t===1?"Text":"HTML");e.cA(n);e.dF(r,u,f);return e}};_mcp.bq=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt,dt,gt,ni,ti,ii,ri,ui,fi,ei,oi){_a.c.b(k,"nativeBridge");this.y=n;this.N=t;this.D=i;this.O=r;this.bb=u;this.f=f;this.L=e;this.c=o;this.J=s;this.v=h;this.M=c;this.w=l;this.C=v;this.z=y;this.A=p;this.p=a;this.F=w;this.r=b;this.I=k;this.k=d;this.l=g;this.m=nt;this.t=tt;this.Q=it;this.P=rt;this.B=ut;this.S=ft;this.o=et;this.G=ot;this.H=st;this.T=ht;this.i=ct;this.h=lt;this.j=at;this.x=vt;this.d=yt;this.e=pt;this.U=wt;this.q=bt;this.E=kt;this.K=dt;this.R=gt;this.g=ni;this.n=ti;this.s=ii;this.W=ri;this.u=ui;this.Y=fi;this.X=ei;this.Z=oi};_mcp.bq.prototype={x:null,y:null,N:null,D:null,O:null,bb:null,f:null,w:null,L:null,c:null,J:null,v:null,M:null,C:null,z:null,A:null,T:null,p:null,r:null,F:null,t:null,I:null,k:null,l:null,m:null,Q:null,P:null,B:null,S:null,o:null,G:null,H:null,i:null,h:null,j:null,U:null,q:null,E:null,K:null,R:null,g:null,n:null,s:null,W:null,Y:null,X:null,u:null,Z:null,d:null,e:null,b:function(n,t,i){return this.bc(n,null,t,i)},a:function(n,t,i){return this.V(n,null,t,i)},bc:function(n,t,i,r){var u=this.bb.a(!1,!1);u.hw(n);return this.V(u,t,i,r)},V:function(n,t,i,r){var u=null;u=this.c.a()==="Mouse"?new _mcp.bp(n,t,this.y,this.N,this.D,this.O,this.L,this.c,this.J,this.v,this.M,this.w,this.p,this.C,this.z,this.A,this.F,this.r,this.I,this.f,i,r,this.k,this.l,this.m,this.t,this.Q,this.P,this.B,this.S,this.o,this.G,this.H,this.T,this.i,this.h,this.j,this.x,this.d,this.e,this.U,this.q,this.E,this.K,this.R,this.g,this.n,this.s,this.W,this.u,this.Y,this.X,this.Z):new _mcp.d(n,t,this.y,this.N,this.D,this.O,this.L,this.c,this.J,this.v,this.M,this.w,this.p,this.C,this.z,this.A,this.F,this.r,this.I,this.f,i,r,this.k,this.l,this.m,this.t,this.Q,this.P,this.B,this.S,this.o,this.G,this.H,this.T,this.i,this.h,this.j,this.x,this.d,this.e,this.U,this.q,this.E,this.K,this.R,this.g,this.n,this.s,this.W,this.u,this.Y,this.X,this.Z);u.ck();return u}};_mcp.br=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt,dt,gt,ni,ti,ii,ri,ui,fi,ei,oi){_mcp.br.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt,dt,gt,ni,ti,ii,ri,ui,fi,ei,oi])};_mcp.br.prototype={V:function(n,t,i,r){var u=new _mcp.E(n,t,this.y,this.N,this.D,this.O,this.L,this.c,this.J,this.v,this.M,this.w,this.p,this.C,this.z,this.A,this.F,this.r,this.I,this.f,i,r,this.k,this.l,this.m,this.t,this.Q,this.P,this.B,this.S,this.o,this.G,this.H,this.T,this.i,this.h,this.j,this.x,this.d,this.e,this.U,this.q,this.E,this.K,this.R,this.g,this.n,this.s,this.W,this.u,this.Y,this.X,this.Z);u.ck();return u}};_mcp.bn=function(){_mcp.bn.initializeBase(this)};_mcp.bn.prototype={b:null,a:null,d:function(n){if(this.b!==n){this.b=n;this.eJ("Description")}return n},c:function(n){if(this.a!==n){this.a=n;this.eJ("ConversationOwner")}return n}};_mcp.bm=function(){_mcp.bm.initializeBase(this)};_mcp.bm.prototype={b:null,a:null,e:function(n){if(this.b!==n){this.b=n;this.eJ("TemplateLists")}return n},d:function(n){if(this.a!==n){this.a=n;this.eJ("Rmstemplate")}return n},c:null};_mcp.v=function(n,t,i,r,u,f){this.n=Function.createDelegate(this,this.o);_mcp.v.initializeBase(this,[_mcp.v.a]);this.d=_u.n.QZ;this.c=r;this.i=_u.n.HO;this.h=i;this.l=_u.n.Hr;this.j=new _j.g(this.n,i.g);var e=n?n:" ";e.charAt(e.length-1)===":"&&(e=e.substring(0,e.length-1));t=t?t:" ";this.b=e+": "+t;var o=this.b;this.g=o;this.a=!0;this.f=!0;this.e=!u;this.m=!1};_mcp.v.prototype={a:!1,f:!1,e:!1,m:!1,g:null,b:null,l:null,j:null,d:null,c:null,i:null,h:null,o:function(){this.a=!0}};_mcp.M=function(n,t,i){this.c=n;this.d=t;this.b=i};_mcp.M.b=function(n){var t=_j.k.i(n,"display");return t==="none"};_mcp.M.a=function(n){return n.attributes.hasOwnProperty("originalsrc")?n.attributes.getNamedItem("originalsrc").value:null};_mcp.M.prototype={c:null,d:null,b:null,a:null,dispose:function(){this.a&&(this.a=_j.m.a().b(this.a))},h:function(n,t,i){if(!this.a&&this.g(n)){var r=this;this.a=_j.m.a().a(_a.a.f,"OnComposeContentChanged",function(){var n=new _cmc.h(_a.a.f,"ProcessLinks",!1);r.f(t,i);n.b()},500)}},g:function(n){return n===2||n===9||n===6||n===1||!n},f:function(n,t){this.a=null;for(var a=_mcp.s.a(n),f=0,o=new _j.q,e=0;e<a.length;e++){var i=a[e];var l=i.className;var u=i.id;var r;var v,s;if(s=_cmc.f.a(i,v={val:r}),r=v.val,s){if(l.startsWith("OWAAutoLink")||l.startsWith("x_OWAAutoLink")){this.e(u,o);if(this.d.t(r)){f++;continue}}var h=!u.startsWith("LP")&&!_b.k.d(u);if(h||u.startsWith("LPlnk")){var c=_mcp.M.a(i);if(this.b&&this.b.a(c?c:r)){f++;h&&(i.id=_b.k.e());_j.k.d(i,_zz.Q.a);this.e(u,o);if(f>=10)continue;t(i,r)}}}}this.c.bx(o)},e:function(n,t){var i=n.indexOf("|");i>0?t.c(n.substring(0,i)):t.c(n)}};_mcp.bb=function(n){this.e=Function.createDelegate(this,this.i);_mcp.bb.initializeBase(this);this.b=_a.g.a;this.c=n};_mcp.bb.prototype={c:null,b:null,a:function(n,t,i,r){t&&n.c(t);n.b(i||this.e);r&&n.a(r);this.b.a(n)},f:function(n,t){var i=_nbs.a.Oq;this.g(n,i,null,i,null,t)},h:function(n,t,i,r,u,f){var e=t;var o=n.G;if(o){if(_g.W.a(o)){var h=o;if(h.ErrorCode===503){_j.e.a(_a.a.a,"GetErrorMessage returning service unavailable {0} since the specified exception was a service unavailable json fault body",_u.R.LX);e=_u.R.LX}else if(h.ErrorCode===408&&u){_j.e.a(_a.a.a,"GetErrorMessage returning request timeout {0} since the specified exception was a request timeout json fault body",u);e=u}else if(_g.W.c(h)&&i){_j.e.a(_a.a.a,"GetErrorMessage returning disconnected {0} since the specified exception was a disconnected json fault body",i);e=i}}if(e===t){var s=_a.c.l(o);s?r&&s==="ErrorItemNotFound"?e=r:s==="ErrorAccessDenied"?e=_u.R.Dh:f&&s==="ErrorQuotaExceeded"?e=f:_j.e.a(_a.a.cx,"CalculateInfoBarMessageId returning default id "+t+" since the specified exception was not one of the specific jsonFaultBody or response code exceptions we are currently looking for"):_j.e.b(_a.a.cx,"CalculateInfoBarMessageId returning default id "+t+" since the specified exception was not a JsonFaultBody exception or an exception with response code. The exception.Message was "+o.message)}}else _j.e.a(_a.a.a,"GetErrorMessage returning default message {0} since the exception was null",t);_j.e.a(_a.a.a,"MailComposeActionSubmitter.GetErrorMessage: showing error {0}",e);return e},g:function(n,t,i,r,u,f){var e=this.h(n,t,i,r,u,null);this.c.h(0,e,f)},i:function(n){this.f(n,null);this.d(n)},d:function(n){this.bO("MailComposeActionFailed",n)}};_mcp.b=function(){this.fU=Function.createDelegate(this,this.hd);this.w=this.I;this.cW=this.t;this.cU=this.y;this.cV=this.bt;this.eI=this.h;this.eH=this.s;_mcp.b.resolveInheritance();this.eF=this.fa;this.eE=this.fo;_mcp.b.initializeBase(this);this.i("Html"===_g.a.a().a().m()?"HTML":"Text");this.apcl(_mcp.b.c.a,this.fU);this.apcl(_mcp.b.k.a,this.fU);if(_a.m.a&&_a.m.f()){this.ey(_g.a.a().a().bH.SmimeEncrypt);this.eA(_g.a.a().a().bH.SmimeSign)}this.ft=-1;this.fb={};this.fd={}};_mcp.b.$$cctor=function(){_mcp.b.o.b(new _a.bC(_g.g));_mcp.b.i.b(new _a.bC(_g.g));_mcp.b.h.b(new _a.bC(_g.g));_mcp.b.n.b(new _a.bC(_pc.a));_mcp.b.f.b(new _a.bC(_g.Attachment));_mcp.b.j.b(new _a.bC(_g.be));_mcp.b.g.b(new _a.bC(_db.d))};_mcp.b.a=function(){_mcp.b.b||_mcp.b.d||_mcp.b.ce();return _mcp.b.b};_mcp.b.cf=function(){_mcp.b.b||_mcp.b.d||_mcp.b.ce();return _mcp.b.d};_mcp.b.ce=function(){var n=_g.a.a().c();_j.h.a(n.bH.SharePointUrl)?_mcp.b.b=n.bH.UserEmailAddress||"":_mcp.b.b=n.bH.LogonEmailAddress||"";_mcp.b.d=n.bH.UserDisplayName};_mcp.b.cc=function(n,t,i,r){if(!(i in t))return r;var u=t[i];return _j.h.a(u)?r:_j.u.b(n,u)};_mcp.b.cb=function(n,t,i){if(!(t in n))return i;var r=n[t];return _j.h.a(r)?i:Boolean.parse(r)};_mcp.b.ca=function(n){return!_j.h.b(_mcp.b.a())&&!_j.h.b(n)&&(_mcp.b.a()===n||_mcp.b.a().toLowerCase()===n.toLowerCase())};_mcp.b.ch=function(n){return n.replace(_mcp.b.cd,"\r\n")};_mcp.b.prototype={gk:null,fe:null,ff:!1,fT:null,fP:-1,fK:null,cw:function(){return this.fK},em:function(n){this.fK=n;return n},dZ:function(n){this.fP=n;return n},fW:null,ea:function(n){this.fW=n;return n},hb:function(n){this.eO("BeforeDraftUpdateEvent",n)},hC:function(n){this.eP("BeforeDraftUpdateEvent",n)},ha:function(n){this.eO("AfterDraftUpdateEvent",n)},hB:function(n){this.eP("AfterDraftUpdateEvent",n)},cX:function(n){this.eO("OnAsyncSendCallbackEvent",n)},dI:function(n){this.eP("OnAsyncSendCallbackEvent",n)},fH:!1,dj:function(){return this.fH},ce:function(n){this.fH=n;return n},d:function(){return this.eM(_mcp.b.bW)},gs:function(n){this.eK(_mcp.b.bW,n);return n},a:function(){return this.eM(_mcp.b.c)},e:function(n){this.eK(_mcp.b.c,n);return n},m:function(){return this.eM(_mcp.b.l)},p:function(n){this.eK(_mcp.b.l,n);return n},A:function(){return this.eM(_mcp.b.bt)},cM:function(n){this.eK(_mcp.b.bt,n);return n},dr:function(){return this.eM(_mcp.b.bs)},en:function(n){this.eK(_mcp.b.bs,n);return n},b:function(){this.fe||(this.fe=this.eM(_mcp.b.bu));return this.fe},cg:function(n){this.fe=n;this.eK(_mcp.b.bu,this.fe);return n},k:function(){return this.eM(_mcp.b.J)},E:function(n){if(this.k()&&n){this.k().Id=n.Id;this.k().ChangeKey=n.ChangeKey}else this.eK(_mcp.b.J,n);return n},bv:function(){return!!this.k()},bf:function(){return!this.gI()},hl:function(){return this.eM(_mcp.b.bS)},hL:function(n){this.eK(_mcp.b.bS,n);return n},I:function(){return this.eM(_mcp.b.bT)},t:function(n){this.eK(_mcp.b.bT,n);return n},y:function(){return this.eM(_mcp.b.M)},r:function(n){this.eK(_mcp.b.M,n);return n},B:function(){return this.eM(_mcp.b.bF)},cN:function(n){this.eK(_mcp.b.bF,n);return n},de:function(){return this.eM(_mcp.b.L)},br:function(n){this.eK(_mcp.b.L,n);return n},fc:null,bt:function(){return this.fc},dW:function(n){this.fc=n;return n},h:function(){return this.eM(_mcp.b.t)},i:function(n){this.eK(_mcp.b.t,n);return n},g:function(){return this.eM(_mcp.b.o)},u:function(n){this.eK(_mcp.b.o,n);return n},bV:function(){return this.eM(_mcp.b.n)},eB:function(n){this.eK(_mcp.b.n,n);return n},bp:function(){return this.eM(_mcp.b.bU)},cQ:function(n){this.eK(_mcp.b.bU,n);return n},j:function(){return this.eM(_mcp.b.i)},bb:function(n){this.eK(_mcp.b.i,n);return n},bh:function(){return this.eM(_mcp.b.v)},dN:function(n){this.eK(_mcp.b.v,n);return n},c:function(){return this.eM(_mcp.b.h)},cb:function(n){this.eK(_mcp.b.h,n);return n},N:function(){return this.eM(_mcp.b.s)},dL:function(n){this.eK(_mcp.b.s,n);return n},gE:function(){return this.eM(_mcp.b.m)},f:function(n){this.eK(_mcp.b.m,n);return n},X:function(){return this.eM(_mcp.b.W)},dY:function(n){this.eK(_mcp.b.W,n);return n},dv:function(){return this.eM(_mcp.b.bB)},fC:function(n){this.eK(_mcp.b.bB,n);return n},hk:function(){return this.eM(_mcp.b.bL)},ex:function(n){this.eK(_mcp.b.bL,n);return n},bT:function(){return this.eM(_mcp.b.bN)},cO:function(n){this.eK(_mcp.b.bN,n);return n},gF:function(){return this.eM(_mcp.b.bO)},ez:function(n){this.eK(_mcp.b.bO,n);return n},ge:function(){return this.eM(_mcp.b.p)},cC:function(n){this.eK(_mcp.b.p,n);return n},fV:null,ck:function(){return this.fV},dK:function(n){this.fV=n;return n},fD:0,O:function(){return this.fD},cc:function(n){this.fD=n;return n},fh:null,bG:function(){return this.fh},ca:function(n){this.fh=n;return n},fn:0,cx:function(){return this.fn},M:function(n){this.fn=n;return n},gC:function(){return this.eM(_mcp.b.bc)},fp:function(n){this.eK(_mcp.b.bc,n);return n},bu:function(){return this.eM(_mcp.b.k)},gp:function(n){this.eK(_mcp.b.k,n);return n},bk:function(){return this.eM(_mcp.b.bg)},gq:function(n){this.eK(_mcp.b.bg,n);return n},dk:function(){return this.eM(_mcp.b.bn)},gS:function(n){this.eK(_mcp.b.bn,n);return n},fO:function(){return this.eM(_mcp.b.br)},gT:function(n){this.eK(_mcp.b.br,n);return n},bK:function(){return this.eM(_mcp.b.T)},gM:function(n){this.eK(_mcp.b.T,n);return n},di:function(){return this.eM(_mcp.b.Y)},eb:function(n){this.eK(_mcp.b.Y,n);return n},n:function(){return this.eM(_mcp.b.P)},cF:function(n){this.eK(_mcp.b.P,n);return n},bw:function(){return this.eM(_mcp.b.bG)},es:function(n){this.eK(_mcp.b.bG,n);return n},l:function(){return this.eM(_mcp.b.bq)},cK:function(n){this.eK(_mcp.b.bq,n);return n},dx:function(){return this.eM(_mcp.b.bJ)},hK:function(n){this.eK(_mcp.b.bJ,n);return n},z:function(){return this.eM(_mcp.b.be)},ef:function(n){this.eK(_mcp.b.be,n);return n},cs:function(){return this.eM(_mcp.b.ba)},fR:function(n){this.eK(_mcp.b.ba,n);return n},Y:function(){return this.eM(_mcp.b.Z)},cd:function(n){this.eK(_mcp.b.Z,n);return n},bS:function(){return this.eM(_mcp.b.bx)},ep:function(n){this.eK(_mcp.b.bx,n);return n},bR:function(){return this.eM(_mcp.b.bw)},eo:function(n){this.eK(_mcp.b.bw,n);return n},hh:function(){return!!this.cl()},cl:function(){return this.eM(_mcp.b.u)},dM:function(n){this.eK(_mcp.b.u,n);return n},cu:function(){return this.eM(_mcp.b.bi)},eg:function(n){this.eK(_mcp.b.bi,n);return n},dg:function(){return this.eM(_mcp.b.O)},hH:function(n){this.eK(_mcp.b.O,n);return n},gB:function(){return this.eM(_mcp.b.X)},gn:function(n){this.eK(_mcp.b.X,n);return n},bJ:function(){return this.eM(_mcp.b.S)},gm:function(n){this.eK(_mcp.b.S,n);return n},cq:function(){return this.eM(_mcp.b.R)},dX:function(n){this.eK(_mcp.b.R,n);return n},hf:function(){return this.eM(_mcp.b.D)},cD:function(n){this.eK(_mcp.b.D,n);return n},he:function(){return this.eM(_mcp.b.C)},hF:function(n){this.eK(_mcp.b.C,n);return n},bn:function(){return this.eM(_mcp.b.bo)},cJ:function(n){this.eK(_mcp.b.bo,n);return n},K:function(){return this.eM(_mcp.b.K)},dS:function(n){this.hp();this.eK(_mcp.b.K,n);this.ho();return n},bg:function(){return this.eM(_mcp.b.q)},hE:function(n){this.eK(_mcp.b.q,n);return n},V:function(){return this.eM(_mcp.b.Q)},cG:function(n){this.eK(_mcp.b.Q,n);return n},s:function(){return this.eM(_mcp.b.f)},T:function(n){var i=null;if(n){i=new _j.l;for(var t=0;t<n.b();t++)i.a(n.c(t))}this.eK(_mcp.b.f,i);this.gY();return n},U:function(){return this.eM(_mcp.b.g)},cB:function(n){this.eK(_mcp.b.g,n);return n},hg:function(){return this.eM(_mcp.b.I)},hG:function(n){this.eK(_mcp.b.I,n);return n},L:function(){return this.eM(_mcp.b.bV)},eD:function(n){this.eK(_mcp.b.bV,n);return n},eR:function(){return this.eM(_mcp.b.r)},fB:function(n){this.eK(_mcp.b.r,n);return n},eU:null,eY:!1,bL:function(){return this.eY},cH:function(n){this.eY=n;return n},fA:!1,ct:function(){return this.fA},q:function(){return this.eM(_mcp.b.bE)},bs:function(n){if(n!==this.q()){this.eK(_mcp.b.bE,n);this.eN("IsCopyRestricted","IsPrintRestricted")}return n},x:function(){return this.eM(_mcp.b.A)},bq:function(n){this.eK(_mcp.b.A,n);return n},gu:!1,eu:function(n){this.gu=n;return n},Q:function(){return this.ff},ee:function(n){if(this.ff!==n){this.ff=n;n&&!this.eR()&&this.gA();this.eJ("IsEditorInitialized")}return n},fF:null,df:function(){return this.fF},dT:function(n){this.fF=n;return n},fX:!1,ek:function(n){this.fX=n;return n},bM:function(){return this.eM(_mcp.b.bf)},go:function(n){this.eK(_mcp.b.bf,n);return n},dC:function(){return this.eM(_mcp.b.bX)},fk:function(n){this.eK(_mcp.b.bX,n);return n},W:function(){return this.eM(_mcp.b.V)},gQ:function(n){this.eK(_mcp.b.V,n);return n},gD:function(){return this.eM(_mcp.b.bh)},cI:function(n){this.eK(_mcp.b.bh,n);return n},cz:function(){return this.eM(_mcp.b.bY)},gt:function(n){this.eK(_mcp.b.bY,n);return n},gh:function(){return!!this.q()&&!this.q().a()&&!this.q().e()&&!this.q().b()},bx:function(){return this.bu()&&_mcp.h.g(this)},gg:function(){return!!this.q()&&0===this.q().a()&&!this.q().j()&&!this.q().b()},be:function(){return null},ch:function(){return this.I()},bD:function(){return this.gk},bj:function(){return this.eM(_mcp.b.bb)},bB:function(n){this.eK(_mcp.b.bb,n);return n},da:function(){return this.eM(_mcp.b.x)},bA:function(n){this.eK(_mcp.b.x,n);return n},cp:function(){return this.eM(_mcp.b.H)},dR:function(n){this.eK(_mcp.b.H,n);return n},co:function(){return this.eM(_mcp.b.G)},dQ:function(n){this.eK(_mcp.b.G,n);return n},gf:function(){return this.eM(_mcp.b.F)},dP:function(n){this.eK(_mcp.b.F,n);return n},cm:function(){return this.eM(_mcp.b.z)},by:function(n){this.eK(_mcp.b.z,n);return n},cn:function(){return this.eM(_mcp.b.w)},bz:function(n){this.eK(_mcp.b.w,n);return n},db:function(){return this.eM(_mcp.b.y)},gK:function(n){this.eK(_mcp.b.y,n);return n},C:function(){return this.eM(_mcp.b.bI)},et:function(n){this.eK(_mcp.b.bI,n);return n},Z:function(){return this.eM(_mcp.b.bd)},ed:function(n){this.eK(_mcp.b.bd,n);return n},ba:function(){return this.eM(_mcp.b.bl)},ei:function(n){this.eK(_mcp.b.bl,n);return n},gi:function(){return this.H()},bU:function(){return this.eM(_mcp.b.bP)},cP:function(n){this.eK(_mcp.b.bP,n);return n},H:function(){return _a.m.a&&(this.o()||this.v())},o:function(){if(!_a.m.a||!_a.m.k()||!this.dH()||_g.a.a().a().bH.AlwaysShowFrom)return!1;var n=_g.a.a().bH.SmimeAdminSettings;return!!n&&n.AlwaysEncrypt||this.eM(_mcp.b.bM)},ey:function(n){this.eK(_mcp.b.bM,n);this.eJ(_mcp.b.e);_j.e.a(_a.a.k,"Context.SmimeEncryptMessage is set to {0}",n);return n},v:function(){if(!_a.m.a||!_a.m.k()||!this.dH()||_g.a.a().a().bH.AlwaysShowFrom)return!1;var n=_g.a.a().bH.SmimeAdminSettings;return!!n&&n.AlwaysSign||this.eM(_mcp.b.bQ)},eA:function(n){this.eK(_mcp.b.bQ,n);this.eJ(_mcp.b.e);_j.e.a(_a.a.k,"Context.SmimeSignMessage is set to {0}",n);return n},dA:function(){return _g.a.a().bH.SmimeAdminSettings&&(_g.a.a().bH.SmimeAdminSettings.AlwaysEncrypt||_g.a.a().a().bH.AlwaysShowFrom)||this.z()?!1:!0},dB:function(){return _g.a.a().bH.SmimeAdminSettings&&(_g.a.a().bH.SmimeAdminSettings.AlwaysSign||_g.a.a().a().bH.AlwaysShowFrom)||this.z()?!1:!0},ft:0,bi:function(){return this.eM(_mcp.b.B)},fQ:function(n){this.eK(_mcp.b.B,n);return n},ds:function(){return this.eM(_mcp.b.bv)},gr:function(n){this.eK(_mcp.b.bv,n);return n},bO:function(){if(this.bu()||_y.c.a.i()||this.H())return!1;var n=this.q();return!n||!!n.a()||n.b()},bN:function(){return _a.g.b?!1:this.a()!==8&&!this.R()},fj:function(){return this.eM(_mcp.b.bk)},hI:function(n){this.eK(_mcp.b.bk,n);return n},fJ:!1,gv:!1,bo:function(){return this.gv},fq:null,dh:function(){return this.fq},dV:function(n){this.fq=n;return n},dz:function(){return this.eM(_mcp.b.bK)},ew:function(n){this.eK(_mcp.b.bK,n);return n},fL:!1,dy:function(){return this.fL},ev:function(n){this.fL=n;return n},R:function(){return this.a()===11||this.a()===12||this.a()===13},bH:function(){return this.eM(_mcp.b.bz)},D:function(n){this.eK(_mcp.b.bz,n);return n},fy:function(){return this.eM(_mcp.b.by)},bc:function(n){this.eK(_mcp.b.by,n);return n},hm:function(){return this.eM(_mcp.b.bZ)},bd:function(n){this.eK(_mcp.b.bZ,n);return n},dw:function(){return this.eM(_mcp.b.bD)},er:function(n){this.eK(_mcp.b.bD,n);return n},P:function(){return this.eM(_mcp.b.j)},dU:function(n){this.eK(_mcp.b.j,n);return n},bm:function(){return this.eM(_mcp.b.bj)},eh:function(n){this.eK(_mcp.b.bj,n);return n},dl:function(){return this.eM(_mcp.b.bp)},ej:function(n){this.eK(_mcp.b.bp,n);return n},cr:function(){return this.eM(_mcp.b.U)},gP:function(n){this.eK(_mcp.b.U,n);return n},hj:function(){return this.eM(_mcp.b.bH)},hJ:function(n){this.eK(_mcp.b.bH,n);return n},cy:function(){this.fT||(this.fT=this.bY());return this.fT},cS:function(){return this.eM(_mcp.b.bA)},bE:function(n){this.eK(_mcp.b.bA,n);return n},bI:function(){return this.eM(_mcp.b.E)},cE:function(n){this.eK(_mcp.b.E,n);return n},bl:function(){if(this.P()){var n=_g.c.a(this.P().f(),_g.c.d());return!!n&&n.bH.Value.toUpperCase()==="TRUE"}return!1},cf:function(n){_j.e.a(_a.a.a,"Setting IsOmeRequested to {0}",n);this.hO(n);return n},bQ:function(){if(!this.P())return null;var n=_g.c.a(this.P().f(),_g.c.c());if(n&&n.bH.Value){var i=n.bH.Value;var t=_a.d.b(i);t||_j.e.c(_a.a.U,"Attempt to get OME expiration time but value in extended property cannot be parsed into a datetime object.  Value: {0}",i);return t}else return null},cL:function(n){_j.e.a(_a.a.a,"Setting OmeTimeExpiration to {0}",n);this.hP(n?_a.d.m(n):"");return n},hi:function(){return this.a()===1||this.a()===2||this.fE===1},fv:null,cv:function(){return this.fv},el:function(n){this.fv=n;return n},fw:null,eq:function(n){this.fw=n;return n},fb:null,dt:function(){return this.fb},dm:function(){return _cmc.g.c(_g.cx,this.fb,_cmc.b.b,null)},fd:null,du:function(){return this.fd},cZ:function(){return _cmc.e.b(this.fd,this.fG,!0)},fG:null,fz:null,dc:function(){return this.fz},dO:function(n){this.fz=n;return n},fE:0,dd:function(){return this.fE},fx:!1,bW:function(){return this.fx},eC:function(n){this.fx=n;return n},fY:!1,dn:function(){return this.fY},gc:null,dq:function(){return this.gc},fZ:null,dp:function(){return this.fZ},gb:null,bP:function(){return this.gb},fs:!1,ec:function(n){this.fs=n;return n},cj:function(){return this.eM(_mcp.b.bR)},gV:function(n){this.eK(_mcp.b.bR,n);return n},ci:function(){return this.eM(_mcp.b.N)},gL:function(n){this.eK(_mcp.b.N,n);return n},eG:function(){return this.eM(_mcp.b.bC)},gU:function(n){this.eK(_mcp.b.bC,n);return n},cT:function(){return this.eM(_mcp.b.bm)},gR:function(n){this.eK(_mcp.b.bm,n);return n},fg:null,fi:null,dD:function(n){return _dg.l.isInstanceOfType(n)?2:1},hw:function(n){this.p(_mcp.b.cc(_y.fv,n,_mcp.b.l.a,0));this.e(_mcp.b.cc(_y.m,n,_mcp.b.c.a,0));this.f(_mcp.b.cb(n,_mcp.b.m.a,!0));var t=_mcp.b.cb(n,"IsCalendarItem",!1);this.dM(t?1:0);if(n&&"StoreId"in n){this.fp(!1);this.hL(n.StoreId)}this.hx(n);this.cK(0===this.a()||4===this.a())},dE:function(n){_g.cE.isInstanceOfType(n)?this.e(1):_g.cD.isInstanceOfType(n)?this.e(2):_g.cQ.isInstanceOfType(n)&&this.e(3);this.gZ(n,n.f());this.cM(n.bH.ReferenceItemId);this.en(n.t());this.E(n.bH.ItemId);this.t(n.bH.Subject);this.r(n.f().bH.Value);this.cF(n.bH.From);this.u(n.q()?n.q().f:null);this.bb(n.A()?n.A().f:null);this.cb(n.E()?n.E().f:null);this.f(!1);this.dY(n.bg());this.fM(n);this.bs(n.bY());this.et(n.cp());this.ed(n.bH.IsDeliveryReceiptRequested);this.ei(n.bH.IsReadReceiptRequested);this.eb(n.bH.InternetMessageId);this.gx(n);this.gH(n);this.cK(!1);this.fp(!0);_j.e.a(_a.a.a,"Initialized context with smart response")},cA:function(n){if(!n)throw Error.argumentNull("message");this.gZ(n,n.X());this.dS(n);this.E(n.bH.ItemId);this.t(n.bH.Subject);var u=this.a()===16;u?this.r(n.cf().bH.Value):this.r(n.cS()?n.cS().bH.Value:n.X().bH.Value);this.hq();this.fQ(n.bH.ConversationId);if(_g.i.isInstanceOfType(n)){var t=n;this.cF(t.bH.From);this.u(t.q()?t.q().x():null);this.bb(t.A()?t.A().x():null);this.cb(t.E()?t.E().x():null);this.ed(t.bH.IsDeliveryReceiptRequested);this.ei(t.bH.IsReadReceiptRequested);this.eb(t.bH.InternetMessageId);if(t.bH.ParentMessageId){this.cM(t.bH.ParentMessageId);this.fE=t.ee()}n.dI()&&_cmc.g.f(n.dI(),this.fb,this.fd,_mco.i.b);n.cQ()&&(this.fG=n.cQ())}else if(_g.bl.isInstanceOfType(n)){var f=n;this.cF(f.bH.From)}this.fg=n.cC();this.fi=n.cs();this.fs||this.f(!1);this.dY(n.bg());this.fM(n);this.bs(n.bY());this.et(n.cp());n.bY()&&!n.bY().a()?this.i(n.bY().h()):n.cS()?this.i(n.cS().a()):this.i(n.ej()===1?"Text":"HTML");this.gp(_dg.r.isInstanceOfType(n));if(this.bu()){var i=n;this.fN(i.I());this.gq(_dg.m.isInstanceOfType(i));i.bH.From&&this.cF(i.bH.From);i.bH.Sender&&this.es(i.bH.Sender)}n.dp()&&n.dp().b()?this.T(n.dp()?n.dp().f:null):(!this.fj()||this.l())&&this.T(n.bi()?n.bi().f:null);if(this.s()&&(u&&n.cf().a()==="Text"||n.X()&&n.X().a()==="Text"))for(var r=0;r<this.s().b();r++)this.s().c(r)&&this.s().c(r).a()&&this.s().c(r).h(!1);this.gH(n);this.cK(!0);this.fp(!0);_j.e.a(_a.a.a,"Initialized context with draft")},dF:function(n,t,i){this.fQ(n);this.cM(t.bH.ItemId);this.fA=!0;this.cg(this.K());this.fY=i;if(i){this.gc=t.q().e();this.fZ=t.A().e();this.gb=t.bH.Sender.Mailbox}},S:function(n){this.cg(n);this.ht(n)},gG:function(){this.eT("OnAsyncSendCallbackEvent",this)},hq:function(){this.eS("OnInitializingDraftContentEvent")},hs:function(){this.eS("OnPrepareQuotedBodyEvent")},hp:function(){this.eT("BeforeDraftUpdateEvent",this)},ho:function(){this.eT("AfterDraftUpdateEvent",this)},G:function(n){var i=new _g.i;var t;this.gW(i,t={val:n}),n=t.val;return i},bF:function(n){var i=new _g.bl;var t;this.gW(i,t={val:n}),n=t.val;return i},cY:function(){var t=this.gz();_a.c.b(this.fc,"GetEditorContentCommand");this.fc.a();var n=this.y();t.a()==="Text"&&(n=_mcp.b.ch(n));t.b(n);this.ft=_j.h.a(n)?0:n.length;_j.e.a(_a.a.a,"MailComposeContext.CreateBodyFromEditor, ContentLength: {0}",this.ft);return t},hN:function(n){var t=this.eR();if(!t||this.X()===t.i()){this.dY(n);t&&t.A(n)}},gA:function(){if(this.ff&&this.fX){this.fc.a();if(this.eR()){_mcp.c.z(this.eR(),this);_j.e.a(_a.a.a,"Updated baseline")}else{this.fB(_mcp.c.b(this));_j.e.a(_a.a.a,"Captured baseline for the first time");if(this.fJ&&this.eU){this.eU.r(this.eR().a());this.fJ=!1}if(!this.k()||this.fj()&&this.dC()){this.eU=_mcp.c.b(this);_j.e.a(_a.a.a,"Captured initial baseline for context")}}}},gI:function(){if(!this.eR())return!1;this.fc&&this.fc.a();return!this.eR().t(this)},bZ:function(n,t){var i=null;if(this.h()!=="HTML"||t)i=this.y();else{var u,r;r=_a.B.a(this.y(),u={val:i}),i=u.val,r}i=i?i.length>n?i.substr(0,n)+"...":i:"";return i},fl:function(n,t,i,r,u){this.u(new _j.l);var f=n?n.Mailbox:null;this.a()!==8&&this.gn(!0);if(f&&_mcp.b.ca(f.EmailAddress)){var l;var c;if(this.a()===1&&(l=t?t.b():0)+(c=i?i.b():0)+(r?r.b():0)===1){this.gn(!1);l===1?this.g().a(t.c(0)):c===1?this.g().a(i.c(0)):this.g().a(r.c(0))}else this.a()===2&&this.gn(!1)}if(this.a()===8&&this.gB()||this.a()!==8&&(!u||!u.b())&&f&&this.gB()){this.g().a(f);_j.e.a(_a.a.a,"Adding original From to To, Operation = {0}; From= {1}; Self= {2}",this.a(),_g.n.n(n),_mcp.b.a())}if(this.a()===2||this.a()===8){_j.e.a(_a.a.a,"Adding {0} To recipients to To.",t?t.b():0);this.gd(t,this.g(),f,null);_j.e.a(_a.a.a,"Adding {0} Cc recipients to Cc.",i?i.b():0);this.bb(new _j.l);this.gd(i,this.j(),f,this.g());_j.e.a(_a.a.a,"Adding {0} Bcc recipients to Bcc.",r?r.b():0);this.cb(new _j.l);this.gd(r,this.c(),f,this.g())}if(u&&u.b()>0)if(this.a()===1){this.g().g();for(var e=0;e<u.b();e++){var a=u.c(e);this.g().a(a)}}else if(this.a()===2)for(var o=0;o<u.b();o++){var s=u.c(o);var v=this;if(this.g().b()===this.g().k(function(n){return _g.n.a(s,n)})){var y=this;var h=this.j().k(function(n){return _g.n.a(s,n)});h!==this.j().b()&&this.j().n(h);this.g().a(s)}}if(this.a()!==8&&f&&0===this.g().b()&&(!this.j()||0===this.j().b())){this.g().a(f);_j.e.a(_a.a.a,"Adding original From since there are no recipients left, From = {0}",_g.n.n(n))}this.gw()},dJ:function(){_j.e.a(_a.a.a,"Context reset start.");this.gs(null);this.fc=null;this.a()&&this.e(0);this.m()&&this.p(0);this.A()&&this.cM(null);this.b()&&this.cg(null);this.k()&&this.E(null);_j.h.a(this.I())||this.t(null);_j.h.a(this.y())||this.r("");this.g()&&this.u(null);_j.h.a(this.bp())||this.cQ(null);this.j()&&this.bb(null);_j.h.a(this.bh())||this.dN(null);this.c()&&this.cb(null);_j.h.a(this.N())||this.dL(null);this.gE()||this.f(!0);this.X()!=="Normal"&&this.dY("Normal");_j.h.a(this.dv())||this.fC(null);this.gC()&&this.fp(!1);this.bu()&&this.gp(!1);this.bk()&&this.gq(!1);this.dk()&&this.gS(!1);this.fO()&&this.gT(null);this.bK()&&this.gM(!1);this.di()&&this.eb(null);this.cj()&&this.gV(null);this.ci()&&this.gL(null);this.eG()&&this.gU(null);this.cT()&&this.gR(!1);this.n()&&this.cF(null);this.bw()&&this.es(null);this.l()&&this.cK(!1);this.z()&&this.ef(!1);this.cs()&&this.fR(!1);this.Y()&&this.cd(!1);this.s()&&this.T(null);this.U()&&this.cB(null);this.L()&&this.eD(!1);this.eR()&&this.fB(null);this.bJ()&&this.gm(!1);this.cq()&&this.dX(!1);this.bn()&&this.cJ(!1);this.K()&&this.dS(null);this.q()&&this.bs(null);_j.h.a(this.x())||this.bq(null);this.bj()&&this.bB(!1);_j.h.a(this.da())||this.bA(null);_j.h.a(this.cm())||this.by(null);_j.h.a(this.cn())||this.bz(null);this.db()&&this.gK(!1);this.C()!=="Normal"&&this.et("Normal");this.Z()&&this.ed(!1);this.ba()&&this.ei(!1);this.o()&&this.ey(!1);this.v()&&this.eA(!1);this.gF()&&this.ez(null);this.bi()&&this.fQ(null);_j.h.a(this.ds())||this.gr(null);this.cl()&&this.dM(0);this.cu()&&this.eg(!1);this.bM()&&this.go(!1);this.gD()&&this.cI(!1);this.P()&&this.dU(null);this.fx&&(this.fx=!1);this.fg&&(this.fg=null);this.fi&&(this.fi=null);if(this.bH()){_y.l.a(this.bH(),null,"ContextReset",null,null);this.D(null)}_j.e.a(_a.a.a,"Context reset end.")},dG:function(){return!!this.b().bY()&&0===this.b().bY().a()&&!this.b().bY().m()&&!this.b().bY().n()},bX:function(){var n=null;if(this.n()&&this.n().Mailbox&&!_j.h.a(this.n().Mailbox.EmailAddress))n=this.n().Mailbox;else if(this.bw()&&this.bw().Mailbox&&!_j.h.a(this.bw().Mailbox.EmailAddress))n=this.bw().Mailbox;else if(!_j.h.a(_mcp.b.a())){n=new _g.g;n.EmailAddress=_mcp.b.a();n.Name=_mcp.b.cf();n.MailboxType="Mailbox";n.RoutingType="SMTP"}return n},dH:function(){if(!_a.m.a||_a.m.t)return!1;switch(this.a()){case 0:case 1:case 2:case 3:case 4:break;default:return!1}return this.K()&&!this.gj(this.K())?!1:this.b()&&!this.gj(this.b())?!1:_j.h.a(this.bI())?!0:!1},gj:function(n){if(_j.h.a(n.bH.ItemClass)||n.bH.ItemClass==="IPM.Note"||n.bA())return!0;else{var i=this.a()===1||this.a()===2;var t=i||this.a()===3;return i&&(n.bH.ItemClass.startsWith("IPM.Schedule.Meeting")||n.bH.ItemClass.startsWith("IPM.Appointment"))?!0:t&&n.bH.ItemClass.startsWith("REPORT.IPM.Note")?!0:t&&n.bH.ItemClass.startsWith("IPM.Note.Rules")?!0:t&&n.bH.ItemClass==="IPM.Post"?!0:!1}},cR:function(n){_j.e.a(_a.a.k,"Updating S/MIME options...");if(_a.m.a)switch(n){case 6:this.ey(!0);this.eA(!1);break;case 10:case 11:this.ey(!1);this.eA(!0);break;case 12:case 13:case 14:this.ey(!0);this.eA(!0);break;case-1:case 0:default:this.ey(!1);this.eA(!1);break}},hQ:function(n){_j.e.a(_a.a.k,"Upgrading S/MIME options...");if(_a.m.a)switch(n){case 6:this.ey(!0);break;case 10:case 11:this.eA(!0);break;case 12:case 13:case 14:this.ey(!0);this.eA(!0);break;case-1:case 0:default:break}},bC:function(){if(this.bH()){var t=!1;var n=this;this.gk=function(i){if(!t&&n.bH()){_y.l.a(n.bH(),null,i);n.D(null);t=!0}}}},bY:function(n,t){var i=this.gF();if(!i||!i.length)return null;_j.C.a(n)&&(n=0);_j.C.a(t)&&(t=i.length);for(var r=new _j.q,h=n;h<n+t;h++){var s=i[h];if(s&&s.length)for(var a=s,v=a.length,f=0;f<v;++f){var u=a[f];_j.h.a(u)||r.g(u)||r.c(u)}}if(n+t<i.length){var o=i[i.length-1];if(o&&o.length>0)for(var l=o,y=l.length,e=0;e<y;++e){var c=l[e];_j.h.a(c)||r.g(c)||r.c(c)}}return r.d.length>0?r.d:null},gW:function(n,t){t.val=!!t.val!==t.val?!1:t.val;n.cW(this.I());n.em(this.X());n.cc(this.k());n.bp(new(_a.fT.$$(_g.Attachment,_g.bq)));n.gK(this.fi);n.gC(this.fg);if(this.H()){var s=_g.a.a().bH.SmimeAdminSettings.ClearSign;n.fW(this.o()?"IPM.Note.SMIME":s?"IPM.Note.SMIME.MultipartSigned":"IPM.Note.SMIME");n.bH.ItemClass==="IPM.Note.SMIME.MultipartSigned"?n.da(this.gy(t.val)):n.da(new _g.y(new _g.t(this.h(),"")));var o=_a.bf.a(this.hk());n.jt(new _g.eF(o))}else{n.da(this.gy(t.val));(this.K()&&this.K().bA()||this.b()&&this.b().bA())&&n.fW("IPM.Note");this.s()&&n.bi().g(this.s().f())}n.X().k(this.hf());n.X().j(this.he());n.jy(this.q());n.dY(this.C());n.fV(this.bj());n.fQ(this.cm());n.fR(this.cn());n.fT(this.da());n.hC(this.cp());n.hB(this.co());n.hA(this.gf());n.jm(this.hg());if(this.P()){n.gF(new(_a.fT.$$(_g.be,_g.T)));n.bV().g(this.P().f())}if(_g.i.isInstanceOfType(n)){var i=n;i.cI(this.n());_cmc.b.e(i.X().bH.Value,i.bH.Subject,this.fb);_cmc.e.a(i.X().bH.Value,i.bH.Subject,this.fd);var e=_cmc.b.d(i.X().bH.Value,i.bH.Subject,this.fb);i.gD(e);this.hz(e);_cmc.g.b(i,this.fb,this.dm(),this.fd,this.cZ());if(this.H()&&this.fn){if(this.fn===1){i.cw(new _a.j);this.g()&&i.q().g(this.g().f());i.cv(new _a.j);this.j()&&i.A().g(this.j().f())}else if(this.fn===2){i.cz(new _a.j);this.c()&&i.E().c(this.c().c(this.fD))}else if(this.fn===3){i.cz(new _a.j);this.c()&&i.E().g(this.c().f())}}else{i.cw(new _a.j);this.g()&&i.q().g(this.g().f());i.cv(new _a.j);this.j()&&i.A().g(this.j().f());i.cz(new _a.j);this.c()&&i.E().g(this.c().f())}i.df(this.Z());i.dk(this.ba());i.et(this.o());i.eu(this.v());this.di()&&i.dd(this.di())}else{var u=n;u.db(this.bR());var f=_g.a.a().c();var r=null;r=_j.h.a(f.bH.LogonEmailAddress)?null!==this.n()&&this.n().Mailbox?this.n().Mailbox.EmailAddress:_mco.a.g(null)||f.bH.UserEmailAddress:f.bH.LogonEmailAddress;if(r){u.o(new _g.R);u.bH.From.Mailbox=new _g.g;u.bH.From.Mailbox.EmailAddress=r}}},hz:function(n){if(n){var r="AtAllMention_Mail_";r=r+(this.eY?"Group_":"ME_");var h=_y.m.toString(this.a());var e=new _a.bt(1,r+h);_a.A.b.a(e);for(var t=this.g(),i=!1,u=0;u<t.b();u++)if(t.c(u).MailboxType==="GroupMailbox"){i=!0;break}if(!i){t=this.j();for(var f=0;f<t.b();f++)if(t.c(f).MailboxType==="GroupMailbox"){i=!0;break}}if(!i){t=this.c();for(var o=0;o<t.b();o++)if(t.c(o).MailboxType==="GroupMailbox"){i=!0;break}}var s="MsgHasAtleastAGroup_";i||(s="MsgHasNoGroup_");e=new _a.bt(1,r+s+h);_a.A.b.a(e)}},gd:function(n,t,i,r){if(n)for(var f=0;f<n.b();f++){var u=n.c(f);if(_g.n.a(u,i)){_j.e.a(_a.a.a,"Excluding original from {0}",i);continue}if(_mcp.b.ca(u.EmailAddress)||this.hy(u.EmailAddress)){_j.e.a(_a.a.a,"Excluding self address {0}",_mcp.b.a()||"null");continue}var e=this;if(r&&r.b()!==r.k(function(n){return _g.n.a(u,n)})){_j.e.a(_a.a.a,"Excluding address {0} already in to",u);continue}t.a(u)}},hy:function(n){var t=this.n();return!!t&&!!t.Mailbox&&t.Mailbox.EmailAddress===n},hd:function(n,t){this.eJ("ShowMeetingReadonlyFields")},hx:function(n){var t=this.hA(n);switch(this.a()){case 0:case 4:this.E(t);break;case 1:case 2:case 3:this.cM(t);break}},gH:function(n){if(n.bV()){this.dU(new _j.l);this.P().j(n.bV().e())}},hA:function(n){var t=null;if(n&&"Id"in n){t=new _g.e(n.Id);"ChangeKey"in n&&(t.ChangeKey=n.ChangeKey)}return t},gZ:function(n,t){0===n.ej()&&n.gJ(t&&t.a()==="Text"?1:3)},hv:function(n){var r=_mco.a.g(n);if(r){this.cF(new _g.R);this.n().Mailbox=new _g.g;this.n().Mailbox.EmailAddress=r}this.dM(0);switch(this.a()){case 1:case 2:case 12:this.fM(n);if(_g.i.isInstanceOfType(n)){var t=n;t.H()?this.fl(t.bH.From||t.bH.Sender,null,null,null,null):this.fl(t.bH.From||t.bH.Sender,t.q()?t.q().f:null,t.A()?t.A().f:null,t.E()?t.E().f:null,t.dx()?t.dx().f:null);this.gS(this.a()===2&&n.ja()&&!t.bH.IsGroupEscalationMessage);this.en(n.fs())}else if(_g.bl.isInstanceOfType(n)){var i=n;this.fl(i.bH.From||i.bH.Sender,null,null,null,null)}this.gl(n);break;case 3:_dg.r.isInstanceOfType(n)||this.fM(n);this.en(n.fs());this.gw();this.gl(n);this.hD(n);break;case 9:case 10:_g.i.isInstanceOfType(n)?this.fl(n.bH.Sender,null,null,null,null):_g.bl.isInstanceOfType(n)&&this.fl(n.bH.Sender,null,null,null,null);this.gl(n);break;case 5:case 6:case 7:default:this.gX();break}_j.e.a(_a.a.a,"Initialized context with original email message")},ht:function(n){this.cM(n.bH.ItemId);var i=this.dG();this.bs(i?null:n.bY());this.hM(n.de());this.et(n.cp());this.r(this.y()||"");this.gx(n);if(!this.l()){this.cK(!(this.a()===1||this.a()===2||this.a()===3||this.a()===12));this.a()!==3||_a.m.a&&n.bA()||i||this.q()&&this.q().a()||this.T(n.bi()?n.bi().f:null)}if(_dg.ICalendaring.isInstanceOfType(n)){var t=n;t.bt();this.hu(t)}else if(_g.i.isInstanceOfType(n)||_g.bl.isInstanceOfType(n)){if(3===this.a()&&!this.l()){this.dY(n.bg());_j.e.a(_a.a.a,"Setting importance to {0} since we are forwarding item {1} with that importance",this.X(),_h.G.c(n.bH.ItemId))}this.hv(n)}else throw Error.invalidOperation(String.format("Original item of type {0} is not supported.",Object.getType(n).getName()));this.gY();_g.i.isInstanceOfType(n)&&n.co?this.fp(!1):this.fp(!0)},gx:function(n){n.cS()&&this.i(n.cS().a())},hn:function(n){var t=null;_dg.t.isInstanceOfType(n)||_dg.q.isInstanceOfType(n)?t=n.bH.From:n.y()?t=n.y():_j.e.c(_a.a.a,"ICalendaring doesnt have an organizer");return t},gY:function(){var n=new _j.q;this.bk()&&n.h(_dg.m.a(this.s()));if(this.fe&&_a.m.a&&this.fe.bA()&&this.fe.eB()){var t=this.fe.bi().a(0).bH.AttachmentId.Id;n.c(t)}this.hE(n.i())},hu:function(n){this.dM(this.dD(n));var u=this.hn(n);var t;var r;if(_dg.t.isInstanceOfType(n)||_dg.q.isInstanceOfType(n)){t=n.q()?_g.n.g(n.q().f):null;r=n.A()?_g.n.g(n.A().f):null}else{t=n.v()?_g.n.g(_dg.d.d(n.v().f)):null;r=n.t()?_g.n.g(_dg.d.d(n.t().f)):null}if(_dg.l.isInstanceOfType(n)){var i=n;if(!_j.h.a(i.bH.CustomerEmail)&&_a.J.a(i.bH.CustomerEmail)){var f=new _g.g;f.EmailAddress=i.bH.CustomerEmail;f.Name=_j.h.b(i.bH.CustomerName)?i.bH.CustomerEmail:i.bH.CustomerName;t.a(f)}}switch(this.a()){case 1:case 2:this.fl(u,t,r,null,null);break;case 5:case 6:case 7:this.fl(u,t,r,null,null);this.fN(n);this.gQ(!0);break;case 8:var e=n.v().t();e.g(n.O().e());t=_g.n.g(_dg.d.d(e.f));this.fl(u,t,r,null,null);this.fN(n);this.gQ(!0);break;case 3:_dg.a.isInstanceOfType(n)&&n.iI();if(_dg.m.isInstanceOfType(n)||_dg.a.isInstanceOfType(n)){this.gq(!0);this.cF(u);this.fN(n)}break;default:this.gX();break}this.gp(!0);_j.e.a(_a.a.a,"Initialized context from original calendar item")},fN:function(n){this.hc(n);this.gT(n.x());this.gM(!!this.fO()&&!_j.h.a(this.fO().bH.DisplayName))},hM:function(n){var t="";switch(this.a()){case 1:case 2:case 12:t=_u.n.OC;break;case 3:t=_nbs.a.cZ;break;case 5:t=_nbs.a.wV;break;case 6:t=_nbs.a.lV;break;case 7:t=_nbs.a.ik;break;case 8:t=_nbs.a.Uw;break;case 9:t=_nbs.a.se;break;case 10:t=_nbs.a.PW;break}var i=String.format(_nbs.a.nW,t,n);_j.e.a(_a.a.a,"Formatted subject with Prefix = {0}; Operation = {1}",t,this.a());if(255<i.length){this.t(i.substr(0,255));_j.e.a(_a.a.a,"Truncated subject from {0} to {1} to meet the {2} characters rule.",i,this.I(),255)}else this.t(i)},gl:function(n){this.fQ(n.bH.ConversationId);_g.i.isInstanceOfType(n)?this.gr(n.bH.InternetMessageId):_g.bl.isInstanceOfType(n)&&this.gr(n.bH.InternetMessageId)},gX:function(){var n=_j.u.c(_y.m,this.a());throw Error.invalidOperation(String.format("Cannot perform operation {0} with original item.",n));},fM:function(n){this.bB(n.eh());this.bA(n.fq());this.by(n.fn());this.bz(n.fp());this.gK(n.iS())},gy:function(n){return n?this.gz():this.cY()},gz:function(){var n=new _g.y(new _g.t("HTML",""));n.b("");if(4!==this.a()&&13!==this.a()||this.dw()){_j.e.a(_a.a.a,"Create new body for action email message, setting body type to context body type: {0}",this.h());n.c(this.h())}else{_j.e.a(_a.a.a,"Create new body for action email message, setting body type to text due to lack of support for RichTextEditor.");n.c("Text")}return n},gw:function(){if(_y.c.a.i()){var n=this.bX();if(n){if(!this.gJ(this.g(),n.EmailAddress)&&!this.gJ(this.j(),n.EmailAddress)){this.j()||this.bb(new _j.l);this.j().a(n);_j.e.a(_a.a.a,"Adding self to CC")}}else _j.e.c(_a.a.a,"Could not add self to CC as the address was missing")}},gJ:function(n,t){if(n)for(var i=0;i<n.b();i++){var r=n.c(i);if(t.toLowerCase()===r.EmailAddress.toLowerCase())return!0}return!1},hO:function(n){var t=null;if(n){this.P()?t=_g.c.a(this.P().f(),_g.c.d()):this.dU(new _j.l);if(!t){var i=new _g.T;i.ExtendedFieldURI=_g.c.d();t=new _g.be(i);this.P().a(t)}t.b("True")}else{if(!this.P())return;t=_g.c.a(this.P().f(),_g.c.d());t&&t.b("False")}},hc:function(n){this.gV(n.c());this.gL(n.f());this.gU(n.L());this.gR(n.R())},hP:function(n){var t=null;if(_j.h.a(n)){if(!this.P())return;t=_g.c.a(this.P().f(),_g.c.c());if(t){t.b(undefined);this.P().p(t,!0)}}else{this.P()?t=_g.c.a(this.P().f(),_g.c.c()):this.dU(new _j.l);if(!t){var i=new _g.T;i.ExtendedFieldURI=_g.c.c();t=new _g.be(i);this.P().a(t)}t.b(n)}},hD:function(n){if(_a.g.b){var t=n.bV()?_g.c.a(n.bV().e(),_g.c.c()):null;t&&this.cL(_a.d.b(t.bH.Value))}}};_mcp.C=function(n,t,i,r){_j.s.a(n,"mailComposeContextAsyncFactory");_j.s.a(t,"mailComposeConductorSelector");_j.s.a(i,"urlParameters");this.n=n;this.m=t;this.o=i;this.l=r};_mcp.C.a=function(n,t,i,r){r.val=null;var u=n.a[t];if(_j.h.b(u))return!1;else{r.val=i?u.replace(_a.w.l," "):u;return!0}};_mcp.C.prototype={h:0,c:function(n){this.h=n;return n},i:null,e:function(n){this.i=n;return n},k:!1,d:function(n){this.k=n;return n},j:null,f:function(n){this.j=n;return n},n:null,m:null,o:null,l:null,a:function(n){var t=this;this.n.a(function(n){var i=n.a(!1,!0);i.p(t.h);i.e(0);t.g(i,t.i,t.o);t.p(i);var u=t.j?t.j.g:null;var f=t.m.a(u,t.h,u?u.o():0,null);f.a(i);var r=new _a.l;r.a("pid",i.dc());r.c("f",t.k);t.i.m=r.toString();_a.b.a(t.i)});return this.h===3},g:function(n,t,i){try{var r=null;var l,c;if(c=_mcp.C.a(i,"mailtouri",!0,l={val:r}),r=l.val,c)_y.u.a(r,n,this.l.b());else{var a,y;(y=_mcp.C.a(i,"subject",!0,a={val:r}),r=a.val,y)&&n.t(r);var v,h;if(h=_mcp.C.a(i,"body",!0,v={val:r}),r=v.val,h){n.r(_a.B.b(r,!0,!0));n.i("HTML")}var f,u;(u=_mcp.C.a(i,"to",!1,f={val:r}),r=f.val,u)&&n.cQ(r)}var e,s;(s=_mcp.C.a(i,"pid",!1,e={val:r}),r=e.val,s)&&n.dO(r)}catch(p){var o="Could not parse optional deep-link parameters.";_j.e.d(_a.a.a,p,o);t.p=o;t.n=Object.getType(p).getName();return}},p:function(n){var t=window.self.leanPopoutDraftItemId;if(!_j.h.a(t)){n.E(new _g.e(_ff.g.b(t)));n.e(4);n.ec(!0);_j.k.e(document.body,"mainWindow")}}};_mcp.D=function(n){this.e={};this.f=n};_mcp.D.prototype={f:null,a:function(n){return n in this.e},d:function(n,t){if(n in this.e){var i=this.e[n];!i.a&&t&&(this.e[n]=new _mcp.bf(t))}else this.e[n]=new _mcp.bf(t)},g:function(n,t){var u=n.a;var r=u.ba;var i=r.d();var o=r.K();var f=!1;if(r.bM())_j.e.a(_a.a.a,"Not discarding a loaded draft for context {0}",i);else if(r.bJ())_j.e.a(_a.a.a,"Not discarding an explicitly saved draft for context {0}",i);else if(u.bl().f())_j.e.a(_a.a.a,"Not discarding a draft currently being explicitly saved for context {0}",i);else if(u.bg().b())_j.e.a(_a.a.a,"Not discarding a draft currently being sent for context {0}",i);else if(u.cq)_j.e.a(_a.a.a,"Not discarding a message that was sent {0}",i);else{var e=!1;if(t)_j.e.a(_a.a.a,"Skipping dirty check for context {0}",i);else{_j.e.a(_a.a.a,"Checking dirty for determining whether to discard unused message on navigate away.");e=u.cb()}if(e)_j.e.a(_a.a.a,"Not discarding a dirty draft for context {0}",i);else if(r.eU)if(r.eU.s(r.eR())){if(_g.k.b&&r.bn()&&!r.k()){_j.e.a(_a.a.a,"Calling main window to remember the pending discard for context {0}",i);_g.k.b.ku(i,!r.bJ());f=!0}else if(!r.R()){_j.e.a(_a.a.a,"Discarding unused draft for context {0}",i);this.b(i,o,u.bp,r.bJ());f=!0}}else _j.e.a(_a.a.a,"Not discarding a draft different from the initial baseline for context {0}",i);else _j.e.a(_a.a.a,"Not discarding without an initial baseline for context {0}",i)}return f},b:function(n,t,i,r){i||(i=new _mcp.bb(new _bc.b));var u;if(this.e[n]){var e=this.e[n];u=e.a}else u=!r;if(t){var f=this.f.a(t,u);i.a(f,null,null,null);delete this.e[n];_j.e.a(_a.a.a,"Delete action submitted, ID={0}, Changekey={1}, isHardDelete={2}",t.bH.ItemId.Id,t.bH.ItemId.ChangeKey,u)}else{this.e[n]=new _mcp.bf(u);_j.e.a(_a.a.a,"Discard pending because we do not have the draft ID yet. ContextId={0}; Hard={1}",n,u)}},c:function(n,t){this.b(n,t,new _mcp.bb(new _bc.b),!1)}};_mcp.c=function(){_mcp.c.initializeBase(this)};_mcp.c.$$cctor=function(){_mcp.c.h.b(_mcp.c.f);_mcp.c.e.b(_mcp.c.f);_mcp.c.d.b(_mcp.c.f);_mcp.c.c.b(new _a.bC(_g.Attachment));_mcp.c.g.b(new _a.bC(_g.be))};_mcp.c.b=function(n){var t=new _mcp.c;_mcp.c.z(t,n);return t};_mcp.c.z=function(n,t){n.K(t.w());n.r(t.y());if(t.g()){n.B(new _j.l);n.e().j(t.g().f())}else n.B(null);n.L(t.bp());if(t.j()){n.x(new _j.l);n.d().j(t.j().f())}else n.x(null);n.D(t.bh());if(t.c()){n.w(new _j.l);n.c().j(t.c().f())}else n.w(null);if(t.s()){n.p(new _j.l);n.b().j(t.s().f())}else n.p(null);if(t.P()){n.y(new _j.l);n.q().j(t.P().f())}else n.y(null);n.C(t.N());n.A(t.X());n.z(t.n());n.E(t.x());n.H(t.C());n.F(t.Z());n.G(t.ba());n.I(t.o());n.J(t.v())};_mcp.c.a=function(n,t,i,r){if(i!==r&&!(_j.h.a(i)&&_j.h.a(r))||!_mcp.c.x(n,t))return!1;if(!n||!t)return!0;for(var u=0;u<n.b();u++){var e=n.c(u);var f=t.c(u);if(!_mcp.c.i(e,f))return!1}return!0};_mcp.c.i=function(n,t){return!n&&t||!t&&n?!1:!n&&!t?!0:_g.n.a(n,t)};_mcp.c.x=function(n,t){var r=_mcp.c.y(n);var i=_mcp.c.y(t);return r===i};_mcp.c.y=function(n){return n?n.b():0};_mcp.c.w=function(n,t){if(!_mcp.c.x(n,t))return!1;if(!n||!t)return!0;for(var i=0;i<n.b();i++){var u=n.c(i);var r=t.c(i);if(!_mcp.c.B(u,r))return!1}return!0};_mcp.c.A=function(n,t){return _db.cl.a(n,t)};_mcp.c.B=function(n,t){return!n&&t||!t&&n?!1:!n&&!t?!0:!n.bH.AttachmentId&&t.bH.AttachmentId||!t.bH.AttachmentId&&n.bH.AttachmentId?!1:n.bH.AttachmentId&&n.bH.AttachmentId.Id!==t.bH.AttachmentId.Id?!1:n.bH.Name!==t.bH.Name?!1:n.bH.ContentType!==t.bH.ContentType?!1:n.bH.ContentId!==t.bH.ContentId?!1:n.bH.ContentLocation!==t.bH.ContentLocation?!1:n.b()!==t.b()?!1:!n.o()&&t.o()||!t.o()&&n.o()?!1:n.o()&&!n.o().C(t.o())?!1:n.a()!==t.a()?!1:!0};_mcp.c.prototype={f:function(){return this.eM(_mcp.c.u)},K:function(n){this.eK(_mcp.c.u,n);return n},a:function(){return this.eM(_mcp.c.m)},r:function(n){this.eK(_mcp.c.m,n);return n},e:function(){return this.eM(_mcp.c.h)},B:function(n){this.eK(_mcp.c.h,n);return n},j:function(){return this.eM(_mcp.c.v)},L:function(n){this.eK(_mcp.c.v,n);return n},d:function(){return this.eM(_mcp.c.e)},x:function(n){this.eK(_mcp.c.e,n);return n},h:function(){return this.eM(_mcp.c.k)},D:function(n){this.eK(_mcp.c.k,n);return n},c:function(){return this.eM(_mcp.c.d)},w:function(n){this.eK(_mcp.c.d,n);return n},g:function(){return this.eM(_mcp.c.j)},C:function(n){this.eK(_mcp.c.j,n);return n},i:function(){return this.eM(_mcp.c.o)},A:function(n){this.eK(_mcp.c.o,n);return n},l:function(){return this.eM(_mcp.c.n)},z:function(n){this.eK(_mcp.c.n,n);return n},k:function(){return this.eM(_mcp.c.l)},E:function(n){this.eK(_mcp.c.l,n);return n},o:function(){return this.eM(_mcp.c.r)},H:function(n){this.eK(_mcp.c.r,n);return n},m:function(){return this.eM(_mcp.c.p)},F:function(n){this.eK(_mcp.c.p,n);return n},n:function(){return this.eM(_mcp.c.q)},G:function(n){this.eK(_mcp.c.q,n);return n},u:function(){return this.eM(_mcp.c.s)},I:function(n){this.eK(_mcp.c.s,n);return n},v:function(){return this.eM(_mcp.c.t)},J:function(n){this.eK(_mcp.c.t,n);return n},b:function(){return this.eM(_mcp.c.c)},p:function(n){this.eK(_mcp.c.c,n);return n},q:function(){return this.eM(_mcp.c.g)},y:function(n){this.eK(_mcp.c.g,n);return n},t:function(n){if(this.i()!==n.X()){_j.e.a(_a.a.a,"Dirty due to importance: snapshotImportance={0}, contextImportance={1}",this.i(),n.X());return!1}if(this.f()!==n.w()){_j.e.a(_a.a.a,"Dirty due to subject: snapshotSubjectLength={0}, contextSubjectLength={1}",this.f()?this.f().length:0,n.w()?n.w().length:0);return!1}if(this.k()!==n.x()){_j.e.a(_a.a.a,"Dirty due to compliance ID: snapshotId={0}, contextId={1}",this.k(),n.x());return!1}if(this.o()!==n.C()){_j.e.a(_a.a.a,"Dirty due to sensitivity: snapshot={0}, context={1}",this.o(),n.C());return!1}if(this.m()!==n.Z()){_j.e.a(_a.a.a,"Dirty due to IsDeliveryReceiptRequested: snapshot={0}, context={1}",this.m(),n.Z());return!1}if(this.n()!==n.ba()){_j.e.a(_a.a.a,"Dirty due to IsReadReceiptRequested: snapshot={0}, context={1}",this.n(),n.ba());return!1}if(this.u()!==n.o()){_j.e.a(_a.a.a,"Dirty due to SmimeEncryptMessage: snapshot={0}, context={1}",this.u(),n.o());return!1}if(this.v()!==n.v()){_j.e.a(_a.a.a,"Dirty due to SmimeSignMessage: snapshot={0}, context={1}",this.v(),n.v());return!1}var i=this.l()?this.l().Mailbox:null;var t=n.n()?n.n().Mailbox:null;if(!_mcp.c.i(i,t)){_j.e.a(_a.a.a,"Dirty due to From: snapshotFrom={0}, contextFrom={1}",i?i.EmailAddress:"null",t?t.EmailAddress:"null");return!1}if(!_mcp.c.a(this.e(),n.g(),this.j(),n.bp())){_j.e.a(_a.a.a,"Dirty due to To: snapshotToCout={0}, contextToCout={1}, snapshotQueryStringLength={2}, contextQueryStringLength={3}",this.e()?this.e().x.length:0,n.g()?n.g().b():0,this.j()?this.j().length:0,n.bp()?n.bp().length:0);return!1}if(!_mcp.c.a(this.d(),n.j(),this.h(),n.bh())){_j.e.a(_a.a.a,"Dirty due to To: snapshotCcCout={0}, contextCcCout={1}, snapshotQueryStringLength={2}, contextQueryStringLength={3}",this.d()?this.d().x.length:0,n.j()?n.j().b():0,this.h()?this.h().length:0,n.bh()?n.bh().length:0);return!1}if(!_mcp.c.a(this.c(),n.c(),this.g(),n.N())){_j.e.a(_a.a.a,"Dirty due to To: snapshotBccCout={0}, contextBccCout={1}, snapshotQueryStringLength={2}, contextQueryStringLength={3}",this.c()?this.c().x.length:0,n.c()?n.c().b():0,this.g()?this.g().length:0,n.N()?n.N().length:0);return!1}if(!_mcp.c.w(this.b(),n.s())){_j.e.a(_a.a.a,"snapshotAttachmentCount="+(this.b()?this.b().b():0)+", contextAttachmentCount="+(n.s()?n.s().b():0));return!1}if(!_mcp.c.A(this.q(),n.P())){_j.e.a(_a.a.a,"snapshotExtendedPropertyCount="+(this.q()?this.q().x.length:0)+", contextExtendedPropertyCount="+(n.P()?n.P().x.length:0));return!1}if(this.a()!==n.y()){_j.e.a(_a.a.a,"Dirty due to editor content: snapshotContentLength={0}, contextContentLength={1}",this.a()?this.a().length:0,n.y()?n.y().length:0);return!1}_j.e.a(_a.a.a,"Context is clean");return!0},s:function(n){if(!n){_j.e.a(_a.a.a,"Comparing with a null snapshot, this case is always considered equal.");return!0}if(this.i()!==n.i()){_j.e.a(_a.a.a,"sourceImportance={0}, targetImportance={1}",this.i(),n.i());return!1}if(this.f()!==n.f()){_j.e.a(_a.a.a,"sourceSubject={0}, targetSubject={1}",this.f(),n.f());return!1}if(this.k()!==n.k()){_j.e.a(_a.a.a,"sourceComplianceId={0}, targetComplianceId={1}",this.k(),n.k());return!1}if(this.o()!==n.o()){_j.e.a(_a.a.a,"sourceSensitivity={0}, targetSensitivity={1}",this.o(),n.o());return!1}if(this.m()!==n.m()){_j.e.a(_a.a.a,"sourceIsDeliveryReceiptRequested={0}, targetIsDeliveryReceiptRequested={1}",this.m(),n.m());return!1}if(this.n()!==n.n()){_j.e.a(_a.a.a,"sourceIsReadReceiptRequested={0}, targetIsReadReceiptRequested={1}",this.n(),n.n());return!1}var i=this.l()?this.l().Mailbox:null;var t=n.l()?n.l().Mailbox:null;if(!_mcp.c.i(i,t)){_j.e.a(_a.a.a,"sourceFrom={0}, targetFrom={1}",i?i.EmailAddress:"null",t?t.EmailAddress:"null");return!1}if(!_mcp.c.a(this.e(),n.e(),this.j(),n.j())){_j.e.a(_a.a.a,"sourceToCout={0}, targetToCout={1}, sourceQueryString={2}, targetQueryString={3}",this.e()?this.e().x.length:0,n.e()?n.e().x.length:0,this.j(),n.j());return!1}if(!_mcp.c.a(this.d(),n.d(),this.h(),n.h())){_j.e.a(_a.a.a,"sourceCcCout={0}, targetCcCout={1}, sourceQueryString={2}, targetQueryString={3}",this.d()?this.d().x.length:0,n.d()?n.d().x.length:0,this.h(),n.h());return!1}if(!_mcp.c.a(this.c(),n.c(),this.g(),n.g())){_j.e.a(_a.a.a,"sourceBccCout={0}, targetBccCout={1}, sourceQueryString={2}, targetQueryString={3}",this.c()?this.c().x.length:0,n.c()?n.c().x.length:0,this.g(),n.g());return!1}if(!_mcp.c.w(this.b(),n.b())){_j.e.a(_a.a.a,"sourceAttachmentCount="+(this.b()?this.b().b():0)+", targetAttachmentCount="+(n.b()?n.b().b():0));return!1}if(this.a()!==n.a()){_j.e.a(_a.a.a,"Dirty due to editor content: snapshotContentLength={0}, snapshotContentLength={1}",this.a()?this.a().length:0,n.a()?n.a().length:0);return!1}_j.e.a(_a.a.a,"snapshot is clean");return!0}};_mcp.cf=function(n,t){this.g=Function.createDelegate(this,this.i);if(!n)throw Error.argumentNull("callback");if(t<=3e3)throw Error.argumentOutOfRange("timeoutPeriod");this.f=t;this.d=n};_mcp.cf.prototype={f:0,d:null,a:null,b:!1,c:function(){!this.a&&this.b&&(this.a=_j.m.a().a(_a.a.a,"MailComposeTimer",this.g,this.f))},h:function(){_j.e.a(_a.a.a,"Disabling timer.");this.b=!1;this.e()},e:function(){if(this.a){_j.e.a(_a.a.a,"Clearing timer.");this.a=_j.m.a().b(this.a)}},i:function(){_j.e.a(_a.a.a,"Executing timer callback.");this.e();this.d()}};_mcp.bp=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt,dt,gt,ni,ti,ii,ri,ui,fi,ei,oi,si,hi,ci){_mcp.bp.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt,dt,gt,ni,ti,ii,ri,ui,fi,ei,oi,si,hi,ci])};_mcp.bp.prototype={bE:function(){return this.ba.bW()?"MailUnifiedCompose_UpConverted":"MailUnifiedCompose"},ek:function(){return 15}};_mcp.d=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt,dt,gt,ni,ti,ii,ri,ui,fi,ei,oi,si,hi,ci){this.dl=Function.createDelegate(this,this.bi);this.dZ=Function.createDelegate(this,this.fC);this.ec=Function.createDelegate(this,this.fZ);this.eb=Function.createDelegate(this,this.fW);this.ed=Function.createDelegate(this,this.gc);this.dj=Function.createDelegate(this,this.fK);this.cY=Function.createDelegate(this,this.ex);this.cZ=Function.createDelegate(this,this.fJ);this.dY=Function.createDelegate(this,this.eg);this.da=Function.createDelegate(this,this.fM);this.dk=Function.createDelegate(this,this.fL);this.ea=Function.createDelegate(this,this.fF);this.cv=new _j.R;_mcp.d.resolveInheritance();this.V=this.dispose;_mcp.d.initializeBase(this);_a.c.b(k,"nativeBridge");this.cS=4;this.ba=n;this.bh=t||new _bc.b;this.bh.D(g);this.bb=this.bs();this.ds=i;this.bV=r;this.dc=u;this.bp=new _mcp.bb(this.bh);this.dL=f;this.cR=s;this.dE=e;this.bv=o;this.bY=h;this.bB=c;this.be=l;this.bK=v;this.cH=p;this.cE=a;this.cM=w;this.bo=b;this.bC=y;this.cQ=k;this.bX=d;this.bw=g;this.dF=nt;this.cz=tt;this.cA=it;this.cB=rt;this.dp=ut;this.bQ=ft;this.cm=et;this.dt=ot;this.cW=st;this.cD=ht;this.ew=ct;this.cP=lt;this.dO=at;this.cx=vt;this.cw=yt;this.cy=pt;this.cG=wt;this.dn=bt;this.dP=kt;this.bH=dt;this.cg=gt;this.ca=ni;this.dD=ti;this.cV=ii;this.cu=ri;this.cC=ui;this.cF=fi;this.cj=ei;this.eh=oi;this.dM=si;this.dm=hi;this.dN=ci;if(this.ba.m()===3)this.bI=_mcp.d.e(o);else if(o){var li=o;this.bI=li.v||(li.v=Function.createDelegate(li,li.d))}this.bw||(this.cO=!0);this.cp=!0;this.ct=!0;this.dA()&&this.bZ()&&this.fE();_j.e.a(_a.a.a,"ViewModel created")};_mcp.d.a=function(n,t){if(!n){_j.e.b(_a.a.a,"MailComposeViewModel.SafeGetComponent - map is null, cannot access component.");return null}return n.b(t)};_mcp.d.e=function(n){return function(t){if(n&&t){n.L(t,n.c());n.c().e(t)}else _j.e.b(_a.a.a,"GetDeepLinkPopUpHandler cannot invoke popup.")}};_mcp.d.d=function(){return+new Date+":"+Math.random()};_mcp.d.prototype={ds:null,ba:null,bV:null,dc:null,dL:null,dE:null,cR:null,bh:null,bv:null,bK:null,cH:null,dO:null,bY:null,bB:null,bC:null,cQ:null,cM:null,ew:null,bX:null,cz:null,cA:null,cB:null,dp:null,bw:null,dF:null,bQ:null,cm:null,dt:null,bH:null,cE:null,cW:null,cD:null,cg:null,ca:null,dD:null,cV:null,cP:null,cx:null,cw:null,cy:null,cG:null,cu:null,cC:null,cF:null,dm:null,eh:null,cj:null,dM:null,dN:null,bb:null,be:null,dg:null,bW:null,cN:!1,ce:!1,co:null,cn:!1,bP:!1,cS:0,cO:!1,cU:!1,bT:null,db:null,cT:!1,dn:null,dP:null,bF:!1,cl:!1,dI:!0,dG:!0,dK:!0,dH:!0,dJ:!0,dh:!0,fg:function(n){this.cv.b(n)},fO:function(n){this.cv.c(n)},a:function(){return this.ba},fP:function(n){if(this.bb!==n){this.bb=n;this.eJ("InfoBarViewModel")}return n},fT:function(n){if(n!==this.bW){var t;_a.h.a(t={val:this.bW}),this.bW=t.val;this.bW=n;this.eJ("SenderPhotoViewModel")}return n},dA:function(){return this.fy()&&this.bn()},cK:function(){_a.c.d(this.cW.d(),"MailComposeViewModel: Smime override factory has not been created");return this.cW.b()},bA:function(){return _mcp.d.a(this.bf,0)},bM:function(){return _mcp.d.a(this.bf,10)},bm:function(){return _mcp.d.a(this.bf,2)},bc:function(){return _mcp.d.a(this.bf,5)},bS:function(){return _mcp.d.a(this.bf,11)},er:function(){return _mcp.d.a(this.bf,4)},bd:function(){return _mcp.d.a(this.bf,1)},em:function(){return _mcp.d.a(this.bf,6)},bg:function(){return _mcp.d.a(this.bf,7)},bl:function(){return _mcp.d.a(this.bf,8)},cc:function(){return _mcp.d.a(this.bf,9)},cd:function(){return _mcp.d.a(this.bf,28)},by:function(){return _mcp.d.a(this.bf,16)},ci:function(){return _mcp.d.a(this.bf,18)},bL:function(){return _mcp.d.a(this.bf,3)},de:function(){return _mcp.d.a(this.bf,17)},es:function(){return _mcp.d.a(this.bf,29)},df:function(){return _mcp.d.a(this.bf,23)},bq:function(){return _mcp.d.a(this.bf,19)},bj:function(){return _mcp.d.a(this.bf,22)},cI:function(){return _mcp.d.a(this.bf,24)},fn:function(){return _mcp.d.a(this.bf,30)},bD:function(){return _mcp.d.a(this.bf,25)},ej:function(){return _mcp.d.a(this.bf,32)},cJ:function(){return _mcp.d.a(this.bf,35)},bO:function(){return _mcp.d.a(this.bf,12)},dB:function(){return _mcp.d.a(this.bf,27)},fz:function(){return _mcp.d.a(this.bf,31)},el:function(){return _mcp.d.a(this.bf,34)},fi:function(){return _mcp.d.a(this.bf,36)},bp:null,fy:function(){return this.bC.i()},d:function(){return this.bw},bu:function(){return!this.bv.b()||!!this.bw},bn:function(){return!1},bE:function(){return"MailCompose"},dz:function(){return!1},ek:function(){return 5},fs:function(){return!!this.bK&&this.bK.a().bk().Enabled},ch:function(){var t=this.bu();var n=new _a.l;n.c("P",t);n.a("I",t?this.bN().toString():"NA");n.a("ET",this.ba.fF);n.a("S",this.bE());return n},fQ:function(n){if(this.cO!==n){this.cO=n;this.eJ("IsReadyForViewInitialization")}return n},bN:function(){return!!this.bw},bx:function(){return this.cS},eA:function(n){if(this.cS!==n){this.cS=n;this.eJ("PopupPanelSize")}return n},x:function(){if(this.bM()){var n=this.bM();return n.c||(n.c=Function.createDelegate(n,n.j))}else return this.ea},y:function(){return this.dg},o:function(n){_j.e.a(_a.a.a,"Shell setting ClosePopupCommand from {0} to ",this.dg?"non-null":"null",n?"non-null":"null");this.dg=n;return n},cp:!1,bz:function(){return this.cp},P:function(n){this.cp=n;return n},ct:!1,U:function(n){this.ct=n;return n},en:function(){return this.bH.g()},fp:function(){return this.bH.e()},ep:function(){return this.bH.i()},eo:function(){return this.bH.f()},dy:function(){return this.bH.b()},n:function(){return this.bZ()?0:1},fj:function(){return this.bH.F()},cq:!1,K:function(){return this.cq},S:function(n){this.cq=n;return n},ey:function(n){if(this.cN!==n){this.cN=n;this.eJ("IsInView")}return n},bJ:!1,v:function(n){this.bJ=n;return n},eC:function(n){var t=this.eu();if(this.ce!==t){this.ce=t;this.eJ("ShouldShowToolbarMessage")}return n},eD:function(n){if(this.co!==n){this.co=n;this.eJ("ToolbarMessage")}return n},bf:null,eB:function(n){var t=this.eu();if(t!==this.cn){this.cn=t;this.eJ("ShouldBlockView")}return n},R:function(n){if(this.bP!==n){this.bP=n;this.eJ("IsNavigatingAway")}return n},eu:function(){return this.bm()&&(this.bm().i()||this.bm().h())?!0:this.bg()&&this.bg().b()?!0:!1},dd:function(){return!this.bH.k()},bo:null,ee:null,f:function(n){this.ee=n;return n},bI:null,z:function(n){this.bI=n;return n},s:function(){var n=_mcp.d.a(this.bf,27);if(n){n.e()||n.g();return n.a()}else{this.eZ||this.fm||_j.e.b(_a.a.a,"MailComposeViewMode.ComposeCommandingBarViewModel -- CommandingBarComponent should not be null if the state is not disposed or disposing.");return null}},cL:function(){return this.ba.gi()},t:function(n){if(this.cU!==n){this.cU=n;this.eJ("SharedCommandingBarShown")}return n},bZ:function(){return this.bv.a()==="Mouse"},fB:function(){return this.cg.c()&&this.bZ()},bk:function(){this.db||(this.db=new _cmc.bE);return this.db},cs:null,fA:function(){return this.bg().a()},fR:function(n){this.bg().c(n);return n},T:function(n){if(n!==this.cT){this.cT=n;this.eJ("ReadyToSetInitialFocus")}return n},ev:function(){return!1},ez:function(n){this.bF!==n&&(this.bF=n);return n},I:function(){return this.cl},Q:function(n){if(this.cl!==n){this.cl=n;this.eJ("IsInSxSView")}return n},et:function(){return this.bC.a().ic().Enabled&&this.bZ()&&!this.bu()},ft:function(){return this.ba.W()||!this.dG},fv:function(){this.dh&&this.be.a(_mco.be.a,new _mco.be.a("MailComposeViewModel.IsCollapsedInsertPictureButton"));return!this.dK},eq:function(){return!!this.cJ()&&this.dJ},fw:function(){return this.ba.m()===3},fL:function(n,t){if(this.ba.H()){this.Z();this.bf.q()}else{this.Y();this.bf.l()}},fh:function(){this.ba.apcl(_mcp.b.e,this.dk)},Z:function(){if(this.cL()&&!this.bT){_j.e.a(_a.a.a,"Setting mail compose viewmodel override");this.bT=this.cK().c();this.bT.b(this.bb)}},Y:function(){if(this.bT){this.bT.a();this.bT=null}},H:function(n){if(!this.fm&&this.bc()&&this.bc().a()){_j.e.a(_a.a.C,"[MailComposeViewModel_AddAttachmentToCompose] Adding Attachment to Compose by setting Files property on AttachmentWellViewModel.");this.bc().a().P(new _h.ci([n]))}else _j.e.a(_a.a.C,"[MailComposeViewModel_AddAttachmentToCompose] Can not upload Attachment to Compose.")},L:function(){if(!this.fm&&this.bc()){_j.e.a(_a.a.C,"[MailComposeViewModel_OpenAttachmentFilePicker] Opening attachment file picker.");this.bc().a()?this.bc().q():this.bc().i(this.da)}},N:function(){!this.fm&&this.bc()&&this.bc().a()&&this.bc().a().h(this.bc().a().b(),this.ba.s(),this.ba.bg())},bi:function(){if(!this.fm){this.bD().d();this.bd().bh()}},dC:function(n){this.cs=n;this.bc()&&this.bc().a()&&this.bc().a().cy(this.cs)},fH:function(){this.cI()&&this.cI().j()},ck:function(){this.ba.d()&&(this.ba.fj()||this.ba.dl())||this.ba.gs(_mcp.d.d());_j.e.a(_a.a.a,"Init");this.be.a(_cmc.bn,new _mcp.ce);this.bf||(this.bf=this.dq());this.cT=!this.ca||!this.ca.q()||this.ca.b;if(this.cL()){_j.e.a(_a.a.a,"Creating Smime override factory");this.dr(this.dY)}else this.eg()},dr:function(n){_j.e.a(_a.a.a,"Calling CreateSmimeOverrideFactoryAsync");var t=this;this.cW.a(function(i){_j.e.a(_a.a.a,"Smime override factory created");i.f(t.ba,t.be);_j.e.a(_a.a.a,"Calling createFactoryCallback");n()})},w:function(n,t){this.bj()&&this.bj().a()&&this.bj().a().I(n,t)},bG:function(){this.bj()&&this.bj().a()&&this.bj().a().s(1)},ei:function(){},dq:function(){return new _mcp.bH(this,this.cE,this.bK,this.bC,this.cH,this.cM,this.cQ,this.bw,this.cz,this.cA,this.cB,this.cD,this.cP,this.cx,this.cw,this.cy,this.cG,this.dn,this.dP,this.bH,this.cg,this.ca,this.cV,this.cu,this.cC,this.cF,this.dM,this.dm,this.dN)},eg:function(){_j.e.a(_a.a.a,"Completing initialization");this.Z();this.fh();if(this.bb){this.bb.r();this.be.a(_y.fx,new _y.fx);this.ba.dl()&&this.ef(this.ba.hj())}this.R(!1);this.be.b(_a.dU,this.cZ);this.bA().g();if(!this.bw){this.bv.l(this.cY);this.bv.m(this.cY);_j.e.a(_a.a.a,"Before unload handler has been hooked up")}if(this.ba.dy()){this.L();this.ba.ev(!1)}this.bM()&&(this.bM().f()?this.cv.a():this.bM().apcl("IsAppBarSetup",this.dj))},fK:function(n,t){this.bM().f()&&this.cv.a()},ef:function(n){switch(n){case 94:case 99:case 100:this.bb.c(n,null,_u.n.Sr,this.ed);break;case 98:this.bb.c(n,null,_u.n.Sr,this.eb);break;case 91:case 92:this.bb.c(n,null,_u.n.Ft,this.ec);break;default:this.bb.a(n,null);break}},e:function(n){this.bm()?this.bm().d(n):this.eZ||this.fm||_j.e.b(_a.a.a,"MailComposeViewMode.SetMailComposeConductor - NavigationComponent should not be null if the state is not disposed or disposing.")},c:function(){if(this.bm())return this.bm().n();else{this.eZ||this.fm||_j.e.b(_a.a.a,"MailComposeViewMode.TryExitNow - NavigationComponent should not be null if the state is not disposed or disposing.");return!1}},j:function(n,t){this.bl().b(n,t)},gc:function(){window.open("/owa/owahipcontrol.aspx?compose=1");this.bb.b(100);this.bb.b(99);this.bb.b(94)},fW:function(){window.open(_mcp.d.b);this.bb.b(98)},fZ:function(){window.open(_mcp.d.c);this.bb.b(91);this.bb.b(92)},fU:function(n){this.ff(n);_j.e.a(_a.a.a,"Set screen view model appbar. ContextId={0}",this.ba.d())},fV:function(n){this.fl(n);_j.e.a(_a.a.a,"Set screen view model top appbar. ContextId={0}",this.ba.d())},du:function(){_y.lJ.prototype.du.call(this);var n=this.bA();if(n){if(n.e()){_j.e.a(_a.a.a,"PostTransitionIn view model, begin secondary init now since primary init is already finished.");n.b()}else _j.e.a(_a.a.a,"PostTransitionIn view model, primary init not finished yet. Relying on primary init to fire secondary init...");this.ey(!0);if(this.ba.dl()&&this.ba.cr()){var i=this.ba.d();this.be.a(_y.he,new _y.he(i))}(this.ba.a()||this.bv.a()!=="TouchNarrow")&&this.ba.fv&&this.ba.fv();if(this.bZ()){var t=this;_j.m.a().c(_a.a.c,"PreloadOwaFilePicker",function(){var n=t.bc();n&&n.A()})}if(this.ba.fw){this.ba.fw(this);this.ba.fw=null}this.bk().m(this.bE())}},dv:function(){_j.e.a(_a.a.a,"Post transition out");if(!this.bg()){_j.e.a(_a.a.a,"[MailComposeViewModel:PostTransitionOut] Send component is null");return}if(this.bg().l()){var n=this.bg().l();n.m=this.ba.cr()?"SentViaNotification":"NotSentViaNotificationDueToOtherPendingFailedAsyncSend";_a.b.a(n)}this.ey(!1);this.bk().c();if(!this.bg().k()){if(this.bJ){this.bd().f();this.ba.fc.a()}IMailComposeAutoSaveComponent.isInstanceOfType(this.bg())&&this.bg().k()}this.be.a(_a.cE,new _a.cE(!0,"NotLoadedByReadingPaneComposeHide"));this.be.a(_a.U,new _a.U(6));_y.lJ.prototype.dv.call(this)},cb:function(){if(this.bc().b()){_j.e.a(_a.a.a,"Dirty due to attachment in progress");return!0}this.bd().f();return this.ba.gI()},bs:function(){this.bb||this.fP(new _db.j);return this.bb},M:function(){_h.z.k()},O:function(){_h.z.g()},fX:function(){this.bT&&this.bT.c()},X:function(){this.fQ(!0)},W:function(){var n=new _y.hE;this.ex(n);return n.b},ex:function(n){this.bm().f(n);this.bk().c()},m:function(){this.bk().c()},fc:function(){this.bu()&&this.ba&&!_j.h.a(this.ba.I())&&!this.bw&&(document.title=this.ba.I())},i:function(n){this.dB()&&this.dB().c(n+this.ek())},eH:function(n){this.dI=n;this.eJ("IsCollapsedSendDiscardButtons")},eE:function(n){this.dG=n;this.bc()&&this.bc().G(n);this.eJ("IsCollapsedAttachButton")},eR:function(n){this.dK=n;this.bc()&&this.bc().H(n);this.dh=!1;this.eJ("IsCollapsedInsertPictureButton");this.dh=!0},eG:function(n){this.dH=n;this.by().b(n);this.eJ("IsCollapsedEmojiButton")},eI:function(n){this.dJ=n;this.cJ()&&this.cJ().b(n);this.eJ("IsShowInsertAvailableTimeButton")},eL:function(){_j.e.a(_a.a.a,"Disposing view model");this.Y();this.ba.rpcl(_mcp.b.e,this.dk);if(!this.bf){_j.e.b(_a.a.a,"MailComposeViewModel.Reset - Skipping post-transition out processing because the component map is null.");return}var n=this.bm();if(!n){_j.e.b(_a.a.a,"MailComposeViewModel.Reset - Skipping post-transition out processing because the navigation component is null.");return}if(!n.c()){_j.e.b(_a.a.a,"MailComposeViewModel.Reset - Skipping post-transition out processing because IsNavigatingAwayFromCompose is false.");return}this.bj()&&this.bj().a()&&this.bj().a().f(!1);this.bM()&&this.bM().rpcl("IsAppBarSetup",this.dj);this.bc()&&this.bc().h(this.da);n.m(!1);this.bf.dispose();this.bf=null;this.ba&&!this.bJ&&this.ba.dJ();if(this.bb){this.bb.q.g();var i;_a.h.a(i={val:this.bb}),this.bb=i.val}this.bw||this.bv.l(this.cY);this.be.c(_a.dU,this.cZ);this.bI=null;this.cq=!1;var t;_a.h.a(t={val:this.bW}),this.bW=t.val;_y.lJ.prototype.eL.call(this)},fN:function(n,t){this.bc().z(n);this.bZ()&&(!n.c||n.c===2)&&this.bc().v();this.el()&&this.el().a()},fG:function(n){if(this.ba.bv()&&this.ba.A()&&this.ba.dd()===1){var t=this.ba.A().Id;if(this.fb(n)){_j.e.a(_a.a.a,"Original message {0} loaded from cache.",t);return}var r=new _h.M(200,[this.ba.A()],_h.b.a(),"ItemNormalizedBody",2,!1,this.bC,null);var i=this,u=this;this.bp.a(r,function(r){_j.e.a(_a.a.a,"Original message {0} loaded from server.",t);i.fb(n)},function(n){_j.e.b(_a.a.a,"Fail to load original item with id "+t)},null)}},fb:function(n){var t=_h.d.a().a(this.ba.A().Id);if(t){this.ba.cg(t);n&&n();return!0}return!1},fF:function(n,t,i){return t===1?!this.ct:!1},eY:function(n){if(this.bh.r)_j.e.b(_a.a.a,"ShowMessageBoxForSessionTimeout: A message is already being shown, pending timeout dialog was not shown");else{_j.e.b(_a.a.a,"ShowMessageBoxForSessionTimeout: Show pending timeout dialog");n?this.bh.h(0,_u.n.r,this.dZ,!1,_u.n.Om,null,_u.n.DS,this.bh.z):this.bh.h(0,_u.n.DF,null,!1,null,null,_u.n.DS,this.bh.z)}},fJ:function(n){if(n.a<120){_j.e.a(_a.a.a,"OnSessionTimeoutEvent: Timeout header recieved with less than 2 minutes until session expires");this.be.c(_a.dU,this.cZ);var i=this,t=this;this.bl().a("Save",function(){_j.e.a(_a.a.a,"OnSessionTimeoutEvent: Save was successful");i.eY(!0)},function(){_j.e.a(_a.a.a,"OnSessionTimeoutEvent: Save was unsuccessful");t.eY(!1)},!1)}},fC:function(n,t){if(n){_j.e.a(_a.a.a,"HandleSessionTimeoutDialog: Logout for user");var r=new _a.br;this.be.a(_a.br,r);var i=new _a.cp(this.dD.d());this.be.a(_a.cp,i)}},fE:function(){var n=this.ba.bX();if(n){var i=_h.j.a(n,!1);var t=this.fY(i);this.fT(t)}},fY:function(n){var i=2;n.b()!==5&&(i|=1);var t=null;if(this.bV&&this.bV.c){t=this.bV.c.a(n,i,!0,5,!1,!1,!1);t.b(!0)}return t},fM:function(n){this.bc().h(this.da);this.bc().q()}};_mcp.E=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt,dt,gt,ni,ti,ii,ri,ui,fi,ei,oi,si,hi,ci){this.g=Function.createDelegate(this,this.A);_mcp.E.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt,dt,gt,ni,ti,ii,ri,ui,fi,ei,oi,si,hi,ci]);this.bC.v()&&(this.ba.ct()||this.bF)&&this.be.b(_mco.D,this.g)};_mcp.E.prototype={bn:function(){return!0},bE:function(){return"MailInlineCompose"},ev:function(){return!0},h:null,e:function(n){_mcp.d.prototype.e.call(this,n);IInlineComposeConductorViewModel.isInstanceOfType(n)&&(this.h=n.e())},eL:function(){this.be.c(_mco.D,this.g);_mcp.d.prototype.eL.call(this)},A:function(n){if(this.ba.bi().Id===n.b.Id){var t=n.a.a();this.bd().f();if(_mco.j.d(this.ba,t)){this.b(t.q()?t.q().e():new Array(0),this.bd().c(),t.bH.Sender.Mailbox);this.b(t.A()?t.A().e():new Array(0),this.bd().h(),t.bH.Sender.Mailbox);this.q(t.bH.Sender.Mailbox);this.r(t.bH.ItemId,n.a)}else{this.bb.a(1004);this.p(!1,"Recipients differ")}}},r:function(n,t){var u=this.ba.a();this.ba.e(14);this.ba.cM(n);var f=this.bX.h(this,0);var i=this,r=this;this.bp.a(f,function(n){i.bb.a(1003);i.be.a(_mco.p,new _mco.p(t));t?i.p(!0,""):_mco.j.a(!0,"",!0)},function(n){r.bb.a(1004);t?r.p(!1,n.G.toString()):_mco.j.a(!1,"Server",!0)},null);this.ba.e(u)},b:function(n,t,i){var f=_g.a.a().c().bH.UserEmailAddress;var e=i.EmailAddress;t.a.D();for(var o=n.length,r=0;r<o;r++){var u=n[r];u.EmailAddress!==f&&u.EmailAddress!==e&&t.a.bw(u)}},q:function(n){if(n.EmailAddress!==_g.a.a().c().bH.UserEmailAddress){this.bd().c().b&&this.bd().c().b.o(n);this.bd().c().a&&this.bd().c().a.o(n)}},p:function(n,t){var i=new _a.l;i.c("S",n);i.a("err",t);var r=_a.b.b(_a.a.a,"RPCountDraftReparent",!1,null);r.m=i.toString();_a.b.a(r)},ei:function(){this.ez(!0);this.ba.e(2);if(this.ba.dn()){this.b(this.ba.dq(),this.bd().c(),this.ba.bP());this.b(this.ba.dp(),this.bd().h(),this.ba.bP());this.q(this.ba.bP());this.r(this.ba.A(),null);return}this.be.a(_mco.p,new _mco.p(null));_mco.j.a(!0,"",!1)}};_mcp.j=function(n,t,i){this.b=n;this.c=t};_mcp.j.b=function(n){return n.EmailAddress?n.EmailAddress.toLowerCase():n.ItemId.Id};_mcp.j.prototype={b:null,d:null,c:!1,a:null,e:null,f:null,g:function(){!this.d&&this.b&&(this.d=_a.C.b(this.b.EmailAddress));return this.d},l:function(n){if(!this.c)return n.val.g();_j.e.a(_mcp.j.a,"begin calculating initial audience");var t=new _j.l;this.a={};if(this.b){_j.e.a(_mcp.j.a,"adding always keep address "+this.g()+" as the first To recipient");t.a(this.b);this.a[this.g()]=0}this.h(t,n.val.g(),0);this.h(t,n.val.j(),1);_j.e.a(_mcp.j.a,"end calculating initial audience");this.k(t,n);return t},n:function(n,t){if(_rw.d.isInstanceOfType(n)){this.e=n;if(this.b)for(var u=this.e.G,i=0;i<u.b();i++){var r=u.c(i);if(_a.C.b(r.l.a().EmailAddress)===this.d){r.j.K(!0);break}}}this.f=t},k:function(n,t){if(!this.c||!n){t.val.u(n);return}for(var f=new _j.l,e=new _j.l,o=n.x.length,r=0;r<o;r++){var i=n.x[r];var u=_mcp.j.b(i);if(u in this.a)this.a[u]?e.a(i):f.a(i);else{_j.e.a(_mcp.j.a,"Email address "+u+" is not in the local bookkeeping, add it to To");f.a(i)}}t.val.u(f);t.val.bb(e);if(this.f){this.f.E(e);_j.e.a(_mcp.j.a,"Update Cc recipient well with the separated Cc recipients")}},m:function(n,t){if(this.c){var i=t.c;_j.e.a(_mcp.j.a,"user edited the To recipients, processing the "+i+" change");var u=t.b;var r=t.a;switch(i){case 0:this.i(r);break;case 2:this.j(u);break;case 3:this.j(u);this.i(r);break;default:throw Error.notImplemented("a new NotifyCollectionChangedAction "+i+" has been introduced and to recipient helper does not work with it");}}},j:function(n){if(n)for(var u=n.length,r=0;r<u;r++){var f=n[r].l.a();var t=_mcp.j.b(f);_j.e.a(_mcp.j.a,"recording removed recipient "+t);if(t in this.a)if(t===this.g()){var i=this;_j.m.a().a(_mcp.j.a,"ProcessAlwaysKeepRecipients",function(){if(i.e){_j.e.a(_mcp.j.a,"adding the always keep address "+t+" back in To well");var n=i.e.bw(i.b);n.K(!0)}},0)}else{_j.e.a(_mcp.j.a,"removing removed recipient "+t+" from cc recipient well");delete this.a[t]}}},i:function(n){if(n)for(var r=n.length,t=0;t<r;t++){var u=n[t].l.a();var i=_mcp.j.b(u);_j.e.a(_mcp.j.a,"adding added recipient "+i+" to local copy");this.a[i]=0}},h:function(n,t,i){var e=t?t.b():0;_j.e.a(_mcp.j.a,"merging "+e+" "+i+" partial audience into audience");for(var r=0;r<e;r++){var f=t.c(r);var u=_mcp.j.b(f);if(!(u in this.a)){n.a(f);this.a[u]=i}}}};_mcp.bs=function(n,t,i,r,u,f,e,o,s){this.W=Function.createDelegate(this,this.bb);this.I=Function.createDelegate(this,this.Q);this.V=Function.createDelegate(this,this.Z);_mcp.bs.initializeBase(this);this.P=o;this.r=o.b;this.t=n;this.A=t;this.s=o.a;this.G=i;this.L=r;this.O=u;this.N=f;this.M=e;this.R=s};_mcp.bs.prototype={A:null,t:null,r:null,s:null,P:null,G:null,L:null,O:null,N:null,M:null,R:null,x:null,u:0,E:!1,T:!1,H:null,v:null,y:null,B:!1,U:!1,f:function(){this.x||(this.x=new _y.bs);return this.x},e:function(n){this.x=n;return n},w:function(){return this.s?this.s.co():null},K:null,p:function(n){this.K=n;return n},C:null,o:function(n){this.C=n;return n},D:null,q:function(n){this.D=n;return n},c:function(n){_a.O.a(_a.a.p,"MailComposeReplyLoad",3);this.B=!0;this.v=_y.l.b(_a.a.p,"MailComposeReply",!0,!1);this.y=_y.l.b(_a.a.p,"MailComposeReplyLoad",!0,!1);this.r.bH.ConversationId?this.t.l("Inference.Reply",this.r,this.r.bH.ConversationId,this.s?this.s.R():null,this.w(),!0):this.t.a("Inference.Reply",this.r,this.w(),!0);this.z(1,n)},l:function(n,t,i){var r=this.d(n);if(r.Q())r.br(new _cmc.i(1,t,i,7));else{var u=this;_j.m.a().d(_a.a.a,"OnReplyAllWithContent",function(){u.X(r,t,i)})}},j:function(n,t){var i=this.d(n);i.U()||i.cB(new _j.l);i.U().a(t)},m:function(n){this.U=!0;this.d(n)},d:function(n){_a.O.a(_a.a.p,"MailComposeReplyAllLoad",3);this.B=!0;this.v=_y.l.b(_a.a.p,"MailComposeReplyAll",!0,!1);this.y=_y.l.b(_a.a.p,"MailComposeReplyAllLoad",!0,!1);this.r.bH.ConversationId?this.t.l("Inference.ReplyAll",this.r,this.r.bH.ConversationId,this.s?this.s.R():null,this.w(),!0):this.t.a("Inference.ReplyAll",this.r,this.w(),!0);return this.z(2,n)},h:function(n){this.E=!0;this.d(n)},i:function(n){this.T=!0;this.d(n)},b:function(n){this.t.a("Inference.PostReply",this.r,this.w(),!1);this.z(12,n)},a:function(n){_a.O.a(_a.a.p,"MailComposeForwardLoad",3);this.B=!0;this.v=_y.l.b(_a.a.p,"MailComposeForward",!0,!1);this.y=_y.l.b(_a.a.p,"MailComposeForwardLoad",!0,!1);this.r.bH.ConversationId?this.t.l("Inference.Forward",this.r,this.r.bH.ConversationId,this.s?this.s.R():null,this.w(),!0):this.t.a("Inference.Forward",this.r,this.w(),!0);this.z(3,n)},g:function(n){this.E=!0;this.a(n)},n:function(){if(!this.P.q())throw Error.invalidOperation("OnSendAgain is invoked on an item that can't be sent again. ");var t=_g.b.a.nameToId("drafts");var n=new _mcp.bx(this.r.bH.ItemId.Id,t.Id);n.c(this.V);n.b(this.I);_a.g.a.a(n)},Z:function(n){var i=n.h;if(i.length>0){var t=this.L.i(_g.e.b(i));t.c(this.W);t.b(this.I);_a.g.a.a(t)}else this.Q(n)},Q:function(n){this.s.B().b(9500);this.s.B().a(9500)},bb:function(n){var t=n;if(t.e){this.s.B().b(9500);var i=this.G.b(t.k[0],!1,t.e.ej(),t.e.bY());i.dV(this.C);_y.c.a.b()||i.p(0);this.f().a(i)}else this.Q(n)},z:function(n,t){this.u=n;return this.bc(t)},bc:function(n){var u=_dg.a.isInstanceOfType(this.r);n||(n=!_y.c.a.b());var t=this.G.a(n,!1);t.bd(this.B);t.fq=this.C;t.ew(this.D);t.fL=this.U;this.D="";n&&t.p(0);var f=null;switch(this.u){case 1:f=!t.m()||u?"MailComposeReplyPopOut":"MailComposeReply";break;case 2:f=!t.m()||u?"MailComposeReplyAllPopOut":"MailComposeReplyAll";break;case 3:f=!t.m()||u?"MailComposeForwardPopOut":"MailComposeForward";break;default:break}if(f&&this.v){this.v.u=f;t.D(this.v);t.bc(this.y);t.bC()}t.eo(this.r.bH.ParentFolderId);this.s&&t.ep(this.s.cz());t.e(this.u);t.cJ(!0);t.eY=this.E;t.fA=this.T;t.f(!t.eY||this.u===3);var i=new _g.R;i.Mailbox=new _g.g;i.Mailbox.EmailAddress=this.A.c().bH.UserEmailAddress;i.Mailbox.Name=this.A.c().bH.UserDisplayName;i.Mailbox.MailboxType="Mailbox";i.Mailbox.RoutingType="SMTP";t.es(i);t.fv=this.K;if(u){var r=this.r;if(r.cN())t.S(r);else{t.hH(_dg.a.a(r));t.dM(t.dD(r));t.cM(this.r.bH.ItemId);t.eg(_dg.a.f(r))}}else t.S(this.r);if((this.u===1||this.u===2)&&_g.i.isInstanceOfType(this.r)){var o;var e=this.r;var l=this.S(e.E())+this.S(e.A())+this.S(e.q());o=this.u===1?"MailComposeBeforeReply":"MailComposeBeforeReplyAll";var c=_a.b.b(_a.a.p,o,!1,null);c.m=l.toString();_a.b.a(c)}if((_g.i.isInstanceOfType(this.r)||u)&&t.gj(this.r)){var s=_a.m.f();s&&t.hQ(this.r.bC());if(this.r.cR()||t.H()&&s){var h=this;this.ba(function(n){n.b(t,h.r,h.u)})}else this.f().a(t)}else this.f().a(t);return t},ba:function(n){_j.e.a(_a.a.k,"[MailResponseViewModel] Creating Smime command factory.");var t=this;this.O.a(function(i){t.N.a(function(r){t.M.a(function(u){t.H||(t.H=t.Y(i,r,u));_j.e.a(_a.a.k,"[MailResponseViewModel] Executing smime operation.");n(t.H)})})})},Y:function(n,t,i){_j.e.a(_a.a.k,"[MailResponseViewModel] Creating SmimeMailResponseViewModelCommand instance.");var r=null;r=n.f();var f=this,u=this;r.a(this,this.A,this.R,function(n,i){i.dM(i.dD(n));var u=t.a(n.bH.ItemId,i.cu(),i.cl(),_dg.a.a(n));var r=t.b(200,u,i.cl());r.ba=i.d();return r},function(n,t,r){var u=new _mcp.ci(n,t,r,i);return u.toString()});return r},S:function(n){return n?n.b():0},X:function(n,t,i){if(!this.eZ)if(n.Q())n.br(new _cmc.i(1,t,i,7));else{var r=this;_j.m.a().a(_a.a.a,"OnReplyAllWithContentAction",function(){r.X(n,t,i)},500)}}};_mcp.bt=function(n,t,i,r,u,f,e,o){this.f=n;this.i=t;this.g=i;this.b=r;this.h=u;this.d=f;this.c=e;this.e=o};_mcp.bt.prototype={f:null,i:null,g:null,b:null,h:null,d:null,c:null,e:null,a:function(n){return new _mcp.bs(this.f,this.i,this.g,this.b,this.h,this.d,this.c,n,this.e)}};_mcp.S=function(){_mcp.S.initializeBase(this)};_mcp.S.prototype={a:null,d:"Normal",e:!1,f:!1,b:!1,c:!1,i:!1,j:!1,g:null,h:!1,l:!1,m:!1,s:function(){if(!this.a){this.a=new _j.l;this.a.a("Normal");this.a.a("Personal");this.a.a("Private");this.a.a("Confidential")}return this.a},p:function(n){if(this.d!==n){this.d=n;this.eJ("Sensitivity")}return n},n:function(n){if(this.e!==n){this.e=n;this.eJ("IsDeliveryReceiptRequested")}return n},o:function(n){if(this.f!==n){this.f=n;this.eJ("IsReadReceiptRequested")}return n},v:function(n){if(this.h!==n){this.h=n;this.eJ("ShowSmimeOptions")}return n},q:function(n){if(this.b!==n){this.b=n;this.eJ("SmimeEncryptMessage")}return n},r:function(n){if(this.c!==n){this.c=n;this.eJ("SmimeSignMessage")}return n},w:function(n){if(this.i!==n){this.i=n;this.eJ("SmimeEncryptMessageIsEnabled")}return n},x:function(n){if(this.j!==n){this.j=n;this.eJ("SmimeSignMessageIsEnabled")}return n},y:function(n){if(this.m!==n){this.m=n;this.eJ("WaitingForPreviousAction")}return n},u:function(n){if(this.g!==n){this.g=n;this.eJ("Conductor")}return n},t:function(n){this.l=n.H();this.v(_a.m.a&&_a.m.k()&&n.dH());this.y(!1);this.p(n.C());this.n(n.Z());this.o(n.ba());this.q(n.o());this.r(n.v());this.w(n.dA());this.x(n.dB())},eL:function(){this.g=null;this.a.g();var n;_a.h.a(n={val:this.a}),this.a=n.val;_a.gd.prototype.eL.call(this)}};_mcp.be=function(n){_mcp.be.initializeBase(this);this.h=n;var t=_a.d.cd();if(t.length>=3){this.c=new _mcp.bd(t[0]);this.e=new _mcp.bd(t[1]);this.f=new _mcp.bd(t[2])}};_mcp.be.prototype={h:0,b:null,a:0,d:!1,g:"",c:null,e:null,f:null,m:function(){return(this.h&3)==3},j:function(n){if(this.d!==n){this.d=n;this.eJ("IsTimeExpirationSelected")}return n},o:function(n){this.a=n;this.j(this.a===1?!0:!1);this.eJ("SelectedOption");return n},i:function(n){this.g=n;this.eJ("ErrorText");return n},l:function(){return[this.c,this.e,this.f]},n:function(n){if(this.b!==n){this.b=n;this.eJ("Conductor")}return n}};_mcp.bd=function(n){this.b=n};_mcp.bd.prototype={b:0,a:null,c:!1,f:function(n){this.a!==n&&(this.a=n);return n},e:function(){var n="";switch(this.b){case 7:n=_nbs.a.Cl;break;case 6:n=_nbs.a.uw;break;case 5:this.c=!0;n=_nbs.a.lr;break}return n},d:function(){var n=0;switch(this.b){case 7:case 6:n=2;break;case 5:n=4;break}return n}};_mcp.bf=function(n){this.a=n};_mcp.bf.prototype={a:!1};_mcp.ch=function(n,t){this.a=n;this.b=t};_mcp.ch.prototype={a:null,b:null};_mcp.ci=function(n,t,i,r){this.j=new RegExp("<","g");this.i=new RegExp(">","g");this.d=n;this.a=t;this.e=i};_mcp.ci.prototype={e:0,a:null,d:!1,f:null,toString:function(){_j.e.a(_a.a.a,"Building message headers for reply/fwd. locally.");var a=this.n();var t=this.g(!0);var r=this.g(!1);r&&r.toLowerCase()!==t.toLowerCase()&&(t=String.format(_u.n.Ri,r,t));var o=this.a.cJ()||this.a.dQ();var w=o?o.toString():this.a.jb();var h=this.h(!0);var e=this.h(!1);var i,n;var s,u;this.o(s={val:i},u={val:n}),i=s.val,n=u.val;var p=this.b(_nbs.a.iv,t);var k=this.b(_nbs.a.MP,w);var b=h?this.b(_u.n.QO,h.join("; ")):null;var y=e?this.b(_u.n.Qr,e.join("; ")):null;var l=this.b(_u.P.e,a);var c=i?this.b(_u.P.R,i):null;var v=n?this.b(_u.P.J,n):null;var f=this.k(p,k,b,y,l,c,v);return this.d?'<p style="color:black;border-top:1pt solid #E1E1E1;padding-top:3pt;margin-top:0;margin-bottom:13pt;font-family:Calibri,sans-serif;font-size:11pt">'+f.join("<br/>")+"</p>":String.format("________________________________________{0}{1}{0}{0}","\r\n",f.join("\r\n"))},k:function(){for(var u=[],n=0;n<arguments.length;++n)u[n]=arguments[n];for(var f=new _j.q,r=u,e=r.length,t=0;t<e;++t){var i=r[t];_j.h.a(i)||f.c(i)}return f.i()},n:function(){if(this.a.bH.Subject)return this.a.bH.Subject;else{var n;switch(this.e){case 1:case 2:case 12:n=_u.n.OC;break;case 3:n=_nbs.a.cZ;break;case 8:n=_nbs.a.Uw;break;case 9:n=_nbs.a.se;break;case 10:n=_nbs.a.PW;break;case 5:case 6:case 7:n="";break;default:n="";break}return String.format(_nbs.a.nW,n,this.a.de()||_u.R.VL)}},g:function(n){if(_g.i.isInstanceOfType(this.a)){var r=this.a;var i=n?r.bH.From:r.bH.Sender;return i?this.c(i.Mailbox):null}else if(_dg.a.isInstanceOfType(this.a)){var t=this.a;return t.bH.Organizer?this.c(t.bH.Organizer.Mailbox):null}else return null},h:function(n){if(_g.i.isInstanceOfType(this.a)){var i=this.a;return this.m(n?i.q():i.A())}else if(_dg.a.isInstanceOfType(this.a)){var t=this.a;return this.l(n?t.v():t.t(),n)}else return null},o:function(n,t){var i=null;var r=null;n.val=t.val=null;if(_dg.r.isInstanceOfType(this.a)){var f=this.a;i=f.I();r=f.ea()}else if(_dg.a.isInstanceOfType(this.a)){var u=this.a;i=u;r=u}if(r){var e=this.f.a();n.val=e.a(r,null)||" "}i&&(t.val=i.x()?i.x().bH.DisplayName||" ":" ")},m:function(n){if(!n||!n.b())return null;var t=new _j.q;var i=this;n.n(function(n){t.c(i.c(n))});return t.i()},l:function(n,t){if(!n||!n.b())return t?[this.c(this.a.bH.Organizer.Mailbox)]:null;var i=new _j.q;var r=this;n.n(function(n){i.c(r.c(n.bH.Mailbox))});return i.i()},c:function(n){return n?n.Name||n.OriginalDisplayName||n.EmailAddress||"":""},b:function(n,t){return this.d?"<b>"+n+"</b> "+this.p(t):n+" "+t},p:function(n){if(!n)return null;n=n.replace(this.j,"&lt;");n=n.replace(this.i,"&gt;");return n}};_mcp.bu=function(n,t){this.l=Function.createDelegate(this,this.t);this.i=Function.createDelegate(this,this.m);this.j=Function.createDelegate(this,this.n);_mcp.bu.initializeBase(this);this.g=n;this.f=t};_mcp.bu.prototype={f:null,a:null,b:null,h:null,c:null,e:null,g:null,q:function(){this.c||(this.c=new _j.g(this.j,_a.a.a));return this.c},p:function(){this.e||(this.e=new _j.g(this.i,_a.a.a));return this.e},bU:function(){this.b||(this.b=new _y.A);return this.b},bt:function(n){this.b=n;return n},r:function(n){if(this.a!==n){this.a=n;this.eJ("ConsensusSchedulingViewModel")}return n},eL:function(){var t;_a.h.a(t={val:this.c}),this.c=t.val;var n;_a.h.a(n={val:this.a}),this.a=n.val;this.b=null;_a.gd.prototype.eL.call(this)},bx:function(){return 2},x:function(){return null},d:null,y:function(){return this.d},o:function(n){this.d=n;return n},bz:function(){return!1},s:function(n){if(this.a){this.a.a().g();this.g(this)}else if(this.f){var t=this;this.f.a(function(n){t.r(n.a(_a.d.a().d(),null,0));t.a.K(60);t.a.c(3);t.g(t)})}this.h=n},n:function(){this.d();_j.m.a().d(_a.a.a,"ClosePopupAndSubmitSelectedTimes",this.l)},t:function(){var n=this.a.a();this.h(n.f());this.h=null},m:function(){_a.b.c(_a.a.a,"AvailableTimeInsertCanceled");this.d()}};_mcp.cd=function(n,t,i,r,u){this.m=n;this.i=t;this.g=i;this.k=u;this.o=r;this.j=0;this.e=!!this.g&&this.g.a().bj().Enabled;this.n=!!this.g&&this.g.a().fv().Enabled;this.c=new _j.q;this.f=new _j.q;this.d={};this.h={};this.b={};this.l=0};_mcp.cd.prototype={m:null,i:null,g:null,k:null,o:null,e:!1,n:!1,j:0,d:null,h:null,b:null,c:null,f:null,l:0,p:function(){return this.o.bc().a()},dispose:function(){var t;var n=_a.b.b(_a.a.c,"GetSharingInformation",!1,(t=new _a.K,t.a=!0,t));n.q(new _a.y("Throttled_"+this.l.toString()));n.q(new _a.y("Total_"+this.j.toString()));_a.b.a(n);this.d=null;this.h=null;this.b=null;this.c.f();this.f.f()},x:function(n,t,i,r,u,f){if(this.e){if(f&&!this.k){_j.e.c(_a.a.f,"TryGetSharingInfoForSharePointLink: sharePointLinkDetector is null");return}(!f||this.k.a(t?t:n))&&this.a(n,i,r,u)}},a:function(n,t,i,r){if(!this.p()&&this.e){_j.e.a(_a.a.f,"TryGetSharingInfo: AttachmentWellViewModel is null");var u;this.c.c((u=new _mcp.cd.a,u.c=n,u.a=t,u.b=i,u))}else this.q(n,t,i,r)},r:function(){if(this.f.d.length){this.p().bx(this.f);this.f.f()}},u:function(){this.r();for(var n=0;n<this.c.d.length;n++)this.q(this.c.d[n].c,this.c.d[n].a,this.c.d[n].b,!1);this.c.f()},t:function(n){return n in this.d||n in this.b},q:function(n,t,i,r){if(n in this.d){var e=this.d[n];var s=i(e);this.s(s,e);return}if(n in this.b){_j.e.a(_a.a.f,"Waiting response of GetSharingInfoAction for {0}",t);this.b[n].c(i);return}if(!r&&this.e&&this.j++>=10){_j.e.a(_a.a.f,"GetSharingInfoAction has been throttled for {0}",t);++this.l;return}var f=_a.b.b(_a.a.f,"GetSharingInfo",!1,null);var h=new _db.N(n);this.b[n]=new _j.q([i]);var u=this,c=this,o=this;this.m.a(h,function(t){if(u.d&&_db.N.isInstanceOfType(t)){u.d[n]=t;for(var r=u.b[n],i=0;i<r.d.length;i++){var e=r.d[i];var f=e(t);u.s(f,t)}}},function(n){f.n="GetSharingInfoFailed";f.p=n.O();_j.e.a(_a.a.f,"GetSharingInfoFailed")},function(t){_a.b.a(f);o.b&&delete o.b[n]})},s:function(n,t){var u=t;var i=u.f;if(i&&i.ResultCode!==1&&i.ResultCode!==24){var r=n.c();if(_j.h.a(i.CanonicalUrl)&&this.e)r.f(!1);else{r.f(i.CanShareInternally);r.t(i.CanCreateOrganizationEditLink);r.u(i.CanCreateOrganizationViewLink);r.d(i.CanCreateAnonymousEditLink);r.e(i.CanCreateAnonymousViewLink);_j.h.a(i.CanonicalUrl)||r.c(i.CanonicalUrl)}switch(n.p()){case 3:n.e(6);break;case 2:n.e(5);break;case 5:n.e(4);break;case 4:n.e(3);break;default:n.e(0);break}i.IsOrganizationEditLinkAvailable&&r.k(i.OrganizationEditLink);i.IsOrganizationViewLinkAvailable&&r.l(i.OrganizationViewLink);this.e||r.c(u.e.attachmentUrl);n.t(r);this.w(n,i)}else this.v(n)},w:function(n,t){if(n.d()&&!(n.d()in this.h)){var i=n.m();i&&i.length||_j.e.a(_a.a.f,"LinkInfoManager.RaiseSharingTipsLinksUpdatedEvent: FileName is empty for {0}",n.d());var u=n.b()?n.b():0;var r=new _db.bW(n.d(),i,u,t.CanShareExternally,t.CanShareInternally);this.i.a(_db.P,new _db.P(r));this.h[n.d()]=!0}},v:function(n){if(n.d()&&!(n.d()in this.h)&&this.n){n.c().f(!1);var t=new _db.bW(n.d(),"",0,!1,!1);this.i.a(_db.P,new _db.P(t))}}};_mcp.cd.a=function(){};_mcp.cd.a.prototype={c:null,a:null,b:null};var IMailComposeSmartReplyComponent=function(){};IMailComposeSmartReplyComponent.registerInterface("IMailComposeSmartReplyComponent");_mcp.bj=function(){};_mcp.bj.prototype={setNoRestriciton:0,unknownClassification:1};_mcp.bj.registerEnum("_mcp.bj",!1);_mcp.bk=function(){};_mcp.bk.prototype={others:0,fullComposeCommandingBar:1,fullComposeBottomButton:2,inlineCompose:3};_mcp.bk.registerEnum("_mcp.bk",!1);var IMailComposeComponent=function(){};IMailComposeComponent.registerInterface("IMailComposeComponent");var IMailComposeAccCheckerComponent=function(){};IMailComposeAccCheckerComponent.registerInterface("IMailComposeAccCheckerComponent");_mcp.cn=function(){};_mcp.cn.registerInterface("_mcp.cn");var IMailComposeAttachmentComponent=function(){};IMailComposeAttachmentComponent.registerInterface("IMailComposeAttachmentComponent");var IMailComposeAutoSaveComponent=function(){};IMailComposeAutoSaveComponent.registerInterface("IMailComposeAutoSaveComponent");var IMailComposeCalendaringInfobarComponent=function(){};IMailComposeCalendaringInfobarComponent.registerInterface("IMailComposeCalendaringInfobarComponent");var IMailComposeCommandingBarComponent=function(){};IMailComposeCommandingBarComponent.registerInterface("IMailComposeCommandingBarComponent");var IMailComposeComplianceComponent=function(){};IMailComposeComplianceComponent.registerInterface("IMailComposeComplianceComponent");var IMailComposeContentConversionComponent=function(){};IMailComposeContentConversionComponent.registerInterface("IMailComposeContentConversionComponent");var IMailComposeContextMenuProvider=function(){};IMailComposeContextMenuProvider.registerInterface("IMailComposeContextMenuProvider");var IMailComposeContextMenuComponent=function(){};IMailComposeContextMenuComponent.registerInterface("IMailComposeContextMenuComponent");var IMailComposeDiscardComponent=function(){};IMailComposeDiscardComponent.registerInterface("IMailComposeDiscardComponent");var IMailComposeEditorComponent=function(){};IMailComposeEditorComponent.registerInterface("IMailComposeEditorComponent");var IMailComposeExtensibilityComponent=function(){};IMailComposeExtensibilityComponent.registerInterface("IMailComposeExtensibilityComponent");_mcp.co=function(){};_mcp.co.registerInterface("_mcp.co");var IMailComposeHashtagComponent=function(){};IMailComposeHashtagComponent.registerInterface("IMailComposeHashtagComponent");var IMailComposeImportanceComponent=function(){};IMailComposeImportanceComponent.registerInterface("IMailComposeImportanceComponent");var IMailComposeInitializerComponent=function(){};IMailComposeInitializerComponent.registerInterface("IMailComposeInitializerComponent");var IMailComposeLinkPreviewComponent=function(){};IMailComposeLinkPreviewComponent.registerInterface("IMailComposeLinkPreviewComponent");var IMailComposeMailTipsComponent=function(){};IMailComposeMailTipsComponent.registerInterface("IMailComposeMailTipsComponent");var IMailComposeMeetingComponent=function(){};IMailComposeMeetingComponent.registerInterface("IMailComposeMeetingComponent");var IMailComposeMessageOptionsComponent=function(){};IMailComposeMessageOptionsComponent.registerInterface("IMailComposeMessageOptionsComponent");var IMailComposePeopleRecommendationsComponent=function(){};IMailComposePeopleRecommendationsComponent.registerInterface("IMailComposePeopleRecommendationsComponent");var IMailComposeNavigationComponent=function(){};IMailComposeNavigationComponent.registerInterface("IMailComposeNavigationComponent");var IMailComposeOmeComponent=function(){};IMailComposeOmeComponent.registerInterface("IMailComposeOmeComponent");var IMailComposePALGenericAttachmentComponent=function(){};IMailComposePALGenericAttachmentComponent.registerInterface("IMailComposePALGenericAttachmentComponent");var IMailComposePhotoComponent=function(){};IMailComposePhotoComponent.registerInterface("IMailComposePhotoComponent");var IMailComposePolicyTipsComponent=function(){};IMailComposePolicyTipsComponent.registerInterface("IMailComposePolicyTipsComponent");var IMailComposeRecipientComponent=function(){};IMailComposeRecipientComponent.registerInterface("IMailComposeRecipientComponent");var IMailComposeRecipientSummarizationComponent=function(){};IMailComposeRecipientSummarizationComponent.registerInterface("IMailComposeRecipientSummarizationComponent");var IMailComposeSaveComponent=function(){};IMailComposeSaveComponent.registerInterface("IMailComposeSaveComponent");var IMailComposeSendAsContextMenuComponent=function(){};IMailComposeSendAsContextMenuComponent.registerInterface("IMailComposeSendAsContextMenuComponent");_mcp.cp=function(){};_mcp.cp.registerInterface("_mcp.cp");var IMailComposeSendComponent=function(){};IMailComposeSendComponent.registerInterface("IMailComposeSendComponent");var IMailComposeShareAttachmentComponent=function(){};IMailComposeShareAttachmentComponent.registerInterface("IMailComposeShareAttachmentComponent");var IMailComposeSignatureComponent=function(){};IMailComposeSignatureComponent.registerInterface("IMailComposeSignatureComponent");var IMailComposeTouchComponent=function(){};IMailComposeTouchComponent.registerInterface("IMailComposeTouchComponent");var IMailComposeUpgradeComponent=function(){};IMailComposeUpgradeComponent.registerInterface("IMailComposeUpgradeComponent");_mcp.bD=function(n,t,i,r,u){this.i=Function.createDelegate(this,this.l);this.h=Function.createDelegate(this,this.k);_mcp.bD.initializeBase(this,[36,n,i,r]);this.d=u;this.j=t};_mcp.bD.prototype={d:null,j:null,c:null,f:null,b:null,a:function(){this.c||(this.c=new _j.g(this.h,_a.a.dl));return this.c},m:function(){this.f||(this.f=new _j.g(this.i,_a.a.dl));return this.f},bC:function(){var n=new _fm.c(_nbs.a.ZT,null,this.a());return[n]},bN:function(){var n=_mcp.q.a(this.a(),_nbs.a.ZT);return[n]},bx:function(){return null},bz:function(){if(this.b){this.b.b();this.b.dispose()}this.c&&this.c.dispose();_mcp.q.prototype.bz.call(this)},k:function(){this.bk.fc&&this.bk.fc.a();var t=this.bk.y();if(this.b)this.b.a(t);else if(this.d){var n=this;this.d.a(function(i){n.b=i.a();n.b.c(n.a());n.b.d(n.m());n.b.a(t)})}},l:function(){var n=this.bi.bD();if(n){var t=new _cmc.bh;n.a(t)}}};_mcp.bE=function(n,t,i,r){this.r=Function.createDelegate(this,this.w);this.o=Function.createDelegate(this,this.x);this.q=Function.createDelegate(this,this.v);_mcp.bE.initializeBase(this,[32,n]);this.n=i;this.d=t;this.k=r};_mcp.bE.prototype={n:null,d:null,k:null,c:null,f:null,g:function(){if(this.e()){_j.e.b(_a.a.a,"MailComposeAtMentionComponent is already initialized, skipping redundant Initialize call.");return}if(this.d&&this.d.c()&&this.k){this.k.a(this.q);this.d.d()&&this.u()}_mcp.I.prototype.g.call(this)},bz:function(){this.c&&this.t();var n;_a.h.a(n={val:this.f}),this.f=n.val;_mcp.I.prototype.bz.call(this)},a:function(){return this.f},b:function(){return!this.d||!this.d.d()},p:function(){if(this.s()){var n=this.bj.a.bb;n.a(10302,null);this.bi.bi()}},y:function(){if(this.s()){var n=this.bj.a.bb;n.b(10302);this.bi.bi()}},j:function(n){if(this.bk)if(n.c()){this.c.a(n.a(),this.bk.fb);this.p()}else if(this.l()){var i=this.bi.bd().b(0);var t=this.bi.bd().b(1);this.c.b(n,this.bk.fb,i,t)}},m:function(n){if(n.a()&&this.bk){var t=this.bk.fb;if(n.c()){this.c.c(n.a(),t);_cmc.b.h(t)||this.y()}else if(this.l()){var i=this.bi.bd().b(0);this.c.d(n,t,i,_cmc.b.g)}}},h:function(){return this.bk?_cmc.b.f(this.bk.fb):null},i:function(n,t){if(this.l()){n.val=this.bi.bd().b(0).a();t.val=this.bi.bd().b(1).a()}else{n.val=null;t.val=null}},v:function(n){this.c=n;this.n.b(_y.dl,this.o)},u:function(){this.f=new _j.g(this.r,_a.a.a);_cmc.b.h(this.bk.fb)&&this.p()},t:function(){this.n.c(_y.dl,this.o);this.c=null},x:function(n){if(this.l()){var t=this.bi.bd().b(0);this.bk&&t&&n.b()===t.v()&&this.c.e(n.a(),this.bk.fb)}},w:function(){var t=_j.h.c("{0}{1}","OWAALLAM",_cmc.g.a());var r=_cmc.b.k("@all",t);var n=new _cmc.i(0,r,!0,7);n.q=!1;n.p=!0;this.bk.br(n);this.p();this.bk.fb[t]="at-all";var i=new _a.bt(1,"AtAllMention_AddedUsingButton");_a.A.b.a(i)},l:function(){return!!this.bi&&!!this.bi.bd()},s:function(){return!!this.bj&&!!this.bj.a&&!!this.bj.a.bb}};_mcp.m=function(n,t,i,r,u,f,e,o){this.bU=Function.createDelegate(this,this.cq);this.bx=Function.createDelegate(this,this.cz);this.bI=Function.createDelegate(this,this.cD);this.bC=Function.createDelegate(this,this.cA);this.bD=Function.createDelegate(this,this.cB);this.bG=Function.createDelegate(this,this.co);this.bH=Function.createDelegate(this,this.cC);this.bw=Function.createDelegate(this,this.cv);this.cb=Function.createDelegate(this,this.cn);this.ch=Function.createDelegate(this,this.cp);this.cf=Function.createDelegate(this,this.cI);this.cg=Function.createDelegate(this,this.cJ);this.cd=Function.createDelegate(this,this.cH);this.cc=Function.createDelegate(this,this.cE);this.bZ=Function.createDelegate(this,this.cx);this.ca=Function.createDelegate(this,this.cy);this.bW=Function.createDelegate(this,this.cs);this.bY=Function.createDelegate(this,this.ct);this.bV=Function.createDelegate(this,this.cr);this.t=this.a;_mcp.m.initializeBase(this,[5,n]);this.bq=i;this.W=u;this.bJ=t;this.N=new _j.g(this.bV,this.bl());this.bn=new _j.g(this.bY,this.bl());this.bm=new _j.g(this.bW,this.bl());this.V=r;this.bo=f;this.T=e;this.bu=o;this.bq&&this.bu&&(this.bP=this.bq.a().b().Enabled&&!this.bu.bH.IsShadowMailbox);this.U=new Array(2);this.U[0]=new _fm.c(_nbs.a.FX,null,this.N);this.U[0].a(!0);this.U[1]=new _fm.c(_nbs.a.MK,null,this.f());this.U[1].a(!0)};_mcp.m.c=function(){return _fm.b.b(_fm.a.cs,null,["ms-fcl-tp-b"],[_fm.WebfontSizes.a.a],null,null,null,null)};_mcp.m.b=function(){return _fm.b.b(_fm.a.ec,null,["ms-fcl-tp-b"],[_fm.WebfontSizes.a.a],null,null,null,null)};_mcp.m.prototype={X:null,bq:null,V:null,W:null,bJ:null,bo:null,bu:null,bP:!1,N:null,bn:null,bm:null,bf:null,bQ:null,bt:!1,O:null,S:null,bh:!1,T:null,bN:!0,bg:null,bd:null,bv:!1,bs:null,be:null,U:null,ba:null,n:function(){this.X||this.cm();return this.X},cM:function(n){if(this.X!==n){this.X=n;this.by("Menu")}return n},w:function(){if(!this.ba){var n=new Array(0);this.ba=new _fm.e(n);this.ba.p.a(new _fm.n(_nbs.a.ED));this.ba.p.a(new _fm.c(_nbs.a.BT,_mcp.m.c(),this.bn));this.ba.p.a(new _fm.c(_nbs.a.Nz,_mcp.m.b(),this.bm))}return this.ba},cK:function(n){if(this.bg!==n){this.bg=n;this.by("InsertButtonCommand")}return n},cL:function(n){if(this.bs!==n){this.bs=n;this.by("InsertButtonText")}return n},f:function(){if(!this.bf){var n=this;this.bf=new _j.w(this.ca,this.bl(),this.bj.a.ba,"BodyType",function(){return n.bj.a.ba.h()==="HTML"})}return this.bf},u:function(n){this.bB("AttachButtonPressed",n)},B:function(n){this.bF("AttachButtonPressed",n)},i:function(n){this.bB("AttachmentWellInitialized",n)},h:function(n){this.bF("AttachmentWellInitialized",n)},a:function(){return this.eM(_mcp.m.a)},D:function(n){this.eK(_mcp.m.a,n);return n},b:function(){return this.a()?this.a().l():!1},j:function(){return this.a()&&this.a().a()?this.a().a().x.length>0:!1},k:function(){return!!this.a()&&this.a().r()},x:function(){return this.a()?this.a().n():0},E:function(n){this.bN=n;return n},m:function(){var n=_a.o.a();return n.c()&&this.V.b()},R:function(){return this.U},Q:function(){return null},P:function(){return null},l:function(){return this.bc()&&this.V.a().hk().Enabled},G:function(n){this.U[0].a(n)},H:function(n){this.U[1].a(n)},Z:function(){if(this.bi.cL()&&!this.S){_j.e.a(_a.a.a,"Setting attachment component override");this.S=this.bi.cK().a();this.S.c(this.bZ);this.by("HideNewDocumentMenuButton")}},Y:function(){if(this.S){this.S.a();this.S=null;this.by("HideNewDocumentMenuButton")}},g:function(){var n=this.bk;this.Z();this.cm();if(this.a()){var t=n.W();this.a().cj(n.k(),n.s(),t,n.d(),n.bg());this.ck(n,t)}else this.bJ.a(this.cc)},cx:function(){return this.a()},cD:function(n,t){t==="EditorCallContext"&&this.bi.bD().a(this.a().bd())},s:function(n){this.bQ&&this.bQ.a(!n)},cA:function(n){if(_a.bu.a){var t=this.bi;_j.m.a().c(_a.a.M,"SafeTriggerPolicyTipsIfNeededForAttachmentAdded",this.cd)}this.bj.a.dC(this.bj.a.cs)},cB:function(){var t=this.bj.a;var n=t.ba;var i=t.bO();var r=!!i&&i.k();if(n.k()){this.cl(n);this.a()&&this.a().h(n.k(),n.s(),n.bg())}else r||t.bl().a("Attach",this.cg,this.cf,!1)},K:function(){if(!this.bt&&this.a()){var n=this.bj.a.ba;if(_y.c.a.a()==="Mouse")this.a().h(n.k(),n.s(),n.bg());else{_j.e.a(_a.a.a,"Delaying attachment refresh because we're in not in mouse layout.");this.a().bK(n.k(),n.s(),n.bg(),this.ch)}this.cp();this.bj.a.be.a(_y.fu,new _y.fu);this.bt=!0}},v:function(){this.bv||(this.bk.b()?this.cn():this.bi.fG(this.cb))},z:function(n){this.a()&&this.a().G(n)},I:function(n){if(this.V.b()){this.be=n;this.be.h(this.bw)}},C:function(){var e=this.bi.bD();var r=this.o();var i=0;if(r&&e)for(var t=r.x.length-1;t>=0;t--){var n=r.x[t];if(n.a().a()&&n.c()){var f=new _cmc.bk(n.a().bH.ContentId);e.a(f);if(!f.b){_j.e.b(_a.a.cg,"[RemoveUnreferencedInlineAttachments] Removing inline image cid: {0}",n.a().bH.ContentId);this.r(n,!1);i++}}}if(i>0){var u=new _cmc.h(_a.a.cg,"RemoveUnusedInlineImages",!1);u.a("R",i,!0,!0);u.b();return!0}return!1},q:function(){this.a()&&this.N.a()},cO:function(){if(this.be){this.be.j(this.bw);this.be=null}},cv:function(n){if(this.j()&&_zz.o.isInstanceOfType(n.d())){var t=n.d();t.ch()||this.C()}},cp:function(){var n=this.bj.a.ba;if(n.eU)if(n.s()){var t=new _j.l;t.j(n.s().f());n.eU.p(t);n.eR()&&n.eR().p(t)}else{n.eU.p(null);n.eR()&&n.eR().p(null)}},y:function(){var n=[];var t=this.bj.b(13);var i=this.bj.b(20);if(t){t.a().b&&Array.add(n,new _y.i(_u.P.p,t.a()));t.b().b&&Array.add(n,new _y.i(_u.P.Q,t.b()));this.bc()&&Array.add(n,new _y.i(this.bb(),this.N))}else i?Array.add(n,new _y.i(this.bb(),i.a())):_a.o.a().B()&&Array.add(n,new _y.i(this.bb(),this.N));return n},p:function(){var n=new _j.q;var t=this.bj.b(13);var i=this.bj.b(20);if(t){t.a().b&&n.c(new _fm.c(_u.P.p,null,t.a(),!1,null,_u.P.L));t.b().b&&n.c(new _fm.c(_u.P.Q,null,t.b(),!1,null,_u.P.C));this.bc()&&n.c(new _fm.c(this.bb(),null,this.N,!1,null,this.br()))}else i?n.c(new _fm.c(this.bb(),null,i.a(),!1,null,this.br())):_a.o.a().B()&&n.c(new _fm.c(this.bb(),null,this.N,!1,null,this.br()));return n},L:function(){var n=this.bj.a.ba;if(!_j.h.a(n.bI())&&!this.bh&&n.k()&&this.a()){this.bh=!0;var t=!1;try{this.a().bC(n.bI(),this.bH,this.bG);t=!0}finally{t||(this.bh=!1)}}},M:function(n){this.bo&&this.a()&&this.bo.a(this.a(),this.bl()).b(n)},o:function(){return this.a().a()},r:function(n,t){this.a().o(n,t)},cr:function(){var t=this.bj.a;var i=t.ba;_j.e.a(_a.a.a,"Insert attachment start");this.bO("AttachButtonPressed",this);if(this.a())if(this.S)this.S.b(!1);else if(this.bc()){var n=_a.b.b(_a.a.c,"AttachmentsFilePickerPanelOpen",!1,null);_j.e.a(_a.a.a,"Opening OWA's file picker");this.bR(n,0)}else{_j.e.a(_a.a.a,"Opening OS's file picker");this.a().g(!1,null,null,null)}this.bi.bk().a("AttachFile");_j.e.a(_a.a.a,"Insert attachment end")},ct:function(){_j.e.a(_a.a.a,"Opening OS's file picker without showing owa file picker");var t=_a.b.b(_a.a.c,"DirectlyAttachFromComputer",!1,null);if(this.W){var n=this;this.W.a(function(i){n.O=i;n.O.b(!n.T.AttachmentDataProviderAvailable&&n.T.GroupsOneDriveDataProviderAvailable);n.O&&n.O.d(n.a(),t,n.bj.a.bI,!!n.bi.bL()&&n.bi.bL().a(),n.bi.ba.h()==="Text")})}},cs:function(){var n=_a.b.b(_a.a.c,"AttachFromCloudLocations",!1,null);_j.e.a(_a.a.a,"Attach from cloud locations");this.bR(n,0)},cz:function(n,t){this.a()&&this.a().cs(this.bi.bl().c())},cy:function(){var t=this.bj.a;var i=t.ba;_j.e.a(_a.a.a,"Insert picture start");if(this.a()){if(this.S)this.S.b(!0);else if(this.bP){var n=_a.b.b(_a.a.c,"AttachmentsFilePickerPanelOpen",!1,null);this.bR(n,1)}else this.a().g(!0,null,null,null);this.bi.bk().a("InsertPicture")}_j.e.a(_a.a.a,"Insert picture end")},bz:function(){var n=this.a();if(n){n.I(this.bD);n.w(this.bC);n.rpcl("EditorCallContext",this.bI);this.bi.bl().rpcl("IsSaving",this.bx);this.a().bq(this.bi.dl);n.dispose();this.D(null)}this.O=null;var r;_a.h.a(r={val:this.bf}),this.bf=r.val;var i;_a.h.a(i={val:this.N}),this.N=i.val;this.bg=null;var t;_a.h.a(t={val:this.X}),this.X=t.val;this.bt=!1;this.Y();this.cO();this.bK(0);_mcp.I.prototype.bz.call(this)},cm:function(){if(!this.X){var n=[];this.cK(this.N);this.cL(_nbs.a.WS);if(!this.bi.bn()){if(this.l()){var r=new _fm.c(_nbs.a.BT,_mcp.m.c(),this.bn);Array.add(n,r);var i=new _fm.c(_nbs.a.Nz,_mcp.m.b(),this.bm);Array.add(n,i)}else{var t=new _fm.c(this.bb(),null,this.N,!1,null,this.br());Array.add(n,t)}this.cM(new _fm.e(n))}}},ck:function(n,t){this.a().cr(!n.l());_j.e.a(_a.a.a,"Attachment component initialized, ReadOnly={0}",t);n.l()&&this.K();this.cN(n);this.cu(n);_mcp.I.prototype.g.call(this)},cE:function(n){if(!this.e()){var t=this.bk;var i=this.bi;if(this.bp()){_j.e.a(_a.a.a,"InitializeAttachmentWell is exiting early due to null context and/or view model disposing.");return}var h=t.W();var o=!((t.a()===4||t.a()===13)&&!this.V.b());var u=i.bd();var e=!!u.c().a||!!u.h().a||!!u.o().a;if(_y.c.a.a()==="TouchNarrow")this.D(n.a(t.k(),t.s(),t.W(),o,t.bg(),!0,i.bb,t.d(),e));else{var r=n.b(t.k());r.c(t.K());r.l(1);r.k(t.df()==="PlainText");var f=t.V();var s=f?f.EmailAddress:null;this.D(n.e(r,t.s(),t.W(),_y.c.a.a()==="Mouse"?3:0,o&&this.bN,t.bg(),!0,i.bb,t.d(),i.bw,i.dF,i.bI,s,e))}this.a().v(this.bD);this.a().u(this.bC);this.a().apcl("EditorCallContext",this.bI);this.a().X(i.dl);this.bi.bl().apcl("IsSaving",this.bx);this.bO("AttachmentWellInitialized",this);this.ck(t,h);i.dC(this.bj.a.cs);i.fH()}},cu:function(n){if(n&&this.a()&&n.a()===3&&this.a().r()){var t=_a.b.b(_a.a.c,"IntentToForwardReferenceAttachment",!1,null);_a.b.a(t)}},cl:function(n){n.s()||n.T(new _j.l)},cJ:function(n){var i=this.bj.a;var t=i.ba;if(n.ba===t.d()){this.cl(t);this.a()&&this.a().h(t.k(),t.s(),t.bg());this.L()}},cI:function(n){var t=this.bj.a;var i=t.ba;if(this.a()&&n.ba===i.d()){this.a().K();t.bh.r||t.bh.h(0,_nbs.a.te,null);this.L()}},bR:function(n,t){if(this.W){var i=this;this.W.a(function(r){i.O=r;i.O.b(!i.T.AttachmentDataProviderAvailable&&i.T.GroupsOneDriveDataProviderAvailable);i.O&&i.O.a(i.a(),n,!1,i.bj.a.bI,i.bj.a.bw,!!i.bi.bL()&&i.bi.bL().a(),i.bi.ba.h()==="Text",t)})}},A:function(){if(this.bc()&&this.W){var n=this;this.W.a(function(t){n.O=t;n.O&&n.O.e()})}},bc:function(){return!this.bk.R()&&!!this.V&&!!this.T&&this.V.j(this.T.AttachmentDataProviderAvailable||this.T.GroupsOneDriveDataProviderAvailable)},cC:function(n){this.bj.a.ba.cE(null);this.co(n)},co:function(n){n.D(this.bH);n.bd(this.bG);this.bh=!1},bb:function(){return this.bc()?_u.P.m:_u.P.A},br:function(){return this.bc()?_u.P.Z:_u.P.E},cn:function(){if(this.bk){this.bi.bb.b(10301);var n=this.bk.b();if(_g.i.isInstanceOfType(n)&&!n.bA()&&n.bH.HasAttachments&&n.eH()&&this.bk.hi()){var f=this.bi.fz().a(n);if(!f.length)return;for(var u=0,r=0;r<n.eH().b();r++){var t=n.eH().c(r);if(!t.a()||_dg.b.isInstanceOfType(t)){_j.e.a(_a.a.a,"Found attachments from original item to be added: {0}, show infobar.",t.bH.Name);u++}}if(u>0){this.bd=new _cmc.h(_a.a.a,"AddOriginalAttachment",!1);var i=this;var e=new _mcp.Q(f,u,this.bU,function(){i.bv=!0;i.bi.bb.b(10301);i.bK(-1)});this.bi.bb.d(10301,e,null)}}}},cq:function(){this.bv=!0;this.bi.bb.b(10301);var t=this.bk.b();if(t){for(var i=new _j.q,r=0;r<t.eH().b();r++){var n=t.eH().c(r);if(n.a()&&!_dg.b.isInstanceOfType(n)){_j.e.a(_a.a.a,"Skip adding original attachment: {0}. IsInline: {1}",n.bH.Name,n.a());continue}var u=new _db.F(n.r(),t.bH.ItemId.Id);i.c(u);_j.e.a(_a.a.a,"Original attachment '{0}' added to the collection.",n.bH.Name)}if(i.d.length>0){this.M(i);this.bK(i.d.length)}}},bK:function(n){if(this.bd){this.bd.a("A",n,!0,!0);this.bd.b();this.bd=null}},cH:function(){_mcp.I.a(this.bi,8)},cN:function(n){if(n.U()&&n.U().x.length>0){_j.h.a(n.cw())||this.a().L(n.cw());_j.h.a(n.ck())||this.a().x(n.ck());this.a().P(new _h.ci(n.U().f()));n.U().g()}}};_mcp.Y=function(n,t,i,r,u){this.C=Function.createDelegate(this,this.bh);this.M=Function.createDelegate(this,this.bm);this.N=Function.createDelegate(this,this.bn);this.D=Function.createDelegate(this,this.bq);_mcp.Y.initializeBase(this,[n,t,i,r,u])};_mcp.Y.prototype={p:null,g:function(){var n=this.bi;var t=n.ba;_j.e.a(_a.a.a,"Enabling timer during initialization of auto save component");this.p=this.bo();this.p.b=!0;if(!t.bo()){this.br();_j.e.a(_a.a.a,"Auto save timer started")}_mcp.z.prototype.g.call(this);n.be.b(_a.cP,this.D)},bh:function(){var r=this.bi;var n=r.ba;if(!this.bT&&!n.bo()){if(!n.bN()){_j.e.a(_a.a.a,"Auto Save not supported for the current operation {0}",n.a());return}var u=this.bi.bc();_j.e.a(_a.a.a,"Checking dirty before auto save");var t=r.cb();var i=u.b();if(t&&!i){_j.e.a(_a.a.a,"AutoSave");this.p.e();this.a("AutoSave",this.N,this.M,!1)}else{this.p.c();_j.e.a(_a.a.a,"Skip auto save since IsDirty={0}, AttachmentInProgress={1}",t,i)}}},br:function(){var n=this.bj.a.ba;!n.bo()&&n.bN()&&this.p.c()},k:function(){this.p&&this.p.h()},bz:function(){this.k();this.bi.be.c(_a.cP,this.D);_mcp.z.prototype.bz.call(this)},bo:function(){return new _mcp.cf(this.C,this.E())},E:function(){return 3e4},L:function(n){_mcp.z.prototype.L.call(this,n);this.n&&n==="AutoSave"&&this.n.q(_mcp.Y.a)},bq:function(n){_j.m.a().c(_a.a.a,"Autosave triggered for PAL OnPause event",this.C)},bn:function(n){var i=this.bj;var r=i.a;var t=r.ba;t.dX(!0);t.bo()||this.p.c()},bm:function(n){_j.e.a(_a.a.a,"AutoSaveActionFailed: Error: {0}",n.G.message);this.bj.a.ba.bo()||this.p.c()}};_mcp.y=function(n,t,i){this.x=Function.createDelegate(this,this.T);this.r=Function.createDelegate(this,this.R);this.s=Function.createDelegate(this,this.S);this.k=Function.createDelegate(this,this.Q);_mcp.y.initializeBase(this,[0,n]);this.w=t;this.t=i};_mcp.y.prototype={t:null,j:null,i:null,n:null,p:null,q:null,o:null,l:null,d:null,z:null,w:null,b:function(){return this.z},a:function(){return this.d},U:function(n){if(this.d!==n){this.d=n;this.by("ComposeCommandingBar")}return n},A:function(){return this.bk.R()?this.bi.bg().a():this.bi.bg().q()},O:function(){var n=this.bj.b(3);var t=n.T();return n.U(t)},C:function(){return this.bi.bq().a()},P:function(){return this.bi.bj().j()},I:function(){return this.bi.bm().b()},L:function(){return this.bi.bl().j()},m:function(){return this.bi.bc().n()},v:function(){this.q||(this.q=new _fm.f(this.P(),_u.P.N,_mcp.e.t(),0,null,_mcp.e.u(),!1,!1,!1,!1,null));return this.q},N:function(){this.j||(this.j=this.bk.R()?new _fm.f(this.A(),_u.P.h,_mcp.e.N(),0,null,null,!1,!1,!1,!1,null):new _fm.f(this.A(),_u.P.D,_mcp.e.P(),0,null,null,!1,!1,!1,!1,null));return this.j},u:function(){this.o||(this.o=new _fm.f(this.O(),_u.n.Hp,null,0,null,null,!1,!1,!1,!1,null));return this.o},D:function(){this.l||(this.l=new _fm.f(this.C(),_u.n.Pi,null,0,null,null,!1,!1,!1,!1,null));return this.l},E:function(){if(!this.i)if(this.m().p.x.length>1){var n=this.bi.bc().l()?_nbs.a.WS:_nbs.a.jD;var t=this;this.i=new _fm.l(n,function(n){n(t.m())},0,n,!1,!1,_mcp.e.j(),null,!1,null)}else this.m().p.x.length===1&&(this.i=new _fm.f(this.m().p.x[0].j,_nbs.a.WS,_mcp.e.j(),0,null,null,!1,!1,!1,!1,null));return this.i},K:function(){this.n||(this.n=new _fm.f(this.I(),null,_mcp.e.L(),0,_u.n.CO,null,!0,!1,!1,!1,null));return this.n},M:function(){this.p||(this.p=new _fm.f(this.L(),null,_mcp.e.A(),0,_u.n.Ma,null,!0,!1,!1,!1,null));return this.p},H:function(){return this.t.l()},G:function(){return!!this.bi&&!!this.bi.bK&&!!this.bi.bK.a()&&!!this.bi.bK.a().e()&&this.bi.bK.a().e().Enabled},g:function(){if(this.e()){_j.e.a(_mcp.y.a,"Commanding bar component is already initialized, skipping redundant Initialize call.");return}if(!this.bi.bn()){_j.e.a(_mcp.y.a,"Initializing compose commanding bar");this.U(new _fm.k(_u.R.Uz,_u.R.Uz,_u.R.HJ));this.d.ba=!0;this.d.L=!0;this.d.p=!0;this.h(this.N(),!0);this.h(this.E(),!0);this.bk.m()!==3&&this.bi.bu()&&!this.G()&&this.h(this.v(),!1);if(this.bi.bL()&&this.bi.bL().d())if(this.bi.bo.WasLoadedFromServer&&this.bi.bo.RmsTemplates.length>0)this.h(this.u(),!0);else{this.h(this.u(),!1);var n=this.bi.be;n.b(_a.cn,this.k)}this.h(this.D(),!0);(this.w.b||this.bi.bu())&&!this.bk.dl()&&this.h(this.M(),!0);this.bj.a.apcl("ShouldShowToolbarMessage",this.s);if(this.bi.bA().e()){_j.e.a(this.bl(),"Primary init is complete; creating commanding bar affordance menu synchronously.");this.y()}else{_j.e.a(this.bl(),"Scheduling commanding bar affordance menu creation because primary initialization has not finished.");this.bi.bA().apcl("IsInitialized",this.r)}this.bj.a.bu()||this.bj.a.ba.m()===3||this.h(this.K(),!0);this.d.A();this.B(this.bi.bj().n());this.c(0);_j.e.a(_mcp.y.a,"Completed initializing compose commanding bar")}_mcp.I.prototype.g.call(this)},c:function(n){if(this.d){var u=this.bi.bu();var r=this.H();var t;var i;if(u){t=0;i=0}else{t=r?20:n;i=r?n:20}this.d.bC(t);this.d.bc(i)}},bz:function(){this.bj.a.rpcl("ShouldShowToolbarMessage",this.s);this.bi.be.c(_a.cn,this.k);var n;_a.h.a(n={val:this.d}),this.d=n.val;_mcp.I.prototype.bz.call(this)},y:function(){_j.e.a(_mcp.y.a,"Adding affordance items to compose commanding bar");var n=new _j.q;this.f(n,8);this.f(n,11);this.f(n,1);this.f(n,28);this.f(n,6);this.f(n,3);this.f(n,15);this.f(n,9);this.f(n,36);this.f(n,37);for(var t=0;t<n.d.length;t++)this.d.a(n.d[t]);var i=n.d[0];i?_j.e.a(_mcp.y.a,"Completed added affordance items to compose commanding bar"):_j.e.b(_mcp.y.a,"Affordance menu item at index 0 is null.")},f:function(n,t){var r=null;var i=this.bj.b(t);if(i&&IMailComposeContextMenuProvider.isInstanceOfType(i)){_j.e.a(_a.a.a,"Getting affordance menu items for type '{0}', IsInitialized = {1}",Object.getType(i).getName(),i.e());i.e()||i.g();r=i;n.h(r.Q())}},h:function(n,t){if(!this.d.ch(n)){n.b(!0);n.c(t);this.d.a(n)}},S:function(n,t){var i=!this.bj.a.ce;this.V(i)},Q:function(n){var t=this.bj.a;t.bo.RmsTemplates&&t.bo.RmsTemplates.length>0&&this.u().c(!0);t.be.c(_a.cn,this.k)},V:function(n){if(this.d)for(var r=this.d.b.x.length,t=0;t<r;t++){var i=this.d.b.x[t];i&&i.d!==1&&i.b(n)}},B:function(n){this.d&&!this.d.bT&&this.d.ch(this.v())&&this.v().c(n)},R:function(n,t){this.bi.bA().rpcl("IsInitialized",this.r);_j.m.a().c(_a.a.a,"AddAffordanceMenuItemsToComposeCommandingBar",this.x)},T:function(){if(!this.bT&&this.d&&!this.d.bT&&this.d.b){this.d.p=!0;this.y();this.d.A()}else _j.e.a(this.bl(),"OnInitializerComponentPrimaryInitCompleted - commanding bar or its item collection is null, skipping affordance async init.")}};_mcp.F=function(n,t,i,r,u){this.H=Function.createDelegate(this,this.Y);this.K=Function.createDelegate(this,this.bc);this.v=Function.createDelegate(this,this.ba);this.I=Function.createDelegate(this,this.bb);this.A=Function.createDelegate(this,this.X);this.L=Function.createDelegate(this,this.G);_mcp.F.initializeBase(this,[3,n,r,u]);this.S=i;this.n=!1;this.E=t;var e=_g.a.a().bH.RmsV2UIEnabled;var o=!!r&&!!r.a().bn()&&r.a().bn().Enabled;this.t=e||o;var s=this.bi;var f=new _g.cu;f.t("CF5CF348-A8D7-40D5-91EF-A600B88A395D");f.q(_g.a.a().c().bH.UserEmailAddress);f.s(0);f.u(_u.n.Dz);f.k(_u.n.Dh);this.i=f};_mcp.F.b=function(n,t){return new _y.i(n,t)};_mcp.F.c=function(n,t){return new _fm.c(n,null,t,!0)};_mcp.F.prototype={S:null,y:null,m:null,x:null,p:null,s:!1,z:null,u:null,h:null,r:null,o:null,l:null,E:null,C:null,i:null,t:!1,b:function(){return"IsIrmProtected"},T:function(){return"CF5CF348-A8D7-40D5-91EF-A600B88A395D"},k:null,j:null,a:function(){return this.s},q:function(n){if(this.s!==n){this.s=n;this.by("IsIrmProtected")}return n},f:function(){return this.z},Z:function(n){if(this.z!==n){this.z=n;this.by("ShowIrmInformationCommand")}return n},c:function(){return this.h},V:function(n){if(this.h!==n){this.h=n;this.by("DialogViewModel")}return n},n:!1,w:function(){var i=_g.a.a();if(i.e()&&!i.e().bH.Irm||this.bU.c()){_j.e.a(_a.a.a,"IRM segmentation flag has been turned off or user is consumer, cannot set compliance.");return!1}var n=this.bj.a.ba.q();var t=!n||!!n.a()||n.b()||n.n();_j.e.a(_a.a.a,"CanSetCompliance={0}",t);return t},U:function(n){return new _j.g(this.W(n),this.bl())},D:function(){return!this.bk.R()&&this.w()},d:function(){return this.t},g:function(){var n=this.bi;var r=n.ba;var o=n.eU;var i=n.bo;if(this.w())if(_g.k.b){_j.e.a(_a.a.a,"Checking main window for compliance configuration");this.j=_mcp.F.a;i.IsLoadingFromServer=!0;_g.k.b.kl(this.L)}else if(i.WasLoadedFromServer)this.G(i);else{_j.e.a(_a.a.a,"Adding the loading permissions menu item");this.j=_mcp.F.a;if(!i.IsLoadingFromServer){_j.e.a(_a.a.a,"Submitting GetComplianceConfigurationAction");var l=n.be;l.b(_a.cn,this.A);var s=new _h.cv(i,n.be);s.h()}}else if(this.j&&this.n&&o.a){n.eU.t(this.j);this.n=!1}var t=r.q();this.q(!!t&&!t.a());this.u||(this.u=new _j.g(this.I,this.bl()));if(this.s&&"Mouse"===_y.c.a.a())if(this.t){var c=n.bs();var f=t.bH.TemplateDescription;t.bH.RmsTemplateId.toLowerCase()===this.i.bH.RmsTemplateId.toLowerCase()&&(f=this.i.bH.TemplateDescription);var h=new _mcp.v(t.bH.TemplateName,f,new _j.g(this.v,this.bl()),this.u,t.b(),!1);c.d(4499,h,null)}else{var u=n.bs();u.a.apply(u,[4499].concat([t.bH.TemplateName,t.bH.TemplateDescription]))}else if(r.bj()){var e=n.bs();e.a.apply(e,[3800].concat([r.cm(),r.cn()]))}"Mouse"===_y.c.a.a()||this.z||this.Z(new _j.g(this.K,this.bl()));_mcp.q.prototype.g.call(this)},bz:function(){this.bi.be.c(_a.cn,this.A);var i;_a.h.a(i={val:this.h}),this.h=i.val;var r;_a.h.a(r={val:this.o}),this.o=r.val;var n;_a.h.a(n={val:this.l}),this.l=n.val;var t;_a.h.a(t={val:this.r}),this.r=t.val;this.q(!1);_mcp.q.prototype.bz.call(this)},bC:function(){if(this.t){if(this.w()&&this.bi.bo.WasLoadedFromServer&&this.bi.bo.RmsTemplates&&this.bi.bo.RmsTemplates.length>0){this.r=new _fm.c(_u.n.Hp,null,this.U(this.i.bH.RmsTemplateId));this.r.v(_u.n.Hp);return[this.r]}}else if(this.D()){!this.k&&this.bi.bo.WasLoadedFromServer&&this.B();if(this.k){this.m=new _fm.j(_nbs.a.sf,null,this.k);return[this.m]}else if(this.w()&&this.bi.bo.IsLoadingFromServer){this.m=new _fm.j(_nbs.a.sf,null,null);this.m.a(!0);this.y=new _fm.c(_u.P.g,null,null);return[this.y,this.m]}else _j.e.b(_a.a.a,"Compliance sub-menu creation has been skipped.")}return null},bN:function(){if(this.D()&&!this.t){var n=this;this.p=new _fm.l(_nbs.a.sf,function(t){t(n.k)},1,null,!1,!1,null,null,!1,null);if(this.k)return[this.p];else if(this.w()&&this.bi.bo.IsLoadingFromServer){this.p.b(!1);this.x=_mcp.q.a(null,_u.P.g);return[this.p,this.x]}}return null},bx:function(){if(this.D())return[this.j];else{this.n=!1;return null}},cd:function(){this.x&&this.x.b(!1);if(!this.k&&this.bi.bo.WasLoadedFromServer){this.B();this.k||(this.p=null)}this.p&&this.p.b(!0)},ca:function(){this.y&&this.y.a(!0);if(!this.k&&this.bi.bo.WasLoadedFromServer){this.B();this.k||(this.m=null)}if(this.m){this.m.E(this.k);this.m.a(!1)}},cx:function(){this.j&&this.bi.eU&&this.bi.eU.t(this.j);this.j=null;this.n=!1;this.B()},O:function(n){var t=this.bj.a.bo;var e=t.RmsTemplates?t.RmsTemplates.length:0;var o=t.MessageClassifications?t.MessageClassifications.length:0;if(0===e&&0===o){_j.e.a(_a.a.a,"There are neither RmsTemplates nor message classifications available, skip setup of the compliance sub context menu.");return null}var i=new Array(1+e+o);var f=0;i[f++]=n(_nbs.a.q,new _j.g(this.v,this.bl()));for(var u=0,r=0;u<e||r<o;)if(u===e){var c=t.MessageClassifications[r++];i[f++]=n(c.Name,new _j.g(this.M(c.Id),this.bl()))}else if(r===o){var l=t.RmsTemplates[u++];i[f++]=n(l.Name,new _j.g(this.N(l.Id),this.bl()))}else{var s=t.MessageClassifications[r];var h=t.RmsTemplates[u];if(0<h.Name.localeCompare(s.Name)){i[f++]=n(s.Name,new _j.g(this.M(s.Id),this.bl()));r++}else{i[f++]=n(h.Name,new _j.g(this.N(h.Id),this.bl()));u++}}return i},B:function(){if("Mouse"===_y.c.a.a()||_y.c.a.a()==="TouchNarrow"){var i=this.O(_mcp.F.c);i&&(this.k=new _fm.e(i))}else if(!this.n){if(!this.j){var t=this.O(_mcp.F.b);t&&(this.j=new _y.i(_nbs.a.sf,null,t))}var n=this.bi.eU;if(this.j&&n){var r=n.a;if(r){this.ck=[this.j];this.bi.bM().b();this.n=!0}}}},X:function(n){if(!this.bp()){var t=this.bj.a;this.G(t.bo);t.be.c(_a.cn,this.A)}},G:function(n){var t=this.bi;t.bo=n;_j.e.a(_a.a.a,"Updating menu with complete compliance configuration.");n.WasLoadedFromServer&&this.bs()},ba:function(){var t=this.bj.a;var n=t.ba;t.bk().a(_mcp.bj.toString(0));_j.e.a(_a.a.a,"Set no restriction");n.bq("0");var i=t.bs();if(n.q()){"Mouse"===_y.c.a.a()&&i.b(4499);n.bs(null);this.q(!1)}else if(n.bj()){i.b(3800);n.bB(!1);n.by(null);n.bz(null);n.bA(null)}},N:function(n){var t=this;return function(){var f=t.bj.a;var i=f.ba;i.bq(n);if(!(t.bu&&t.bu.a().bG().Enabled)&&f.bc()&&f.bc().k()){_j.e.a(t.bl(),"Cannot set permission because the message has reference attachments.");t.bj.a.bh.h(0,_nbs.a.uR,null);return}var h=new _cmc.h(_a.a.a,"MailComposeSetIRM",!0);if(i.bj()){f.bb.b(3800);t.bi.bi();i.bB(!1);i.by(null);i.bz(null);i.bA(null)}for(var s=f.bo.RmsTemplates,o=0;o<s.length;o++){var u=s[o];if(n.toLowerCase()===u.Id.toLowerCase()){var c="Permission_"+u.Id.toLowerCase();f.bk().a(c);var r=new _g.cu;r.t(n);r.q(_g.a.a().c().bH.UserEmailAddress);r.r(!0);r.s(0);r.u(u.Name);r.k(u.Description);r.p(i.h());i.bs(r);if("Mouse"===_y.c.a.a()){var e=f.bs();e.b(4499);e.a.apply(e,[4499].concat([u.Name,u.Description]))}t.q(!0);_j.e.a(_a.a.a,"Set IRM {0}",u.Name);break}}h.b()}},W:function(n){var t=this;return function(){if(!t.s){var r=t.bi;var i=r.ba;i.bq(n);if(r.bc()&&r.bc().k()){_j.e.a(t.bl(),"Cannot set permission because the message has reference attachments.");t.bj.a.bh.h(0,_nbs.a.uR,null);return}if(i.bj()){r.bb.b(3800);t.bi.bi();i.bB(!1);i.by(null);i.bz(null);i.bA(null)}var e=new _cmc.h(_a.a.a,"MailComposeSetIRM",!0);if(n.toLowerCase()===t.i.bH.RmsTemplateId.toLowerCase()){if("Mouse"===_y.c.a.a()){var u=r.bs();u.b(4499);t.i.r(!0);t.i.p(i.h());i.bs(t.i);var f=new _mcp.v(t.i.bH.TemplateName,t.i.bH.TemplateDescription,new _j.g(t.v,t.bl()),t.u,t.i.b(),!1);u.d(4499,f,null)}t.q(!0);_j.e.a(_a.a.a,"Set IRM {0}",t.i.bH.TemplateName)}e.b()}}},M:function(n){var t=this;return function(){var u=t.bj.a;var r=u.ba;r.bq(n);if(r.q()&&"Mouse"===_y.c.a.a()){var s=u.bs();s.b(4499);r.bs(null);t.q(!1)}for(var o=u.bo.MessageClassifications,f=0;f<o.length;f++){var i=o[f];if(n.toLowerCase()===i.Id.toLowerCase()){var h="Classification_"+i.Id.toLowerCase();u.bk().a(h);r.bB(!0);r.by(i.Name);r.bz(i.Description);r.bA(i.Id);var e=u.bs();e.b(3800);e.a.apply(e,[3800].concat([i.Name,i.Description]));_j.e.a(_a.a.a,"Set class {0}",i.Name);break}}}},bc:function(){var t=this.bj.a.ba;if(t.q()){var n=t.q();this.bd(n.bH.TemplateName,n.bH.TemplateDescription,n.bH.ContentOwner)}else _j.e.c(_a.a.a,"ShowIrmInformation was triggered without pre-existing license data or compliance entry selected.")},bd:function(n,t,i){if(!this.h){this.V(new _bc.n);this.h.p.a(new _ff.d(this.h.q,_nbs.a.Ef,null,!0,!1))}this.h.s(n);this.o||(this.o=new _mcp.bn);this.o.d(t);this.o.c(String.format(_nbs.a.uk,i));this.h.t(this.o);this.h.f(!0)},bb:function(){if(!this.h){this.V(new _bc.n);this.C=[new _ff.d(new _j.g(this.H,this.bl()),_u.P.X,null,!0,!1),new _ff.d(this.h.q,_u.R.BG,null,!1,!1)];this.h.D(this.E);this.h.p.j(this.C)}this.h.s(_u.n.QZ);this.l||(this.l=new _mcp.bm);for(var u=this.bi,i=u.bo,f=i.RmsTemplates?i.RmsTemplates.length:0,t=new _j.l,r=0;r<f;r++){var n=new _g.cu;n.t(i.RmsTemplates[r].Id);n.q(_g.a.a().c().bH.UserEmailAddress);n.r(!0);n.s(0);n.u(i.RmsTemplates[r].Name);n.k(i.RmsTemplates[r].Description);n.p(u.ba.h());n.bH.RmsTemplateId.toUpperCase()==="C026002D-CDA6-401E-BFAD-28DE214D0FBA"?t.t(0,n):n.bH.RmsTemplateId.toUpperCase()===this.T()?t.x.length>0&&t.x[0].bH.RmsTemplateId.toUpperCase()==="C026002D-CDA6-401E-BFAD-28DE214D0FBA"?t.t(1,n):t.t(0,n):t.a(n)}this.l.e(t);this.l.d(u.ba.q());this.l.c=_u.n.DU;this.h.t(this.l);this.h.f(!0)},Y:function(){var i=this.bi;var n=i.ba;if(n.q()!==this.l.a){n.bs(this.l.a);n.bq(this.l.a.bH.RmsTemplateId);this.q(!0);if("Mouse"===_y.c.a.a()){var u=n.x().toLowerCase()===this.i.bH.RmsTemplateId.toLowerCase()?this.i.bH.TemplateDescription:n.q().bH.TemplateDescription;n.q().k(u);var t=i.bs();t.b(4499);var r=new _mcp.v(n.q().bH.TemplateName,n.q().bH.TemplateDescription,new _j.g(this.v,this.bl()),this.u,n.q().b(),!1);t.d(4499,r,null)}}_j.e.a(_a.a.a,"User hit OK on IRM restrition dialog, setting Template="+this.bk.q().bH.TemplateName);this.h.q.a()}};_mcp.bF=function(n,t,i){this.a=Function.createDelegate(this,this.d);this.b=Function.createDelegate(this,this.f);_mcp.bF.initializeBase(this,[37,n,t,i])};_mcp.bF.prototype={bx:function(){return null},bC:function(){return null},bN:function(){if(_g.a.a().E||!this.bu.a().cT().Enabled||!_g.a.a()||!_g.a.a().G().b())return null;var t=this.c();var i=this;var n=new _fm.l(_u.R.OG,function(n){n(t.i)},1,null,!1,!1,null,null,!1,null);return[n]},c:function(){var i=_g.a.a().G();var r=this.bk.fi?this.bk.fi.a():null;var n=this.bk.fg?this.bk.fg.a():null;return new _y.R(_u.R.OG,null,this.b,this.a,i,_g.bb.a,_g.a.a().c().bH.HasArchive,r,n,!0)},f:function(n){var t=new _g.bp;t.c(n);t.b(!!n);this.bk.fi=t},d:function(n){var t=new _g.bp;t.c(n);t.b(!!n);this.bk.fg=t}};_mcp.I=function(n,t){this.dD=Function.createDelegate(this,this.ej);this.cF=Function.createDelegate(this,this.ek);_mcp.I.initializeBase(this);this.dE=n;this.bj=t;if(t&&t.a){this.bi=t.a;this.bk=this.bi.ba;this.bS=this.bi.bb}};_mcp.I.a=function(n,t){n&&!n.fm&&n.df().a(t)};_mcp.I.prototype={dE:0,bj:null,bi:null,bk:null,bS:null,dc:!1,e:function(){return this.dc},cj:function(n){this.dc=n;return n},bl:function(){return _a.a.a},bp:function(){return this.bT||!this.bk||!this.bi||this.bi.fm},g:function(){this.cj(!0)},cG:function(n){var i=this.cw(n);this.bi.ef(i);if(i===55||i===50){var t=this;this.bi.cR.a(function(n){if(!t.bp()){n.a(t.bS);t.bi.bi()}})}else this.bi.bi()},ek:function(n){this.bS.g(n);this.bi.bi()},ej:function(n,t){for(var u=[],i=2;i<arguments.length;++i)u[i-2]=arguments[i];var r;(r=this.bS).l.apply(r,[t,n].concat(u));this.bi.bi()},bz:function(){this.cj(!1);_j.S.prototype.bz.call(this)},ci:function(){this.bS.o();this.bS.f(_mcp.z.b);this.bS.f(_mcp.u.a);this.bS.f(_mcp.t.b);var n=this;this.bi.cR.a(function(t){if(!n.bp()){t.b(n.bS);n.bi.bi()}})},cw:function(n){throw Error.notImplemented(String.format("GetErrorInfoBarMessageId is not implemented for type {0}",Object.getType(this)));},dd:function(n,t,i,r){t.val=r;i.val="";if(n)if(_g.W.a(n)){t.val=_g.W.b(n);i.val=n.FaultMessage}else if(_g.H.isInstanceOfType(n)){t.val=n.responseCode;i.val=n.toString()}else Error.isInstanceOfType(n)&&(i.val=n.message)}};_mcp.bH=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot){this.f=Function.createDelegate(this,this.k);this.i=Function.createDelegate(this,this.p);this.g=Function.createDelegate(this,this.m);this.h=Function.createDelegate(this,this.o);this.c=[];this.e=new _mcp.bG(this,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot);this.a=n};_mcp.bH.prototype={e:null,c:null,a:null,b:function(n){var t=n;this.c[t]||(this.c[t]=this.e.v(n,this.a.bv.a(),this.a.ba.m()));return this.c[t]},n:function(){this.d(this.h)},dispose:function(){this.d(this.g,!0);this.c.length=0;this.c=null;this.a=null},q:function(){_j.e.a(_a.a.a,"Component Map set override start.");this.d(this.i);_j.e.a(_a.a.a,"Component Map set override end.")},l:function(){_j.e.a(_a.a.a,"Component Map clear override start.");this.d(this.f);_j.e.a(_a.a.a,"Component Map clear override end.")},d:function(n,t){if(!!t===t&&t)for(var i=this.c.length-1;i>=0;i--)this.j(n,i);else for(var r=0;r<this.c.length;r++)this.j(n,r)},j:function(n,t){var i=this.c[t];i&&n(i,t)},o:function(n,t){IMailComposeInitializerComponent.isInstanceOfType(n)||n.e()||n.g()},m:function(n,t){var i=Object.getType(n).getName();if(n.bT)_j.e.b(_a.a.a,"Skip component '{0}' at index {1} because it is already disposing.",i,t);else{_j.e.a(_a.a.a,"Disposing component '{0}' at index {1}...",i,t);try{n.dispose()}catch(r){_j.e.d(_a.a.a,r,"Exception in MailComposeComponentMap trying to dispose component '{0}'",i)}}},p:function(n,t){IMailComposeOverridable.isInstanceOfType(n)&&n.Z()},k:function(n,t){IMailComposeOverridable.isInstanceOfType(n)&&n.Y()}};_mcp.bI=function(n,t,i,r){this.j=Function.createDelegate(this,this.p);this.m=Function.createDelegate(this,this.s);this.k=Function.createDelegate(this,this.q);this.l=Function.createDelegate(this,this.r);_mcp.bI.initializeBase(this,[15,n,i,r]);this.i=t};_mcp.bI.prototype={a:null,b:null,d:null,c:null,h:null,f:null,i:null,g:function(){this.b||(this.b=new _j.g(this.l,this.bl()));this.a||(this.a=new _j.g(this.k,this.bl()));_mcp.q.prototype.g.call(this)},bz:function(){var t;_a.h.a(t={val:this.b}),this.b=t.val;var n;_a.h.a(n={val:this.a}),this.a=n.val;this.i=null;_mcp.q.prototype.bz.call(this)},bC:function(){if(this.bi.bn())return null;this.d=new _fm.c(_nbs.a.et,null,this.b);this.c=new _fm.c(_nbs.a.hP,null,this.a,!0);this.bs();return[this.d,this.c]},bN:function(){this.h=_mcp.q.a(this.b,_nbs.a.et);this.f=_mcp.q.a(this.a,_nbs.a.hP);this.bs();return[this.h,this.f]},bx:function(){return null},ca:function(){if(this.c&&this.d){this.c.a(this.bk.h()==="HTML");this.d.a(this.bk.h()!=="HTML")}},cd:function(){this.f.b(this.bk.h()!=="HTML");this.h.b(this.bk.h()==="HTML")},r:function(){_j.e.a(this.bl(),"User chose to convert to plain text");this.bj.a.bk().a("SwitchToPlain");if(this.o(_nbs.a.Re)){this.bj.a.ba.bt().a();var r=this.bj.a.ba.y();var n;var i,t;var f=(t=_a.B.h(r,i={val:n}),n=i.val,t);if(!f){n=r;_j.e.a(this.bl(),"Using html due to failed conversion")}if(n.length>0){var u=this.bj.a.bh;u.i(1,[_nbs.a.ZZ],this.m,!1,null,null,null,this.i,null,null,null)}else this.n()}},s:function(n,t){n&&this.n()},n:function(){var n=this.bj.b(5);var i=this.bi.bl();var t=!1;if(n.C()){i.a("ContentConversion",this.j,null,!1);t=!0}n.s(!1);n.a()&&n.a().bG();this.bj.a.ba.i("Text");this.bs();t||this.p(null);_j.e.a(this.bl(),"MailComposeContentConversionComponent.ToPlainText succeeded.")},p:function(n){if(!this.bM&&!this.bT&&this.bi&&this.bi.bl()){var t=this.bi.bl();var i=this;t.a("AutoSave",function(){},null,!1)}},q:function(){_j.e.a(this.bl(),"User chose to convert to html");this.bj.a.bk().a("SwitchToHTML");if(this.o(_nbs.a.TJ)){var t=this.bj;var r=t.a;var i=r.ba;i.i("HTML");this.bs();var n=this.bj.b(5);n.s(!0);n.a()&&n.a().ca();_j.e.a(this.bl(),"MailComposeContentConversionComponent.ToHtml succeeded.")}},o:function(n){_j.e.a(this.bl(),"Checking if the email has been upgraded which is a pre-requisite of content conversion.");if(!this.bj.a.ba.l()){this.bj.a.bh.h(0,n,null);_j.e.a(this.bl(),"Conversion is not available because the email has not yet been upgraded.");return!1}if(!this.bj.a.ba.Q()){this.bj.a.bh.h(0,n,null);_j.e.a(this.bl(),"Conversion is not available when content is being loaded in editor.");return!1}var t=this.bj.b(5);if(t.a()&&t.a().r()){this.bj.a.bh.h(0,_nbs.a.eR,null);_j.e.a(this.bl(),"Conversion is not available because the email has reference attachments.");return!1}return!0}};_mcp.J=function(n){this.j=Function.createDelegate(this,this.n);_mcp.J.initializeBase(this,[16,n]);var t=this;this.h=new _j.w(this.j,_a.a.a,this.bj.a.ba,"BodyType",function(){return t.bj.a.ba.h()==="HTML"})};_mcp.J.prototype={h:null,d:null,a:function(){return this.eM(_mcp.J.a)},k:function(n){this.eK(_mcp.J.a,n);return n},g:function(){if(this.e()){_j.e.a(_a.a.a,"Context menu component is already initialized, skipping redundant Initialize call.");return}var n=this.i();if(n&&n.d.length>0){_j.e.a(_a.a.a,"Creating context menu items.");this.k(new _fm.e(n.i()))}_mcp.I.prototype.g.call(this)},b:function(n){this.d&&this.d.a(n)},i:function(){var n=new _j.q;if("Mouse"===_y.c.a.a()){if(this.bi.et()){this.c(n,5);this.m(n);this.c(n,35)}this.c(n,8);this.c(n,11);this.c(n,1);this.c(n,28);this.c(n,6);this.c(n,3);this.c(n,15);this.c(n,9);this.c(n,2);this.c(n,36)}return n},bz:function(){if(this.a()){this.a().dispose();this.k(null)}_mcp.I.prototype.bz.call(this)},c:function(n,t){var r=null;var i=this.bj.b(t);if(i&&IMailComposeContextMenuProvider.isInstanceOfType(i)){_j.e.a(_a.a.a,"Getting context menu items for type '{0}', IsInitialized = {1}",Object.getType(i).getName(),i.e());i.e()||i.g();r=i;n.h(r.R())}},m:function(n){this.d=new _fm.c(_nbs.a.HX,null,this.h);this.d.a(!0);n.c(this.d)},n:function(){this.bi.be.a(_mcp.P,new _mcp.P)}};_mcp.bJ=function(n){_mcp.bJ.initializeBase(this,[n])};_mcp.bJ.prototype={i:function(){var n=new _j.q;if("TouchNarrow"===_y.c.a.a()){var t;var f=this.bi.bc();var i=f.p();if(i)if(i.d.length>1){t=new _fm.j(_nbs.a.jD,null,new _fm.e(i.d));n.c(t)}else if(i.d.length===1){var u=i.d[0].j;t=new _fm.c(_nbs.a.jD,null,u);n.c(t)}var r=this.bi.bj();t=new _fm.c(_u.P.l,null,r.j());n.c(t);this.c(n,11);this.c(n,1);this.c(n,28);this.c(n,6);this.c(n,3);this.c(n,9)}return n}};_mcp.K=function(n,t,i,r,u){this.bd=Function.createDelegate(this,this.co);_mcp.K.initializeBase(this,[n,t,i,r,u]);this.bi.bv.l(_mcp.K.a)};_mcp.K.a=function(n){n.a(_nbs.a.CK)};_mcp.K.prototype={R:!1,Q:function(){return this.W()&&!this.bk.eY},bh:function(){return this.Q()&&this.A>0&&!this.bY()},g:function(){if(this.Q()){this.cl(_j.C.a(_g.a.a().a().bH.MailSendUndoInterval)?0:_g.a.a().a().bH.MailSendUndoInterval);_g.a.a().a().apcl("MailSendUndoInterval",this.bd)}_mcp.u.prototype.g.call(this)},bz:function(){this.Q()&&_g.a.a().a().rpcl("MailSendUndoInterval",this.bd);this.bi.bv.l(_mcp.K.a);_mcp.u.prototype.bz.call(this)},bb:function(){this.R=!1;if(this.bh()){_j.e.a(_a.a.a,"Queueing delayed async send.");this.cp();this.R=!0}else{_j.e.a(_a.a.a,"Submitting send action with no delay.");_mcp.u.prototype.bb.call(this)}},cp:function(){var n=this;_j.m.a().c(_a.a.a,"QueueAsyncSend",function(){n.bi.bv.m(_mcp.K.a);_j.e.a(_a.a.a,"Firing optimistic save for delayed send.");n.bi.bl().a("Save",function(){_j.e.a(_a.a.a,"Optimistic save for delayed send succeeded.");n.bs()},function(){_j.e.b(_a.a.a,"Optimistic save for delayed send failed! Continuing with delayed send anyway...")},!0);n.bs();var t=new _mcp.cc(n.A,n.bk,function(){n.cn();n.bi.bv.l(_mcp.K.a);_mcp.u.prototype.bb.call(n);n.bi.bQ.a(function(){n.v.a(ISendEvent,new _mcp.bv(n.bi))})});n.v.a(IDelayedSendEvent,t)})},bs:function(){if(this.bk.K()&&_g.i.isInstanceOfType(this.bk.K())){var n=this.bk.K();if(!n.bw){_h.c.A(n,!0);_j.e.a(this.bl(),"TryFlagDraftAsQueuedForSubmission - draft was successfully updated as queued for submission.")}}else _j.e.b(this.bl(),"TryFlagDraftAsQueuedForSubmission - no draft to update as queued for submission.")},ch:function(){if(this.R)_j.e.a(_a.a.a,"Skipping firing send event for delayed async send.");else{_j.e.a(_a.a.a,"Firing send event for immediate async send.");this.cb()}},cq:function(){if(this.Q()){var n=this.bi.bb;n.b(1002);this.A>0&&n.a(1002,this.A.toString())}},co:function(n,t){this.cl(_g.a.a().a().bH.MailSendUndoInterval);this.cq()}};_mcp.p=function(n){this.x=Function.createDelegate(this,this.H);this.y=Function.createDelegate(this,this.C);this.w=Function.createDelegate(this,this.B);this.u=Function.createDelegate(this,this.v);this.z=Function.createDelegate(this,this.N);this.A=Function.createDelegate(this,this.O);_mcp.p.initializeBase(this,[19,n]);this.q=new _j.g(this.A,this.bl());this.p=new _j.g(this.z,this.bl());this.s=n.a.bY};_mcp.p.prototype={q:null,p:null,s:null,r:null,m:null,t:!1,n:!1,a:function(){return this.q},l:function(){return this.p},f:function(){return this.r},G:function(n){if(n!==this.r){this.r=n;this.by("DiscardConfirmDialogButtonData")}return n},E:function(n){if(n!==this.m){this.m=n;this.by("CloseConfirmDialogButtonData")}return n},b:function(){return this.t},i:function(n){if(n!==this.t){this.t=n;this.by("IsDiscardConfirmDialogShown")}return n},o:function(n){if(n!==this.n){this.n=n;this.by("IsCloseConfirmDialogShown")}return n},k:function(){var i=this.bj;var t=i.a;var n=t.ba;this.I(n);t.bk().a("Discard");if(n.a()||!n.a()&&(n.k()||t.bl().c())){_j.e.a(_a.a.a,"Discard");this.D(n.d(),n.K())}},c:function(n,t){if(this.s.a(n)){_j.e.a(_a.a.a,"Resuming discard of {0}",_h.G.c(t.bH.ItemId));this.D(n,t)}else _j.e.a(_a.a.a,"User had already discarded.")},j:function(){if(!this.bk.eU)return!0;_j.e.a(_a.a.a,"Comparing initial baseline to baseline.");if(!this.bk.eU.s(this.bk.eR()))return!0;_j.e.a(_a.a.a,"Checking dirty before showing discard confirmation.");return this.bi.cb()?!0:this.bk.bJ()?!0:!1},d:function(n){this.bB("IsDiscardingCompose",n)},h:function(n){this.bF("IsDiscardingCompose",n)},bz:function(){this.i(!1);this.o(!1);this.G(null);this.E(null);var t;_a.h.a(t={val:this.q}),this.q=t.val;var n;_a.h.a(n={val:this.p}),this.p=n.val;this.s=null;_mcp.I.prototype.bz.call(this)},M:function(){_j.e.a(_a.a.a,"Checking dirty before showing discard confirmation.");return this.bi.cb()?!0:!1},D:function(n,t){this.C();var i=this.bj.a;var r=i.ba.bM()||i.ba.bJ();this.s.b(n,t,i.bp,r)},O:function(){var n=this.bj.a;var t=n.ba;_j.e.a(_a.a.a,"User chose to discard");if(this.j()){this.L();_j.e.a(_a.a.a,"Toggle IsDiscardConfirmDialogShown flag to show the dialog. ");this.i(!0)}else{_j.e.a(_a.a.a,"User hit discard, we determined there's no need to show confirmation dialog, calling discard and navigating away. ");this.B()}},N:function(){_j.e.a(_a.a.a,"User chose to close");if(!this.bi.bh.r)if(this.M()){this.K();_j.e.a(_a.a.a,"Toggle IsCloseConfirmDialogShown flag to show the dialog.");this.o(!0)}else if(this.bi.bj().f()){_j.e.a(_a.a.a,"Addins are still running. Prompt to terminate them.");this.bi.bj().k(this.bi.bh,this.u)}else{_j.e.a(_a.a.a,"User hit close, we determined there's no need to show confirmation dialog, navigating away.");this.v()}},C:function(){_j.e.a(_a.a.a,"Toggle IsDiscardConfirmDialogShown flag to hide the dialog.");this.i(!1)},H:function(){_j.e.a(_a.a.a,"Toggle IsCloseConfirmDialogShown flag to hide the dialog.");this.o(!1)},L:function(){if(!this.r){_j.e.a(_a.a.a,"Creating discard confirm dialog.");var n=new _j.l;n.a(new _ff.d(new _j.g(this.w,this.bl()),_u.n.MH,_u.n.Mg,!0,!1));n.a(new _ff.d(new _j.g(this.y,this.bl()),_u.n.RQ,_u.n.MU,!1,!1));this.G(n)}},K:function(){if(!this.m){_j.e.a(_a.a.a,"Creating close confirm dialog.");var n=new _j.l;n.a(new _ff.d(new _j.g(this.u,this.bl()),_u.n.RT,_u.n.Gj,!0,!1));n.a(new _ff.d(new _j.g(this.x,this.bl()),_u.n.KS,_u.n.MU,!1,!1));this.E(n)}},B:function(){_j.e.a(_a.a.a,"Discard and close");this.k();this.v();this.bi.bd().u("Discard")},v:function(){this.bk.fB(null);this.bi.bm().a(this.bi,!1);_j.e.a(_a.a.a,"Navigated away from compose");this.ce("IsDiscardingCompose")},I:function(n){var i=_a.b.b(this.bl(),"MailComposeDiscard",!1,null);var t=new _a.l;t.a("EID",n.dh()||"");i.m=t.toString();_a.b.a(i)}};_mcp.bK=function(n,t,i){this.k=Function.createDelegate(this,this.d);this.h=Function.createDelegate(this,this.p);this.m=Function.createDelegate(this,this.o);_mcp.bK.initializeBase(this,[25,n]);this.f=t;this.i=new _j.g(this.m,_a.a.a);var r=n.a.ba;r.dW(this.i)};_mcp.bK.prototype={i:null,f:null,j:!1,l:null,b:function(){return this.l},a:function(n){this.l=n;this.by("EditorCallContext");return n},d:function(){this.a(new _cmc.P)},g:function(){if(!this.j){this.q();this.j=!0;_g.a.a().b().o(this.h);_g.a.a().b().z(this.h)}_mcp.I.prototype.g.call(this)},c:function(n,t){var i;if(n){var e=_g.a.a();var r=e.a().ch();var o=(r&1)>0;var u=(r&2)>0;var f=(r&4)>0;i=_j.h.b(t)?"<P style='margin-top:0;margin-bottom:0'><BR></P>":_a.B.f+t+_a.B.d;o&&(i='<strong id="OWAStrongID">'+i+"</strong>");u&&(i='<em id="OWAItalicID">'+i+"</em>");f&&(i='<span id="OWAUnderLineID" style="text-decoration:underline;">'+i+"</span>")}else i=_j.h.b(t)?"":t;return i},bz:function(){var n;_a.h.a(n={val:this.i}),this.i=n.val;this.r();this.j=!1;this.f=null;_g.a.a().b().v(this.h);_g.a.a().b().G(this.h);_mcp.I.prototype.bz.call(this)},o:function(){this.a(new _cmc.k(!1))},p:function(n,t){this.d()},q:function(){if(this.f)try{var n=this.f;if(!n.closed){var r=_j.x.b(n);var i=this;r.b("resize",function(n){i.d()},"MCEditorComponent")}}catch(u){var t=this.n(this.f);_j.e.d(this.bl(),u,"Projection window dump: {0}",t)}else _y.c.a.n(this.k)},r:function(){if(this.f){var n=_j.x.b(this.f);n.c("resize","MCEditorComponent")}else _y.c.a.p(this.k)},n:function(n){var t="";for(var i in n)t=t+i+",";return t}};_mcp.bL=function(n){_mcp.bL.initializeBase(this,[n,null,null])};_mcp.bL.prototype={d:function(){}};_mcp.bM=function(n,t,i){this.n=Function.createDelegate(this,this.B);this.o=Function.createDelegate(this,this.C);this.l=Function.createDelegate(this,this.z);this.m=Function.createDelegate(this,this.A);this.t=Function.createDelegate(this,this.D);this.s=Function.createDelegate(this,this.w);_mcp.bM.initializeBase(this,[34,n]);this.p=t;this.c=i;this.d=this.bi.be;this.f=this.bi.bb;this.j=_a.d.get_utcNow();this.h=new _j.q;this.y()};_mcp.bM.prototype={p:null,c:null,f:null,d:null,b:null,i:!1,u:"",r:!1,h:null,q:!1,j:null,a:function(){if(!this.r){if(this.c){var l=this.c.bH.GroupSuggestionDismissalCount;var h=this.c.bm();if(l>=5&&h&&h.c(30).a(this.j)>0)return}var t=this.bi.bd();if(t&&t.b(0)&&t.b(0).a()&&t.b(0).a().x.length>=2){var s=t.b(0).a();var o=!1;var a=s.x.length;var u=new _j.q;var i={};this.h.f();var v=_g.a.a().c();i[v.bH.LogonEmailAddress]=!0;for(var r=0;r<a;r++){var n=s.x[r];var f=n.l.a().EmailAddress;if(n.j.bb()){o=!0;this.bk.eY||_a.b.c(_a.a.bp,"GroupSuggestionOnCompose_ConversationAlreadyContainsGroup");n.j.a()&&n.j.a().b()===5&&_a.b.c(_a.a.bp,"GroupSuggestionOnCompose_HasGroupOnToLine");n.j.a()&&n.j.a().b()===2&&_a.b.c(_a.a.bp,"GroupSuggestionOnCompose_HasDLOnToLine");break}if(!(f in i)){var e=new _g.g;e.EmailAddress=f;u.c(e);i[f]=!0;this.h.c(n.l.a())}}if(u.d.length>=2&&!o){var c=t.r();this.h.c(c.d[c.d.length-1]);this.x(u.i())}else if(!this.i){this.k();_a.b.c(_a.a.bp,"GroupSuggestionOnCompose_ContainsGroupToSkipRequest")}}else if(!this.i){this.k();_a.b.c(_a.a.bp,"GroupSuggestionOnCompose_NotEnoughRecipientsToSkipRequest")}}},v:function(n,t){this.q=!0;if(this.f&&this.f.h(10307)&&this.b){this.b.c(t);this.b.d(n);this.b.e(this.h);this.b.f()}else{var i=this;this.p.a(function(r){i.b=r.d(i.s,i.t,i.h,n,t,i.bi.bh);if(i.q){i.f.d(10307,i.b,null);i.d.b(ICreateGroupInGroupSuggestionEvent,i.m);i.d.b(ICreateGroupCompleteInGroupSuggestionEvent,i.l)}})}this.bk.a()===2?_a.b.c(_a.a.bp,"GroupSuggestionOnCompose_FromReplyAll"):this.bk.a()?_a.b.c(_a.a.bp,"GroupSuggestionOnCompose_FromOthers"):_a.b.c(_a.a.bp,"GroupSuggestionOnCompose_FromNewMail")},w:function(){if(this.c){var t=this.c.bH.GroupSuggestionDismissalCount;var n=this.c.bm();n&&n.c(30).a(this.j)<=0&&(t=0);this.c.cG(t+1);this.c.cH(this.j);_h.f.a(this.c.u,_a.g.a)}this.k();this.r=!0;this.b&&this.b.b()?_a.b.c(_a.a.bp,"GroupSuggestionOnCompose_DismissUsageSuggesstion"):_a.b.c(_a.a.bp,"GroupSuggestionOnCompose_DismissCreationSuggesstion")},k:function(){this.q=!1;if(this.f&&this.f.h(10307)){this.f.b(10307);var n;_a.h.a(n={val:this.b}),this.b=n.val;this.d.c(ICreateGroupInGroupSuggestionEvent,this.m);this.d.c(ICreateGroupCompleteInGroupSuggestionEvent,this.l)}},A:function(n){this.i=!0},z:function(n){var u=this.bi.bd();if(u){var t=u.b(0);t.i(this.u);if(n.a()&&t){var r=n.c();r.a().Name=r.c();var e=t.o(r.a());e.K(!0);for(var f=n.b(),i=0;i<f.length;i++)t.i(f[i])}}this.i=!1},D:function(){var f=this.bi.bd();var u=f.b(0);var r=this.b.a();var n=new _g.g;n.Name=r.DisplayName;n.EmailAddress=r.SmtpAddress;n.MailboxType="GroupMailbox";var e=u.o(n);e.K(!0);var i=r.TopRelevantMembers;if(i)for(var t=0;t<i.length;t++)u.i(i[t].EmailAddress.EmailAddress);_a.b.c(_a.a.bp,"GroupSuggestionOnCompose_ClickReplaceWithGroupLink")},y:function(){var n=this;this.p.a(function(n){})},x:function(n){var t=new _mcp.bA(n);t.c(this.o);t.b(this.n);this.bi.bp.a(t,null,null,null)},C:function(n){n.U(this.o);n.T(this.n);var i=n;var t=i.e;if(!i.j&&t&&t.length>0){this.v(!0,t[0]);_a.b.c(_a.a.bp,"GroupSuggestionOnCompose_ShowExistGroupSuggestion")}else this.i||this.k()},B:function(n){n.U(this.o);n.T(this.n);this.k()},g:function(){this.a();if(this.e()){_j.e.b(_a.a.a,"MailComposeAtMentionComponent is already initialized, skipping redundant Initialize call.");return}_mcp.I.prototype.g.call(this);_a.b.c(_a.a.bp,"GroupSuggestionOnCompose_ComposeMail")},bz:function(){var n;_a.h.a(n={val:this.b}),this.b=n.val;this.d.c(ICreateGroupInGroupSuggestionEvent,this.m);this.d.c(ICreateGroupCompleteInGroupSuggestionEvent,this.l);_mcp.I.prototype.bz.call(this)}};_mcp.bO=function(n,t,i,r){this.k=Function.createDelegate(this,this.s);this.l=Function.createDelegate(this,this.t);this.j=Function.createDelegate(this,this.r);_mcp.bO.initializeBase(this,[6,n,i,r]);this.n=t};_mcp.bO.prototype={b:null,c:null,h:!1,d:!1,i:!1,n:null,o:function(n){if(n!==this.h){this.h=n;this.by("IsHighImportance")}return n},a:function(){return this.d},q:function(n){if(n!==this.d){this.d=n;this.by("IsNormalImportance")}return n},p:function(n){if(n!==this.i){this.i=n;this.by("IsLowImportance")}return n},g:function(){var i=this.bk.X();this.f(i);_j.e.a(_a.a.a,"Importance component initialized and importance set to {0}",i);if("Mouse"===_y.c.a.a()||_y.c.a.a()==="TouchNarrow"){if(!this.b){var t=this.m(_mcp.q.b);t&&(this.b=new _fm.e(t))}}else if(!this.c){var n=this.m(_mcp.q.c);n&&(this.c=new _y.i(_nbs.a.lW,null,n))}_mcp.q.prototype.g.call(this)},bz:function(){this.b=null;_mcp.q.prototype.bz.call(this)},bC:function(){var n=new _fm.j(_nbs.a.lW,null,this.b);return[n]},bN:function(){var t=this;var n=new _fm.l(_nbs.a.lW,function(n){n(t.b)},1,null,!1,!1,null,null,!1,null);return[n]},bx:function(){return[this.c]},r:function(){var n=new _cmc.h(_a.a.a,"MailComposeSetImp",!1);_j.e.a(_a.a.a,"User sets high importance");this.f("High");this.bj.a.bk().a("Importance:High");n.b()},t:function(){_j.e.a(_a.a.a,"User sets normal importance");this.f("Normal");this.bj.a.bk().a("Importance:Normal")},s:function(){var n=_a.b.b(_a.a.a,"MailComposeSetImp",!1,null);_j.e.a(_a.a.a,"User sets low importance");this.f("Low");this.bj.a.bk().a("Importance:Low");_a.b.a(n)},f:function(n){this.bj.a.ba.dY(n);this.o("High"===n);this.q("Normal"===n);this.p("Low"===n)},m:function(n){return[n(new _j.g(this.j,this.bl()),_nbs.a.T),n(new _j.g(this.l,this.bl()),_nbs.a.Ox),n(new _j.g(this.k,this.bl()),_nbs.a.fV)]}};_mcp.s=function(n,t,i,r,u){this.bw=Function.createDelegate(this,this.cA);this.W=Function.createDelegate(this,this.cn);this.Y=Function.createDelegate(this,this.cB);this.bu=Function.createDelegate(this,this.cy);this.bG=Function.createDelegate(this,this.cT);this.P=Function.createDelegate(this,this.bb);this.bq=Function.createDelegate(this,this.Z);this.bt=Function.createDelegate(this,this.co);this.D=Function.createDelegate(this,this.bn);this.bv=Function.createDelegate(this,this.cz);this.V=Function.createDelegate(this,this.cm);this.R=Function.createDelegate(this,this.cg);this.Q=Function.createDelegate(this,this.cf);this.S=Function.createDelegate(this,this.ch);this.T=Function.createDelegate(this,this.ck);this.U=Function.createDelegate(this,this.cl);this.X=Function.createDelegate(this,this.cs);this.br=Function.createDelegate(this,this.bJ);this.bx=Function.createDelegate(this,this.cK);this.bs=Function.createDelegate(this,this.cc);this.bC=Function.createDelegate(this,this.cL);this.bD=Function.createDelegate(this,this.cM);this.bN=["bmp","gif","jpg","jpeg","png"];_mcp.s.initializeBase(this,[24,n]);this.o=_mco.d.e(i);this.bm=r;this.N=_a.o.a();this.t=t;this.E=i;this.q=u;this.bh=!!this.t&&this.t.a().bj().Enabled;this.bg=!!this.t&&this.t.a().ka().Enabled;_b.k.j()||this.bR(!1);this.s=new _mcp.cd(this.bi.bp,this.bj.a.be,this.t,this.bj.a,this.q)};_mcp.s.a=function(n){var r=[];if(!_j.E.a(n.children)&&n.children.length>0)for(var t=0;t<n.childNodes.length;t++){var i=n.childNodes[t];i.nodeType!==1||_cmc.f.b(i)||_j.B.a(i.getElementsByTagName("A"),function(n,t){_mcp.M.b(t)||Array.add(r,t)})}return r};_mcp.s.prototype={r:null,G:null,o:!1,M:!1,L:!1,O:null,H:null,y:null,C:null,B:null,A:null,bm:null,m:null,n:null,p:null,w:null,x:null,N:null,u:null,t:null,E:null,q:null,I:null,v:!1,s:null,z:null,bh:!1,bg:!1,bR:function(n){if(n!==this.o){this.o=n;this.by("IsLinkPreviewEnabled")}return n},K:function(n){if(n!==this.v){this.v=n;this.by("IsOneDriveLinkPreviewActivated")}return n},cC:function(n){if(n!==this.r){this.r=n;this.cN()}return n},cp:function(){this.A||(this.A={});return this.A},cE:function(n){this.G=n;this.by("LinkPreviewResponse");if(this.G&&_zz.e.c(this.m)){var t=this.m.bW();this.bH(this.G,t?t:null)}return n},cI:function(n){if(n!==this.C){this.C=n;this.C&&_mco.d.a(this.C,null,this.bD,null,null)}return n},cH:function(n){if(n!==this.B){this.B=n;this.B&&_mco.d.a(this.B,null,this.bC,null,null)}return n},b:function(){return this.M},d:function(n){if(this.M!==n){this.M=n;this.by("ShowYouTubePlayer")}return n},a:function(){return this.L},c:function(n){if(this.L!==n){this.L=n;this.by("ShowOEmbedVideoPlayer")}return n},i:function(){return this.O},cJ:function(n){this.O=n;this.by("YouTubePlayerUrl");return n},h:function(){return this.H},bU:function(n){this.H=n;this.by("OEmbedVideoPlayerHtml");return n},f:function(){this.y||(this.y=new _j.g(this.bs,_a.a.f));return this.y},bz:function(){var i;_a.h.a(i={val:this.y}),this.y=i.val;var t;_a.h.a(t={val:this.z}),this.z=t.val;this.m=null;this.cS();this.w=null;this.x=null;this.u=null;this.A=null;var n;_a.h.a(n={val:this.s}),this.s=n.val;_mcp.I.prototype.bz.call(this)},cN:function(){if(_mco.d.n()){_j.e.a(_a.a.f,"Link preview feature is disabled.  Skipping GetLinkPreview action for {0}",this.r.Url);this.bJ();return}if(this.r){var i=1;var r=_a.b.b(_a.a.f,"GetComposeLinkPreview",!1,null);var n=[];Array.add(n,this.r);_j.e.a(_a.a.f,"Preparing GetLinkPreview action for {0}",this.r.Url);this.r.Autoplay=!0;var u=new _mco.d(this.r);_j.e.a(_a.a.f,"Submitting GetLinkPreview action for {0}",this.r.Url);var t=this,f=this;this.bj.a.bp.a(u,function(u){_mco.d.q(u,t.bx,t.br,i,r,"GetComposeLinkPreview",n,0)},function(t){_mco.d.l(t,i,r,"GetComposeLinkPreview",n,0)},null)}},cK:function(n){this.cE(n)},bJ:function(){this.bR(!1)},cM:function(n){this.cJ(n);this.d(!!this.O)},cL:function(n){var t=this.p.g(n);t?this.bU(t):this.bU(n);this.c(!!this.H)},cc:function(){this.c(!1)},k:function(n){this.n=n;this.n.u(this.X);this.n.b(this.U);this.n.a(this.T);this.n.c(this.S);this.n.g(this.Q);this.n.t(this.R);this.n.h(this.V)},cS:function(){if(this.n){this.n.w(this.X);this.n.e(this.U);this.n.d(this.T);this.n.f(this.S);this.n.i(this.Q);this.n.v(this.R);this.n.j(this.V);this.n=null}},cu:function(n){if(!this.o){_j.e.a(_a.a.f,"RTE: Skipping IsElementFromPreviewAnchor because previews are disabled");return!1}var t="LPNoLP";var i="a[id^='"+t+"']";return _b.k.a(n.id,t)||!!n.querySelector(i)},ct:function(n){if(!this.o){_j.e.a(_a.a.f,"RTE: Skipping IsElementFromPreviewAnchor because previews are disabled");return!1}var t=!1;var i="a[id^='LPlnk']";t=_b.k.a(n.id,"LPlnk")||!!n.querySelector(i);!t&&n.nodeName==="#text"&&n.parentNode&&n.parentNode.nodeName==="A"&&(t=_b.k.a(n.parentNode.id,"LPlnk"));return t},cs:function(n){var i=n.c();var t=n.d();if(_zz.h.isInstanceOfType(t))this.m=t;else{_j.e.c(_a.a.f,"HandleLinkPreviewOnLinkAdded: event source was not an instance of HtmlEditorBase");return}this.bV(i,!0)},bV:function(n,t){var i=null;var u,r;if((r=this.bW(n,t,u={val:i}),i=u.val,r)&&(!this.l()||this.l().t(n))&&i.toLowerCase().startsWith("http")){_j.e.a(_a.a.f,"FindAndInsertLinkInPreviousWord: Trigger link preview");this.cO(n.id,i)}},bW:function(n,t,i){if(!n||!this.o||_mcp.M.b(n)||!_cmc.f.a(n,i)||this.cu(n)||this.ct(n)||_b.k.d(n.id))return!1;n.id=_b.k.e();_j.k.d(n,_zz.Q.a);this.bo(n,i.val,t,!0);return!0},bo:function(n,t,i,r){if(!t){var e,o;if(!(o=_cmc.f.a(n,e={val:t}),t=e.val,o))return}var f=this.bd(n.id);var u=this;this.s.x(t,_mcp.M.a(n),f,function(t){var h=t;var r=h.f;var e=null;if(r&&r.ResultCode!==1&&r.ResultCode!==24){var s=u.cb(r,n.href,f);e=u.l().h(s);if(u.bg&&!_j.h.a(r.FileName)&&i){u.m.bc(!0);n.innerText=r.FileName;u.m.bc(!0)}}else{var o=u.ca(n.href,f);e=u.l().h(o)}e.g(f);u.v||u.K(!0);n.setAttribute("previewremoved",!0);return e},i,r)},cb:function(n,t,i){var r=new _gg.p;r.Url=t;r.Title=n.FileName;r.Id=i;r.__type=_gg.p._dataContractName;r.LinkType=n.SharingLinkKind;r.LinkingUrl=n.CanonicalUrl;return r},ca:function(n,t){var i=new _gg.p;i.Url=n;i.Id=t;i.__type=_gg.p._dataContractName;i.LinkType=0;return i},cd:function(n){if(n){var t=n.toLowerCase().split(".");if(t&&t.length>1)return Array.contains(this.bN,t[t.length-1])?!0:!1}return!1},cr:function(){!this.z&&this.bh&&this.bj.a.bc()&&this.bj.a.bc().a()&&this.q&&(this.z=new _mcp.M(this.bj.a.bc().a(),this.s,this.q));return this.z},ch:function(n){var t=n.d();if(_zz.h.isInstanceOfType(t))this.m=t;else{_j.e.c(_a.a.f,"EditorOnContentLoaded: event source was not an instance of HtmlEditorBase");return}this.be(n.c(),!0,!1)},cf:function(n){n.c()===1&&this.bY(n.e());var t=this.cr();if(t){var i=this;t.h(n.c(),n.e(),function(n,t){i.bo(n,t,!1,!1)})}},cg:function(n){this.be(n.c(),!0,!1)},cl:function(n){var t=n.c();this.bZ(t)},cm:function(n){if(!this.o||!this.E||!this.E.u()){_j.e.a(_a.a.f,"MailComposeLinkPreviewComponent: Skipping getting doc links because doc link previews are disabled");return}if(this.m&&this.m.z&&this.q)for(var s=this.m.z.querySelectorAll(".OWAAutoLink"),f=0;f<s.length;f++){var t=s[f].href;if(!_j.h.d(t)){var u;var i=_a.b.b(_a.a.c,"SendingALink",!1,(u=new _a.K,u.a=!0,u));this.q.a(t)?i.q(new _a.y("SharePoint")):this.q.g(t)?i.q(new _a.y("OneDriveConsumer")):(this.q.d(t)||this.q.e(t))&&i.q(new _a.y("GDrive"));_a.b.a(i)}}else{var r;var o=_a.b.b(_a.a.c,"NotTrackingLinksSent",!1,(r=new _a.K,r.a=!0,r));this.m&&!this.q&&o.q(new _a.y("nullSharePointLinkDetector"));_a.b.a(o)}if(this.p){var e=new _a.j;var h=this.l().j();var c=this;Array.forEach(h,function(n){var t=n;if(t.a()===1&&!t.o()){var i=new _g.eq;i.Url=t.k();i.ProviderType=_g.q.toString(t.j()==null?0:t.j());i.PermissionType=t.b()==null?0:t.b();e.c(i);t.s(!0)}});this.bk.hG(e)}},ck:function(n){var t=n.c();this.be(t,!1,!1)},cO:function(n,t){if(!this.o){_j.e.a(_a.a.f,"MailComposeLinkPreviewComponent: Skipping link preview requests because previews are disabled");return}if(this.cd(t)){var i=this;_j.m.a().a(this.bl(),"InsertInlineImageTimerCallback",function(){if(!i.bT&&i.m&&i.m.Z()&&i.m.bd){var u=i.m.E().querySelectorAll("#"+n);if(u&&u.length>0&&u[0]){var r=document.createElement("img");_j.k.b(r,"error",i.bv);try{r.src=t;r.style.maxWidth="99.9%"}catch(o){_j.e.a(_a.a.f,"Exception encountered when inserting image for {0}. Exception: {1}",t,o.message);_j.k.c(r,"error");return}var e=document.createElement("p");e.appendChild(r);i.m.bc(!0);var f=u[0];f.parentNode&&_j.k.s(e,f);i.m.be(3);i.m.bD()}}},10)}else{_j.e.a(_a.a.f,"Trigger link preview request for {0}",t);var r=new _g.cK;r.Id=n;r.Url=t;r.RequestStartTimeMilliseconds=_a.d.a().h();if(this.N.b()){var u=this;_j.m.a().c(this.bl(),"QueueGenerateLinkPreviewForIE",function(){u.bn(r)})}else this.bn(r)}},cz:function(n){_j.e.a(_a.a.f,"Failed to load image at URL {0}, removing image element.",n.i().getAttribute("src"));_j.k.c(n.i(),"error");n.i().parentNode&&n.i().parentNode.removeChild(n.i())},bH:function(n,t){_j.e.a(_a.a.f,"Adding link preview for {0}",n.Url);var r=!1;_mco.C.a(n)&&(r=!0);if(!this.l()){this.w=n;this.x=t;this.p&&this.bQ();return}if(r){this.l().m(this.D);return}if(this.m&&this.m.Z()&&this.m.bd){this.m.bc(!0);this.l().f(n,this.D,t,this.bt,this.bq,this.P,null);this.m.be(3);this.m.bD();var i=this.l().a(n.Url);i&&i.a()&&this.K(!0)}else _j.e.a(_a.a.f,"Ignore AddLinkPreview since the editor isn't active or initialized")},l:function(){if(!this.p){_j.e.a(_a.a.f,"MailComposeLinkPreviewComponent: Create LinkPreviewBuilder");var n=this;this.bm.a(function(t){n.cD(t.b(n.bG,n.bu,!0,_y.c.a,n.t,n.bi.bp,n.bj.a.be,n.s));n.p.d(n.cp());n.bQ()})}return this.p},cD:function(n){this.p=n;this.by("LinkPreviewBuilder");return n},cT:function(n){this.cI(new _a.ch(n))},cy:function(n){this.cH(new _a.ch(n))},bQ:function(){_j.e.a(_a.a.f,"MailComposeLinkPreviewComponent: LinkPreviewBuilderFactoryOnOnCreated");if(this.w&&this.x){_j.e.a(_a.a.f,"MailComposeLinkPreviewComponent: There was a deferred AddLinkPreview. Calling it now");this.bH(this.w,this.x);this.w=null;this.x=null}if(this.u){_j.e.a(_a.a.f,"MailComposeLinkPreviewComponent: There was a deferred InitializeLinkPreviewFromAnchors. Calling it now");this.bP(this.u,!0,!1);this.u=null}},bP:function(n,t,i){this.u=n;var f=!1;var b=!1;if(this.l())this.u=null;else return;for(var s=0;s<n.length;s++){var u=!1;var h=null;var r=n[s];if(_b.k.a(r.id,"LPUrlAnchor")){var e;var w,p;if(p=this.l().n(r,w={val:e}),e=w.val,p){var d,k;u=(k=this.cQ(r,e,d={val:f}),f=d.val,k)}else _j.e.b(this.bl(),String.format("InitializeLinkPreviewFromAnchors: LPBorder was not found for found LPUrlAnchor id:{0}",r.id))}else if(_b.k.a(r.id,"LPImageAnchor"))u=this.cR(r);else{if(_b.k.a(r.id,"LPlnk")){t&&this.bo(r,null,i,!0);u=this.cx(r)}else if(b){if(t){var y=null;var c,l;l=this.bW(r,i,c={val:y}),y=c.val,l}}else{this.bV(r,i);b=!0}if(t){var g=this.bd(r.id);this.s.f.c(g)}}var o;var v,a;if(u&&!this.v&&(a=_cmc.f.a(r,v={val:o}),o=v.val,a)){h=this.l().a(o);h&&h.a()&&this.K(!0)}}t&&this.bi.bc().a()&&this.s.r();f&&this.l().m(this.D)},cQ:function(n,t,i){var r=null;i.val=!1;var c=this.I+"[id^='LPRemovePreview']";var h=t.querySelector(c);if(h){_j.e.a(_a.a.f,"Remove preview button already added. Skipping preview initialization.");return!1}this.bf(t);var f=!1;var o;this.l().q(t,o={val:f}),f=o.val;this.l().o(t);if(f){this.l().p(n);i.val=!0}this.bI(t);this.Z(t);this.bb(t);this.ba(t);var u;var e,s;if(s=_cmc.f.a(n,e={val:u}),u=e.val,s){t.id=this.l().i(t.id,u);r=this.l().a(u);r.g(r.f(t.id));r&&(r.a()!==1||!r.c()||r.c().b()!=null||this.l().u(r,t,this.P))}return!0},j:function(){this.s.u()},cR:function(n){var s=String.format("[id^='{0}']","LPBestFitImageContainer");var e=_j.B.e(_j.k.o(n),s);if(e&&e.length>0){var t;var i;var o,r,u,f;if((r=this.l().n(n,o={val:t}),t=o.val,r)&&(f=_cmc.f.a(n,u={val:i}),i=u.val,f)){t.id=this.l().i(t.id,i);return!0}}return!1},cx:function(n){var i=this.bd(n.id);var t=this.m.z.querySelectorAll("div[id*='"+i+"']");if(!t.length){n.setAttribute("previewremoved",!0);return!0}return!1},bd:function(n){var t=n.indexOf("|");return t>-1?n.substring(0,t):n},bn:function(n){this.cC(n)},co:function(n){this.bI(n);this.Z(n);this.bb(n);this.ba(n);var t=n;if(this.N.b()){n.style.display="inline-block";t=window.document.createElement("p");t.appendChild(n)}this.bf(t);return t},bI:function(n){var t=this.l().e(n,"[id^='LPRemovePreviewContainer']");if(t){this.I=t.tagName;t.id="LPRemovePreview";t.style.marginLeft="10px";_j.k.b(t,"click",this.Y);_j.k.d(t,_mcp.e.r().a())}},bb:function(n){var f=n.querySelector("a[id^='LPUrlAnchor']");var i;var e,o;if(f&&(o=_cmc.f.a(f,e={val:i}),i=e.val,o)&&this.l().s(i)){var r=n.querySelector("[id^='LPOptionsContainer']");if(r&&_j.h.a(r.innerHTML)){var t=this.l().e(n,"[id^='LPOptionsContainer']");if(t){t.id="LPOptions";var u=_mcp.e.E().a();if(!_j.k.p(t,u)){_j.k.d(t,u);this.ba(n);this.K(!0)}}}}},ba:function(n){var e=n.querySelector("a[id^='LPUrlAnchor']");var r=n.querySelector("[id^='LPMetadata']");var i;var o,s;if(r&&e&&(s=_cmc.f.a(e,o={val:i}),i=o.val,s)){var t=this.l().a(i);if(t&&t.a()){var f;var u;t.b()&&!_j.h.a(f=this.l().b(t.b()==null?0:t.b()))?r.innerText=f:_j.h.a(u=this.cq(i))||(r.innerText=String.format(_nbs.a.OX,u))}}},Z:function(n){var i;if((i=n.querySelector("div[id^='LPDescription']"))&&!_j.h.a(i.getAttribute("altdesc"))){var t=this.l().e(n,"[id^='LPExpandDescriptionContainer']");if(t){t.id="LPExpandDescription";i.id.endsWith("_summary")&&_j.k.d(t,"ms-fcl-tp-b");_j.k.d(t,_mcp.e.Q().a());_j.k.b(t,"click",this.W)}}},bf:function(n){_j.e.a(_a.a.f,"InitializePreviewForEditor: InitializePreviewForEditor.");n.setAttribute("contenteditable",!1);_j.k.b(n,"click",this.bw)},bK:function(n){var t=[];this.bc(t,n,this.I,"LPRemovePreview");this.bc(t,n,"a","LPExpandDescription");this.bc(t,n,"a","LPOptions");return t},bc:function(n,t,i,r){for(var f=t.getElementsByTagName(i),u=0;u<f.length;u++)f[u].id===r&&Array.add(n,f[u])},cn:function(n){var i=n.b();var s=_b.k.b(i);var t=s.querySelector("div[id^='LPDescription']");if(t){var e=t.id.endsWith("_summary");if(e){t.id=t.id.substring(0,t.id.length-8);_j.k.e(i,"ms-fcl-tp-b")}else{t.id+="_summary";_j.k.d(i,"ms-fcl-tp-b")}this.cv(t,!e);var f=t.getAttribute("altdesc");if(!_j.h.a(f)){t.setAttribute("altdesc",t.innerHTML);t.innerHTML=f}var r="maxHeight";var u=t.getAttribute("altmaxheight");var o=u?u:"100%";t.setAttribute("altmaxheight",_j.k.i(t,r));_j.k.a(t,r,o)}},cv:function(n,t){var i=new _a.l;var r=_a.b.b(_a.a.f,"LinkPreviewExpandDescriptionAction",!1,null);var u=_b.k.b(n).querySelector("a[id^='LPUrlAnchor']");i.a("U",_mco.d.b(u,"href",100));i.c("Summary",t);r.m=i.toString();_a.b.a(r)},cB:function(n){var t=new _cmc.h(_a.a.f,"RemoveLinkPreviewClickEvent",!1);if(!this.m){_j.e.c(_a.a.f,"RemovePreviewClicked: editor was null");return}this.m.eE(n);var l=n.b();var i=_b.k.b(l);var w=this.m.dR();if(i){var y=20;var u=null;u=_b.k.a(i.id,"LPBorder")?i:i.querySelector("[id^='LPBorder']");if(u){var r=u.getAttribute("id");_b.k.a(r,"LPBorder_YT")?t.a("T","Y",!0,!0):_b.k.a(r,"LPBorder_VT")?t.a("T","V",!0,!0):_b.k.a(r,"LPBorder_PT")?t.a("T","P",!0,!0):_b.k.a(r,"LPBorder_BVT")?t.a("T","BV",!0,!0):t.a("T","G",!0,!0);var s;var o=_b.k.h(i);var a,h;if(o&&(h=_cmc.f.a(o,a={val:s}),s=a.val,h)){var e=this.l().a(s);var v=e.f(r);var c=document.body.querySelector(String.format("[id^='{0}']",v));c&&c.setAttribute("previewremoved",!0);e.a()&&t.a("D",e.a(),!0,!0);t.a("U",_mco.d.d(o.href,y),!0,!0)}}var f=i.querySelector("div[id^='LPDescription']");var p=!!f&&!!f.id&&f.id.endsWith("_summary");t.a("S",p,!0,!0);t.j().length<1;_j.k.c(l,"click");this.m.lx(i);t.b()}else t&&t.d("NullPreview",null)},bZ:function(n){if(!this.o){_j.e.a(_a.a.f,"RTE: Skipping link preview cleanup because previews are disabled");return!1}for(var o=this.bK(n),h=0;h<o.length;h++){var s=o[h];var i=_b.k.b(s);if(i){i.removeAttribute("contenteditable");_j.k.c(i,"click");_j.k.c(s,"click mouseenter mouseleave");_j.k.f(s);this.p&&this.l().r(i)}}for(var a=n.querySelectorAll(String.format("[id^='{0}']","LPBorder")),e=0;e<a.length;e++){var u=a[e];var t=u.querySelector("a[id^='LPUrlAnchor']");if(!t){var f=u.querySelectorAll("a[id^='LPImageAnchor']");f&&f.length===1&&(t=f[0])}var r;var v,c;if(this.p&&t&&(c=_cmc.f.a(t,v={val:r}),r=v.val,c)){var l=this.l().a(r);l?u.id+=l.r():_j.e.c(_a.a.f,"We should GetLinkPreviewData for {0}",r)}}if(this.p){var y=this.l().j();var p=this;Array.forEach(y,function(t){t.v(n)})}return o.length>0},be:function(n,t,i){if(!this.o){_j.e.a(_a.a.f,"RTE: Skipping link preview initialization because previews are disabled");return}if(!n){_j.e.a(_a.a.f,"RTE: Skipping link preview initialization because bodyElement is null");return}if(n.nodeType===3){_j.e.a(_a.a.f,"RTE: Skipping link preview initialization because bodyElement is text node");return}this.bP(_mcp.s.a(n),t,i)},bY:function(n){if(!this.o){_j.e.a(_a.a.f,"RTE: Skipping link preview bind because previews are disabled");return}if(n)for(var u=this.bK(n),i=0;i<u.length;i++){var t=u[i];var r=_b.k.b(t);if(r){this.bf(r);t.id==="LPRemovePreview"?_j.k.b(t,"click",this.Y):t.id==="LPExpandDescription"&&_j.k.b(t,"click",this.W)}}},cA:function(n){if(!this.m){_j.e.c(_a.a.f,"PreviewClicked: editor was null");return}if(this.m.dR()){var i=n.b().parentNode;var t=_b.k.b(i);if(t){this.m.lI(t);this.bj.a.be.a(_a.ba,new _a.ba(_nbs.a.Bw+t.textContent.replace(_nbs.a.bZ,""),!1,0,2))}}},cq:function(n){var t=this.l().a(n);return t?t.i():null}};_mcp.Z=function(n,t){_mcp.Z.initializeBase(this,[14,n]);this.d=t};_mcp.Z.prototype={d:null,b:null,c:0,a:null,bp:function(){return _mcp.I.prototype.bp.call(this)||!this.b},g:function(){_mcp.I.prototype.g.call(this);this.a=this.j();var n=this.bj.a;this.b=n.bs();this.c=n.ba.a();_mcp.h.g(n.ba)&&!n.ba.bv()&&this.n()},bz:function(){this.a=null;this.b=null;_mcp.I.prototype.bz.call(this)},n:function(){this.b.f(_mcp.Z.a);this.f()},j:function(){var n=this.bj.a.ba;var t=n.b()||n.K();return t&&n.bu()?t:null},m:function(){if(_dg.a.isInstanceOfType(this.a))return this.a.D();else if(_dg.r.isInstanceOfType(this.a)){var n=this.a;return n.I().D()==="RecurringMaster"?n.R()?"RecurringMaster":"Occurrence":n.I().D()}else throw Error.argument("this.Item","Unsupported calendaring type:"+Object.getType(this.a).getName());},f:function(){if(this.a&&!_dg.t.isInstanceOfType(this.a)){this.b.a(6800);switch(this.m()){case"Occurrence":case"Exception":this.i();break;case"RecurringMaster":this.h();break}}},k:function(n){var t;switch(n){case 8:t=3200;break;case 3:t=3205;break;case 5:case 6:case 7:default:throw Error.argument("operation","Unsupported mail compose operation on an occurrence: "+n);}return t},l:function(n){var t;switch(n){case 8:t=3100;break;case 3:t=3105;break;case 5:case 6:case 7:default:throw Error.argument("operation","Unsupported mail compose operation on a series: "+n);}return t},h:function(){var n=this.l(this.c);this.b.a(n)},i:function(){var n=this;this.d.a(function(t){if(!n.bp()){var u=t.a();var r=u.a(n.a,null);var i=n.k(n.c);n.b.a(i,r)}})}};_mcp.L=function(n,t,i,r){this.p=Function.createDelegate(this,this.Z);this.q=Function.createDelegate(this,this.bb);this.H=Function.createDelegate(this,this.bn);this.C=Function.createDelegate(this,this.l);this.E=Function.createDelegate(this,this.P);this.t=Function.createDelegate(this,this.bs);this.D=Function.createDelegate(this,this.ba);this.K=Function.createDelegate(this,this.bq);this.I=Function.createDelegate(this,this.bo);this.j=Function.createDelegate(this,this.bd);this.G=Function.createDelegate(this,this.bg);this.r=Function.createDelegate(this,this.be);this.s=Function.createDelegate(this,this.bh);_mcp.L.initializeBase(this,[0,n]);this.h=n.a.bY;this.i=t;this.v=i;this.B(!0);this.x=r};_mcp.L.prototype={h:null,v:null,m:!1,f:!1,o:!1,z:null,A:null,n:null,i:null,x:!1,d:null,e:function(){return _mcp.I.prototype.e.call(this)},cj:function(n){if(n!==_mcp.I.prototype.e.call(this)){_mcp.I.prototype.cj.call(this,n);this.by("IsInitialized")}this.bj.a.ba.ek(n);return n},c:function(){return this.m},U:function(n){if(n!==this.m){this.m=n;this.by("IsSecondInitializationComplete")}return n},a:function(){return this.f},B:function(n){if(this.f!==n){this.f=n;this.bA("CanLoadPopoutSuccessfully","ShouldHideSpinner")}return n},M:function(){return this.bk?this.bk.ff&&this.f||!this.bk.ff&&!this.f:!0},V:function(){if(this.d){this.d.a();this.d=null}},g:function(){this.z=_j.n.b(_a.a.a,517,"VM.MailCompose.FirstInit");var t=this.bj.a;var n=t.ba;n.apcl("IsEditorInitialized",this.s);n.apcl("IsUpgraded",this.r);if(!n.eU&&!n.k()){_j.e.a(_a.a.a,"Capture initial baseline for a non draft without existing initial baseline.");n.eU=_mcp.c.b(n);n.fj()||n.fk(!0)}if(n.gC()){_j.e.a(_a.a.a,"Finish 1st init for complete context");this.k();if(n.a()!==15){_j.e.a(_a.a.a,"Check begin upgrade for complete context");this.w()}}else{var o=t.bp;var r=n.k();var i=n.A();var s=n.hl();if(!r&&s){var e;var u=_g.a.a().c();e=_j.h.a(u.bH.SharePointUrl)?u.bH.UserEmailAddress||"":u.bH.LogonEmailAddress||"";var l=new _gg.bb("StoreId",s,e);var a=new _mcp.bi([l],"EwsId");var v=this;o.a(a,this.G,function(n){v.bf(n)},this.j);_j.e.a(_a.a.a,"Calling server to convert id, storeId={0}",s)}else if(r)if(n.cz()&&n.fj()){_j.e.a(_a.a.a,"The message was saving prior to popout, check for save result from main window");this.T()}else{_j.e.a(_a.a.a,"Load draft {0}",_h.G.c(r));this.y(r)}else if((4===n.a()||13===n.a())&&n.fj()){_j.e.a(_a.a.a,"Loading draft without id for the popout from reading-pane case, check id from main window");this.T()}else if(i){t.bb.b(3400);t.bb.a(3400,null);if(n.hh()){var f=this;this.v.b(function(t){var u=t.a(i,n.cu(),n.cl(),n.dg());var r=t.b(200,u,n.cl());r.ba=n.d();o.a(r,f.I,function(n){f.S(n)},f.j);_j.e.a(_a.a.a,"Loading original calendar item with ID={0}, ChangeKey={1}",i.Id,i.ChangeKey)})}else{var h=t.bX.i(i);h.ba=n.d();var c=this;o.a(h,this.K,function(n){c.S(n)},this.j);_j.e.a(_a.a.a,"Loading original message item with ID={0}, ChangeKey={1}",i.Id,i.ChangeKey)}}else if(0===n.a()||11===n.a()){n.cK(!0);n.fp(!0);_j.e.a(_a.a.a,"Finish 1st init for new mail");this.k()}else{this.l("ErrorNoDraftOrOriginalItemId",null,null);throw Error.invalidOperation(String.format("Cannot perform operation {0} without either draft ID or original item ID",_j.u.c(_y.m,n.a())));}}_j.h.a(_g.a.a().c().bH.SharePointUrl)||t.bb.a(596,null);t.ba.a()!==16||t.ba.bW()||t.ei()},b:function(){this.X();this.A=_j.n.b(_a.a.a,517,"VM.MailCompose.SecondInit");var i=this.bj;var n=i.a;var u=n.ba;_j.e.a(_a.a.a,"Queue secondary init task.");_j.m.a().c(_a.a.a,"Delayed MailCompose Secondary Init",this.D);if(n.hZ()&&!n.eU.a){var f=i.b(10);_j.e.a(_a.a.a,"Queue appbar setup task");var t=f;_j.m.a().c(_a.a.a,"SetupApplicationBarMenu",t.d||(t.d=Function.createDelegate(t,t.b)))}this.br();if(u.bI()){_j.e.a(_a.a.a,"Queue diagnostics save to trigger uploading of the diagnostics attachment");var e=this;_j.m.a().c(_a.a.a,"Diagnostics save:",function(){n.bl().a("Diagnostics",null,null,!1)})}if(_a.cD.a){_j.e.a(_a.a.a,"Queue GetMailTips if needed task");var r=this;_j.m.a().c(_a.a.a,"TriggerMailTipsIfNeeded",function(){r.bp()||n.de().a(32)})}},l:function(n,t,i){var f=this.bj.a;var r=f.ba;if(r.bH()){var u=new _a.l;_j.h.a(i)||u.a("E",i);_y.l.a(r.bH(),null,n,t,this.Q(u.toString(),r.bH().m));r.D(null)}if(r.fy()){_y.l.a(r.fy(),null,n,t,i);r.bc(null)}this.L()},bz:function(){var n=this.bk;n.rpcl("IsEditorInitialized",this.s);n.rpcl("IsUpgraded",this.r);this.cj(!1);this.U(!1);this.B(!0);this.o=!1;this.V();_mcp.I.prototype.bz.call(this)},bn:function(n){if(this.bj&&this.bj.a&&this.bj.a.ba){var f=_j.n.b(_a.a.a,2,"VM.MailCompose.ProcessDraft");var e=this.bj.a.ba;var u=this.bi.bq();var t=n;var i=n.ba;_j.e.a(_a.a.a,"Got draft, checking pending discards for {0}",i);if(this.h.a(i))u&&u.c(i,t.e);else if(i===this.bk.d()){var r=t.e;if(_g.bx.isInstanceOfType(r)){this.bk.dE(r);this.u(!0);this.R(t)}else _a.m.a&&r.bA()?this.bc(r,t):this.P(r,t);_a.bu.a&&_j.m.a().c(_a.a.a,"SafeTriggerPolicyTipsIfNeededForOpenDraft",this.t)}else _j.e.a(_a.a.a,"Skipping get draft processing since action context {0} doesn't match current context {1}",i,this.bk);_j.n.a(f);_j.n.a(this.n)}},bc:function(n,t){var i=this;this.bi.dr(function(){i.W();i.d.c(n,t)})},W:function(){if(!this.d){_j.e.a(_a.a.a,"Setting initializer component override");this.d=this.bi.cK().b();this.d.b(this.E,this.cF,this.C,this.bi.bp)}},P:function(n,t){this.bk.cA(n);this.u(!1);this.R(t)},R:function(n){if(this.bk.fj()&&this.bk.dC()){_j.e.a(_a.a.a,"Capture initial baseline for a loaded draft.");this.bk.eU=_mcp.c.b(this.bk)}_j.e.a(_a.a.a,"Finish 1st init for a loaded draft.");this.k();_j.m.a().c(_a.a.a,"SafeTriggerPolicyTipsIfNeededForOpenDraft",this.t)},bo:function(n){var u=this.bj;var f=u.a;var t=f.ba;var i=n.ba;if(i===t.d()&&!this.h.a(i)){var r=n;t.S(r.e());t.eg(!1);_j.e.a(_a.a.a,"Got original cal item, finish 1st init.");this.k();_j.e.a(_a.a.a,"Check begin upgrade on original cal item");this.w()}},bq:function(n){var u=this.bj;var f=u.a;var i=f.ba;var t=n.ba;if(t===i.d()&&!this.h.a(t)){var r=n;i.S(r.e);_j.e.a(_a.a.a,"Got original message, finish 1st init.");this.k();_j.e.a(_a.a.a,"Check begin upgrade on original message item");this.w()}},Z:function(n,t){this.bi.bm().a(this.bj.a,!1);_j.e.a(_a.a.a,"Navigate away on action failure")},bd:function(n){if(!this.bp()&&n.ba===this.bk.d()){this.bi.bb.b(3400);this.bi.bi()}},k:function(){var s=_j.n.b(_a.a.a,2,"VM.MailCompose.ComponentInit");var n=this.bj;var o=n.a;var r=o.ba;var h=r.a();n.b(7).g();if(r.a()!==15){n.b(8).g();n.b(1).g();var t=n.b(11);t.g();var u=n.b(38);u.g();u.a().a();if(this.bk.a()!==4&&!this.bk.y()||!this.bk.a()&&this.bk.y()||this.bk.fs&&t.a()){var i=this.bi.bD().c(this.i.b()&&this.bk.h()==="HTML",this.bk.y());if(t.a()){var e=t.b();e&&(i=i+e)}this.bk.r(i)}}r.bu()&&n.b(14).g();var f=_y.c.a.a();if(f!=="Mouse"){if(f==="TouchNarrow"){n.b(5).g();n.b(6).g();n.b(3).g();n.b(9).g();n.b(22).g();n.b(16).g()}n.b(10).g()}else{n.b(22).g();n.b(25).g()}_j.n.a(s);_j.n.a(this.z);if(o.cN){_j.e.a(_a.a.a,"Finishing primary init, beginning secondary init because we are already in view.");this.b()}this.cj(!0)},ba:function(){var n=this.bj;var r=n.a;var t=r.ba;n.b(2);n.b(15);n.b(25);n.b(27);if(t.a()!==15){n.b(32);n.b(34)}n.n();t.eR()||t.gA();if(t.fP!==-1){var i;(i=this.bi.bb).a.apply(i,[t.fP].concat(t.fW))}this.U(!0);_j.e.a(_a.a.a,"Finished secondary init.");_j.n.a(this.A)},y:function(n){this.n=_j.n.b(_a.a.a,517,"VM.MailCompose.LoadDraft");var i=this.bj.a;var t=i.ba;var e=i.bp;if(t.fj()){if(t.dC()){_j.e.a(_a.a.a,"Capture initial baseline since message was a clean new message before popout.");t.eU=_mcp.c.b(t)}t.bn()&&!t.l()&&this.u(!0)}else t.go(!0);i.bb.b(3400);i.bb.a(3400,null);t.gD()&&i.bb.a(3480);var r=this.i.b()&&t.h()==="HTML"?_h.b.d():_h.b.l();var o="MailCompose";var u=i.bX.i(n,r,o);u.ba=t.d();var f=this;e.a(u,this.H,function(n){f.bm(n)},this.j);_j.e.a(_a.a.a,"Loading draft with ID={0}; Shape={1}; Layout={2}; ContextBodyType={3}",_h.G.c(n),r.BodyType,_y.c.a.a(),t.h())},u:function(n){if(n!==this.o){var t=this.bj.a.bb;t.b(3440);n&&t.a(3440,null);this.bi.bi();this.o=n}},bg:function(n){var i=n;var t=new _g.e(i.k().Id);this.bj.a.ba.E(t);this.y(t)},w:function(){var u=this.bj;var n=u.a.ba;var t=n.a();var i=1===t||2===t||3===t||12===t;if(!i||n.k()||n.l()){if(i&&n.k()&&n.l()&&_a.o.a().I){var r=this;_j.m.a().a(_a.a.a,"MailComposeInitializerComponent.BeginUpgradeIfNecessary",function(){r.bT||r.bi.bi()},1e3)}}else this.bi.bO().b()},T:function(){var n=this.bj.a.ba.d();if(this.x){_j.e.a(_a.a.a,"Processing save result on main window for popout projection compose window {0}",n);var t=window.self.windowServiceEndPoint;t.getSaveResultForPopout(n,_a.Y.b,this.q)}else{_j.e.a(_a.a.a,"Calling main window to process save result {0}",n);_g.k.b.getSaveResultForPopout(n,_a.Y.b,this.q)}},bb:function(n){var t=this.bj.a.ba;if(n){var i=JsonParser.deserialize(n);_j.e.a(_a.a.a,"Resume loading draft after main window successfully saved item: {0}",i.Id);t.bn()&&!t.l()&&t.cK(!0);this.y(i)}else{_j.e.a(_a.a.a,"Save failed on the main window for this popout, show failure message.");this.B(!1);this.l("ErrorSaveFailedOnMainWindow",null,null)}},bh:function(n,t){var r=this.bj.a;var i=r.ba;i.ff&&this.Y();this.by("ShouldHideSpinner")},be:function(n,t){var r=this.bj.a;var f=r.ba;if(f.l()){var i=this.bi.bO();if(i.f()){var u=r.ch()?r.ch().toString():"";_y.l.a(i.f(),null,null,null,u);i.l(null)}}},Y:function(){var t=this.bj.a;var n=t.ba;if(n.fy()){n.fy().q(new _a.y("OneCompose"));this.i.a().i()&&this.i.a().i().Enabled&&n.fy().q(new _a.y("PE"));var i=t.ch()?t.ch().toString():"";_y.l.a(n.fy(),null,"",null,i);n.bc(null)}this.L()},Q:function(n,t){var i="";i=_j.h.a(n)?t:_j.h.a(t)?n:n+"|"+t;return i},X:function(){var i=this.bj.a;var n=i.ba;if(n.bH()){var t=n.bH().m;i.ch()&&(t=this.Q(i.ch().toString(),t));_y.l.a(n.bH(),null,"",null,t);n.D(null)}},L:function(){var i=this.bj.a;var t=i.ba;if(t.hm()){var n=null;switch(t.a()){case 0:n="MailComposeNewLoad";break;case 1:n="MailComposeReplyLoad";break;case 2:n="MailComposeReplyAllLoad";break;case 3:n="MailComposeForwardLoad";break;case 4:n="MailComposeEditDraftLoad";break}if(n){_a.O.b(n);t.bd(!1)}}},bf:function(n){this.O(n,"ConvertIdAction")},bm:function(n){this.O(n,n.m)},O:function(n,t){var i=this;this.N(n,t,function(t){t.g(n,_nbs.a.NN,_nbs.a.De,_nbs.a.NN,_bms.E.BC,i.p)})},S:function(n){var t=this;this.N(n,n.m,function(i){i.f(n,t.p)})},N:function(n,t,i){var r=t+"_UnknownError";if(this.bp()){_j.e.a(_a.a.a,"MailComposeInitializerComponent.HandleActionFailure: viewModel is null or disposing, aborting logic. ErrorCode = {0}",r);return}var s=this.bj;var e=s.a;var h=e.ba;var f=n.ba;f!==h.d()||this.h.a(f)||i(e.bp);var u=r;u=_g.W.a(n.G)?_g.W.b(n.G)||r:n.G.ExceptionName||r;var o=n.G.FaultMessage||n.G.message;_j.n.a(this.n);this.l(u,n.P(),o)},bs:function(){_mcp.I.a(this.bi,32)},br:function(){this.bi&&this.bi.ba.m()===1&&!this.bi.bu()&&this.bi.be.a(_a.U,new _a.U(6))}};_mcp.h=function(n,t,i){_mcp.h.initializeBase(this,[4,n]);this.k=t;this.i=i};_mcp.h.f=function(){_mcp.h.b||(_mcp.h.b=new _a.f("LocationViewModel",_y.jg,_mcp.h));return _mcp.h.b};_mcp.h.e=function(){_mcp.h.a||(_mcp.h.a=new _a.f("IsMeetingForwardOnBehalfOf",Boolean,_mcp.h));return _mcp.h.a};_mcp.h.g=function(n){switch(n.a()){case 4:return n.bv();case 8:case 3:return!0;case 5:case 7:case 6:return!1;default:return!1}};_mcp.h.prototype={k:null,i:null,h:null,a:function(){return this.eM(_mcp.h.c)},n:function(n){this.eK(_mcp.h.c,n);return n},d:function(){return this.eM(_mcp.h.d)},f:function(n){this.eK(_mcp.h.d,n);return n},b:function(){return this.eM(_mcp.h.f())},l:function(n){this.eK(_mcp.h.f(),n);return n},j:function(){return this.eM(_mcp.h.e())},o:function(n){this.eK(_mcp.h.e(),n);return n},c:function(){return this.h},p:function(n){if(n!==this.h){this.h=n;this.by("MeetingCalendarTimePeriod")}return n},g:function(){var n=this.bj.a.ba;var i=this.bj.a.dE;if(n.bK()){var e=this;this.k.a(function(t){e.l(t.a(n.fO(),null,!1))})}else this.l(null);if(n.bu()){if(n.bx()){var o=this;this.i.a(function(t){var i=t.a();o.p(i.a(n,null))})}if(n.bk()){var t=2;var s=_pc.a.n(n.n());var r=i.e(s,_bc.e.a,!0,t,!1,!1);this.n(r);this.o(!!n.bw()&&!!n.bw().Mailbox&&!!n.n()&&!!n.n().Mailbox&&!_g.n.a(n.n().Mailbox,n.bw().Mailbox));if(this.j()){var f=_pc.a.n(n.bw());var u=i.e(f,_bc.e.a,!0,t,!1,!1);this.f(u)}else this.d()&&this.f(null)}}else this.m();_j.e.a(_a.a.a,"Meeting component initialized, IsMeeting={0}, IsMeetingForward={1}",n.bu(),n.bk());_mcp.I.prototype.g.call(this)},bz:function(){this.m();if(this.b()){this.b().dispose();this.l(null)}_mcp.I.prototype.bz.call(this)},m:function(){if(this.a()){this.a().dispose();this.n(null)}if(this.d()){this.d().dispose();this.f(null)}}};_mcp.q=function(n,t,i,r){_mcp.q.initializeBase(this,[n,t]);this.bU=r;this.bu=i};_mcp.q.a=function(n,t){return new _fm.f(n,t,null,1,null,null,!1,!1,!1,!1,null)};_mcp.q.c=function(n,t){return new _y.i(t,n)};_mcp.q.b=function(n,t){return new _fm.c(t,null,n,!0)};_mcp.q.prototype={bU:null,bu:null,cI:null,cH:null,ck:null,R:function(){return this.cI},Q:function(){return this.cH},P:function(){return this.ck},dF:function(){return this.bU.a()==="Mouse"&&!!this.bu&&!this.bi.bn()},g:function(){if(_y.c.a.a()==="Mouse"||_y.c.a.a()==="TouchNarrow"){this.dF()&&(this.cH=this.bN());this.cI=this.bC()}else this.ck=this.bx();_mcp.I.prototype.g.call(this)},ca:function(){},cd:function(){},cx:function(){},bz:function(){this.cI=null;this.cH=null;this.ck=null;_mcp.I.prototype.bz.call(this)},bs:function(){if(_y.c.a.a()==="Mouse"||_y.c.a.a()==="TouchNarrow"){this.dF()&&this.cd();this.ca()}else this.cx()}};_mcp.bQ=function(n,t,i,r){this.h=Function.createDelegate(this,this.v);this.f=Function.createDelegate(this,this.u);this.n=Function.createDelegate(this,this.s);this.k=Function.createDelegate(this,this.w);this.m=Function.createDelegate(this,this.r);this.o=Function.createDelegate(this,this.x);this.p=Function.createDelegate(this,this.A);_mcp.bQ.initializeBase(this,[9,n,i,r]);this.j=t};_mcp.bQ.prototype={j:null,d:null,c:null,b:null,l:null,a:function(){return this.c},z:function(n){if(this.c!==n){this.c=n;this.by("DialogViewModel")}return n},g:function(){this.d||(this.d=new _j.g(this.p,this.bl()));this.q();_mcp.q.prototype.g.call(this)},bz:function(){var t;_a.h.a(t={val:this.b}),this.b=t.val;var n;_a.h.a(n={val:this.d}),this.d=n.val;this.c=null;this.j=null;_mcp.q.prototype.bz.call(this)},bC:function(){if(!this.bk.R()&&!this.bU.c()&&!this.bi.bn()){var n=_mcp.q.b(this.d,_nbs.a.QN);return[n]}return null},bN:function(){if(!this.bk.R()&&!this.bU.c()){var n=_mcp.q.a(this.d,_nbs.a.QN);return[n]}return null},bx:function(){if(!this.bk.R()&&!this.bU.c()){var n=new _y.i(_nbs.a.QN,this.d);return[n]}return null},A:function(){_j.e.a(_a.a.a,"User chose to show message options");this.b||(this.b=new _mcp.S);this.b.t(this.bk);if(!this.c){var t=new _bc.n;t.D(this.j);this.z(t);this.c.s(_nbs.a.WQ);this.l=[new _ff.d(new _j.g(this.o,this.bl()),_u.P.X,null,!0,!1),new _ff.d(new _j.g(this.m,this.bl()),_u.R.BG,null,!1,!1)];this.c.p.j(this.l)}this.c.t(this.b);if("TouchNarrow"===_y.c.a.a()){var n=this.bj.a.bU();this.b.u(n);n.b().d(this.k)}this.c.f(!0)},x:function(){if(this.c.H){_j.e.a(_a.a.a,"User tried to click OK button more than once.");return}var n=this.bi.ba;if(n.C()!==this.b.d){this.bj.a.bk().a("Sensitivity:"+this.b.d);"Normal"!==n.C()&&this.y();n.et(this.b.d);"Normal"!==n.C()&&this.q()}n.Z()!==this.b.e&&this.bj.a.bk().a("RequestDeliveryReceipt");n.ba()!==this.b.f&&this.bj.a.bk().a("ReadReceiptRequested");n.ed(this.b.e);n.ei(this.b.f);if(this.b.b&&!n.o()||this.b.c&&!n.v()){this.c.A(!0);this.bi.dr(this.n)}else this.s();this.b.b!==n.o()&&this.bj.a.bk().a("EncryptMessage");this.b.c!==n.v()&&this.bj.a.bk().a("SignMessage")},s:function(){this.c.A(!1);var n=this.bi.ba;var u=this.bj.a;var t=this.bi.bc();var i=t.a();if(n.o()!==this.b.b){n.ey(this.b.b);this.by("SmimeEncryptMessage");_j.e.a(_a.a.k,"SmimeEncryptMessage option is changed to {0} by user.",this.b.b)}if(n.v()!==this.b.c){n.eA(this.b.c);this.by("SmimeSignMessage");_j.e.a(_a.a.k,"SmimeSignMessage option is changed to {0} by user.",this.b.c)}var r=this.b.b||this.b.c;r&&u.fX();i&&i.bt(n.H());if(this.b.l&&!r&&t.j())if(t.b()){_j.e.a(_a.a.k,"Waiting to move attachments because the attachment well is currently in progress.");this.c.A(!0);i.J(this.f)}else this.u(null,null);else if(!this.b.l&&r){this.bi.bn()&&this.bi.bO().i()&&!n.bm()&&this.bi.bO().a().a();if(t.j())if(t.b()){_j.e.a(_a.a.k,"Waiting to move attachments because the attachment well is currently in progress.");this.c.A(!0);i.J(this.h)}else this.v(null,null);else this.i()}else this.i()},u:function(n,t){if(this.t(n,t)){_j.e.a(_a.a.k,"Started MoveAttachmentsFromClientToServer due to user turned off S/MIME for current message.");if(n){n.F(this.f);this.c.A(!1)}var i=this.bi.bc().a();if(this.bi.ba.k())i.bj();else{var r=this;this.bi.bl().a("Attach",function(){i.bj()},null,!1)}this.i()}},v:function(n,t){if(this.t(n,t)){_j.e.a(_a.a.k,"Started MoveAttachmentsFromServerToClient due to user turned on S/MIME for current message.");if(n){n.F(this.h);this.c.A(!1)}this.bi.bc().a().bk();this.i()}},t:function(n,t){return!n&&!t?!0:t==="IsInProgress"&&!n.l()},i:function(){_j.e.a(_a.a.a,"User hit OK on message options dialog, setting Sensitivity="+this.bk.C()+"; DeliveryReceipt="+this.bk.Z()+"; ReadReceipt="+this.bk.ba()+"; SmimeEncryptMessage="+this.bk.o()+"; SmimeSignMessage="+this.bk.v());this.r()},r:function(){if(this.c.H){_j.e.a(_a.a.a,"User tried to close dialog when busy.");return}var t=this.bj.a.ba;var i=this.bi.bs();if(t.H()&&t.z()){_a.D.a(_u.R.HS,1);i.a(750)}else i.b(750);this.bi.bd().bc().c(!t.H());var n=this.bi.bc();if(n.a()){n.a().F(this.f);n.a().F(this.h)}"TouchNarrow"===_y.c.a.a()&&this.b.g.b().e(this.k);_j.e.a(_a.a.a,"Close message options dialog");this.c.q.a()},w:function(n,t){_mcp.d.isInstanceOfType(this.bj.a.bU().a())?this.c.f(!0):this.c.f(!1)},y:function(){var t=this.bj.a;var n=t.bs();switch(t.ba.C()){case"Personal":n.b(8900);break;case"Confidential":n.b(8901);break;case"Private":n.b(8902);break}this.bi.bi()},q:function(){var t=this.bj.a;var n=t.bs();switch(t.ba.C()){case"Personal":n.a(8900,null);break;case"Confidential":n.a(8901,null);break;case"Private":n.a(8902,null);break}this.bi.bi()}};_mcp.t=function(n,t,i,r){this.N=Function.createDelegate(this,this.bc);this.Y=Function.createDelegate(this,this.bv);this.U=Function.createDelegate(this,this.bo);this.W=Function.createDelegate(this,this.bg);this.X=Function.createDelegate(this,this.bt);this.S=Function.createDelegate(this,this.bh);this.O=Function.createDelegate(this,this.H);this.V=Function.createDelegate(this,this.br);this.D=Function.createDelegate(this,this.bm);this.T=Function.createDelegate(this,this.bn);_mcp.t.initializeBase(this,[2,n,i,r]);this.u=new _j.g(this.T,this.bl());var e=this;this.K=new _j.g(function(){e.C("Upconvert")},this.bl());var s=this;this.v=new _j.g(function(){s.C("ShowOriginalMessage")},this.bl());var h=this,o=this;this.L=new _j.w(function(){h.C("UpconvertOnFormat")},this.bl(),this.bj.a.ba,"BodyType",function(){return o.bj.a.ba.h()==="HTML"});var f=this;this.B=new _j.g(function(){f.C("UpconvertOnMoreOptions")},this.bl());var u=this;this.A=new _j.g(function(){u.bj.a.ba.eq(function(n){n.bj().I()});u.C("UpconvertAndShowApps")},this.bl());this.r=n.a.bY;this.E=t};_mcp.t.prototype={r:null,E:null,u:null,K:null,L:null,v:null,A:null,B:null,t:!1,x:!1,p:!1,w:!1,G:!1,o:null,q:null,z:!1,b:function(){return this.u},j:function(){return this.A},y:function(n){this.t!==n&&(this.t=n);return n},i:function(){return this.x},I:function(n){if(this.x!==n){this.x=n;this.Z(n)}return n},h:function(){return this.p},M:function(n){if(this.p!==n){this.p=n;this.Z(n)}return n},k:function(){return this.w},c:function(){return this.s().t()},m:function(n){this.s().m(n);return n},s:function(){this.q||(this.q=this.bb());return this.q},g:function(){var n=_y.c.a;"Mouse"!==n.a()||n.b()||n.w(this.D);_mcp.q.prototype.g.call(this)},d:function(n){this.q=n},a:function(n,t){n.R(!0);var i=this.bk.m();this.bi.bj().o();if(i===3){this.bi.be.a(_a.br,new _a.br);this.bq(t)}this.s().f(n,t);i===1&&(this.t&&_a.o.a().I||this.bi.be.a(_y.dF,new _y.dF));this.bi.be.a(IExtensibilityShowHideEvent,_mcp.ba.a)},f:function(n){this.bj.a.bP&&(this.z=!0);if(!this.z){_j.e.a(_a.a.a,"Checking dirty before prompting user for before unload confirmation.");this.bj.a.cb()&&n.a(_nbs.a.LZ)}this.z=!0;_j.m.a().a(_a.a.a,"ResetSkipBeforeUnloadConfirmationFlag",this.V,100)},n:function(){var t=!0;var u=this.bj;var n=u.a;var i=n.ba;var r=n.bg();var o=n.bl();var e=i.d();var s=i.a();if(this.r.a(e))_j.e.a(_a.a.a,"User had chose to discard, simply navigate away.");else if(i.bn()&&this.r.g(u,!1))_j.e.a(_a.a.a,"User had navigated away on an unused response, the unused response was discarded.");else if(this.ba())t=!1;else if(r.b()){_j.e.a(_a.a.a,"We're sending the message, can't exit yet.");t=!1}else if(r.o()){_j.e.a(_a.a.a,"We're resolving the recipients before sending, can't exit yet.");r.m();t=!1}else if(i.R()){var f=n.bq();f.a().a();t=!1}else if(n.bj().f()){_j.e.a(_a.a.a,"Addins are still running on the message, invalid to navigate");n.bj().k(n.bh,this.O);t=!1}else if(i.a()===15)_j.e.a(_a.a.a,"Navigate away if the current operation is ReplyToBotMessage.");else{_j.e.a(_a.a.a,"Checking dirty before navigating away from compose.");if(n.cb()||n.bF){this.G=!1;_j.m.a().a(_a.a.a,"NavigatingAwaySaveTimeout",this.S,1e4);this.ci();if(o.a("ReadingPaneExit",this.X,this.W,!1)){this.M(!0);_j.e.a(_a.a.a,"Save is in progress or failed, can't exit yet.");t=!1}}}t&&this.bi.bj()&&this.bi.bj().o();return t},l:function(){this.be(this.bi.ba);this.bi.ez(!1)},bb:function(){return new _y.bs},bz:function(){var r;_a.h.a(r={val:this.L}),this.L=r.val;var u;_a.h.a(u={val:this.u}),this.u=u.val;var f;_a.h.a(f={val:this.K}),this.K=f.val;var n;_a.h.a(n={val:this.v}),this.v=n.val;var t;_a.h.a(t={val:this.B}),this.B=t.val;var i;_a.h.a(i={val:this.A}),this.A=i.val;_y.c.a.D(this.D);this.q=null;_mcp.q.prototype.bz.call(this)},bC:function(){if(this.bi.bn()){var n=new _fm.c(_u.n.Ly,null,this.u);return[n]}return null},bN:function(){return null},bx:function(){return null},br:function(){this.z=!1},bm:function(){_y.c.a.D(this.D);this.r.g(this.bj,!0)},Z:function(n){var t=this.bj.a;t.eD(_u.P.r);t.eC(n);t.eB(n)},bn:function(){var t=this.bi;var n=t.ba;var f=n.d();_j.m.a().j(_a.a.a,"MailComposePopOut");if(this.t){_j.e.a(_a.a.a,"Skipped pop out because another pop out is in progress.");return}if(this.bd()){t.bk().a("UpconvertOnPopOut");n.D(this.o=_y.l.b(_a.a.a,"MailComposeReadingPanePopOut",!0,!1));this.y(!0);var e=!1;try{var s=this.bj.a.bb;s.f(_mcp.t.b);t.bi();var i=t.bl();_j.e.a(_a.a.a,"Checking dirty before popping out from reading pane.");var u=t.cb();var r=t.ba.dj();var o=t.bS();if(!n.k()||u||o.a()||r){this.I(!0);(n.k()&&!r||u||i.f())&&n.fk(!1);_j.e.a(_a.a.a,"Set WasCleanNewMessageBeforePopout = {0}",n.dC());this.w=!1;_j.m.a().a(_a.a.a,"PopoutSaveTimeout",this.U,1e4);n.gt(!0);this.ci();t.bB.get_saveForPopoutMap()[f]=new _y.jH;i.a("Popout",this.Y,this.N,!1);this.bf()}else{if(n.bM())n.fk(!1);else if(n.bJ())n.fk(!1);else if(i.f())n.fk(!1);else if(n.eU){_j.e.a(_a.a.a,"Comparing initial baseline with baseline.");n.eU.s(n.eR())||n.fk(!1)}else n.fk(!1);n.gt(!1);_j.s.b(t.bB,"PopoutManager");_j.s.b(t.bB.get_saveForPopoutMap(),"PopoutManager.SaveForPopoutMap");delete t.bB.get_saveForPopoutMap()[f];this.bf()}_j.e.a(_a.a.a,"MailComposeNavigationComponent::OpenComposeWindow - setting composeConductor.HasNavigatedFromReadingPaneToPopoutCompose = true");this.s().u(!0);e=!0}finally{if(!e){this.y(!1);this.I(!1);_y.l.a(this.o,null,_mcp.t.a.toString(4));n.D(null);this.o=null}}}},bd:function(){var r=this.bj;var n=r.a;var u=n.ba;var t=u.d();var i=this.bi.bg();if(i.b()){_j.e.a(_a.a.a,"Skipped navigating away because send is in progress.");return!1}if(this.ba()||this.r.a(t)){_j.e.a(_a.a.a,"Skipped navigating away because attachment is currently uploading or user had discarded");return!1}if(n.bj().f()){_j.e.a(_a.a.a,"Skipped navigating away because addins are still running.");n.bh.h(0,_nbs.a.oS,null,!1,_nbs.a.bu,null);return!1}return!0},ba:function(){var n=this.bj.a;var t=n.bc();if(t.b()){if(!n.bh.r){_j.e.a(_a.a.a,"Show attachment in progress error dialog");n.bh.h(0,_u.R.EB,null)}return!0}return!1},bf:function(){var r=this.bj.a;var n=r.ba;var t=new _mcp.b;this.E&&t.er(this.E.b());t.p(0);t.f(!1);if(n.a()===11||n.a()===12){t.e(13);t.ep(n.bS());t.eo(n.bR())}else t.e(4);t.E(n.k());t.i(n.h());var i=this.bb();t.hI(!0);t.cK(n.l());t.eD(n.L());t.cJ(n.bn());t.go(n.bM());t.gm(n.bJ());t.dX(n.cq());t.fk(n.dC());t.gt(n.cz());t.gs(n.d());t.t(n.w());t.D(n.bH());t.fR(n.cs());t.cd(n.Y());t.fx=n.bW();t.eb(n.di());n.bH()&&n.bH().e()==="MailComposeReadingPanePopOut"&&n.D(null);n.l()||n.a()!==3||n.dG()||!n.b().bi()||t.T(n.b().bi().f);i.a(t);if(!n.cz()){this.H();this.y(!1)}},bv:function(n){this.I(!1);if(this.w){_j.e.a(_a.a.a,"Popout was cancelled by timer, skipping save succeeded processing for popout.");if(this.o){_y.l.a(this.o,null,_mcp.t.a.toString(3));this.o=null}}else{var i=n.ba;var t=this.bj.a;if(i in t.bB.get_saveForPopoutMap()){var u=_mcp.bc.a(n);var r=t.bB.get_saveForPopoutMap()[i];if(r.a.length){var f=JsonParser.serialize(u);t.bB.pushSaveResultToPopout(f,r.a);delete t.bB.get_saveForPopoutMap()[i]}else r.b=u}if(t.ba.d()===i){_j.e.a(_a.a.a,"Save succeeded for popout, navigating away from the main window.");this.H();this.y(!1)}else _j.e.a(_a.a.a,"Skipped navigating away since contextId={0}; viewModelId={1}",i,t.ba.d())}},bt:function(n){this.p&&this.M(!1);if(this.G){_j.e.a(_a.a.a,"Navigation away was cancelled by timer, skipping navigating from compose.");return}this.H()},bg:function(n){if(this.p){_j.e.a(_a.a.a,"Save failed, reset IsSavingForNavigatingAway flag to false");this.M(!1)}},H:function(){var n=this.bj.a;this.a(n,!1);_j.e.a(_a.a.a,"Navigated away from reading-pane compose")},C:function(n){this.bi.bk().a(n);var o=this.bj;var r=o.a;var t=r.ba;if(!t.l()&&!t.k()&&!t.L()){_j.e.a(_a.a.a,"upgrade is still in progress, need to wait till it is completed. ContextId={0}",t.d());r.bh.h(0,_nbs.a.mz);return}if(this.bd()){var f=this.s();if(IInlineComposeConductorViewModel.isInstanceOfType(f)){var i=_a.b.b(_a.a.a,"MailComposeUpConvert",!1,null);i.m=n;var u=new _a.l;u.a("O",n);i.m=u.toString();t.D(i);t.eC(!0);var s=f;if(r.bF){var e=this;this.bi.bl().a("RehydrateUpgrade",function(){e.bi.bO().b()},null,!1)}else{this.bi.bO().a().a();this.be(t)}}}},bc:function(n){if(this.t){this.y(!1);this.I(!1);var f=this.bj;var i=f.a;var t;t=n?n.ba:i.ba.d();if(t in i.bB.get_saveForPopoutMap()){var r=i.bB.get_saveForPopoutMap()[t];r.a.length>0&&i.bB.pushSaveResultToPopout(null,r.a);delete i.bB.get_saveForPopoutMap()[t]}}if(this.o){var u=this.w?2:1;_y.l.a(this.o,null,_mcp.t.a.toString(u));this.o=null}},bo:function(){_j.e.a(_a.a.a,"Attempt to popout expired since save did not come back in time");if(this.x&&!this.bT){this.w=!0;this.bc(null);var t=this.bj;var n=t.a.bb;this.ci();n.a(84);this.bi.bi()}},bh:function(){_j.e.a(_a.a.a,"Attempt to navigate away expired since save did not come back in time");if(this.p&&!this.bT){this.G=!0;this.bg(null);var n=this.bi.bb;this.ci();n.a(86);this.bi.bi()}},bq:function(n){var t=new _mcp.bB;t.Name="MailComposeNavigation";t.Result=n;n&&!this.bp()&&(t.Recipients=this.bi.bd().C());window.parent.postMessage(t,"*")},be:function(n){var t=this.s();t.g(!1);t.p(n)}};_mcp.t.a=function(){};_mcp.t.a.prototype={popoutSaveFailed:1,popoutSaveExpired:2,popoutSaveSucceededExpired:3,popoutEncounteredException:4};_mcp.t.a.registerEnum("_mcp.t.a",!1);_mcp.bR=function(n,t,i,r){this.z=Function.createDelegate(this,this.E);this.C=Function.createDelegate(this,this.O);this.p=Function.createDelegate(this,this.H);this.q=Function.createDelegate(this,this.K);this.A=Function.createDelegate(this,this.L);this.D=Function.createDelegate(this,this.S);this.B=Function.createDelegate(this,this.N);_mcp.bR.initializeBase(this,[28,n,i,r]);this.i=new _j.g(this.B,this.bl());this.j=new _j.g(this.D,this.bl());this.h=new _j.g(this.A,this.bl());this.y=t;this.bi.ba.bl()&&this.G();if(_a.g.b){var u=this.bi.ba.bQ();if(u){var f=this.bi.bs();f.a(10213,u.b(9))}}};_mcp.bR.prototype={i:null,j:null,h:null,o:null,v:null,m:null,x:null,u:null,w:null,n:null,t:null,l:null,f:null,b:null,c:null,y:null,k:null,d:0,r:function(){return!!this.bi.bo.OmeSettings},s:function(){var n=this.bi.bo.OmeSettings;return(n&3)==3||(n&5)==5},a:function(){return this.b},M:function(n){if(this.b!==n){this.b=n;this.by("DialogViewModel")}return n},g:function(){this.bi.bo.WasLoadedFromServer||this.bi.be.b(_a.cn,this.q);_mcp.q.prototype.g.call(this)},bz:function(){this.bi.be.c(_a.cn,this.q);var r;_a.h.a(r={val:this.b}),this.b=r.val;var u;_a.h.a(u={val:this.c}),this.c=u.val;this.k&&(this.k.length=0);this.bj.a.bU().b().e(this.p);var i;_a.h.a(i={val:this.i}),this.i=i.val;var n;_a.h.a(n={val:this.j}),this.j=n.val;var t;_a.h.a(t={val:this.h}),this.h=t.val;_mcp.q.prototype.bz.call(this)},bC:function(){if(!_y.c.a.i()&&!this.bi.bn()){this.v=new _fm.c(_nbs.a.eg,null,this.j);this.o=new _fm.c(_nbs.a.wd,null,this.i);this.m=new _fm.c(_nbs.a.SK,null,this.h);this.ca();return[this.v,this.o,this.m]}return null},bN:function(){if(!_y.c.a.i()){this.u=new _fm.f(this.j,_nbs.a.eg,null,1,null,null,!1,!1,!1,!1,null);this.x=new _fm.f(this.i,_nbs.a.wd,null,1,null,null,!1,!1,!1,!1,null);this.w=new _fm.f(this.h,_nbs.a.SK,null,1,null,null,!1,!1,!1,!1,null);this.cd();return[this.u,this.x,this.w]}return null},bx:function(){if(!_y.c.a.i()&&this.r()){this.t=new _y.i(_nbs.a.eg,this.j);this.n=new _y.i(_nbs.a.wd,this.i);this.l=new _y.i(_nbs.a.SK,this.h);this.f=this.bi.ba.bl()?this.l:this.s()?this.t:this.n;return[this.f]}return null},cd:function(){var t=this.r();var n=this.bi.ba.bl();var i=this.s();this.u.b(t&&i&&!n);this.x.b(t&&!i&&!n);this.w.b(t&&n)},ca:function(){if(this.o&&this.m){var t=this.r();var n=this.bi.ba.bl();var i=this.s();this.v.a(!t||!i||n);this.o.a(!t||i||n);this.m.a(!t||!n)}},cx:function(){if(this.r()){this.l||this.n||(this.ck=this.bx());var n=this.bk.bl()?this.l:this.s()?this.t:this.n;if(this.f&&this.f!==n){this.bi.eU.K(this.f,n);this.f=n}else this.bi.bM().b()}},N:function(){this.bi.ba.cf(!0);this.bs();var n=this.bi.bs();this.d=10206;n.a(this.d,null)},L:function(){this.bi.ba.cf(!1);this.bi.ba.bQ()&&this.bi.ba.cL(null);this.bs();var n=this.bi.bs();n.b(this.d)},S:function(){_j.e.a(_a.a.a,"User chose to show message options");this.c||(this.c=new _mcp.be(this.bi.bo.OmeSettings));if(!this.b){var t=new _bc.n;t.D(this.y);this.M(t);this.b.s(_nbs.a.Xw);this.k=[new _ff.d(new _j.g(this.C,this.bl()),_u.P.X,null,!1,!1),new _ff.d(new _j.g(this.z,this.bl()),_u.R.BG,null,!1,!1)];this.b.p.j(this.k)}this.b.t(this.c);if("TouchNarrow"===_y.c.a.a()){var n=this.bj.a.bU();this.c.n(n);n.b().d(this.p)}this.b.f(!0)},E:function(){if(this.b.H){_j.e.a(_a.a.a,"User tried to close dialog when busy.");return}"TouchNarrow"===_y.c.a.a()&&this.c.b.b().e(this.p);_j.e.a(_a.a.a,"Close message options dialog");this.b.q.a()},G:function(){var i=this.bi.bs();var u=this.bi.ba.bl();if(u){var n=this.bi.ba.bQ();var f=!!n;var t="";if(f){var r=_a.d.a().t;t=n.H(r).b(1);this.d=10214}else this.d=10206;i.a(this.d,t)}else i.b(this.d)},H:function(n,t){_mcp.d.isInstanceOfType(this.bj.a.bU().a())?this.b.f(!0):this.b.f(!1)},O:function(){if(this.b.H){_j.e.a(_a.a.a,"User tried to click OK button more than once.");return}var n=!0;switch(this.c.a){case 0:break;case 1:n=this.I();break}if(n){this.c.i("");this.bi.ba.cf(!0);this.G();this.bs();this.E()}},I:function(){for(var n="",h=0,s=0,o=0,c,t=!0,l=this.c.l(),a=l.length,r=0;r<a;++r){var u=l[r];var i;if(_j.h.a(u.a)){n=_u.n.HS;t=!1;break}else if(isNaN(i=Number.parseInvariant(u.a))){n=_u.n.Pd;t=!1;break}switch(u.b){case 7:h=i;break;case 6:s=i-1;break;case 5:o=i;break}}if(t){var f,e;c=(e=this.T(o,s,h,f={val:n}),n=f.val,e);_j.h.a(n)&&this.bi.ba.cL(c.o())}if(!_j.h.a(n)){this.c.i(n);t=!1}return t},T:function(n,t,i,r){var u=new _a.d(n,t,i,23,59,0,0,_a.d.a().t);r.val="";t<0||t>11||_a.d.s(t,n)<i?r.val=_u.n.n:u.k(_a.d.a())<0&&(r.val=_u.n.On);return _j.h.a(r.val)?u:null},K:function(n){if(!this.bp()){var t=this.bj.a;this.bs();t.be.c(_a.cn,this.q)}}};_mcp.bS=function(n,t){this.c=Function.createDelegate(this,this.d);_mcp.bS.initializeBase(this,[13,n]);this.b=new _j.g(this.c,this.bl());this.b.c(t.f().a().a())};_mcp.bS.prototype={b:null,a:function(){return this.b},d:function(){_j.e.a(_a.a.a,"OpenFilePicker on PAL.");var n=this.bi.bc();if(!n){_j.e.c(_a.a.a,"Unable to open file picker, attachment component is null.");return}if(!n.a()){_j.e.c(_a.a.a,"Unable to open file picker, attachment well ViewModel is null.");return}n.a().cf();_j.e.a(_a.a.a,"OpenFilePicker on PAL end.")},bz:function(){var n;_a.h.a(n={val:this.b}),this.b=n.val;_mcp.I.prototype.bz.call(this)}};_mcp.bU=function(n,t){this.h=Function.createDelegate(this,this.j);this.f=Function.createDelegate(this,this.i);_mcp.bU.initializeBase(this,[13,n]);var i;i=t.b(t.f())?t.f().a():this;var u=this;this.c=new _j.w(this.f,this.bl(),i,"CameraAvailable",function(){return t.b(t.f())&&t.f().a().c()});var r=this;this.d=new _j.w(this.h,this.bl(),i,"GalleryAvailable",function(){return t.b(t.f())&&t.f().a().e()})};_mcp.bU.prototype={c:null,d:null,a:function(){return this.c},b:function(){return this.d},i:function(){_j.e.a(_a.a.a,"User chose to attach from camera");var n=this.bj.b(5);if(!n){_j.e.c(_a.a.a,"Unable to open camera, attachment component is null.");return}if(!n.a()){_j.e.c(_a.a.a,"Unable to open camera, attachment well ViewModel is null.");return}n.a().bl(n.m());_j.e.a(_a.a.a,"Attach from camera end")},j:function(){_j.e.a(_a.a.a,"User chose to attach from gallery");var n=this.bj.b(5);if(!n){_j.e.c(_a.a.a,"Unable to open gallery, attachment component is null.");return}if(!n.a()){_j.e.c(_a.a.a,"Unable to open gallery, attachment well ViewModel is null.");return}n.a().H(n.m());_j.e.a(_a.a.a,"Attach from gallery end")},bz:function(){var t;_a.h.a(t={val:this.c}),this.c=t.val;var n;_a.h.a(n={val:this.d}),this.d=n.val;_mcp.I.prototype.bz.call(this)}};_mcp.f=function(n,t,i){this.dG=Function.createDelegate(this,this.ev);this.dH=Function.createDelegate(this,this.cM);this.dI=Function.createDelegate(this,this.dS);this.dJ=Function.createDelegate(this,this.dT);this.di=Function.createDelegate(this,this.eH);this.df=Function.createDelegate(this,this.eC);this.dg=Function.createDelegate(this,this.eE);this.dO=Function.createDelegate(this,this.eN);this.bD=Function.createDelegate(this,this.eD);this.dN=Function.createDelegate(this,this.eI);this.cy=Function.createDelegate(this,this.eB);this.dh=Function.createDelegate(this,this.eG);this.cJ=Function.createDelegate(this,this.el);this.dM=Function.createDelegate(this,this.eF);this.dP=Function.createDelegate(this,this.eO);this.de=Function.createDelegate(this,this.eu);this.dL=Function.createDelegate(this,this.ez);this.dR=Function.createDelegate(this,this.dB);this.dK=Function.createDelegate(this,this.ey);this.dQ=Function.createDelegate(this,this.eQ);_mcp.f.initializeBase(this,[1,n,t,i]);this.dk={};this.dX()&&(this.cf=new _fp.j(_a.g.a,i.h()));this.bm=this.dp(0);this.bo=this.dp(1);this.bn=this.dp(2);this.ch=new _j.g(this.dQ,this.bl());this.cq=new _j.g(this.dK,this.bl());this.bP=new _j.g(this.dR,this.bl());this.cc=new _j.g(this.dL,this.bl());this.co=new _j.g(this.de,this.bl());this.cz=new _j.g(this.dP,this.bl());this.bY=new _j.g(this.dM,this.bl());this.cg=new _j.q;this.eo()};_mcp.f.d=function(n,t){n.bb(t)};_mcp.f.b=function(n,t){n.cb(t)};_mcp.f.e=function(n,t){n.cQ(t)};_mcp.f.c=function(n,t){n.dN(t)};_mcp.f.a=function(n,t){n.dL(t)};_mcp.f.prototype={bm:null,bo:null,bn:null,ch:null,cq:null,bP:null,cc:null,co:null,cz:null,bY:null,cv:null,cm:null,cl:null,ct:null,bv:null,bR:null,bQ:null,cs:null,cp:null,cu:null,cr:null,da:null,cO:null,cZ:null,cN:null,bq:null,bG:null,cW:!1,br:!1,bt:null,cn:null,cL:null,cC:null,dx:!1,dz:!1,cY:!1,cX:!1,cg:null,bZ:null,bw:null,cR:null,cS:null,cD:null,cQ:null,cE:!0,T:function(n){this.bB("ResolveOperationSucceeded",n)},K:function(n){this.bF("ResolveOperationSucceeded",n)},S:function(n){this.bB("ResolveOperationCanceled",n)},I:function(n){this.bF("ResolveOperationCanceled",n)},dk:null,cf:null,m:function(){return this.cf},cU:function(n){if(this.bq!==n){this.bq=n;this.by("FromPersonaViewModel")}return n},O:function(){return this.bq&&this.bq.ca?this.bq.ca.a():null},ex:function(){return!!this.bu&&this.bu.a().H().Enabled&&_y.c.a.a()==="Mouse"},dX:function(){return!!this.bu&&this.bu.a().et().Enabled},Z:function(){var n=(this.bm.D()+this.bo.D()+this.bn.D()).trim();return n===""?n:n.substring(0,n.length-1)},n:function(){if(!this.bG){var n=this;this.bi.dt.a(function(t){if(n.bp()){_j.e.a(_a.a.a,"get_FromFindRecipientViewModel: viewModel is null or disposing, aborting logic.");return}var i=t.a(null,null,0,0,!0);i.A(!0);i.bF(!1);i.cJ(100);i.bG(0);i.cH("PersonaDetailedView");i.cj();i.L(!0);i.bJ(new _j.g(n.cJ,_a.a.a));n.bU.c()&&i.bI(new _j.g(n.cJ,_a.a.a));_y.c.a.a()!=="Mouse"&&i.cA(new _j.g(n.cJ,_a.a.a));i.T(n.dh);n.bG=i;if(n.cY){n.dB();n.cY=!1}else if(n.cX){n.dw();n.cX=!1}})}return this.bG},x:function(){return this.cW},L:function(n){if(this.cW!==n){this.cW=n;this.by("ShouldHighlightFromAsInvalid")}return n},c:function(){return this.bm},h:function(){return this.bo},o:function(){return this.bn},fr:function(){var n=this.bj.a.ba.z()&&(!!this.bq&&this.bq.fr()||!!this.bG&&this.bG.cq());return n||this.bm.fr()||this.bo.fr()||this.bn.fr()},v:function(){return this.br},eP:function(n){this.br=n;this.by("IsReadWrite");return n},cK:!1,ba:function(){return this.cK},bb:function(){return this.dx},cV:function(n){this.dx=n;this.by("IsPeoplePickerShown");return n},w:function(){return this.bY},A:function(){return this.ch},bc:function(){return this.bP},q:function(){var n=this.bj.a.ba;return!!n.n()&&!!n.n().Mailbox&&!_a.J.a(n.n().Mailbox.EmailAddress)},dj:!1,cb:!1,cA:function(){this.da||(this.da=new _y.i(_nbs.a.sn,this.bP));return this.da},ds:function(){this.cO||(this.cO=new _y.i(_nbs.a.QS,this.cc));return this.cO},dv:function(){this.cZ||(this.cZ=new _y.i(_nbs.a.Lq,this.ch));return this.cZ},dr:function(){this.cN||(this.cN=new _y.i(_nbs.a.Th,this.cq));return this.cN},dY:function(){return!this.bj.a.ba.R()},dt:function(){return this.bj.a.ba.R()},X:function(){return this.dm(this.br?this.bm.a.I:this.bm.b.c())||this.dm(this.br?this.bo.a.I:this.bo.b.c())||this.dm(this.br?this.bn.a.I:this.bn.b.c())},p:function(){return this.bm.f()||this.bo.f()||this.bn.f()},Y:function(){return this.bm.g()&&this.bo.g()&&this.bn.g()},dW:function(){return this.bj.a.ba.R()||this.bj.a.dz()},bV:null,z:function(){return this.bV},bH:function(){if(!this.bv){var n=this.ep();this.bv=this.bi.bV.b(1,_bc.e.a,n,2,!1,!0,!1,0,0,this.bu,null,!0,this.bi.bu());this.bv.b(!1);this.bV=new _j.l;this.bV.j(this.bv.a().f())}return this.bv},bI:function(){if(this.bv&&this.bV){var t=this.bv.a().x.length;var n=this.G()-t;if(n>0)return String.format(_u.n.FV,n)}return""},bK:function(){return null},y:function(){return this.du()?!1:this.cE},M:function(n){if(this.du())return n;if(this.cE!==n){if(n){if(this.G()<=0)return n;this.f();this.bm.d.m(this.bk.g());this.bo.d.m(this.bk.j());this.bn.d.m(this.bk.c())}this.cE=n;this.by("ShowAggregatedHeader");this.ee()}return n},bJ:function(){return!1},du:function(){return!this.bi.bn()},dZ:function(){return this.bi.bn()},H:function(n){return this.cB(n).a.G},V:function(n,t){this.cB(t).a.bw(n)},be:function(n){this.cB(n).a.D()},d:function(n){this.cB(n).bh()},b:function(n){return this.cB(n).a},bh:function(){this.bm.I();this.bo.I();this.bn.I()},bg:function(n){this.cC=n},eq:function(n,t,i){if(this.bt){this.bt.c(this.cn);this.bt.a(i);this.cn=i;this.bt.d(t);this.bt.e(n);this.cV(!0);this.bj.a.bI(this.bt)}else{var r=this;this.bi.dL.a(function(u){if(r.bp()){_j.e.a(_a.a.a,"BuildAndLaunchRichPeoplePickerViewModel: viewModel is null or disposing, aborting logic.");return}r.bt=u.a(n,t,r.bi.bu());r.bt.a(i);r.bt.b(r.cy);r.cn=i;r.cV(!0);r.bj.a.bI(r.bt)})}},en:function(){this.dl(0);this.dl(1)},a:function(){return this.cg},er:function(n,t,i,r){var u=null;this.cR=n;this.cS=r;this.cD=t;this.cQ=i;r&&(u=this.ec(this.cS));if(!this.bw&&u){var f=this;this.bi.dO.a(function(t){if(!f.bp()){f.bw=t.a();f.ed(n,u)}})}else if(u){this.bw.a(this.cL);this.ed(n,u)}},ed:function(n,t){this.bw.d(this.cy);this.bw.c(this.cR);this.bw.b(this.cQ);this.cL=n;t.a.H().cI(this.bw);this.cV(t.q=!0);t.a.H().cM()},ec:function(n){var t=null;n===_u.n.QO?t=this.bm:n===_u.n.Qr?t=this.bo:n===_u.n.Sf&&(t=this.bn);return t},g:function(){var n=this.bj.a.ba;var t=n.q();this.eP(!t||!!t.a()||t.v()||t.b());this.bZ=new _mcp.j(n.V(),this.dW(),this.bu);if(n.bV()&&n.bV().b()>0){this.bm.V(n.bV(),this.br,_u.n.QO);n.eB(null)}else{var u,f;var e=(f=this.bZ.l(u={val:n}),n=u.val,f);this.bm.E(e,n.bp(),this.br,_u.n.QO)}this.bo.E(n.j(),n.bh(),this.br,_u.n.Qr);this.bk.fR(this.bk.cs()||!this.dW()&&(this.bi.fB()||this.bi.bn()?!!n.j()&&n.j().b()>0:!0));this.bZ.n(this.br?this.bm.a:this.bm.b,this.br?this.bo.a:this.bo.b);this.en();var i=_g.a.a().c();if(!_j.h.a(i.bH.SharePointUrl)&&!_j.h.a(i.bH.LogonEmailAddress)){var r=new _g.R;r.Mailbox=this.dn(i.bH.LogonEmailAddress);n.cF(r)}("Mouse"===_y.c.a.a()||n.n()||_g.a.a().a().bH.AlwaysShowFrom||n.c()&&n.c().b()>0||_g.a.a().a().bH.AlwaysShowBcc)&&this.bW();this.eh(n);if(this.dZ()){this.bm.y(this.bi.ba.g());this.bo.y(this.bi.ba.j());this.bn.y(this.bi.ba.c());this.M(this.G()>0)}_mcp.q.prototype.g.call(this);this.dX()&&this.cf.e(this.C())},eL:function(){if(this.bV){this.bV.g();this.bV=null}if(this.bv){if(this.bv.a()){this.bv.h(!0);var n;_a.h.a(n={val:this.bv}),this.bv=n.val}this.bv=null}},f:function(){this.bW();var n=this.bk;this.db();this.dy(n,this.bm,this.dN,_mcp.f.e);this.dy(n,this.bo,_mcp.f.d,_mcp.f.c);this.dy(n,this.bn,_mcp.f.b,_mcp.f.a);this.ce("UpdateContext")},U:function(n){var u=this.bH().a().x.length;var i=u-1;if(n<i)this.bH().a().r(n+1,i-n);else if(n>i)for(var t=u;t<=n;t++)this.bH().a().a(this.bV.x[t]);var r=!1;this.bH().a().x.length<this.bV.x.length&&(r=!0);this.bH().b(r);this.by("RecipientsTruncatedString")},N:function(n,t){var r=_a.J.a(n);if(r){this.n().e("");var e=this.dn(n);var o=_pc.a.a(e,!1);var f=this.bj.a.bV.c;var i=f.a(o,4,!0,2,this.bi.bu(),!1,!1);i.I(this.cz);i.b(!0);i.cC=!0;this.cU(i);this.et()}else{this.n().e(n);this.cU(null)}if(t&&_a.cD.a){var u=this.bj.a.de();u.a(1)}this.L(!r);this.f()},G:function(){this.bW();return this.bm.h()+this.bo.h()+this.bn.h()},s:function(){this.bW();return this.bm.h()},E:function(){this.bW();return this.bo.h()},D:function(){this.bW();return this.bn.h()},bf:function(n){this.M(!1);this.bW();this.db();this.es();this.dz=n;this.ew()},C:function(){var n=new _j.q;this.bm.a?n.h(this.bm.a.g()):this.bm.b&&n.h(this.bm.b.g());this.bo.a?n.h(this.bo.a.g()):this.bo.b&&n.h(this.bo.b.g());this.bn.a?n.h(this.bn.a.g()):this.bn.b&&n.h(this.bn.b.g());return n.i()},u:function(n){this.cf&&this.cf.d(n)},bz:function(){var c;_a.h.a(c={val:this.bq}),this.bq=c.val;if(this.bt){this.bt.c(this.cn);this.bt.f(this.cy);this.bt.dispose();this.bt=null;this.cn=null}if(this.ex()&&this.bw){this.bw.f(this.cy);this.bw.a(this.cR);this.bw.e(this.cQ);this.bw.dispose();this.bw=null;this.cL=null;this.cD=null}this.ef();if(this.bG){this.bG.V(this.dh);this.bG.dispose();this.bG=null}this.eL();this.ef();this.eJ();this.cg.f();var h;_a.h.a(h={val:this.bm}),this.bm=h.val;var s;_a.h.a(s={val:this.bo}),this.bo=s.val;var l;_a.h.a(l={val:this.bn}),this.bn=l.val;var y;_a.h.a(y={val:this.ch}),this.ch=y.val;var v;_a.h.a(v={val:this.cq}),this.cq=v.val;var a;_a.h.a(a={val:this.bP}),this.bP=a.val;var o;_a.h.a(o={val:this.cc}),this.cc=o.val;var i;_a.h.a(i={val:this.co}),this.co=i.val;var t;_a.h.a(t={val:this.cz}),this.cz=t.val;var n;_a.h.a(n={val:this.bY}),this.bY=n.val;var r;_a.h.a(r={val:this.cv}),this.cv=r.val;var e;_a.h.a(e={val:this.cm}),this.cm=e.val;var f;_a.h.a(f={val:this.cl}),this.cl=f.val;var u;_a.h.a(u={val:this.ct}),this.ct=u.val;this.bZ=null;this.cC=null;_mcp.q.prototype.bz.call(this)},bC:function(){var n=new _j.q;if(!this.bk.R()&&!this.bi.bZ()){this.cs=new _fm.c(_nbs.a.Lq,null,this.ch);_g.a.a().a().bH.AlwaysShowBcc&&this.cs.a(!0);n.c(this.cs);this.cp=new _fm.c(_nbs.a.Th,null,this.cq);_g.a.a().a().bH.AlwaysShowBcc||this.cp.a(!0);n.c(this.cp)}if(this.bk.bO()||this.bk.H()){var i=this.bj.b(1);this.bR=new _fm.c(_nbs.a.sn,null,this.bP);n.c(this.bR);this.bP.c(!this.bk.H());this.bQ=new _fm.c(_nbs.a.QS,null,this.cc);this.bR.a(this.bk.z());this.bQ.a(!this.bk.z());n.c(this.bQ)}if(!this.bk.R()&&!_y.c.a.i()&&!this.bi.bn()&&_y.c.a.a()!=="TouchNarrow"){var t=new _fm.c(_nbs.a.ks,null,this.bY);n.c(t)}return n.i()},bN:function(){var n=new _j.q;if(this.bk.bO()||this.bk.H()){this.cu=_mcp.q.a(this.bP,_nbs.a.sn);n.c(this.cu);this.cr=_mcp.q.a(this.cc,_nbs.a.QS);n.c(this.cr);this.bP.c(!this.bk.H());this.cu.b(!this.bk.z());this.cr.b(this.bk.z())}if(!this.bk.R()&&!_y.c.a.i()){var t=_mcp.q.a(this.bY,_nbs.a.ks);n.c(t)}return n.i()},bx:function(){var n=new _j.q;_g.a.a().a().bH.AlwaysShowBcc?n.c(this.dr()):n.c(this.dv());if(this.bk.bO())if(_g.a.a().a().bH.AlwaysShowFrom){n.c(this.ds());this.cb=!1}else{n.c(this.cA());this.cb=!0}else this.cb=!1;_a.g.b||n.c(new _y.i(_nbs.a.ks,this.bY));return n.i()},cx:function(){var n=this.bk;var t=this.bi.eU;if(t){var u=n.z()?this.ds():this.cA();var f=n.z()?this.cA():this.ds();t.K(f,u);var i=n.Y()?this.dr():this.dv();var r=n.Y()?this.dv():this.dr();t.K(r,i)}},ca:function(){if(this.bR&&this.bQ){this.bR.a(this.bk.z());this.bQ.a(!this.bk.z())}if(this.cs&&this.cp){this.cs.a(this.bk.Y());this.cp.a(!this.bk.Y())}},cd:function(){if(this.cu&&this.cr){this.cu.b(!this.bk.z());this.cr.b(this.bk.z())}},ew:function(){this.bm.c?this.bm.C():this.dT(!0)},dT:function(n){n?this.bo.c?this.bo.C():this.dS(!0):this.cM(!1)},dS:function(n){n?this.bn.c?this.bn.C():this.cM(!0):this.cM(!1)},cM:function(n){if(this.dz)if(n){_j.e.a(_a.a.a,"Force resolve completed");this.ce("ResolveOperationSucceeded")}else{_j.e.a(_a.a.a,"Force resolve cancelled");this.ce("ResolveOperationCanceled")}},W:function(){this.bW();this.db();this.bm.B();this.bo.B();this.bn.B()},bW:function(){if(!this.dj){this.dj=!0;var n=this.bj.a.ba;this.bn.E(n.c(),n.N(),this.br,_u.n.Sf);if(n.c()&&0<n.c().b()||!_j.h.a(n.N())||_g.a.a().a().bH.AlwaysShowBcc){n.cd(!0);_j.e.a(_a.a.a,"Showing BCC field due to: BccCount={0}, HasBccQueryString={1}, AlwaysShowBcc={2}",n.c()?n.c().b():0,!_j.h.a(n.N()),_g.a.a().a().bH.AlwaysShowBcc)}this.dl(2);_j.e.a(_a.a.a,"Recipient component initialized, ShouldValidate={0}, From={1}, ToCount={2}, CcCount={3}, BccCount={4}",!0,!n.n()||!n.n().Mailbox?"<not set>":n.n().Mailbox.EmailAddress,n.g()?n.g().b():0,n.j()?n.j().b():0,n.c()?n.c().b():0);this.eh(n);if(this.eg(n)){_j.e.a(_a.a.a,"Showing From field due to: From={0}, AlwaysShowFrom={1}",!n.n()||!n.n().Mailbox?"<not set>":n.n().Mailbox.EmailAddress,_g.a.a().a().bH.AlwaysShowFrom);this.n()?this.dw():this.cX=!0}else if(_g.a.a().a().bH.AlwaysShowFrom&&n.q()&&!n.q().b()){var t=this.bj.a.bb;t.b(4525);t.a(4525);this.bi.bi()}}},bd:function(){this.bm.G();this.bo.G();this.bn.G()},r:function(){_j.e.a(_a.a.k,"MailComposeRecipientComponent.GetAllEmailAddresses");var f=this.bj.a.ba;var n=new _j.q;var r=this.br?this.bm.a.I:this.bm.b.c();var i=this.br?this.bo.a.I:this.bo.b.c();var t=null;this.br&&this.bn.a?t=this.bn.a.I:!this.br&&this.bn.b&&(t=this.bn.b.c());if(r){_j.e.a(_a.a.k,"MailComposeRecipientComponent.GetAllEmailAddresses: Adding to addresses");n.h(r.f())}if(i){_j.e.a(_a.a.k,"MailComposeRecipientComponent.GetAllEmailAddresses: Adding cc addresses");n.h(i.f())}if(t){_j.e.a(_a.a.k,"MailComposeRecipientComponent.GetAllEmailAddresses: Adding bcc addresses");n.h(t.f())}_j.e.a(_a.a.k,"MailComposeRecipientComponent.GetAllEmailAddresses: Adding from address");var u=f.bX();n.c(u);return n},eO:function(){if(this.bq){_j.e.a(_a.a.a,"User selected from persona");this.bq.C(!0);this.cC&&this.cC()}else _j.e.a(_a.a.a,"User tries to select from persona, but it is null")},eF:function(){this.bj.a.bk().a("ResolveRecipients");this.bf(!1)},eu:function(){_j.e.a(_a.a.a,"User chose to delete from persona");this.cU(null);this.n().W(!0)},el:function(){this.N(this.n().c(),!0)},eG:function(n,t){this.em()},dp:function(n){return new _mcp.B(this.bj.a.bV,this,this.bu,this.bj,this.dk,this.cf,n,this.bi.ba.a(),this.bi.bu())},eg:function(n){return n.bO()&&!this.bi.bn()&&(!!n.n()||_g.a.a().a().bH.AlwaysShowFrom||this.eA())},ee:function(){!this.cE&&_g.a.a().a().bH.AlwaysShowFrom&&this.dB()},eI:function(n,t){if(this.bZ){var i;this.bZ.k(t,i={val:n}),n=i.val}else n.u(t)},eD:function(n,t){this.cg.f();this.dC(this.bm);this.dC(this.bo);this.dC(this.bn)},dC:function(n){n.a?this.cg.c(n.a):n.b&&this.cg.c(n.b)},eo:function(){this.bm.apcl("ReadWriteRecipientWellViewModel",this.bD);this.bo.apcl("ReadWriteRecipientWellViewModel",this.bD);this.bn.apcl("ReadWriteRecipientWellViewModel",this.bD);this.bm.apcl("ReadOnlyRecipientWellViewModel",this.bD);this.bo.apcl("ReadOnlyRecipientWellViewModel",this.bD);this.bn.apcl("ReadOnlyRecipientWellViewModel",this.bD)},eJ:function(){this.bm.rpcl("ReadWriteRecipientWellViewModel",this.bD);this.bo.rpcl("ReadWriteRecipientWellViewModel",this.bD);this.bn.rpcl("ReadWriteRecipientWellViewModel",this.bD);this.bm.rpcl("ReadOnlyRecipientWellViewModel",this.bD);this.bo.rpcl("ReadOnlyRecipientWellViewModel",this.bD);this.bn.rpcl("ReadOnlyRecipientWellViewModel",this.bD)},eC:function(n,t){this.M(!1);this.bm.f()||this.bo.f()||this.bn.f()||(this.bU.c()?this.bj.a.bb.b(97):this.bj.a.bb.b(65));this.bm.g()&&this.bo.g()&&this.bn.g()||this.bj.a.bb.b(70);if(t&&t.c===2){var i=this.bj.a.de();i.b();_a.bu.a&&_j.m.a().c(_a.a.M,"TriggerPolicyTipsIfNeeded",this.dO)}},eH:function(n,t){this.bZ&&this.bZ.m(n,t)},es:function(){this.bm.a&&this.bm.a.bp();this.bo.a&&this.bo.a.bp();this.bn.a&&this.bn.a.bp()},eB:function(){this.cV(!1);var n=this.ec(this.cS);n&&(n.q=!1);this.cD&&this.cD()},ef:function(){this.cT(0);this.cT(1);this.cT(2)},dl:function(n){var t=this.cT(n);if(t){t.cj(this.eb(n));t.el(this.dg);t.G.d(this.df);n||t.G.d(this.di)}return t},cT:function(n){var t=null;switch(n){case 0:t=this.bm.a;break;case 1:t=this.bo.a;break;case 2:t=this.bn.a;break}if(t){t.cu(this.eb(n));t.ex(this.dg);t.G.e(this.df);n||t.G.e(this.di)}return t},eb:function(n){switch(n){case 0:return this.dJ;case 1:return this.dI;case 2:return this.dH;default:throw Error.notImplemented("a new recipient type has been introduced and mail compose recipient component does not work with it");}},eE:function(){this.bi.bi()},eQ:function(){var t=_a.b.b(_a.a.a,"MailComposeShowBcc",!0,null);this.bj.a.bk().a("ShowBcc");_j.e.a(_a.a.a,"User chose to show bcc");this.bW();var n=this.bj.a.ba;if(!n.Y()){n.cd(!0);this.by("ShowBccButton");this.bi.bi();this.bs()}_a.b.a(t)},ey:function(){var t=_a.b.b(_a.a.a,"MailComposeHideBcc",!0,null);this.bj.a.bk().a("HideBcc");_j.e.a(_a.a.a,"User chose to hide bcc");this.bW();var n=this.bj.a.ba;if(n.Y()){n.cd(!1);this.by("ShowBccButton");this.bi.bi();this.bs()}_a.b.a(t)},eh:function(n){if("Mouse"!==_y.c.a.a()){var f=this.bj;var u=f.a;var r=u.eU;if(r){var i=r.a;if(i)if(n.bO()){if(!this.cb)for(var t=0;t<i.length;t++)if(_nbs.a.Lq===i[t].b){r.w(this.cA(),t+1);this.cb=!0}}else if(this.cb){u.eU.t(this.cA());this.cb=!1}}}},db:function(){var i=this.bj.a.ba;var n=null;if(i.z()){var t=null;this.bq?t=this.bq.ca.a():this.bG&&!_j.h.a(this.bG.c())&&(t=this.dn(this.bG.c()));n=new _g.R;n.Mailbox=t;i.cF(n);this.q()||this.bj.a.bb.b(66)}return n},eA:function(){var t=!1;if(this.bU.c()){var n=_g.a.a().c();t=n.e().b()>0||!!n.a()&&n.a().b()>0||n.b().b()>1}return t},ep:function(){var n=new _j.l;if(this.bk){this.bk.g()&&n.j(this.bk.g().f());this.bk.j()&&n.j(this.bk.j().f());this.bk.c()&&n.j(this.bk.c().f())}return n},dn:function(n){var t=new _g.g;t.MailboxType="Mailbox";t.RoutingType="SMTP";t.EmailAddress=n;return t},et:function(){var t=_mcp.B.b;var n=[];(t&4)==4&&Array.add(n,new _fm.c(_u.n.OX,null,new _j.g(this.dG,_a.a.a)));(t&2)==2&&Array.add(n,new _fm.c(_u.n.NH,null,new _j.g(this.de,_a.a.a)));this.bq.cp&&(t&1)==1&&Array.addRange(n,this.bq.cp);this.bq.bf(n)},dw:function(){var t=this.bj.a.ba;var n=null;var i=_g.a.a().c();n=_j.h.a(i.bH.SharePointUrl)||_j.h.a(i.bH.LogonEmailAddress)?null!==t.n()&&t.n().Mailbox?t.n().Mailbox.EmailAddress:_mco.a.g(null)||i.bH.UserEmailAddress:i.bH.LogonEmailAddress;var u=this.bi.ci();u.a()||u.g();var r;var e,f;(f=u.c(n,e={val:r}),r=e.val,f)&&(n=r);this.N(n,!1);t.ef(!0);var o=this.db();t.eR()&&t.eR().z(o);this.bs()},ev:function(){var n=this.bq.ca.a().EmailAddress;this.cU(null);this.n().e(n);this.n().W(!0)},em:function(){var n=this.n().K();if(n&&n.a()&&n.a().a()){var t=n.a().a().EmailAddress;_j.e.a(_a.a.a,"User selected from={0}",t);this.N(t,!0)}else _j.e.b(_a.a.a,"User selected from but the SelectedResultItem persona is invalid")},dB:function(){if(!this.n()){this.cY=!0;return}var t=_a.b.b(_a.a.a,"MailComposeShowFrom",!0,null);this.bj.a.bk().a("ShowFrom");var n=this.bj.a.ba;if(n.z())_j.e.a(_a.a.a,"Skip show from since it is already shown");else{_j.e.a(_a.a.a,"User chose to show from");this.M(!1);this.cK=!0;this.dw();this.bi.bi();this.bs()}_a.b.a(t)},ez:function(){this.M(!1);var t=_a.b.b(_a.a.a,"MailComposeHideFrom",!0,null);this.bj.a.bk().a("HideFrom");var n=this.bj.a.ba;if(n.z()){n.ef(!1);this.cK=!1;this.bi.bi()}else _j.e.a(_a.a.a,"Skip hide from since it is already hidden");this.bs();this.bj.a.bb.b(750);_a.b.a(t)},dy:function(n,t,i,r){var u=this.br?t.a:t.b;if(u){i(n,u.c());if(_rw.d.isInstanceOfType(u)){var f=u;f.H()&&r(n,f.H().c())}}},dm:function(n){if(!n||!n.x.length)return!1;for(var t=0;t<n.x.length;t++){var i=n.x[t];if(i&&i.MailboxType==="GroupMailbox")return!0}return!1},dq:function(n){var t=this.bm.z(n)||this.bo.z(n)||this.bn.z(n);t&&n.a.dk(t)},ea:function(){if(!this.cv){var n=this;this.cv=new _j.g(function(){n.dq(n.bm)},_a.a.a)}return this.cv},dV:function(){if(!this.cm){var n=this;this.cm=new _j.g(function(){n.dq(n.bo)},_a.a.a)}return this.cm},dU:function(){if(!this.cl){var n=this;this.cl=new _j.g(function(){n.dq(n.bn)},_a.a.a)}return this.cl},B:function(){if(!this.ct){var n=this;this.ct=new _j.g(function(){n.bk.fR(!0);n.bi.bi();n.bj.a.bk().a("ShowCc")},_a.a.a)}return this.ct},cB:function(n){switch(n){case 0:return this.bm;case 1:return this.bo;case 2:return this.bn;default:throw Error.argument();}},eN:function(){_mcp.I.a(this.bi,1)}};_mcp.G=function(n){_mcp.G.initializeBase(this,[31,n])};_mcp.G.d=function(n,t){for(var i=0;i<n.length;i++)if(n[i]===t||t&&n[i]&&n[i].toLowerCase()===t.toLowerCase())return!0;return!1};_mcp.G.c=function(n){var t=_g.a.a().c();t?Array.add(n,t.bH.UserEmailAddress):_j.e.b(_a.a.a,"SessionSettings is null.")};_mcp.G.b=function(n,t){t.bH.From&&t.bH.From.Mailbox&&t.bH.From.Mailbox.EmailAddress&&Array.add(n,t.bH.From.Mailbox.EmailAddress)};_mcp.G.a=function(n,t){if(t)for(var i=0;i<t.b();i++)Array.add(n,t.a(i).EmailAddress)};_mcp.G.prototype={a:function(n){if(!n)throw Error.argumentNull("originalMessage");var u=[];var t=[];_mcp.G.c(t);_mcp.G.b(t,n);_mcp.G.a(t,n.q());_mcp.G.a(t,n.A());for(var f=this.bi.bd().r(),r=0;r<f.d.length;r++){var i=f.d[r];if(i&&!_mcp.G.d(t,i.EmailAddress)){Array.add(u,i);Array.add(t,i.EmailAddress)}}return u}};_mcp.B=function(n,t,i,r,u,f,e,o,s){this.M=Function.createDelegate(this,this.ba);this.L=Function.createDelegate(this,this.Z);this.O=Function.createDelegate(this,this.bc);this.N=Function.createDelegate(this,this.bb);this.w=Function.createDelegate(this,this.be);this.u=Function.createDelegate(this,this.X);this.v=Function.createDelegate(this,this.bd);this.p=Function.createDelegate(this,this.Y);this.K=Function.createDelegate(this,this.W);_mcp.B.initializeBase(this);this.o=n;this.n=t;this.m=i;this.e=r;this.H=u;this.A=f;this.r=e;this.x=o;this.s=s};_mcp.B.prototype={o:null,m:null,j:null,a:null,b:null,d:null,n:null,i:null,k:null,t:null,e:null,H:null,A:null,s:!1,U:function(){return!!this.m&&this.m.a().H().Enabled&&_y.c.a.a()==="Mouse"},S:function(n){if(this.a!==n){this.a=n;this.by("ReadWriteRecipientWellViewModel")}return n},q:!1,Q:function(){this.j||(this.j=new _j.g(this.K,_a.a.bi));return this.j},l:0,bg:function(n){if(n!==this.b){this.b=n;this.by("ReadOnlyRecipientWellViewModel")}return n},D:function(){return this.a?this.R(!0):""},bf:function(n){if(n!==this.d){this.d=n;this.by("AggregatedRecipientWellViewModel")}return n},g:function(){return this.c&&_rw.c.h(this.a)},c:!1,f:function(){return this.c&&!!this.a&&this.a.S},bh:function(){this.c&&this.a&&this.a.ei()},r:0,x:0,V:function(n,t,i){this.k=n;this.c=t;this.a?this.a.m(null):this.S(this.P(null));var r=this.a.H();if(r){r.e("");r.bB(this.k)}else this.a.apcl("FindRecipientViewModel",this.p);this.i=i},E:function(n,t,i,r){this.c=i;this.t=t;if(this.c){this.a?this.a.m(n):this.S(this.P(n));var u=this.a.H();if(u){_j.h.a(t)||u.e(t);this.a.dV()}else this.a.apcl("FindRecipientViewModel",this.p);this.i=r;this.a.G&&this.a.G.d(this.v)}else this.b?this.b.m(n):this.bg(this.T(n))},C:function(){this.a&&this.a.cn()},B:function(){this.a&&!this.q&&this.a.bx()},I:function(){if(this.a&&this.a.H().by())if(this.a.H().cp()){this.a.dd(!0);this.a.dd(!1)}else{this.a.df(!0);this.a.df(!1)}},h:function(){var n;n=this.c?this.a?!this.a.H()||_j.h.a(this.a.H().c())?this.a.I.x.length:this.a.I.x.length+1:0:this.b?this.b.c().x.length:0;return n},G:function(){if(this.a){var n=this.R(!1);n!==""&&_j.e.a(_a.a.a,"{0} Well Invalid Recipients are: {1} \n",this.i,n)}},R:function(n){var e="";if(this.a)for(var o="",f="",u,t,i=0,s=this.a.G.x.length;i<s;i++){u=this.a.G.x[i];if(u&&!u.m){t=this.a.I.x[i];if(t){f=_j.h.b(t.Name)?"":t.Name;var r=null;if(n)r=String.format("{0}, ",f);else{o=_j.h.b(t.EmailAddress)?"":t.EmailAddress;r=String.format("( {0} , {1} ),",f,o)}e+=r}}}return e},bz:function(){if(this.a){this.a.G&&this.a.G.e(this.v);this.a.ee(this.u);this.a.rpcl("SelectedRecipient",this.w);this.a.x(!1);this.a.h(!0);var i;_a.h.a(i={val:this.a}),this.a=i.val}if(this.b){this.b.h(!0);var r;_a.h.a(r={val:this.b}),this.b=r.val}if(this.d){this.d.h(!0);var n;_a.h.a(n={val:this.d}),this.d=n.val}var t;_a.h.a(t={val:this.j}),this.j=t.val;this.n=null;_j.S.prototype.bz.call(this)},P:function(n){var t=this.o.a(_mcp.B.b,_pe.c.d,n,!0,!0,this.H,this.A,this.r,this.x,this.s,!0);t.dL(this.u);t.apcl("SelectedRecipient",this.w);return t},T:function(n){return this.o.b(_mcp.B.a,_bc.e.a,n,2)},y:function(n){this.bf(this.o.b(_mcp.B.a,_bc.e.a,n,2,!1,!0,!1,n?n.b():0,0,this.m,null,!1,this.s));return this.d},be:function(n,t){if(this.e){var i=n;var r=this.e.a;i.L!==i.W&&r.bb.f([10210,10211])}},X:function(n){if(this.e){var t=this.e.a;switch(n){case 1:t.bb.a(10210);break;case 0:t.bb.a(10211);break}}},Y:function(n,t){var r=n;var i=r.H();if(this.k&&this.k.x.length>0){i.e("");i.bB(this.k)}_j.h.b(this.t)||i.e(this.t);r.rpcl("FindRecipientViewModel",this.p)},W:function(){if(this.c&&!_a.g.b)if(this.U()){_j.e.a(_a.a.a,"User chose to launch the new people picker");_a.A.a.c("VM.PeoplePicker.Launched",_a.d.a());var t;_a.p.b(_a.a.bi,"LaunchV2PeoplePicker",!0,(t=new _a.K,t.b=!0,t));this.l=0;this.n.er(this.N,this.O,this.L,this.i)}else{_j.e.a(_a.a.a,"User chose to launch rich people picker");this.a.bx();_a.A.a.c("VM.PeoplePicker.Launched",_a.d.a());var n;_a.p.b(_a.a.bi,"PeoplePicker",!0,(n=new _a.K,n.b=!0,n));this.n.eq(this.a.G,this.i,this.M)}},Z:function(n){this.a&&this.a.H().M(n)},bb:function(n){var t=n;if(t.a()){_a.J.a(_g.n.c(t.a()))||t.a().RoutingType==="MAPIPDL"?this.a.y(t):this.a.bi(t);this.l++}},bc:function(){if(this.l>0){var n=new _cmc.h(_a.a.bi,"CloseV2ToPicker",!1);n.a("sc",this.l,!0,!0);n.b()}},ba:function(n){_y.c.a.a()!=="TouchNarrow"&&this.a.q();var t=this;n.o(function(n){var i=n;i.m?t.a.y(i.l):t.a.bi(i.l)})},z:function(n){var u=this.a.G;var r=null;if(this!==n)for(var t=0;t<u.x.length;t++){var i=u.x[t];if(i.x){r=i;this.a.bb(i);break}}return r},bd:function(n,t){this.e&&this.e.a&&this.e.a.fN(t,this.r)}};_mcp.z=function(n,t,i,r,u){this.T=Function.createDelegate(this,this.I);this.O=Function.createDelegate(this,this.bv);this.S=Function.createDelegate(this,this.bw);this.W=Function.createDelegate(this,this.bf);this.X=Function.createDelegate(this,this.bg);this.V=Function.createDelegate(this,this.bG);this.U=Function.createDelegate(this,this.bD);this.m={};_mcp.z.initializeBase(this,[8,n,r,u]);this.H=t;this.u=new _j.g(this.U,this.bl());this.y=new _j.g(this.V,this.bl());this.B=n.a.bY;this.bb=i};_mcp.z.prototype={bb:null,n:null,B:null,H:null,u:null,y:null,s:!1,x:!1,A:null,z:null,w:null,o:null,d:function(){return this.u},j:function(){return this.y},c:function(){return this.s},K:function(n){if(n!==this.s){this.s=n;this.by("IsSaving")}return n},bH:function(n){if(n!==this.w){this.w=n;this.by("DraftSavedTime")}return n},r:function(){return this.bj&&this.bj.a&&this.bj.a.ba?this.bj.a.ba.d():null},t:!1,h:function(){return this.t},l:function(n){this.t=n;return n},q:!1,f:function(){return this.q},b:function(n,t){var i=this.bj;var f=i.b(5);var u=i.a.bh;var r=i.a.ba;_j.e.a(_a.a.a,"UserInitiatedSave - SaveStart");i.a.bk().a("Save");this.ci();if(!r.bN()){_j.e.a(_a.a.a,"Save not supported for the current operation {0}",r.a());return}if(f.b()){_j.e.a(_a.a.a,"Skip save and show attachment in progress dialog");u.r||u.h(0,_u.R.EB,null);return}this.q=!0;this.a("Save",n,t,!1)},g:function(){this.Z();_mcp.q.prototype.g.call(this)},Z:function(){if(this.bi.cL()&&!this.o){_j.e.a(_a.a.a,"Setting save component override");this.o=this.bi.cK().d();var u=this.bi.bd();var o=this.bi.bc();var f=u,e=u,t=u,n=u,r=o,i=o;this.o.b(this.X,this.W,f.k||(f.k=Function.createDelegate(f,f.s)),e.j||(e.j=Function.createDelegate(e,e.E)),t.i||(t.i=Function.createDelegate(t,t.D)),n.l||(n.l=Function.createDelegate(n,n.f)),r.c||(r.c=Function.createDelegate(r,r.o)),i.d||(i.d=Function.createDelegate(i,i.r)),_cmc.g.b,this.cF)}},Y:function(){if(this.o){this.o.a();this.o=null}},a:function(n,t,i,r){if(this.o&&!this.o.c()){_j.e.a(_a.a.a,"saveComponentOverride.IsReadyForSmimeOperation() == false.  Save ignored.");return!0}var h=this.bj;var s=h.a;var u=s.ba;var c=s.bb;var f=u.d();var a=this.bj.b(5);var o=this.bi.bg();if(!o.p()&&o.b()&&!r){_j.e.a(_a.a.a,"Send is in progress, this {0} save is ignored. ContextId={1}",n,f);return!0}if(this.B.a(f)){_j.e.a(_a.a.a,"User already discarded, clearing all save processors to ignore save effects. ContextId={0}",f);this.m={};return!1}var e=this.bi.bd();n==="AutoSave"&&this.bu&&this.bu.a().gg().Enabled||e.W();if(_g.a.a().bH.MaxRecipientsPerMessage<e.G()){c.a(800,null);this.bi.bi();return!0}e.f();u.bt()&&u.bt().a();this.m[n]=new _mcp.ch(t,i);if(!this.s||r){this.A=_mcp.c.b(u);this.K(!0)}else{this.x=!this.A.t(u);return!0}if(!u.l()&&!u.k()&&!u.L()){_j.e.a(_a.a.a,"Save was attempted during upgrade, remembering this save attempt and waiting for upgrade completion to resume this save. ContextId={0}",f);return!0}this.L(n);this.z=n;_j.m.a().j(_a.a.a,"MailComposeSave");_j.e.a(_a.a.a,"Started new task runner context before starting save.");try{this.o?this.o.d(n):this.bg(n);return!0}catch(l){this.bf(l);throw l;}},L:function(n){_a.O.a(_a.a.a,"MailComposeSave",5);this.n=_y.l.b(_a.a.a,"MailComposeSave",!0,!1);this.n&&this.bk.eY&&this.n.q(_mcp.z.a)},i:function(){this.s=!1;this.x=!1;_j.e.a(_a.a.a,"ResumeSave");var i=this.m;for(var r in i){var n={key:r,value:i[r]};var t=n.value;this.a(n.key,t.a,t.b,!0);break}},bz:function(){this.s=!1;this.x=!1;this.q=!1;this.t=!1;this.m=null;this.A=null;this.Y();var t;_a.h.a(t={val:this.u}),this.u=t.val;var n;_a.h.a(n={val:this.y}),this.y=n.val;_mcp.q.prototype.bz.call(this)},cw:function(n){return _db.j.c(n.G,40,50,60,700,88,89,43,57)},cG:function(n){if("ReadingPaneExit"in this.m||"Popout"in this.m){var u=this.bj.a;var t=u.bb;var f=this.cw(n);var e=new _y.cM;var i=e.a(f,null);t.f(_mcp.t.b);"ReadingPaneExit"in this.m?t.a(87,i):t.a(85,i);if(f===50){var r=this;u.cR.a(function(n){if(!r.bp()){n.a(t);r.bi.bi()}})}else this.bi.bi()}else"Save"in this.m&&_mcp.I.prototype.cG.call(this,n)},bC:function(){if(this.bk.a()!==8&&!this.bk.R()&&!_y.c.a.i()){var n=new _fm.c(_nbs.a.Ed,null,this.bi.bl().d());return[n]}return null},bN:function(){if(this.bk.a()!==8&&!this.bk.R()&&!_y.c.a.i()){var n=_mcp.q.a(this.u,_nbs.a.Ed);return[n]}return null},bx:function(){return null},bg:function(n){_j.e.a(_a.a.bq,"Setup save action, OriParentFolderId={0}",this.bk.b()&&this.bk.b().bH.ParentFolderId&&_g.b.a?_g.b.a.idToName(this.bk.b().bH.ParentFolderId):"null");var t=this.bi.bX.h(this.bi,0);if((_mco.a.isInstanceOfType(t)||_mco.c.isInstanceOfType(t))&&("Attach"===n||"Popout"===n)&&this.bk.R()){var i=t;i.bs=new _g.F(new _g.r("internalsubmission"))}this.bi.bp.a(t,this.S,this.O,null);_j.e.a(_a.a.a,"Save action submitted")},bD:function(){this.bj.a.bk().a("Save");this.b(null,null)},bG:function(){_j.e.a(_a.a.a,"User chose to close and save");if(this.bi.cb()){_j.e.a(_a.a.a,"User hit close, the form is dirty, attempt to save and navigate away.");var n=this;this.b(function(){n.I()},null)}else if(this.bi.bj().f()&&this.bi.bh&&!this.bi.bh.r){_j.e.a(_a.a.a,"Addins are still running, prompting the user to terminate them");this.bi.bj().k(this.bi.bh,this.T)}else this.I()},bf:function(n){this.K(!1);this.q=!1;var t=n.toString();if(this.n){_y.l.a(this.n,null,t,null,this.G(this.z,n.message));this.n=null}_a.O.b("MailComposeSave");_j.e.b(_a.a.a,"Save failed due to an error before action was submitted: {0}",t)},be:function(n){var t=n.ba;var r=!1;if(this.B.a(t)){this.r()===t&&(this.m={});this.v(n);var e=_mcp.bc.a(n);var u=_mcp.bc.b(n);if(u&&this.bj&&this.bj.a){_j.e.a(_a.a.a,"Resume discard for context {0}",t);this.bj.a.bq().c(t,u)}r=!0}else if(t===this.r()){if(this.t){this.t=!1;_j.e.a(_a.a.a,"User issued send while save was in progress, now the save had come back, resume the send and cancel any pending saves. ContextId={0}",t);this.m={};this.v(n);var i=null;_db.e.isInstanceOfType(n)?i=n.bg:_mco.c.isInstanceOfType(n)&&(i=n.bl);i&&this.bj.a.ba.E(i);var f=this.bi.bg();f.h();r=!0}else if(this.x){_j.e.a(_a.a.a,"Saving new content per user's request. ContextId={0}",t);this.i();r=!0}}else _j.e.a(_a.a.a,"Skipping default save processing due to ContextId={0}; viewModelId={1}",t,this.r());return r},bw:function(n){var u=n.ba;_j.e.a(_a.a.a,"Save action returned success, ContextId={0}",u);if(!this.be(n)&&u===this.r()){var f=this.bj;var o=f.a;this.bt(n);this.bd();var i=!1;var t=null;if("Attach"in this.m){if("AutoSave"in this.m){t=this.m.AutoSave;t&&t.a(n)}t=this.m.Attach}else if("Popout"in this.m){t=this.m.Popout;var r=o.bm();if(r&&r.k()&&"ReadingPaneExit"in this.m){t&&t.a(n);t=this.m.ReadingPaneExit}}else if("ReadingPaneExit"in this.m)t=this.m.ReadingPaneExit;else if("AutoSave"in this.m){t=this.m.AutoSave;i=!0}else if("Save"in this.m){t=this.m.Save;i=!0}else if("RehydrateUpgrade"in this.m){t=this.m.RehydrateUpgrade;i=!0}else"Diagnostics"in this.m?i=!0:"ContentConversion"in this.m&&(t=this.m.ContentConversion);t&&t.a&&t.a(n);if(i){var e=f.b(5);e.L()}this.m={}}if(this.n){_y.l.a(this.n,null,"",this.bc(n),this.G(this.z,""));this.n=null}},bd:function(){var i="";var t=this.m;for(var n in t){var r={key:n,value:t[n]};i+=r.key+":"}_j.e.a(_a.a.a,"ProcessorKeys:{0}",i)},bv:function(n){var f=n.ba;_j.e.a(_a.a.a,"Save action returned a failure, ContextId={0}",f);if(!this.be(n)&&f===this.r()){this.bd();var t=!1;var c=this.m;for(var s in c){var i={key:s,value:c[s]};var h=i.value;if(h.b){h.b(n);if((i.key==="ReadingPaneExit"||i.key==="Popout")&&!t){this.ba(n);t=!0}}else if(!t){this.ba(n);t=!0}}t||this.v(n);this.m={}}var r;var u;var e,o;this.dd(n.G,e={val:r},o={val:u},"SaveFailure_UnknownError"),r=e.val,u=o.val;if(this.n){_y.l.a(this.n,null,r,this.bc(n),this.G(this.z,u));this.n=null}},bt:function(n){var i=n.ba;if(i===this.r()){this.bI(n);this.bj.a.ba.ce(!1);this.bj.a.fc()}this.ce("MailSaveSucceeded");if(i===this.r()){var r=_a.d.a();var t=r.b(0);this.bH(this.bj.a.ba.bL()?String.format(_nbs.a.sS,t):String.format(_nbs.a.fT,t));this.bi.be.a(_mco.be.a,new _mco.be.a("MailComposeSaveComponent.DefaultSaveSucceeded"))}_a.bu.a&&this.bi&&this.bi.df().a(this.q?4:2);this.v(n)},ba:function(n){_j.e.a(_a.a.a,"SaveActionFailed: Error: {0}",n.G.message);n.ba===this.r()&&this.cG(n);this.bj&&this.bj.a&&this.bj.a.bP&&this.bj.a.R(!1);this.v(n)},v:function(n){if(n.ba===this.r()){this.K(!1);this.q=!1}_a.O.b("MailComposeSave")},bc:function(n){var t=null;_db.e.isInstanceOfType(n)&&n.Q?t=n.Q.correlationId:_mco.c.isInstanceOfType(n)&&n.Q&&(t=n.Q.correlationId);return t},G:function(n,t){var i=new _a.l;i.a("Ctx",n||"");i.a("Err",t||"");if(this.bk){i.a("O",this.bk.fK||"");i.a("EID",this.bk.fq||"")}return i.toString()},bI:function(n){var t=this.bj.a.ba;t.fB(this.A);if(this.q){t.gm(!0);this.q=!1;_j.e.a(_a.a.a,"Explicit save recorded. ContextId={0}",t.d())}if(_mco.a.isInstanceOfType(n)){var u=n;var r=u.bg;u.k.cc(r);t.E(r);t.dS(u.k);_j.e.a(_a.a.a,"Updated context from create action.");this.H.P(r)}else if(_mco.c.isInstanceOfType(n)){var i=n;var o=i.bl;i.l.cc(o);t.E(o);t.dS(i.l);_j.e.a(_a.a.a,"Updated context from update action.")}else if(_mco.g.isInstanceOfType(n)){var a=n;var l=a.bg;t.E(l);_j.e.a(_a.a.a,"Updated context from create response action. ")}else if(_mcp.w.isInstanceOfType(n)){var v=n;var p=v.e.f();t.E(p);_j.e.a(_a.a.a,"Updated context from create response from modern group action. ")}else if(_mcp.N.isInstanceOfType(n)){var y=n;var h=y.bg;t.E(h);_j.e.a(_a.a.a,"Updated context from create approval response action. ")}if(_db.e.isInstanceOfType(n)&&t.K()){var c=n;var e=c.bK;var f=t.K().eH();if(e&&f){var s=0;var w=this;f.o(function(n){var t=n;t.g(e[s]);s++});_j.e.a(_a.a.a,"Attachment IDs have been updated.")}}},I:function(){this.bi.bm().a(this.bi,!1);_j.e.a(_a.a.a,"Navigated away from compose")}};_mcp.r=function(n,t){this.l=Function.createDelegate(this,this.q);this.k=Function.createDelegate(this,this.v);this.j=Function.createDelegate(this,this.u);_mcp.r.initializeBase(this,[18,n]);this.d=t.c()};_mcp.r.a=function(n,t){return new _fm.c(n,null,t,!0)};_mcp.r.prototype={d:!1,h:0,a:function(){return this.eM(_mcp.r.c)},p:function(n){this.eK(_mcp.r.c,n);return n},g:function(){if(!this.a()){var n=this.d?[_mcp.r.a(_u.R.Oj,null)]:this.n(_mcp.r.a);if(n){this.p(new _fm.e(n));this.a().bP(new _j.g(this.j,this.bl()));this.a().t=this.k}}_mcp.I.prototype.g.call(this)},b:function(n){if(n&&n.Mailbox){var r=n.Mailbox.EmailAddress;if(r!==_g.a.a().c().bH.UserEmailAddress&&!_mco.a.f(n)){var t=_g.a.a().a().W();if(t){if(t.j(r))return;t.b()===1&&t.a(0)===""&&t.o(0)}var i=new _a.j;i.c(r);i.y(t);i.b()>_mcp.r.b&&i.o(i.b()-1);_g.a.a().a().bC(i);_h.f.a(_g.a.a().a().u,_a.g.a);this.s(r)}}},c:function(n,t){t.val=null;var i=_g.a.a().c().bH.UserEmailAddress;if(this.i(i)&&n===i){var r=this.o(i);t.val=r.length>0?r[0]:t.val}return!_j.h.a(t.val)},bz:function(){if(this.a()){this.a().dispose();this.p(null)}_mcp.I.prototype.bz.call(this)},v:function(){if(this.d&&!this.h){this.h=1;_j.m.a().a(this.bl(),"SendAsContextMenu",this.l,2e3);var n=new _mcp.by;var i=this,r=this,t=this;this.bi.bp.a(n,function(t){_g.a.a().c().h(new _a.j(n.e));_g.a.a().c().g(new _a.j(n.f));_g.a.a().c().j(new _a.j(n.h))},function(n){_j.e.b(_a.a.a,"Fail to load alias list for consumer, use the alias list in userConfiguration instead.")},function(n){t.q()})}},s:function(n){if(!this.d&&this.a()){for(var r=_mcp.r.a(n,new _j.g(this.f(n),this.bl())),t=this.a().p,i=t.x.length-1;i>0;i--)if(_fm.i.isInstanceOfType(t.x[i])){t.t(i+1,r);var u=t.x.length-i-1;u>_mcp.r.b&&t.n(t.x.length-1);return}t.a(new _fm.i);t.a(r)}},u:function(){if(this.a()&&this.a().s){var f=this.a().s;var r=_g.a.a().a().W();var e=r.k(f.k);if(e){for(var n=this.a().p,t=n.x.length-1;t>0;t--)if(n.x[t].k===f.k){n.n(t);var u=n.x.length;_fm.i.isInstanceOfType(n.x[u-1])&&n.n(u-1);break}var i=new _a.j;r.b()>0?i.y(r):i.c("");_g.a.a().a().bC(i);_h.f.a(_g.a.a().a().u,_a.g.a)}}},n:function(n){var t=[];var i=_g.a.a().c().bH.UserEmailAddress;this.i(i)||Array.add(t,n(i,new _j.g(this.f(i),this.bl())));if(this.d){var r=this.r(t,n,i);this.m(t,n,r)}else{this.m(t,n,null);this.t(t,n)}return t},m:function(n,t,i){for(var r,f=_g.a.a().c().e(),e=f?f.b():0,u=0;u<e;u++){r=f.a(u).EmailAddress;i&&Array.contains(i,r)||Array.add(n,t(r,new _j.g(this.f(r),this.bl())))}},r:function(n,t,i){for(var f=this.o(i),e=f,o=e.length,r=0;r<o;++r){var u=e[r];Array.add(n,t(u,new _j.g(this.f(u),this.bl())))}return f},o:function(n){var o=new _a.j;if(this.d){for(var t,f,e=_g.a.a().c().b(),s=e?e.b():0,i=_g.a.a().c().a(),h=i?i.b():0,r=0;r<s;r++){t=e.a(r);n===t||this.i(t)||o.c(t)}for(var u=0;u<h;u++){f=i.a(u);n!==f&&o.c(f)}}return o.e()},t:function(n,t){var i=_g.a.a().a().W();var r=i?i.b():0;if(r===1&&i.a(0)===""){i.o(0);r=0}if(r>0){var f;Array.add(n,new _fm.i);for(var u=0;u<r;u++){f=i.a(u);Array.add(n,t(f,new _j.g(this.f(f),this.bl())))}}},f:function(n){var t=this;return function(){_j.e.a(_a.a.a,"User chose from={0}",n);t.bj.a.bd().N(n,!0)}},q:function(){if(this.h===1&&!this.bp()){this.h=2;var n=this.n(_mcp.r.a);if(n&&this.a()&&this.a().p){this.a().p.g();this.a().p.j(n)}}},i:function(n){var t=!1;if(this.d){n=n.toLowerCase();t=n.startsWith("outlook_"+_g.a.a().bH.HexCID)||n.endsWith("@shadow.outlook.com")}return t}};_mcp.g=function(n,t,i,r){this.w=Function.createDelegate(this,this.ba);this.v=Function.createDelegate(this,this.H);this.u=Function.createDelegate(this,this.G);this.q=Function.createDelegate(this,this.bb);this.m=Function.createDelegate(this,this.U);this.n=Function.createDelegate(this,this.V);this.o=Function.createDelegate(this,this.W);this.p=Function.createDelegate(this,this.X);this.x=Function.createDelegate(this,this.bd);_mcp.g.initializeBase(this,[35,n]);this.s=t;this.A=i;this.r=r;this.l=_mcp.g.f("ms-font-color-neutralSecondary ms-bg-color-themeLighterAlt",["color","background-color"]);this.t=_mcp.g.f("ms-font-color-neutralDark ms-bg-color-themeLight",["color","background-color"]);this.i=new Array(1);this.i[0]=new _fm.c(_nbs.a.CB,null,this.a());this.i[0].a(!0)};_mcp.g.f=function(n,t){var i=_mcp.g.a("SPAN");i.style.display="none";document.body.appendChild(i);var e=i;e.setAttribute("class",n);for(var o="",f=t,s=f.length,r=0;r<s;++r){var u=f[r];o+=String.format("{0}: {1};",u,_j.k.i(e,u))}document.body.removeChild(i);return o};_mcp.g.a=function(n){return window.document.createElement(n)};_mcp.g.c=function(n,t){if(t){n.setAttribute("itemtype",t);n.setAttribute("itemscope","")}};_mcp.g.b=function(n,t,i){t&&n.setAttribute("itemprop",t);i&&n.setAttribute("content",i)};_mcp.g.prototype={s:null,A:null,r:null,f:null,d:null,k:null,j:null,l:null,t:null,i:null,a:function(){if(!this.k){var n=this;this.k=new _j.w(this.x,_a.a.a,this.bj.a.ba,"BodyType",function(){return n.bj.a.ba.h()==="HTML"})}return this.k},g:function(){if(this.e()){_j.e.b(_a.a.a,"MailComposeSendAvailableTimeComponent is already initialized, skipping redundant Initialize call.");return}this.O();this.T();this.j=new _mcp.bu(this.bi.bI,this.r);_mcp.I.prototype.g.call(this)},c:function(n){this.d=n;this.d.b(this.p);this.d.a(this.o);this.d.c(this.n);this.d.g(this.m)},R:function(){return this.i},Q:function(){return null},P:function(){return null},b:function(n){this.i[0].a(n)},bz:function(){var t;_a.h.a(t={val:this.j}),this.j=t.val;var n;_a.h.a(n={val:this.k}),this.k=n.val;this.be();_mcp.I.prototype.bz.call(this)},be:function(){if(this.d){this.d.e(this.p);this.d.d(this.o);this.d.f(this.n);this.d.i(this.m);this.d=null}},X:function(n){var t=n.c();this.I(t)},W:function(n){var t=n.c();this.z(t)},V:function(n){var t=n.d();if(_zz.h.isInstanceOfType(t)){this.f=t;this.z(n.c())}else{_j.e.c(_a.a.a,"EditorOnContentLoaded: event source was not an instance of HtmlEditorBase");return}},U:function(n){n.c()===1&&this.E(n.e())},E:function(n){if(n)for(var u=n.querySelectorAll("div[id^='SAContainer']"),t=0;t<u.length;t++){var r=u[t];r.setAttribute("contenteditable",!1);var i=r.querySelector("a[id^='ATRemove']");i&&_j.k.b(i,"click",this.q)}},z:function(n){for(var r=n.querySelectorAll("div[id^='SAContainer']"),t=0;t<r.length;t++){var i=r[t];i.setAttribute("contenteditable",!1);this.y(i)}},I:function(n){for(var r=n.querySelectorAll("div[id^='SAContainer']"),i=0;i<r.length;i++){var u=r[i];u.removeAttribute("contenteditable");var t=u.querySelector("a[id^='ATRemove']");if(t){_j.k.c(t,"click");_j.k.c(t,"mouseenter");_j.k.c(t,"mouseleave");_j.k.f(t)}}},O:function(){if(!_mcp.g.d){var t=this.s.a().b().Enabled?"http://outlook.live.com":"http://outlook.office.com";var n=_mcp.g.a("a");n.style.textDecoration="none";n.style.color="inherit";n.href=t;n.target="_blank";n.innerText=_nbs.a.GF;_mcp.g.d=n}},T:function(){if(_j.h.a(_mcp.g.e)){var n=_a.d.a().t;var i=Math.floor(Math.abs(n)/60);var t=Math.abs(n)-i*60;_mcp.g.e=String.format("UTC{0}{1}{2}",n<0?"-":"+",_a.bI.c(5,i),t>0?":"+_a.bI.c(5,t):"")}},S:function(n){var u=this.h(1,null);var e=_mcp.g.a("tr");var r=_mcp.g.a("td");var o=this.h(5,null);u.appendChild(o);for(var i=0;i<n.length;){var f=n[i].a().d();this.K(r,f);i=this.L(r,n,f,i)}var t=this.h(0,null);this.C(t);e.appendChild(r);u.appendChild(e);t.appendChild(u);t.appendChild(this.N());t.setAttribute("contenteditable",!1);this.y(t);return t},K:function(n,t){var r=String.format("{0}, {1} {2}",_a.d.r(t.r()),_a.d.P(t.f()),t.E().j());var i=this.h(2,r);n.appendChild(i)},L:function(n,t,i,r){for(var u=r;u<t.length&&!t[u].a().k(i);){var h=t[u].a();var f;var o,e;u=(e=this.Z(t,o={val:f},u,n),f=o.val,e);var s=String.format("{0} - {1} ({2})",h.b(0),f.b(0),_mcp.g.e);this.M(s,n)}return u},Z:function(n,t,i,r){var u=i;var e;do{var f=n[u];e=f.a();t.val=f.b();this.D(r,e,t.val);u++}while(u<n.length&&_a.d.h(t.val,n[u].a())&&t.val.L(n[u].a())>=0);return u},C:function(n){var t=_mcp.g.a("div");_mcp.g.b(t,"creator",null);_mcp.g.c(t,String.format("http://schema.org/{0}","Creator"));t.style.display="none";var i=_mcp.g.a("meta");_mcp.g.b(i,"name","OWA");i.style.display="none";t.appendChild(i);n.appendChild(t)},D:function(n,t,i){var r=_mcp.g.a("div");_mcp.g.b(r,"actionOption",null);_mcp.g.c(r,String.format("http://schema.org/{0}","Event"));r.style.display="none";var f=_mcp.g.a("meta");f.style.display="none";_mcp.g.b(f,"startDate",_a.d.d(t.o()));r.appendChild(f);var u=_mcp.g.a("meta");u.style.display="none";_mcp.g.b(u,"endDate",_a.d.d(i.o()));r.appendChild(u);n.appendChild(r)},M:function(n,t){var i=this.h(3,n);t.appendChild(i)},N:function(){var n=this.h(4,null);n.appendChild(_mcp.g.d);return n},h:function(n,t){var r=null;var i=null;switch(n){case 0:r="SAContainer";i="div";break;case 1:i="table";break;case 2:i="div";break;case 3:i="div";break;case 4:i="div";break;case 5:r="ATRemoveContainer";i="div";break;default:throw Error.notImplemented("Type not implemented for "+n);}var u=_mcp.g.a(i);r&&(u.id=r);this.bc(u,n,t);return u},bc:function(n,t,i){switch(t){case 0:n.style.margin="5px 0px";_mcp.g.c(n,String.format("http://schema.org/{0}","EmailMessage"));break;case 1:n.style.borderTopWidth="1px";n.style.borderTopStyle="dotted";n.style.borderTopColor="#c8c8c8";n.style.borderBottom=n.style.borderTop;n.style.paddingBottom="20px";n.style.width="100%";_mcp.g.c(n,String.format("http://schema.org/{0}","ChooseAction"));_mcp.g.b(n,"potentialAction/availableTimes",null);break;case 2:_j.k.d(n,"ms-font-weight-regular");n.style.marginTop="15px";n.style.padding="0px 10px";n.style.textAlign="center";n.style.whiteSpace="nowrap";n.innerText=i;break;case 3:_j.k.d(n,"ms-font-color-themePrimary");_j.k.d(n,"ms-bg-color-themeLighterAlt");_j.k.d(n,"ms-font-weight-semibold");n.style.backgroundColor="#EFF6FC";n.style.fontWeight="600";n.style.color="#0078D7";_j.k.a(n,"max-width","300px");n.style.padding="8px 0px";n.style.marginTop="10px";n.style.marginRight="auto";n.style.marginLeft=n.style.marginRight;_j.k.a(n,"text-align","center");n.innerText=i;break;case 4:_j.k.d(n,"ms-font-weight-regular");n.style.color="#0078D7";n.style.marginTop="10px";n.style.marginLeft="auto";n.style.marginRight="auto";n.style.textAlign="center";break;case 5:n.style.position="static";n.style.height="0px";n.style.display="table-caption";break;default:throw Error.notImplemented("Type not implemented for "+t);}},y:function(n){var t=this.B(n);if(t){t.id="ATRemove";t.style.marginRight="10px";t.style.marginTop="10px";t.className=_mcp.e.r().a();_j.k.b(t,"click",this.q)}},bb:function(n){var i=n.b();var t=this.Y(i);_a.b.c(this.bl(),"AvailableTimeRemovedFromEditor");_j.k.c(i,"click");if(t){t.innerHTML="";t.id="";this.f.bc(!0);this.f.eE(n);this.f.bg(!1)}},Y:function(n){for(var t=null,i=n,r=0;r<10;r++){if(!i)break;if(i.id==="SAContainer"){t=i;break}i=i.parentNode}t&&t.parentNode&&t.parentNode.tagName==="P"&&t.parentNode.getAttribute("contentEditable")&&t.parentNode.getAttribute("contentEditable").toUpperCase()==="FALSE"&&(t=t.parentNode);return t},B:function(n){var t=null;var r=n.querySelectorAll("div[id^='ATRemoveContainer']");if(r.length>0){t=_mcp.g.a("a");t.style.fontFamily="'wf_segoe-ui_normal', 'Segoe UI', 'Segoe WP', Tahoma, Arial, sans-serif";t.style.fontWeight="normal";t.style.position="relative";t.style.cursor="pointer";t.style.padding="8px";t.style.cssText+="float: right";t.style.cssText+=this.l;t.style.zIndex=100;_j.k.b(t,"mouseenter",this.u);_j.k.b(t,"mouseleave",this.v);_j.k.a(t,"-moz-user-select","none");_j.k.a(t,"-khtml-user-select","none");_j.k.a(t,"-webkit-user-select","none");_j.k.a(t,"-ms-user-select","none");var i=r[0];i.style.cssText+="float: right";i.appendChild(t);i.parentNode.style.position="relative"}return t},G:function(n){if(n.b()){var t=n.b();t.style.cssText+=this.t}},H:function(n){if(n.b()){var t=n.b();t.style.cssText+=this.l}},bd:function(){if(this.j){_a.b.c(this.bl(),"AvailableTimeButtonClicked");this.j.s(this.w)}},ba:function(n){var i=new _cmc.h(this.bl(),"AvailableTimeInsertedToEditor",!1);var t=null;if(n&&n.length>0){i.a("N",n.length,!0,!0);var f=(n[0].b().e(n[0].a())/6e4).toString();i.a("D",f,!0,!0);if(this.f){var e=this.S(n);var r=_mcp.g.a("div");r.innerText=_nbs.a.Za;r.appendChild(e);var u=new _cmc.ba(r,this.f.z,null);this.f.bg(!1);this.f.gF(u,12,!0)||(t="ErrorOnInsertingInEditor")}else t="NullEditor"}else t="NoTimesSelected";t?i.d(t,null):i.b()}};_mcp.u=function(n,t,i,r,u){this.bD=Function.createDelegate(this,this.cH);this.bx=Function.createDelegate(this,this.cC);this.bG=Function.createDelegate(this,this.M);this.bw=Function.createDelegate(this,this.cB);this.bI=Function.createDelegate(this,this.cL);this.bR=Function.createDelegate(this,this.cS);this.be=Function.createDelegate(this,this.cK);this.H=Function.createDelegate(this,this.cJ);this.S=Function.createDelegate(this,this.cI);this.bt=Function.createDelegate(this,this.K);this.bu=Function.createDelegate(this,this.bm);this.bv=Function.createDelegate(this,this.bn);this.bU=Function.createDelegate(this,this.cU);this.bV=Function.createDelegate(this,this.cV);this.bH=Function.createDelegate(this,this.ck);this.G=Function.createDelegate(this,this.ct);this.bC=Function.createDelegate(this,this.bo);this.bP=Function.createDelegate(this,this.cQ);this.bN=Function.createDelegate(this,this.cO);this.bK=Function.createDelegate(this,this.cN);this.bJ=Function.createDelegate(this,this.cM);this.bQ=Function.createDelegate(this,this.cR);_mcp.u.initializeBase(this,[7,n]);this.bf=this.t=new _j.g(this.bQ,this.bl());this.N=new _j.g(this.bJ,this.bl());this.O=new _j.g(this.bK,this.bl());this.P=new _j.g(this.bN,this.bl());this.C=new _j.g(this.bP,this.bl());this.bg=n.a.bY;this.D=t;this.V=i;this.v=u};_mcp.u.prototype={bg:null,D:null,V:null,v:null,ba:null,X:null,E:!1,L:null,w:null,x:null,B:null,bc:!1,bq:!1,A:0,u:null,t:null,C:null,O:null,N:null,P:null,z:0,i:function(n){this.bB("SendInvalidated",n)},r:function(n){this.bF("SendInvalidated",n)},j:function(){return this.u?this.u.c():null},a:function(){return this.t},c:function(n){this.t=n;return n},bf:null,d:function(){return this.bf},q:function(){return this.O},f:function(){return this.N},I:!1,o:function(){return this.I},b:function(){return this.E},y:function(n){if(n!==this.E){this.E=n;this.by("IsSending");var t=this.bj.a;t.eB(this.E);t.eD(_u.P.P);t.eC(this.E)}return n},T:!1,p:function(){return this.T},k:function(){return this.W()&&this.bq},n:function(){return this.A},cl:function(n){this.A=n>=0?n:0;return n},W:function(){var n=this.bk.a()===2&&this.bk.eY;return(_g.a.a().bH.AsyncSendEnabled&&!this.bk.eY||n)&&this.bi.bv.a()==="Mouse"&&!this.bi.bu()&&!this.bk.H()&&!!this.bi.bQ&&!!this.bi.cm&&this.bk.m()!==3&&this.bk.a()!==15},bh:function(){return!1},cc:function(){return!!this.V&&this.V.a().b().Enabled},l:function(){return this.x},Z:function(){if(this.bi.cL()&&!this.u){_j.e.a(_a.a.a,"Setting send component override");this.u=this.bi.cK().e();var n=this.bi.bd();var s=this.bi.bc();var f=n,e=n,o=n,i=n,t=n,u=s,r=s;this.u.d(this.bi.k(),this.bC,this.G,this.bH,this.bV,this.bU,this.bv,this.bu,this.bi.bp,this.bj.a.bV,f.t||(f.t=Function.createDelegate(f,f.r)),this.dD,this.bt,e.k||(e.k=Function.createDelegate(e,e.s)),o.j||(o.j=Function.createDelegate(o,o.E)),i.i||(i.i=Function.createDelegate(i,i.D)),t.l||(t.l=Function.createDelegate(t,t.f)),u.c||(u.c=Function.createDelegate(u,u.o)),r.d||(r.d=Function.createDelegate(r,r.r)),_cmc.g.b,this.cF);this.by("InvalidRecipientsDialogViewModel")}},Y:function(){if(this.u){this.u.a();this.u=null;this.by("InvalidRecipientsDialogViewModel")}},g:function(){this.Z();var n=this.bi.bd();if(n){n.K(this.S);n.I(this.G);n.T(this.S);n.S(this.G)}_mcp.I.prototype.g.call(this)},h:function(){_j.e.a(_a.a.a,"ResumeSend() called by external mail-compose component.");this.bo()},bo:function(){var i=this.bi;var n=this.bk;var t=i.bl();i.df().d();i.es().a();if(t.c()){t.l(!0);_j.e.a(_a.a.a,"Send deferred due to in progress save.")}if(n.l()||n.k()||n.L()||n.a()===15){if(!t.h()){this.bi.bd().f();_j.e.a(_a.a.a,"Send without pending saves, OriParentFolderId={0}",n.b()&&n.b().bH.ParentFolderId&&_g.b.a?_g.b.a.idToName(n.b().bH.ParentFolderId):"null");this.bb()}}else{var r=n.d();_j.e.a(_a.a.a,"Send was attempted during upgrade for context {0}, keeping the IsSending state and waiting for upgrade to finish. Upgrade component will resume send.",r)}},bb:function(){var t=this.bi;var r=this.bk;if(r.a()===15)this.cW();else{var n=t.bX.h(t,1);_j.e.a(_a.a.a,"Submitting send action");var i=_g.k.a;_bc.o.isInstanceOfType(i)?_mco.c.isInstanceOfType(n)?n.bZ(this.H):_mco.a.isInstanceOfType(n)&&n.bw(this.H):this.cf();t.bp.a(n,this.bn(),this.bm(),this.be);_j.e.a(_a.a.a,"Send action submitted")}},cW:function(){var n=new _gg.jA;var i=_g.c.a(this.bk.b().bV().e(),_g.c.bs());n.Provider=i?i.bH.Value:"";n.ConversationId=this.bk.bi().Id;n.InReplyToItemId=this.bk.A().Id;n.Body=this.bk.cY().bH.Value;var t=this.bk.b();n.BotAddress=new _g.g;n.BotAddress.Name=t&&t.bH.From&&t.bH.From.Mailbox?t.bH.From.Mailbox.Name:"";var r=new _mco.bj(n);this.bi.bp.a(r,this.bn(),this.bm(),this.be);_j.e.a(_a.a.a,"ReplyToBotMessage action submitted")},bz:function(){this.bi.bd().K(this.S);this.bi.bd().I(this.G);var r;_a.h.a(r={val:this.t}),this.t=r.val;var u;_a.h.a(u={val:this.C}),this.C=u.val;var i;_a.h.a(i={val:this.N}),this.N=i.val;var n;_a.h.a(n={val:this.O}),this.O=n.val;var t;_a.h.a(t={val:this.P}),this.P=t.val;this.y(!1);this.Y();this.ba=null;this.X=null;_mcp.I.prototype.bz.call(this)},ct:function(){var i=this.bj.a.bb;var t=this.bi.bd();var n=null;this.y(!1);if(t.p()){this.U();n="InvalidRecipients";this.v.a(_a.ba,new _a.ba(_u.R.WA,!1,0,2))}if(t.q()){this.U();n="InvalidSendAddress"}this.bi.bi();this.m();n=n||"CancelSend_UnknownError";this.s(n,null,null)},m:function(){var n=this;_j.m.a().a(_a.a.a,"ExitResolvingRecipientsMode",function(){n.I=!1},2e3)},cw:function(n){var t;var i=_a.c.l(n.G);if(i==="ErrorSendAsDenied")t=80;else{var u,r;i==="ErrorRightsManagementPermanentException"&&(r=this.cX(n.G,u={val:t}),t=u.val,r)||(t=i==="ErrorSubmissionQuotaExceeded"?47:i==="ErrorAccountSuspend"?90:i==="ErrorExceededMaxRecipientLimit"?91:i==="ErrorExceededMessageLimit"?92:i==="ErrorExceededHourlyMessageLimit"?101:i==="ErrorMessageTimeout"?102:i==="ErrorMessageThrottled"?103:i==="ErrorMessageTransientError"?104:i==="ErrorMessageBlocked"?93:i==="ErrorMessageSubmissionBlocked"?94:i==="ErrorAccountSuspendShowTierUpgrade"?98:i==="ErrorExceededMaxRecipientLimitShowTierUpgrade"?99:i==="ErrorExceededMessageLimitShowTierUpgrade"?100:_db.j.c(n.G,45,55,62,700,88,89,46,58))}return t},cn:function(){this.w=_y.l.b(_a.a.a,"MailComposeSend",!0,!0)},bn:function(){return this.ba||this.bR},bm:function(){return this.X||this.bI},cV:function(n){this.ba=n},cU:function(n){this.X=n},cX:function(n,t){var u=n.MessageXml;if(u)for(var f=Sys.Net.XMLDOM(u),r=0;r<f.firstChild.childNodes.length;r++){var i=f.firstChild.childNodes[r];if(i.nodeType===1&&_a.bb.b(i)==="Value"&&_a.bb.c(i,"Name")==="HResult"&&-2147168383===Number.parseInvariant(_a.bb.a(i))){t.val=48;return!0}}t.val=-1;return!1},cM:function(){if(this.t.b){this.z=2;this.t.a()}},cN:function(){if(this.t.b){this.z=1;this.t.a()}},cO:function(){if(this.t.b){this.z=3;this.t.a()}},cR:function(){if(this.u&&!this.u.e()){_j.e.a(_a.a.a,"saveComponentOverride.IsReadyForSmimeOperation() == false. Exiting SendStart().");return}_a.O.a(_a.a.a,"MailComposeSend",5);this.bc=!0;this.bh()||this.cn();if(this.z){this.bi.bk().a(_mcp.bk.toString(this.z));this.z=0}(_mcp.E.isInstanceOfType(this.bi)||IGroupInlineComposeViewModel.isInstanceOfType(this.bi))&&this.bk.hK(!0);if(this.W()){this.x=_y.l.b(_a.a.a,"MailComposeSendAsync",!0,!0);if(IGroupInlineComposeViewModel.isInstanceOfType(this.bi)){var n=this.bi;_g.i.isInstanceOfType(this.bk.b())&&n.b()&&(this.B=_y.l.b(_a.a.a,"MailComposeSendAsyncQuickQuickness",!0,!1))}}_j.e.a(_a.a.a,"SendStart");this.ci();this.cs();this.bk.v()?this.u.f():this.bk.a()===15?this.br():this.ck();this.bi.bk().a("Send")},cs:function(){var r=this.bk.P();if(r){var f=_g.c.a(r.f(),_g.c.i());if(f){var s=f.bH.Value;var n;try{n=JSON.parse(s)}catch(c){n=null}if(n){for(var e=0;e<n.length;e++){var i;try{i=n[e]}catch(h){return}var t;t=i.txt?i.txt:"";if(t!==""){var o=i.typ===3;if(!(o&&this.bk.h()==="Text")){var u=new _cmc.i(4,t,o,7);u.u="div[class^= 'owa-append-tag']";u.q=!1;this.bk.br(u)}}}r.p(f,!0)}}}},ck:function(){_j.e.a(_a.a.a,"User chose to send, start force resolve recipients");this.I=!0;this.bi.bd().bf(!0)},cI:function(){if(this.E){_j.e.a(_a.a.a,"Skip send since another send is in progress");return}this.y(!0);this.I=!1;_j.m.a().j(_a.a.a,"MailComposeSend");_j.e.a(_a.a.a,"Started new task runner context before starting send.");var r=!0;try{var n;var i,t;(t=this.cE(i={val:n}),n=i.val,t)?n?_j.e.a(_a.a.a,"waiting for a pending validation decision, once decided, send will resume"):this.M():this.y(!1);r=!1}finally{if(r){this.y(!1);_j.e.b(_a.a.a,"Send failed due to an unhandled exception thrown before the action was submitted");this.K("SendFailure_UnhandledException",null,null)}}},cm:function(){return _dg.a.isInstanceOfType(this.bk.b())&&this.D.a().cw().Enabled&&!!this.bk.s()&&this.bk.s().b()>0&&this.bk.a()===2},br:function(){_mco.X.a(this.bi.bb,"compose");this.bk.gP(!1);if(this.bi.ba.Q()){this.bk.br(new _cmc.I);this.bk.hF(_cmc.I.a(this.bk.de()))}this.cm()&&this.cx();if(this.u)this.u.b();else{this.bo();if(this.W()&&!this.bk.dl()){var n=this.bY();if(!n){_j.e.a(_a.a.a,"Navigating away after submitting action for send via notification");this.bk.gP(!0);this.bq=!0;this.cg();this.cf();this.ch()}}}},ch:function(){this.cb()},cb:function(){var n=this;this.bi.bQ.a(function(){n.v.a(ISendEvent,new _mcp.bv(n.bi))})},cx:function(){var i=this.bk.b().k();var t=this.bk.s();var n=this;this.bi.bQ.a(function(){var r=new _mco.H(i,t);n.v.a(_mco.H,r)})},cy:function(){var i=this.bk.b().k();var t=this.bk.s();var n=this;this.bi.bQ.a(function(){var r=new _mco.G(i,t);n.v.a(_mco.G,r)})},bY:function(){var n=!1;if(this.bi.cm.c()){var i=this;this.bi.cm.a(function(t){t.a()>0&&(n=!0)})}if(!n&&this.bi.bQ.c()){var t=this;this.bi.bQ.a(function(t){t.a()>0&&(n=!0)})}return n},cf:function(){if(IGroupInlineComposeViewModel.isInstanceOfType(this.bi)&&_g.i.isInstanceOfType(this.bk.b())&&this.bk.cr()){var n=this.bi;if(n.b()&&n.g()){var u=this.bk.b();var r=_cmc.f.d(n.b().bH,n.g(),this.bk.n()||this.bk.bw(),this.bk.bw(),"sentitems");var f="MC:"+r.InternetMessageId;this.v.a(_a.cd,new _a.cd(f,this.bk));_h.c.B(r,u.bH.InternetMessageId,n.q()?u:null);var i="OMC:"+n.b().bH.ConversationId.Id;var t=n.B().c[i];if(t)t.d.c(n.g().bH.InternetMessageId);else{t=new _cmc.bB(n.g().bH.InternetMessageId);this.v.a(_a.cd,new _a.cd(i,t))}if(this.B){_y.l.a(this.B);this.B=null}}}},cE:function(n){n.val=!1;var l=null;var h=this.bj;var t=h.a;var i=t.bd();var u=t.bc();var f=t.bb;var y=h.b(23);var v=h.b(3);if(this.bg.a(t.ba.d())){_j.e.a(_a.a.a,"User had already discarded, skipping send.");this.s("UserAlreadyDiscarded",null,"User has already discarded, skipping send");return!1}else if(t.ba.H()&&v&&v.a()){_j.e.a(_a.a.a,"Not valid to send since IRM and SMIME are on the same message");f.a(49,null);this.bi.bi();this.s("NoRecipients",null,"IRM and SMIME both enabled, not valid to send");return!1}else if(i.q()){_j.e.a(_a.a.a,"Not valid to send since sender's address is invalid");f.a(66,null);this.bi.bi();this.s("InvalidSendAddress",null,"Sender's address is invalid, not valid to send");return!1}else if(!t.ba.R()&&i.Y()){_j.e.a(_a.a.a,"Not valid to send since no recipients were specified");f.a(70,null);this.bi.bi();this.s("NoRecipients",null,"No recipients were specified, not valid to send");return!1}else if(i.p()){_j.e.a(_a.a.a,"Not valid to send since invalid recipients are present, IsFromRecipientInvalid={0}, HasInvalidRecipients={1}",i.q(),i.p());i.bd();this.U();this.bi.bi();this.s("InvalidRecipients",null,"Invalid recipients are present, not valid to send");return!1}else if(u.b()){_j.e.a(_a.a.a,"Not valid to send since attachment is in progress");var e=t.bh;e.r||e.h(0,_u.R.EB,null,!1,null,null,null,e.z);this.s("AttachmentInProgress",null,"Attachment is in progress, not valid to send");return!1}else if(_g.a.a().bH.MaxRecipientsPerMessage<i.G()){f.a(800,null);this.bi.bi();this.s("MaxRecipients",null,"Max recipients exceeded, not valid to send");return!1}else if(_a.bu.a&&y.c()){_j.e.a(_a.a.a,"Not valid to send since policy violation detected");var w=t.bh;w.h(0,y.b(),null,!1,null,null,null,w.z);this.s("PolicyTipViolation",null,"PolicyTip violation detected, not valid to send");return!1}else if(_j.h.a(this.bi.ba.w())&&!this.bk.eY){_j.e.a(_a.a.a,"Not valid to send since the subject is empty.");n.val=!0;var s=t.bh;s.r||s.i(2,[_nbs.a.Ub],this.bw,!1,_nbs.a.Vg,_nbs.a.Jc,_nbs.a.Ls,s.z,null,null,null);return!1}else if(this.bi.bj().f()){_j.e.a(_a.a.a,"Not valid to send while addins are still running.");this.bi.bj().L(this.bi.bh,this.bG);n.val=!0;return!1}else{var p,a;if(this.D.a().kd().Enabled&&u&&u.a()&&(a=u.a().bY(p={val:l}),l=p.val,a)){n.val=!0;var o=t.bh;o.r||o.i(3,[l+" "+_nbs.a.uD],this.bx,!1,_nbs.a.Vg,_nbs.a.Jc,_nbs.a.FV,o.z,null,null,null);return!1}else if(u&&u.a()&&this.bi.dc)if(this.L)return this.bW();else{n.val=!0;var r=this;this.bi.dc.a(function(n){r.L=n.a(r.bi.bh,r.t);r.bW()?r.M():r.y(!1)})}else if(this.bk.H())if(this.bk.z()){_a.D.a(_u.R.HS,0);this.s("SmimeSendAs",null,"User attempted to send an S/MIME message using the SendAs (From) feature");return!1}else if(i.X()){_a.D.a(_u.n.OB,0);this.s("SmimeModernGroups",null,"User attempted to send an S/MIME message to modern groups.");return!1}else if(this.bk.s()){var c=new _j.q;var b=this;this.bk.s().o(function(n){_dg.e.isInstanceOfType(n)||_dg.j.isInstanceOfType(n)||_g.B.isInstanceOfType(n)||c.c(n.bH.Name)});if(c.d.length>0){_a.D.a(String.format(_u.n.JX,c.d.join(", ")),0);this.s("SmimeCloudAttachment",null,"User attempted to send an S/MIME message with cloud attachments.");return!1}}}return!0},M:function(){var i=this.D.a().e().Enabled;var r=this.D.a().dw().Enabled;var n=_g.a.a().e().bH.OnSendAddinsEnabled;_j.e.a(_a.a.a,"OnAfterValidations(): IsComposeRequestFromGroups={0} IsAddinCommandsEnabled={1} IsOnSendCommandsEnabled={2} IsOnSendOWAMailboxPolicyEnabled={3}",this.bk.eY,i,r,n);if(!this.bk.eY&&i&&r&&n){if(this.bi.bj()&&this.bi.bj().a()){var t=this.bi.bj().a().D();_j.e.a(_a.a.a,"OnAfterValidations(): ExtensibilityComponent != null, isExtensibilityViewModelLoaded={0}",t);if(t){this.bi.bb.b(106);this.bi.bb.b(107);this.T=!0;this.bi.bj().a().r(this.bD);return}}var u=this.D.a().dy().Enabled;if(u){this.y(!1);this.bi.bb.a(106);return}}this.br()},bW:function(){var n=this.bi.bc();try{if(this.L.a(this.bi.ba,n.a().a())){this.s("ForgottenAttachment",null,"Forgotten attachment detected, not valid to send");return!1}}catch(t){_j.e.d(_a.a.a,t,"An exception has been caught for FAD check; keep sending",this.L,this.bi.ba,n.a().a())}return!0},cS:function(n){var u=this.bi;var t=this.bk;var i=n.ba;_j.e.a(_a.a.a,"Send action succeeded, ContextId={0}",i);this.cT();var r=!1;var o=_g.k.a;_bc.o.isInstanceOfType(o)&&(r=!0);t.bO()&&!r&&this.bi.ci()&&this.bi.ci().b(t.n());if(t.fh&&t.fh.length>0){var s=this.bj.a.bb;s.a(742,t.fh);_j.e.a(_a.a.a,"Showing infobar message for Bcc forking failed");this.y(!1);u.bp.d(n);this.K(_j.u.c(_bc.M,742),null,null)}else{if(i===t.d()||t.a()===15){t.fB(null);if(this.bk.cr()){_j.e.a(_a.a.a,"skip navigating away from compose for send via notification since the navigation was already done at send time, raise send succeeded event instead");var f=this;this.bi.bQ.a(function(){f.v.a(ISendSucceededEvent,new _mcp.ck(u))});this.bk.gG()}else{_j.e.a(_a.a.a,"Context match, navigating away from compose at the end of send success. ContextId={0}",i);this.cg()}}else _j.e.a(_a.a.a,"Context does not match, skipping navigating away from compose.");this.ce("MailSendSucceeded");var e=this.cd();this.cv(e)}this.v.a(_a.ba,new _a.ba(_nbs.a.Co,!1,0,2))},cg:function(){this.bi.bm().a(this.bi,!0)},cL:function(n){var u=this.bj.a;var t=u.ba;var o=n.ba;_j.e.a(_a.a.a,"Send action failed, ContextId={0}",o);var i;var r;var s,f;this.dd(n.G,s={val:i},f={val:r},"SendFailure_UnknownError"),i=s.val,r=f.val;this.cm()&&this.cy();if(o===t.d()){t.fh&&t.fh.length>0&&this.U();this.y(!1);_j.e.a(_a.a.a,"Context match. Showing infobar message for ResponseCode={0}",i);this.cG(n);var e=this.cw(n);if(this.bk.cr()){_j.e.a(_a.a.a,"Raise send failed event for send via notification");t.hJ(e);var h=this;this.bi.cm.a(function(){h.v.a(ISendFailedEvent,new _mcp.cj(u))});t.gG()}this.cD(n,e)}else if(t.a()===15){this.cr();_j.e.b(_a.a.a,"Could not send ReplyToBotMessage request, error={0}",r)}else _j.e.a(_a.a.a,"Context does not match. Skip showing infobar message for ResponseCode={0}",i);this.K(i,this.cz(n),r);u.bp.d(n)},cD:function(n,t){switch(t){case 92:case 100:case 91:case 99:_mco.a.isInstanceOfType(n)?_mcp.d.c=n.N.Body.WasclUpgradeToPremiumUrl:_mco.c.isInstanceOfType(n)&&(_mcp.d.c=n.N.Body.WasclUpgradeToPremiumUrl);_j.e.b(_a.a.a,"Got Wascl verdict {0}, set upgrade to premium path url to {1}.",t,_mcp.d.c);_j.e.b(_a.a.a,"Got Wascl verdict {0}, save a draft to prevent data loss.",t);this.bi.bl().a("AutoSave",null,null,!1);break;case 90:case 98:_mco.a.isInstanceOfType(n)?_mcp.d.b=n.N.Body.AccountRecoveryFlowUrl:_mco.c.isInstanceOfType(n)&&(_mcp.d.b=n.N.Body.AccountRecoveryFlowUrl);_j.e.b(_a.a.a,"Got Wascl verdict {0}, set account recovery flow url to {1}.",t,_mcp.d.b);break;case 93:case 94:_j.e.b(_a.a.a,"Got Wascl verdict {0}.",t);break}},U:function(){var n=this.bj.a.bb;var t=this.bj.a.bd();if(this.cc()){n.b(97);n.a(97,t.Z())}else n.a(65,null)},cr:function(){var n=this.bj.a.bb;if(n){n.a(45,null);this.bi.bi()}},cK:function(n){this.ca();this.cu()},cz:function(n){var t=null;_db.e.isInstanceOfType(n)&&n.Q?t=n.Q.correlationId:_mco.c.isInstanceOfType(n)&&n.Q&&(t=n.Q.correlationId);return t},cQ:function(){if(this.bj.a.dd()&&this.t.b){this.z=0;this.t.a()}},cT:function(){var t=this.bi.bd();var n=this.bi.bc();_j.e.a(_a.a.a,"Check to see if we have attachments to set permissions for");n&&n.a()&&n.a().r()&&n.a().bw(t.C())},cd:function(){var t;if(this.bk){var u=this.bk.h()==="HTML"?"html":"text";var i;i=this.bk.a()===1||this.bk.a()===2||this.bk.a()===3?this.bk.l()?"yes":"no":"na";var n=new _a.l;n.a("BT",u);n.a("U",i);this.bk.ft!==-1&&n.b("S",this.bk.ft);n.b("O",this.bk.a());n.b("M",this.bk.m());n.b("D",this.A);n.c("GR",this.bk.fA);_j.h.a(this.bk.fz)||n.a("P",this.bk.fz);this.bi&&this.bk.eY&&n.a("CS",this.bi.bE());if(this.bi&&this.bi.bS()&&(this.bi.bS().a()||this.bi.bS().c())){n.b("SL",this.bi.bS().b().length);n.c("SI",this.bi.bS().b().indexOf("<img")>0);n.c("SA",this.bi.bS().a());n.c("SM",this.bi.bS().c())}if(this.cc()){_j.h.d(this.bk.co())||n.c("FP",!0);this.bk.gf()&&n.a("DDC",this.bk.gf().replace("|","&"))}n.a("EID",this.bk.fq||"");n.a("MS",this.bk.C());t=n.toString();if(this.bi&&this.bi.bc()&&this.bi.bc().a()){var r=this.bi.bc().a().bX();_j.h.a(r)||(t+="|"+r)}}else t=null;return t},K:function(n,t,i){var r=this.cd();n==="ErrorSendAsDenied"&&(r+="|"+this.cA());if(this.w){_j.h.a(i)||(this.w.p=i);_y.l.a(this.w,null,n,t,r);this.w=null}if(this.x){_j.h.a(i)||(this.x.p=i);_y.l.a(this.x,null,n,t,r);this.x=null}this.bZ(n,t,r);this.ca()},cv:function(n){if(this.w){_y.l.a(this.w,null,null,null,n);this.w=null}this.bZ(null,null,n)},ca:function(){if(this.bc){_a.O.b("MailComposeSend");this.bc=!1}},s:function(n,t,i){if(this.w){this.w.u="MailComposeInvalidToSend";this.w.q(new _a.y(this.bi.bE()))}if(this.x){this.x.u="MailComposeInvalidToSend";this.x.q(new _a.y(this.bi.bE()))}this.K(n,t,i)},cu:function(){this.bi.bd()&&this.bi.bd().u("Send")},bZ:function(n,t,i){if(this.B){if(this.bk.cr()){_j.e.c(this.bl(),"Quick quickness should have been enabled during async send.");i+="|ErrorNoQuickQuicknessForAsyncSend"}else i+="|NoQuickQuicknessForSyncSend";_y.l.a(this.B,null,n,t,i);this.B=null}},cB:function(n,t){n?this.M():this.s("NoSubject",null,'No subject was specified, and user chose "Don\'t Send"')},cC:function(n,t){n?this.M():this.s("PermissionsIssue",null,'There was a permissions issue and user chose "Don\'t Send"')},cJ:function(n){_mco.a.isInstanceOfType(n)&&n.bl(this.H);_mco.c.isInstanceOfType(n)&&n.bY(this.H);if(this.bj&&this.bj.a){var t=this.bj.a.ba;t&&t.bO()&&this.bi.ci().b(t.n())}},cA:function(){var n=new _a.l;if(this.bk){n.c("IFS",this.bk.z());this.bk.z()&&this.bk.n()&&n.a("F",this.bk.n().Mailbox.EmailAddress)}return n.toString()},cH:function(n,t,i){_j.e.a(_a.a.i,"OnAfterExtensionsExecution(): sendAllowed={0}, isSendWaiting={1}, blockingExtensionName={2} ",n,t,i);this.T=!1;if(n)this.br();else{this.y(!1);this.s("CancelledByOnSendEvent",null,"Cancelled by on send event, don't send");t?this.bi.bb.a(106):this.bi.bb.a(107,i)}}};_mcp.bW=function(n,t){_mcp.bW.initializeBase(this,[21,n]);this.a=t};_mcp.bW.prototype={a:null,g:function(){if(!this.e()&&this.a.a().a().e()===2&&this.a.m().a().a()){var n=this.bj.b(5);n&&n.a()&&n.a().bE()}_mcp.I.prototype.g.call(this)}};_mcp.o=function(n,t,i,r,u){this.r=Function.createDelegate(this,this.D);this.t=Function.createDelegate(this,this.E);this.y=Function.createDelegate(this,this.B);_mcp.o.initializeBase(this,[11,n,i,r]);this.f=new _j.g(this.y,this.bl());this.w=t;this.p=_a.o.a();this.k=_a.bn.a();this.d=u};_mcp.o.a=function(n,t){return t?n.bH.SignatureHtml:n.bH.SignatureText};_mcp.o.prototype={w:null,d:null,f:null,l:null,h:null,x:!0,s:!0,p:null,k:null,j:null,o:null,n:null,i:!1,b:function(){return this.q()?this.h:this.l},a:function(){return this.bk.gE()&&!this.bk.dl()&&this.C()&&!this.z()?!0:!1},z:function(){return this.q()?this.x:this.s},u:!1,c:function(){return this.u},q:function(){return this.bk.h()==="HTML"&&this.w.b()},g:function(){var n=_g.a.a().a();n.apcl("SignatureText",this.t);if(!this.e()){this.v();!this.d||this.h||this.l||this.d.apcl("CurrentStatus",this.r);_mcp.q.prototype.g.call(this)}},v:function(){var u=_g.a.a().a();var i=this.A(u,!0);if(_j.h.a(i)){_j.e.a(_a.a.a,"No html signature.");this.h=null}else{var e=String.format('<{0} id="{1}">',"DIV","Signature");var f=String.format("</{0}>","DIV");var n=_mcp.o.f+e+i.replace(_mcp.o.e," ")+f;_j.e.a(_a.a.a,"Computed html signature. OriSig={0}, FormattedSig={1}",i,n);n=this.H(n);n=this.G(n);this.h=n}var t=this.A(u,!1);if(_j.h.a(t)){_j.e.a(_a.a.a,"No plain text signature.");this.l=null}else{var r="\n\n"+t;_j.e.a(_a.a.a,"Computed plain text signature. OriSig={0}, FormattedSig={1}",t,r);this.l=r}this.I()},bz:function(){var n;_a.h.a(n={val:this.f}),this.f=n.val;var t=_g.a.a().a();t.rpcl("SignatureText",this.t);this.d&&this.d.rpcl("CurrentStatus",this.r);_mcp.q.prototype.bz.call(this)},bC:function(){if(!this.bi.bn()){this.j=new _fm.c(_nbs.a.CC,null,this.f);this.j.v(_nbs.a.CC);this.j.a(!this.m());return[this.j]}return null},bN:function(){this.o=_mcp.q.a(this.f,_nbs.a.CC);this.o.b(this.m());return[this.o]},bx:function(){if(!_a.g.b){this.n=new _y.i(_nbs.a.CC,this.f);this.i=!1;if(this.m()){this.i=!0;return[this.n]}}return null},ca:function(){this.j&&this.j.a(!this.m())},cd:function(){this.o&&this.o.b(this.m())},cx:function(){var n=this.bi.eU;if(n&&this.n)if(this.i&&!this.m()){n.t(this.n);this.i=!1}else if(!this.i&&this.m()){n.w(this.n);this.i=!0}},C:function(){var t=_g.a.a().a();if("Mouse"===_y.c.a.a()){var n=this.bk.a();var i=1===n||2===n||3===n||12===n||this.bk.fs;return i?t.bH.AutoAddSignatureOnReply:t.bH.AutoAddSignature}return this.p.c()?this.k.b("MOWA.IsSignatureChanged")==="true"?this.k.b("MOWA.AutoAddSignature")==="true":!0:t.bH.AutoAddSignatureOnMobile},A:function(n,t){if("Mouse"===_y.c.a.a())return _mcp.o.a(n,t);if(this.p.c()){if(this.k.b("MOWA.IsSignatureChanged")==="true")if(this.k.b("MOWA.UseDesktopSignature")==="true")return _mcp.o.a(n,t);else{var r=this.k.b("MOWA.SignatureText")||"";return t?_a.B.b(r):r}return t?_a.B.b(_mcp.V.a(this.p)):_mcp.V.a(this.p)}if(n.bH.UseDesktopSignature)return _mcp.o.a(n,t);else{var i=n.bH.SignatureTextOnMobile||"";return t?_a.B.b(i):i}},m:function(){var n="Mouse"===_y.c.a.a()||_g.a.a().a().bH.UseDesktopSignature;return n?!this.z():!_j.h.b(_g.a.a().a().bH.SignatureTextOnMobile)},B:function(){var i=this.bj.a.ba;var r=_g.a.a().a();i.ce(!0);var t=!_j.h.a(this.b());if(t){var n=new _cmc.i(0,this.b(),this.q(),7);n.q=!0;n.p=!1;this.bi.bD().a(n);this.u=!0}else _j.e.a(_a.a.a,"Skip insert signature due to HasSignature={0};",t)},D:function(n,t){this.d.rpcl("CurrentStatus",this.r);if(this.d.a===2){this.v();this.bs();if(this.bk.ff&&this.a()){var i=this.b();var r;if(this.bk.fs){r=1;i=this.q()?"<div><br></div>"+i:"\n"+i}else r=2;var u=new _cmc.i(r,i,this.q(),7);u.q=!0;this.bk.br(u)}}},H:function(n){return n.replace(_mcp.o.c,'<img class="'+_mcp.o.d+'" '+"$2"+"$3")},G:function(n){var e=n.match(_mcp.o.b);if(!e)return n;for(var u=document.createElement("div"),o=e,s=o.length,i=0;i<s;++i){var f=o[i];u.innerHTML=f+"</a>";var r=u.querySelectorAll("a");r&&r.length===1&&(r[0].id="LPNoLP");var t=u.innerHTML;t=t.substr(0,t.length-4);n=n.replace(f,t)}return n},E:function(n,t){this.v();this.bs()},I:function(){var n=new RegExp("^\n\n{1,5}$");this.s=!this.l||!this.l.search(n);this.x=!this.h||this.s&&this.h.indexOf("<img")===-1}};_mcp.bX=function(n){this.d=Function.createDelegate(this,this.h);_mcp.bX.initializeBase(this,[38,n]);this.b=new _j.g(this.d,this.bl());this.c=_a.o.a()};_mcp.bX.prototype={b:null,c:null,a:function(){return this.b},bz:function(){var n;_a.h.a(n={val:this.b}),this.b=n.val;_mcp.I.prototype.bz.call(this)},h:function(){this.f(10)},f:function(n){var i=this.bj.a.ba;i.ce(!0);var r=i.dz();var u=!_j.h.a(r);if(u){var t=this;_j.m.a().a(_a.a.a,"SmartReplyComponent_AddSmartReply",function(){var f=t.bi.bD();if(f&&f.e()){var e=0;var o=t.c.g()||t.c.f();o&&(e=1);var u=new _cmc.i(e,r,!0,7);u.q=!1;u.p=!1;t.bi.bD().a(u);i.ew("")}else n>0&&t.f(n-1)},250)}}};_mcp.bY=function(n,t){this.u=Function.createDelegate(this,this.s);this.t=Function.createDelegate(this,this.r);this.v=Function.createDelegate(this,this.E);this.w=Function.createDelegate(this,this.z);_mcp.bY.initializeBase(this,[10,n]);this.m=new _j.g(this.w,this.bl());this.q=t};_mcp.bY.prototype={q:null,m:null,l:null,o:!1,p:!1,a:function(){return this.m},h:function(){return this.l},G:function(n){if(n!==this.l){this.l=n;this.by("CloseConfirmDialogButtonData")}return n},i:function(){return this.o},k:function(n){if(n!==this.o){this.o=n;this.by("IsCloseConfirmDialogShown")}return n},f:function(){return this.p},H:function(n){if(n!==this.p){this.p=n;this.by("IsAppBarSetup")}return n},b:function(){_j.e.a(_a.a.a,"Setup appbar menu. Context: {0}",this.bk);if(!this.bT){var n=new _j.q;this.n(n,11);this.n(n,1);this.n(n,28);this.n(n,6);this.n(n,3);this.n(n,9);this.bi.eU.f(n.d);this.H(!0)}},g:function(){_j.e.a(_a.a.a,"InitTouchComponent:Context:{0}",this.bk);this.bi.bv.a()==="TouchNarrow"?this.D():this.bi.eU||this.A();this.bj.b(21);_mcp.I.prototype.g.call(this)},j:function(n,t,i){if(this.bi.bP)return!1;else if(this.bi.bq().j()){this.o||this.z();return!0}else if(this.bi.ba.bn()&&!this.x()){_j.e.a(_a.a.a,"Removing unedited reply forward draft if user clicks outside the form.");this.r();return!0}else{this.bi.R(!0);return!1}},bz:function(){var t;_a.h.a(t={val:this.m}),this.m=t.val;if(this.l){this.l.g();this.l=null}var n;_a.h.a(n={val:this.l}),this.l=n.val;_mcp.I.prototype.bz.call(this)},B:function(){return _a.g.b?null:new _y.h(_y.b.ba(),_y.b.bb(),_u.P.l,this.bi.bj().j())},x:function(){return this.bi.bg().b()},A:function(){var e=new _y.h(_y.b.y(),_y.b.z(),_u.P.a,this.bi.bg().a());var o=_y.h.a(_nbs.a.Ef,this.m);var u=this.B();var r=this.C();var i=2;i+=u?1:0;i+=r?1:0;var n=new Array(i);var t=0;n[t++]=e;u&&(n[t++]=u);n[t++]=o;r&&(n[t++]=r);_j.e.a(_a.a.a,"Creating appbar. ContextId={0}",this.bk.d());var f=_y.k.a(this.bi,n,null);f.L("TouchNarrow"===_y.c.a.a());this.bi.fU(f)},D:function(){var t=this.q;if(t){var n=t.b();if(_a.o.a().a()){n.b(2);n.d(_nbs.a.cN);n.a(t.a(_fm.a.b,_fm.a.b,this.m,_u.R.Ff));n.c(t.a(_fm.a.b,_fm.a.b,this.bi.bg().a(),_u.n.TJ));n.h().a(!0)}else{n.b(1);n.d(_nbs.a.SN);n.a(t.a(_y.b.a(),_y.b.a(),this.m,""));n.i(t.a(_fm.a.h,_fm.a.h,null,""));n.f(this.bi.by().a());var i=this.bi.bc().p();if(i&&i.d.length>0){if(i.d.length>1){n.c(t.a(_y.b.A(),_y.b.A(),null,""));n.m(new _fm.e(i.d))}else{var r=i.d[0].j;n.c(t.a(_y.b.A(),_y.b.A(),r,""))}n.g(t.a(_y.b.q(),_y.b.q(),this.bi.bg().a(),""))}else n.c(t.a(_y.b.q(),_y.b.q(),this.bi.bg().a(),""))}this.bi.fV(n)}},z:function(){_j.e.a(_a.a.a,"User hit close, decide whether to show the confirm dialog. Context:{0}",this.bk);if(this.x()){_j.e.a(_a.a.a,"Skipping close since send is in progress. This is considered a corner case since going to local store should be quick. If this occurs frequently, an UX solution is needed.");return}if(this.bi.bq().j()){this.I();_j.e.a(_a.a.a,"Toggle IsCloseConfirmDialogShown flag to show the dialog.");this.k(!0)}else if(this.bk.bn()){_j.e.a(_a.a.a,"Removing unedited reply forward draft on close.");this.r()}else{_j.e.a(_a.a.a,"Navigate away due to unmodified message.");this.y()}},s:function(){_j.e.a(_a.a.a,"Hide close confirm dialog");this.k(!1)},I:function(){if(!this.l){_j.e.a(_a.a.a,"Create close confirm dialog.");var n=new _j.l;_a.g.b||n.a(new _ff.d(new _j.g(this.v,this.bl()),_u.P.U,_nbs.a.vD,!0,!1));n.a(new _ff.d(new _j.g(this.t,this.bl()),_u.n.MH,_u.n.Mg,_a.g.b,!1));n.a(new _ff.d(new _j.g(this.u,this.bl()),_bcs.D.A,_u.n.MU,!1,!1));this.G(n)}},E:function(){_j.e.a(_a.a.a,"User select save and close");this.s();this.bi.bl().j().a()},r:function(){_j.e.a(_a.a.a,"User select discard and close");this.s();this.bi.bq().k();this.y()},y:function(){this.bi.bm().a(this.bi,!1)},C:function(){if(this.bk.W())return null;var n=new _j.q;var o=this.bi.bc();var t=o.y();if(t&&t.length>0)for(var r=t,e=r.length,i=0;i<e;++i){var u=r[i];n.c(u)}if(n.d.length===1){var f=n.d[0];return new _y.h(_y.b.M(),_y.b.N(),_u.P.T,f.a())}else return new _y.h(_y.b.M(),_y.b.N(),_u.P.T,null,n.d)},n:function(n,t){var r=null;var i=this.bj.b(t);if(i&&IMailComposeContextMenuProvider.isInstanceOfType(i)){_j.e.a(_a.a.a,"Getting app-bar items for type '{0}', IsInitialized = {1}",Object.getType(i).getName(),i.e());i.e()||i.g();r=i;n.h(r.P())}}};_mcp.R=function(n,t,i){this.N=Function.createDelegate(this,this.Z);this.H=Function.createDelegate(this,this.y);this.x=Function.createDelegate(this,this.R);this.K=Function.createDelegate(this,this.U);this.M=Function.createDelegate(this,this.X);this.I=Function.createDelegate(this,this.T);this.t=Function.createDelegate(this,this.O);this.L=Function.createDelegate(this,this.C);_mcp.R.initializeBase(this,[12,n]);this.v=this.bj.a.bY;this.o=t;this.Q=i};_mcp.R.a=function(n){if(n&&!n.fm){n.bb.b(3440);n.bb.a(3440,null);n.bi()}};_mcp.R.prototype={v:null,o:null,Q:null,B:null,n:null,p:null,E:null,D:null,G:null,r:null,m:null,a:function(){this.r||(this.r=new _j.g(this.L,_a.a.a));return this.r},h:function(){return this.j()&&!this.bk.bm()||this.bi.bF},d:function(){var n=this.bk;return this.j()&&n.bm()&&!this.m&&!n.L()},j:function(){return this.i()&&this.bi.bn()&&!this.bk.H()&&!this.bi.bF},i:function(){var n=this.bk.a();return n===1||n===2||n===3},c:function(){return this.h()||this.d()},q:null,f:function(){return this.q},l:function(n){this.q=n;return n},u:!1,k:function(){return this.u},g:function(){if(this.j()){var n=this.bi.ba;if(n.bm()&&n.L()){_j.e.a(_a.a.bq,"initializing upgrade component, user requested upgrade and upgrade failed, show the failure message");this.S();this.bi.bi()}}_mcp.I.prototype.g.call(this)},b:function(){_a.O.a(_a.a.a,"MailComposeUpgrade",3);this.n=_y.l.b(_a.a.a,"MailComposeUpgrade",!0,!0);this.q=_y.l.b(_a.a.a,"MailComposeQuoteBody",!0,!1);var r=this.bj.a;var n=r.ba;var u=n.d();this.B=u;if(!n.l()||this.bi.bF){if(!this.j()){var e=this;_j.m.a().a(_a.a.a,"ShowUpgradeMessage",function(){n.l()||n.L()||u!==e.B||_mcp.R.a(r)},5e3)}var t;t=this.o.b()||n.h()!=="HTML"?n.h()==="Text"?_h.b.l():_h.b.d():_h.b.M();if(t===_h.b.d()||t===_h.b.M()){t=_ff.e.a(t);t.BlockExternalImages=n.b().bH.HasBlockedImages;t.FilterHtmlContent=n.b().bH.HasBlockedImages}var i=r.bX.d(n,t);n.a()===12&&i.q(new _g.F(new _g.r("internalsubmission")));i.l(this.t);_j.e.a(_a.a.bq,"Begin upgrade, OriParentFolderId={0}",n.b()&&n.b().bH.ParentFolderId&&_g.b.a?_g.b.a.idToName(n.b().bH.ParentFolderId):"null");i.m("MailComposeUpgrade");this.u=!0;if(n.bL()){var f=new _mcp.w(i);r.bp.a(f,this.I,this.M,null)}else this.bi.bF?r.bp.a(i,this.K,this.x,null):r.bp.a(i,this.H,this.x,null)}},bz:function(){var n;_a.h.a(n={val:this.r}),this.r=n.val;_mcp.I.prototype.bz.call(this)},T:function(n){var t=n;this.y(t.e)},X:function(n){var i=n;var t=i.e;t.u(this.t);this.R(t)},U:function(n){this.y(n);this.bj.a.bm().l()},y:function(n){if(this.bp()){_j.e.a(_a.a.a,"MailComposeUpgradeComponent.CheckSystemUpgrade: viewModel is null or disposing, aborting logic.");return}this.u=!1;var u=this.bi;var e=u.ba;var t=n;var h=u.bq();var f=t.bg;var i=n.i();var s=t.Q?t.Q.correlationId:null;var c=!!t.bl;if(this.v.a(i)){_j.e.a(_a.a.bq,"Check upgrade callback, resume discard for context {0}",i);h.c(i,t.bw)}else if(i===e.d()){e.E(f);_j.e.a(_a.a.bq,"Context match, updated the draft id. ResponseMessageBodyType={0}",c&&t.bl.X()?t.bl.X().a():"null");var r=u.bl();var o=u.bg();if(!r.c()&&o.b()){_j.e.a(_a.a.bq,"Skipping upgrade for contextId {0} since send was triggered during upgrade",i);this.s("SkipUpgrade",s,"Skip upgrade since send is in progress");o.h();return}if(r.c()&&r.h()){_j.e.a(_a.a.bq,"Skipping upgrade for contextId {0} since save and then send was triggered during upgrade",i);this.s("SkipUpgrade",s,"SkipUpgrade since saving is in progress");r.i();return}}if(t.bl){_j.e.a(_a.a.bq,"Check upgrade, action has response message, call complete upgrade. ActionItemId={0}",_h.G.c(f));this.O(n)}else if(n.i()===e.d()){_j.e.a(_a.a.bq,"Check upgrade: action has id only, updated draft id. ActionItemId={0}",_h.G.c(f));this.A(!0)}},V:function(n){n.dG()&&this.bj.a.bb.a(3050)},O:function(n){if(this.bp()){_j.e.a(_a.a.a,"MailComposeUpgradeComponent.CompleteSystemUpgrade: viewModel is null or disposing, aborting logic.");return}var r=this.bi;var t=r.ba;var i=n;var o=i.Q?i.Q.correlationId:null;var f=n.i();i.u(this.t);if(f===t.d()){t.dS(i.bl);t.fG=i.bl.cQ();this.m=i.bl;t.hN(i.bl.bg());try{if(this.j())if(t.bm()){_j.e.a(_a.a.bq,"upgrade returned success, user already requested for upgrade, merge body and remove spinner");this.z();this.bA("IsWaitingForQuotedBody","IsOnDemandUpgradePending");r.bi()}else{t.cK(!0);this.A(!1)}else this.z();i.bl.bi()&&t.T(i.bl.bi().f);var e=r.bc();e.K()}finally{t.l()&&r.bb.b(3440);_j.e.a(_a.a.bq,"IsUpgraded for context is {0}",t.l())}this.V(t);r.bi();_j.e.a(_a.a.bq,"Complete upgrade.");var u=r.bl();u.c()?u.i():_a.bu.a&&_j.m.a().c(_a.a.a,"SafeTriggerPolicyTipsIfNeededForOpenDraft",this.N);r.be.a(_db.ct,new _mcp.cg(t.K().bH.ItemId.Id,r))}else _j.e.a(_a.a.bq,"MailComposeUpgrade failed since user switched view model context. ContextId={0}; Context{1}=",f,t)},C:function(){this.p=_y.l.b(_a.a.a,"MailComposeOnDemandUpgrade",!0,!1);var n=this.bj.a.ba;n.eh(!0);if(this.m||n.K()&&n.l()){this.m||(this.m=n.K());_j.e.a(_a.a.bq,"user requests for quoted body, upgrade was successful, complete the body merge");this.z();this.bA("ShouldShowQuoteBodyButton","IsOnDemandUpgradePending")}else if(n.L()){_j.e.a(_a.a.bq,"user requests for quoted body, upgrade failed, show error message");this.bA("ShouldShowQuoteBodyButton","IsOnDemandUpgradePending");this.S();this.bi.bi();this.P()}else{_j.e.a(_a.a.bq,"user requests for quoted body, upgrade has yet to come back, show spinner");this.bA("ShouldShowQuoteBodyButton","IsWaitingForQuotedBody")}},z:function(){var n=this.bj.a.ba;var e=!1;if(this.o.b()){if(n.eR()){n.fc.a();n.y()===n.eR().a()&&(e=!0)}else n.fJ=!0;n.fH=!0}if(this.bi.bn()&&this.j()&&this.m.X()&&n.h()!==this.m.X().a()&&this.o.b()){var f=this.m.X().bH.Value;if(n.h()==="HTML")n.fC(_a.B.b(f));else{var i;var o,r;r=_a.B.a(f,o={val:i}),i=o.val,r;n.fC(i);var h=this;n.fw=function(n){n.bc().E(!1)}}}else if(this.o.b()||n.h()!=="HTML"){var u=this.m.X().bH.Value;n.fC(!this.o.b()&&n.h()==="Text"?_a.B.G(u):u)}else n.fC(this.m.ck().bH.Value);if(_y.c.a.a()==="Mouse"||this.o.b()){this.bk.hs();var t=new _cmc.i(2,n.dv(),n.h()==="HTML",14);t.s=!1;t.B=!0;var c=this;t.C=function(){n.cK(!0)};this.bi.bD().a(t)}else n.cK(!0);if(e){n.fc.a();n.eR().r(n.y());var s=n.eU;s&&n.eU.r(n.y())}this.A(!0)},R:function(n){this.u=!1;var r=n;var u=r.Q?r.Q.correlationId:null;r.u(this.t);if(this.bp()){_j.e.a(_a.a.a,"MailComposeUpgradeComponent.OnUpgradeFailure: viewModel is null or disposing, aborting logic.");this.s("SkipUpgrade",u,"Skip upgrade since view mode is disposed");return}var s=this.bj;var t=s.a;var f=t.ba;var h=t.bq();f.eD(!0);var i=n.i();if(this.v.a(i)){_j.e.a(_a.a.bq,"Resume discard for context {0}",i);h.c(i,r.bw)}else if(i===f.d()){_j.e.a(_a.a.bq,"Recording on context upgrade failed");var e=t.bl();var o=t.bg();if(e.c()){if(e.h()){_j.e.a(_a.a.bq,"Skipping upgrade for context {0} since save and then send was triggered during upgrade",i);this.s("SkipUpgrade",u,"Skip upgrade since saving is in progress");e.i();return}_mcp.R.a(t)}else if(o.b()){_j.e.a(_a.a.bq,"Skipping upgrade for context {0} since send was triggered during upgrade",i);this.s("SkipUpgrade",u,"Skip upgrade since send is in progress");o.h();return}else t.bn()||_mcp.R.a(t);if(this.j()&&f.bm()){_j.e.a(_a.a.bq,"upgrade failed and user requested for upgrade, show the failure and trigger property changes to hide the spinner");this.bA("IsWaitingForQuotedBody","IsOnDemandUpgradePending")}}n.g()&&this.Y(n.g(),i,u,f)},Y:function(n,t,i,r){var f;var u;var o,e;this.dd(n,o={val:f},e={val:u},"UpgradeFailure_UnknownError"),f=o.val,u=e.val;_j.e.b(_a.a.bq,"Upgrade failed. ContextId={0}, Context={1}, Server Error: {2}",t,r,u);this.s(f,i,u)},S:function(){var n=this.bj.a.bb;n.b(3450);n.a(3450,null)},s:function(n,t,i){this.E=n;this.D=t;this.G=i;if(this.n){_y.l.a(this.n,null,n,t,i);this.n=null;_a.O.b("MailComposeUpgrade")}if(this.q){_y.l.a(this.q,null,n,t,i);this.q=null}this.P()},A:function(n){if(this.n){n&&this.n.q(new _a.y("UIUpdated"));_y.l.a(this.n);this.n=null;_a.O.b("MailComposeUpgrade")}this.W()},W:function(){if(this.p){_y.l.a(this.p);this.p=null}},P:function(){if(this.p){_y.l.a(this.p,null,this.E,this.D,this.G);this.p=null}},Z:function(){_mcp.I.a(this.bi,32)}};_mcp.bP=function(n,t,i){this.h=Function.createDelegate(this,this.j);_mcp.bP.initializeBase(this,[17,n]);if(_a.cD.a){var r=this;t.a(function(n){if(r.bp()){_j.e.a(_a.a.a,"MailComposeMailTipsComponent.ctor: viewModel is null or disposing, aborting logic.");return}var f=r.bi;var u=f.bd();var e=r.bi.fi();var t=f.bb;if(u&&t){r.c=n.a(u,t,i,e);r.bk.V()&&r.c.g(r.bk.V().EmailAddress);if(r.d){r.i();r.d=!1}if(r.f){r.c.a();r.f=!1}}})}};_mcp.bP.prototype={c:null,d:!1,f:!1,g:function(){if(!_a.cD.a){_mcp.I.prototype.g.call(this);return}this.c?this.i():this.d=!0;_mcp.I.prototype.g.call(this)},a:function(n){if(_a.cD.a||!this.bT){if(n===32){var r=this.bj;var i=r.a;var t=i.ba;if(t.dk()){i.bb.b(4400);i.bb.a(4400);this.bi.bi()}if(!t.a()&&(!t.g()||!t.g().b())&&(!t.j()||!t.j().b())&&(!t.c()||!t.c().b())||t.a()===3||t.a()===11)return}this.e()||this.g();this.k()}},b:function(){if(_a.cD.a){this.e()||this.g();if(this.c){_j.e.a(_a.a.a,"Remove MailTips for deleted recipients");this.c.e()}else _j.e.a(_a.a.a,"MailTips for deleted recipients was called when MailTipsHandler hasn't been created, no operation needed")}},bz:function(){if(this.c){this.c.c(null);this.c=null}_mcp.I.prototype.bz.call(this)},i:function(){this.c.b();this.c.c(this.h)},k:function(){if(_a.cD.a)if(this.c){_j.e.a(_a.a.a,"Prepares to submit mailtips action");this.c.a()}else{_j.e.a(_a.a.a,"Remember to submit MailTips action once the MailTipsHandler is created");this.f=!0}},j:function(){if(_a.cD.a){this.bi.dC(this.c.d());this.bi.bi()}}};_mcp.bT=function(n,t){this.h=Function.createDelegate(this,this.i);_mcp.bT.initializeBase(this,[29,n]);if(t){var i=this;t.a(function(n){if(i.bp()){_j.e.a(_a.a.a,"MailComposePeopleRecommendationsComponent.ctor: viewModel is null or disposing, aborting logic.");return}var t=i.bi;i.c=n.a(i.bi.bd(),i.bi.bb);i.c.c(i.h);if(i.d){i.c.b();i.d=!1}if(i.f){i.c.a();i.f=!1}})}};_mcp.bT.prototype={c:null,d:!1,f:!1,g:function(){this.c?this.c.b():this.d=!0;_mcp.I.prototype.g.call(this)},b:function(n){this.e()||this.g();this.j()},a:function(){this.c&&this.c.d(!0)},bz:function(){if(this.c){this.c.c(null);this.c=null}_mcp.I.prototype.bz.call(this)},j:function(){if(this.c){_j.e.a(_a.a.a,"Prepares to submit PeopleRecommendations action");this.c.a()}else{_j.e.a(_a.a.a,"Remember to submit PeopleRecommendations action once the PeopleRecommendationsHandler is created");this.f=!0}},i:function(){this.bi.bi()}};_mcp.bV=function(n,t){this.p=Function.createDelegate(this,this.w);this.o=Function.createDelegate(this,this.v);this.n=Function.createDelegate(this,this.u);this.m=Function.createDelegate(this,this.t);this.l=Function.createDelegate(this,this.s);_mcp.bV.initializeBase(this,[23,n]);if(_a.bu.a){var i=this;t.a(function(n){if(i.bp()){_j.e.a(_a.a.a,"MailComposePolicyTipsComponent.ctor: viewModel is null or disposing, aborting logic.");return}var t=i.bi;var f=t.bd();var u=t.bc();var r=t.bb;if(f&&u&&r){i.f=n.a(f,u,r);i.f.i(i.l);i.f.e(i.m);i.f.d(i.n);i.f.f(i.o);i.f.g(i.p);if(i.i){i.f.b();i.i=!1}if(i.j){i.a(i.k);i.j=!1}}})}};_mcp.bV.prototype={h:null,f:null,i:!1,j:!1,k:0,g:function(){if(!_a.bu.a){_mcp.I.prototype.g.call(this);return}this.f?this.f.b():this.i=!0;_mcp.I.prototype.g.call(this)},bz:function(){this.h&&(this.h=_j.m.a().b(this.h));var n;_a.h.a(n={val:this.f}),this.f=n.val;_mcp.I.prototype.bz.call(this)},c:function(){if(!_a.bu.a)return!1;switch(this.q()){case 1:return!1;case 2:case 3:return this.bj.a.ba.cp()===null&&this.bj.a.ba.co()===null;case 4:case 5:return this.bj.a.ba.co()===null;default:return!1}},b:function(){if(!_a.bu.a)return"";switch(this.q()){case 2:case 3:return _u.P.S;case 4:case 5:return _u.P.G;default:return""}},d:function(){if(_a.bu.a){if(!this.f){_j.e.a(_a.a.M,"skip setting message sent flag since handler hasn't been created yet.");return}this.f.h(!0);if(this.bj.a.ba.cp()){var n=new _cmc.h(_a.a.M,"DlpPolicyTipOverridden",!1);n.b()}}},a:function(n){this.r(n,0)},x:function(n,t,i){_j.e.a(_a.a.a,"Prepares to submit policyTips action");var u;var r;if(n.eR()){u=_a.C.c(n.eR().f());r=_a.C.c(n.eR().a())}else{u=_a.C.c(n.I());r=_a.C.c(n.y())}this.f.c(i,n.s(),u,r,t)},r:function(n,t){if(_a.bu.a&&!this.bT){if(!this.f){_j.e.a(_a.a.M,"Remember to resume triggering policy tips once the handler is created");this.k=n;this.j=!0;return}var f=this.bj;var e=f.a;var r=e.ba;this.e()||this.g();this.h&&(this.h=_j.m.a().b(this.h));var i=r.k();if(i){_bc.g.a(i)&&!_g.k.b&&(i=_g.k.a.q(i));if(_bc.g.a(i)){if(t<4){var u=this;this.h=_j.m.a().a(_a.a.M,"TriggerPolicyTipsIfNeeded",function(){u.r(n,t+1)},5e3)}}else this.x(r,n,i)}}},q:function(){this.e()||this.g();return this.f?this.f.a():0},s:function(){this.bi.bi()},t:function(n){var r=this.bj;var i=r.a;var t=i.ba;t.dR(n)},u:function(n){var r=this.bj;var i=r.a;var t=i.ba;t.dQ(n)},v:function(){this.a(64)},w:function(n){var r=this.bj;var i=r.a;var t=i.ba;t.dP(n)}};_mcp.A=function(n,t){this.Q=Function.createDelegate(this,this.bJ);this.bb=Function.createDelegate(this,this.bU);this.be=Function.createDelegate(this,this.bv);this.bf=Function.createDelegate(this,this.bC);this.bc=Function.createDelegate(this,this.bV);this.ba=Function.createDelegate(this,this.bR);this.bd=Function.createDelegate(this,this.bW);this.V=Function.createDelegate(this,this.bt);this.Z=Function.createDelegate(this,this.bQ);this.X=Function.createDelegate(this,this.bN);this.Y=Function.createDelegate(this,this.bP);this.U=Function.createDelegate(this,this.bG);this.W=Function.createDelegate(this,this.bH);this.bn=Function.createDelegate(this,this.bD);this.bo=Function.createDelegate(this,this.ca);_mcp.A.initializeBase(this,[22,n]);this.O=!1;this.bh=t;this.N=new _j.g(this.bo,_a.a.i);this.N.c(!1)};_mcp.A.a=function(n){switch(n){case 0:return 0;case 1:return 1;case 2:return 2;default:throw Error.argument();}};_mcp.A.prototype={R:null,S:0,O:!1,bm:!1,P:null,M:null,bh:null,bg:null,N:null,a:function(){return this.M},bY:function(n){if(this.M!==n){this.M=n;this.bX(["ExtensibilityViewModel","ShouldShowAppsButton","ToggleAppPaneCommand","PopoutTaskPanePanelViewModel"])}return n},f:function(){return this.M?this.M.E():!1},bI:function(){return this.bi.bn()?this.bi.bm().j():this.M?this.M.G():null},K:function(){return this.M?this.M.p():null},j:function(){return this.N},n:function(){return!!this.M&&this.M.e()&&this.N.b&&!this.M.c()},m:function(){return this.M?this.M.b():!0},bZ:function(n){if(n!==this.bm){this.bm=n;this.by("RequestCloseComposeForm")}return n},g:function(){if(!_a.g.b&&!_a.bs.a()&&!this.e()){var n=this;this.bh.a(function(t){if(!n.M){if(n.bp()){_j.e.a(_a.a.a,"MailComposeExtensibilityComponent.Initialize: viewModel is null or disposing, aborting logic.");return}var i=n.bi;n.bg=t;n.bY(t.d(n,n.bn,i.bu(),i.bN()));var r=i.bL();n.M.w(r.a());n.M.L(i.bu());var f=i.be;f.b(_a.dw,n.W);n.M.g();r.apcl(r.b(),n.U);n.M.i(n.Y);n.M.h(n.X);var u=n.bj.b(5);u.u(n.Z);n.M.a().j(n.V);n.bt(null,null);n.M.apcl("ShowAppsButton",n.bd);n.M.apcl("ExtensibilityContext",n.ba);n.M.apcl("PopoutTaskPanePanelViewModel",n.bc);_mcp.I.prototype.g.call(n);n.M.s(1);if(n.bk.ge()&&n.bk.ge().length>0){n.bq(n.bk.ge());n.bk.cC(null)}n.bk.hb(n.bf);n.bk.ha(n.be);n.P=new Array(0);n.bv(null);n.bK()}})}},bQ:function(n){this.M.z()},bV:function(n,t){this.by("PopoutTaskPanePanelViewModel")},bw:function(n,t,i,r,u,f){var o=this;var e=function(n,t){if(n){o.o();f()}};u.r||u.h(1,t,e,!1,i,r,n,u.z)},k:function(n,t){this.bw(_nbs.a.ii,_nbs.a.iJ,_nbs.a.dX,_nbs.a.Wl,n,t)},L:function(n,t){this.bw(_nbs.a.ii,_nbs.a.tz,_nbs.a.qh,_nbs.a.XO,n,t)},o:function(){this.M&&this.M.H()},bK:function(){if(this.bk&&this.bk.K()&&this.bi.fs()&&this.bi.cj){var n=this;this.bi.cj.a(function(t){n.bk&&n.bk.K()&&t.a().a().a(n.bk.K())})}},bv:function(n){if(this.bk.K()){this.bk.K().cq.p(this.bb);this.P.length>0&&this.bk.K().cq.g(this.P)}},bC:function(n){if(this.bk.K()){this.P=this.bk.K().cq.e();this.bk.K().cq.q(this.bb)}},bU:function(n,t){if(this.bi&&this.bi.cj){var i=this;this.bi.cj.a(function(n){i.bk&&i.bi&&n.b(i.bk.K(),i.bi.bb)})}},bq:function(n){if(!this.R){var s;var r=null;var o;if(this.bj.a.ba.l()){o=this.bj.b(5);r=o.a()}else _j.e.a(_a.a.i,"Attachment not added - well not upgraded.");if(!r&&this.S<10){var i=this;this.R=_j.m.a().a(this.bl(),"MailComposeExtensibilityComponent - add attachments from context on delay",function(){if(!i.bT){i.S++;i.R=null;i.bq(n)}},100*this.S)}else for(var t=0;t<n.length;t++)if(n[t][0]==="file"){var h=!1;_j.h.a(n[t][3])||(h=n[t][3]);this.br(r,n[t][2],n[t][1],!0,h)}else if(n[t][0]==="item"){var u=new _g.B;u.c(new _g.e(n[t][2]));u.e(n[t][1]);var e,f;f=this.bs(r,u,e={val:s},!0),s=e.val,f}}},bu:function(){this.by("ShouldShowAppsButton");if(this.bi.bZ()){var n=this.bj.b(27);n.B(this.n())}},bW:function(n,t){this.bu()},bR:function(n,t){this.bi.bb.b(106)},br:function(n,t,i,r,u){var e=this.bg.b(t,i);var f=n.Z(e,u,u?i:null);f?f.G(r):_j.e.b(_a.a.i,"Could not create a valid attachment view model. This could be due to policy configuration.");return f},bs:function(n,t,i,r){i.val=0;var e=new _db.F(t,t.bH.ParentItemId);var f=new _j.q;f.c(e);var o=_a.b.b(_a.a.c,"AttachmentExtensibilityItemAttachments",!1,null);var u=n.z(f,o);if(!u.d.length){_j.e.a(_a.a.i,"Attachment not added - max number exceeded.");i.val=9001;return null}u.d[0].G(r);return u.d[0]},b:function(){return _y.c.a.a()==="Mouse"?this.bj.a.ba.h():this.bj.a.ba.dw()?"HTML":"Text"},z:function(){return this.bj.a.ba.w()},D:function(n){this.bj.a.ba.t(n)},y:function(n,t,i){i.val=0;var r=new _cmc.q(n);this.bj.a.ba.cN(r);r.b&&(i.val=9016);t.val=r.c;return r.a},C:function(n,t,i){i.val=0;var r=new _cmc.y(n,!0,t,11);this.bj.a.ba.cN(r);r.y?i.val=2006:r.z&&(i.val=9016)},u:function(){this.bZ(!0);this.by("RequestCloseComposeForm")},x:function(n){return this.bi.bd().H(_mcp.A.a(n))},G:function(n,t){return this.bx(n,t,!1)},B:function(n,t){this.bx(n,t,!0)},s:function(n,t,i){t.val=0;if(!this.bj.a.ba.l()){_j.e.a(_a.a.i,"Attachment not added - well not upgraded.");t.val=9005;return null}var r=this.bj.b(5);if(r.a())return this.bs(r.a(),n,t,i);else{_j.e.a(_a.a.i,"ComposeFormNotReadyForAttachments in mail module");t.val=9015;return null}},r:function(n,t,i,r){i.val=0;if(!this.bj.a.ba.l()){_j.e.a(_a.a.i,"Attachment not added - well not upgraded.");i.val=9005;return null}var f=this.bj.b(5);var u=f.a();if(u)return this.br(u,n,t,!1,r);_j.e.c(_a.a.i,"ComposeFormNotReadyForAttachments in mail module");i.val=9015;return null},H:function(){return this.bj.a.ba.bi()?this.bj.a.ba.bi().Id:null},p:function(n,t){var i=new _cmc.i(0,n,t,11);i.p=!0;i.r=!0;this.T(i)},q:function(n,t){var i=new _cmc.i(1,n,t,11);this.T(i)},i:function(n,t){var r=this,i=this;this.bj.a.bl().b(function(t){n()},function(n){_j.e.a(_a.a.i,"SaveActionFailed: Error: {0}",n.G.message);t()})},v:function(n){if(this.bj.a.ba.Q()){var t=new _cmc.O(n);this.bj.a.ba.br(t);return t.a}else return this.bj.a.ba.y()},A:function(n,t,i){i.val=0;var r=new _cmc.bj(n,t,11);this.bj.a.ba.br(r);r.d&&(i.val=2006)},d:function(){return this.bk.K()},ca:function(){this.M&&this.M.M()},bt:function(n,t){this.N.c(this.M.a().b);this.bu()},bP:function(){if(_y.c.a.a()==="TouchWide"&&this.M.o()){var n=this.bj.a;n.eA(6)}},bN:function(){var n=this.bj.a;n.eA(4)},T:function(n){this.bi.bD().a(n)},h:function(){return this.bj.a.ba.k()?this.bj.a.ba.k().Id:null},c:function(){this.bj.a.ba.P()||this.bj.a.ba.dU(new _j.l);return this.bj.a.ba.P()},l:function(){},E:function(){var n=new _cmc.H(null);this.T(n)},t:function(n){var t=new _cmc.H(n);this.T(t)},w:function(){return this.bk&&this.bk.n()?this.bk.n().Mailbox:null},bz:function(){var t=this.bj.a.bL();t.rpcl(t.b(),this.U);this.bi.be.c(_a.dw,this.W);if(this.M){this.M.u(this.Y);this.M.t(this.X);var i=this.bj.b(5);i.B(this.Z);this.M.a().i(this.V);this.M.rpcl("ShowAppsButton",this.bd);this.M.rpcl("ExtensibilityContext",this.ba);this.M.rpcl("PopoutTaskPanePanelViewModel",this.bc);this.M.n();this.M.m();this.M=null}if(this.N){this.N.c(!1);this.N.i(this.Q);var n;_a.h.a(n={val:this.N}),this.N=n.val}if(this.bk){this.bC(null);this.P=null;this.bk.hC(this.bf);this.bk.hB(this.be)}_mcp.I.prototype.bz.call(this)},bx:function(n,t,i){i&&this.bi.bd().be(_mcp.A.a(n));var e=this.bi.bd().H(_mcp.A.a(n));var u=t.d.length;if(u+e.x.length>500)return!1;n===2?this.bj.a.bd().A().a():n===1&&this.bj.a.bd().B().a();for(var r=0;r<u;r++){var f=t.d[r];this.bi.bd().V(f,_mcp.A.a(n))}return!0},bH:function(n){if(this.O){this.O=!1;this.M.f(!1)}},I:function(){this.n()?this.N.a():this.N.j(this.Q)},bD:function(n){if(n===1){var r=window.document.body.clientWidth;if(r<1367){var i=this.bj.a.be;i.a(_a.dP,new _a.dP(!0));this.O=!0}}else if(n===2&&this.O){var t=this.bj.a.be;t.a(_a.dP,new _a.dP(!1));this.O=!1}this.bi.bi()},bG:function(n,t){var i=this.bj.a.bL();t===i.b()&&this.cb(i)},cb:function(n){this.M.w(n.a());n.a()&&this.M.f(!1)},bJ:function(n,t){if(this.N.b){this.N.i(this.Q);this.N.a()}}};_mcp.bN=function(n,t){this.f=Function.createDelegate(this,this.k);this.c=Function.createDelegate(this,this.i);this.d=Function.createDelegate(this,this.j);_mcp.bN.initializeBase(this,[30,n]);this.h=t};_mcp.bN.prototype={h:null,b:null,a:function(n){this.b=n;this.b.b(this.d);this.b.a(this.c);this.b.c(this.f)},bz:function(){this.l();_mcp.I.prototype.bz.call(this)},l:function(){if(this.b){this.b.e(this.d);this.b.d(this.c);this.b.f(this.f);this.b=null}},k:function(n){var t=n.c();_cmc.B.b(t,this.bk.fd)},j:function(n){var t=n.c();var i=_cmc.B.d(t);_cmc.B.e(i,this.bk.fd);_cmc.B.c(t,this.bk.fd)},i:function(n){var t=n.c();_cmc.B.b(t,this.bk.fd)}};_mcp.bZ=function(n){_mcp.bZ.initializeBase(this,[22,n])};_mcp.bZ.prototype={n:function(){return!1},j:function(){return null},m:function(){return!0},f:function(){return!1},a:function(){return null},K:function(){return null},I:function(){},k:function(n,t){},L:function(n,t){},o:function(){}};_mcp.bG=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et){_a.c.b(e,"nativeBridge");this.a=n;this.c=i;this.b=r;this.w=u;this.t=t;this.h=f;this.e=e;this.f=o;this.n=s;this.p=h;this.q=c;this.s=l;this.y=a;this.l=v;this.g=y;this.m=p;this.o=w;this.i=b;this.D=k;this.d=d;this.x=g;this.B=nt;this.k=tt;this.r=it;this.u=rt;this.j=ft;this.z=ut;this.A=et};_mcp.bG.prototype={a:null,k:null,c:null,b:null,w:null,t:null,h:null,e:null,f:null,n:null,p:null,q:null,y:null,l:null,g:null,m:null,D:null,d:null,r:null,u:null,A:null,z:null,s:null,x:null,B:null,o:null,i:null,j:null,v:function(n,t,i){switch(n){case 0:return new _mcp.L(this.a,this.b,this.l,!!this.f);case 1:return new _mcp.f(this.a,this.c,this.d);case 2:return new _mcp.t(this.a,this.b,this.c,this.d);case 3:return new _mcp.F(this.a,this.f,this.b,this.c,this.d);case 4:return new _mcp.h(this.a,this.m,this.g);case 5:return new _mcp.m(this.a,this.t,this.c,this.b,this.w,this.a.a.dp,this.s,this.z);case 6:return new _mcp.bO(this.a,this.b,this.c,this.d);case 7:return new _mcp.K(this.a,this.b,this.c,this.d,this.a.a.be);case 8:return new _mcp.Y(this.a,this.h,this.b,this.c,this.d);case 9:return new _mcp.bQ(this.a,this.f,this.c,this.d);case 10:if("Mouse"!==t)return new _mcp.bY(this.a,this.k);break;case 11:return new _mcp.o(this.a,this.b,this.c,this.d,this.B);case 38:return new _mcp.bX(this.a);case 12:return new _mcp.R(this.a,this.b,this.c);case 13:if(this.e.b(this.e.f())&&this.e.f().a().f())return new _mcp.bU(this.a,this.e);break;case 20:if(this.e.b(this.e.f())&&this.e.f().a().a())return new _mcp.bS(this.a,this.e);break;case 14:return new _mcp.Z(this.a,this.g);case 15:if("Mouse"===t)return new _mcp.bI(this.a,this.f,this.c,this.d);break;case 16:if("Mouse"===t)return new _mcp.J(this.a);else if("TouchNarrow"===t)return new _mcp.bJ(this.a);break;case 18:return new _mcp.r(this.a,this.d);case 17:return new _mcp.bP(this.a,this.n,this.c);case 29:return new _mcp.bT(this.a,this.p);case 23:return new _mcp.bV(this.a,this.q);case 19:return new _mcp.p(this.a);case 21:if(this.e.b(this.e.m()))return new _mcp.bW(this.a,this.e);break;case 22:return i===3?new _mcp.bZ(this.a):new _mcp.A(this.a,this.a.a.ds);case 24:if(this.b.b())return new _mcp.s(this.a,this.c,this.b,this.y,this.A);break;case 30:if(this.b.b()&&this.b.e())return new _mcp.bN(this.a,this.a.a.be);break;case 25:return t!=="Mouse"?new _mcp.bL(this.a):new _mcp.bK(this.a,this.f,this.c);case 27:if(t==="Mouse")return new _mcp.y(this.a,this.x,this.d);break;case 28:return new _mcp.bR(this.a,this.f,this.c,this.d);case 31:return new _mcp.G(this.a);case 32:if(this.b.c())return new _mcp.bE(this.a,this.b,this.a.a.be,this.r);break;case 34:if(this.c&&this.c.a()&&this.c.a().iL().Enabled)return new _mcp.bM(this.a,this.o,this.i);break;case 35:if(this.b.a().jh().Enabled)return new _mcp.g(this.a,this.b,this.i,this.u);break;case 36:return new _mcp.bD(this.a,this.b,this.c,this.d,this.j);case 37:return new _mcp.bF(this.a,this.b,this.d)}return null}};_mcp.ba=function(n,t){this.c=n;this.d=t};_mcp.ba.prototype={c:!1,d:!1,a:function(){return this.c},b:function(){return this.d}};_mcp.bl=function(){};_mcp.ca=function(){};_mcp.ca.prototype={a:function(n,t){var i=n;return i.bH.TemplateName},b:function(n,t){throw Error.notImplemented();}};_mcp.cb=function(){};_mcp.cb.prototype={a:function(n,t){var r=n;var i=null;switch(r){case"Normal":i=_nbs.a.kB;break;case"Personal":i=_nbs.a.XP;break;case"Private":i=_nbs.a.XZ;break;case"Confidential":i=_nbs.a.x;break;default:i=_nbs.a.kB;break}return i},b:function(n,t){throw Error.notImplemented();}};_mcp.bg=function(n){this.g=Function.createDelegate(this,this.i);_mcp.bg.initializeBase(this);this.f=n;this.h=!0};_mcp.bg.prototype={f:null,c:function(n){this.f.b(_mcp.O,this.g)},b:function(n){this.f.c(_mcp.O,this.g)},i:function(n){this.d(null)}};_mcp.k=function(n){_mcp.k.initializeBase(this,[n])};_mcp.k.prototype={a:null,n:function(){},m:function(){},q:function(n){},o:function(n){},p:function(n){},s:function(n){},r:function(n,t){t.val=3;this.a.a();return!0}};_mcp.e=function(){};_mcp.e.P=function(){return _fm.b.a(_fm.a.G,_fm.WebfontSizes.a.b,"ms-fcl-tp-b")};_mcp.e.N=function(){return _fm.b.a(_fm.a.bZ,_fm.WebfontSizes.a.b,"ms-fcl-tp-b")};_mcp.e.O=function(){return _fm.b.a(_fm.a.bZ,_fm.WebfontSizes.a.a,"ms-fcl-nd-b")};_mcp.e.j=function(){return _fm.b.a(_fm.a.i,_fm.WebfontSizes.a.b,"ms-fcl-tp-b")};_mcp.e.t=function(){return _fm.b.a(_fm.a.D,_fm.WebfontSizes.a.b,"ms-fcl-tp-b")};_mcp.e.u=function(){return _fm.b.a(_fm.a.D,_fm.WebfontSizes.a.b,"ms-fcl-nt-b")};_mcp.e.s=function(){return _fm.b.a(_fm.a.D,_fm.WebfontSizes.a.f,"ms-fcl-ns-b")};_mcp.e.v=function(){return _fm.b.a(_fm.a.D,_fm.WebfontSizes.a.f,"ms-fcl-nd-b")};_mcp.e.w=function(){return _fm.b.a(_fm.a.D,_fm.WebfontSizes.a.d,"ms-fcl-ns-b")};_mcp.e.K=function(){return _fm.b.a(_fm.a.H,_fm.WebfontSizes.a.b,"ms-fcl-ns-b")};_mcp.e.L=function(){return _fm.b.a(_fm.a.H,_fm.WebfontSizes.a.d,"ms-fcl-tp-b")};_mcp.e.M=function(){return _fm.b.a(_fm.a.H,_fm.WebfontSizes.a.b,"ms-fcl-nd-b")};_mcp.e.A=function(){return _fm.b.a(_fm.a.a,_fm.WebfontSizes.a.a,"ms-fcl-tp-b")};_mcp.e.B=function(){return _fm.b.a(_fm.a.a,_fm.WebfontSizes.a.b,"ms-fcl-nsa-b")};_mcp.e.G=function(){return _fm.b.a(_fm.a.t,_fm.WebfontSizes.a.g,"ms-fcl-ns-b")};_mcp.e.I=function(){return _fm.b.a(_fm.a.t,_fm.WebfontSizes.a.g,"ms-fcl-nd-b")};_mcp.e.a=function(){return _fm.b.a(_fm.a.F,_fm.WebfontSizes.a.g,"ms-fcl-ns-b")};_mcp.e.h=function(){return _fm.b.a(_fm.a.F,_fm.WebfontSizes.a.g,"ms-fcl-nd-b")};_mcp.e.H=function(){return _fm.b.a(_fm.a.t,_fm.WebfontSizes.a.g,"ms-fcl-nta-b")};_mcp.e.J=function(){return _fm.b.a(_fm.a.t,_fm.WebfontSizes.a.g,"ms-fcl-tp-b")};_mcp.e.f=function(){return _fm.b.a(_fm.a.c,_fm.WebfontSizes.a.a,"ms-fcl-ns-b")};_mcp.e.g=function(){return _fm.b.a(_fm.a.c,_fm.WebfontSizes.a.a,"ms-fcl-nd-b")};_mcp.e.c=function(){return _fm.b.a(_fm.a.T,_fm.WebfontSizes.a.a,"ms-fcl-ns-b")};_mcp.e.d=function(){return _fm.b.a(_fm.a.c,_fm.WebfontSizes.a.a,"ms-fcl-ns-b","ms-fcl-ns-b")};_mcp.e.e=function(){return _fm.b.a(_fm.a.c,_fm.WebfontSizes.a.a,"ms-bgc-ns","ms-fcl-ns-b","ms-fcl-w-b")};_mcp.e.z=function(){return _fm.b.a(_fm.a.cY,_fm.WebfontSizes.a.f,"ms-fcl-ns-b")};_mcp.e.b=function(){return _fm.b.a(_fm.a.i,_fm.WebfontSizes.a.g,"ms-fcl-ns-b")};_mcp.e.x=function(){return _fm.b.a(_fm.a.i,_fm.WebfontSizes.a.g,"ms-fcl-nd-b")};_mcp.e.y=function(){return _fm.b.a(_fm.a.i,_fm.WebfontSizes.a.g,"ms-fcl-td-b")};_mcp.e.i=function(){return _fm.b.a(_fm.a.i,_fm.WebfontSizes.a.g,"ms-fcl-nta-b")};_mcp.e.n=function(){return _fm.b.a(_fm.a.bg,_fm.WebfontSizes.a.b,"ms-fcl-ns-b")};_mcp.e.o=function(){return _fm.b.a(_fm.a.bg,_fm.WebfontSizes.a.b,"ms-fcl-nd-b")};_mcp.e.p=function(){return _fm.b.a(_fm.a.bg,_fm.WebfontSizes.a.b,"ms-fcl-td-b")};_mcp.e.q=function(){return _fm.b.a(_fm.a.h,"ms-fcl-ns-b")};_mcp.e.F=function(){return _fm.d.a("insertpicture.png")};_mcp.e.k=function(){return _fm.b.a(_fm.a.bA,_fm.WebfontSizes.a.b,"ms-fcl-ns-b")};_mcp.e.l=function(){return _fm.b.a(_fm.a.bA,_fm.WebfontSizes.a.b,"ms-fcl-nd-b")};_mcp.e.m=function(){return _fm.b.a(_fm.a.bA,_fm.WebfontSizes.a.b,"ms-fcl-td-b")};_mcp.e.r=function(){return _fm.b.a(_fm.a.a,_fm.WebfontSizes.a.c)};_mcp.e.E=function(){return _fm.b.a(_fm.a.e,_fm.WebfontSizes.a.c)};_mcp.e.Q=function(){return _fm.b.a(_fm.a.fc,_fm.WebfontSizes.a.c)};_mcp.e.D=function(){return _fm.b.a(_fm.a.G,_fm.WebfontSizes.a.a)};_mcp.e.C=function(){return _fm.b.a(_fm.a.Trash,_fm.WebfontSizes.a.a)};_mcp.cq=function(n,t,i,r,u,f,e,o){this.fp=Function.createDelegate(this,this.gK);this.fs=Function.createDelegate(this,this.gS);this.dH=Function.createDelegate(this,this.gP);this.dI=Function.createDelegate(this,this.cK);this.dG=Function.createDelegate(this,this.gM);this.fq=Function.createDelegate(this,this.gL);_mcp.cq.initializeBase(this,[n,"Mouse",t,i,r,u,f,e]);this.cm=u;this.bi=t;this.dJ=r;this.cQ=o};_mcp.cq.prototype={dJ:null,bP:!1,bc:!1,cc:!1,bQ:null,cO:null,bv:!1,cQ:null,gQ:function(n){this.bP=n;this.bA("EnableRichTextOptions","ShowOneRibbon");this.cK();return n},x:function(){return _mcp.d.isInstanceOfType(this.V())&&this.V().bn()},cs:function(n){this.bc=n;this.fy();return n},ft:function(){return this.cc&&!this.bc},cM:function(n){this.cc=n;this.fy();return n},gE:function(){return!this.x()&&this.cc&&!this.bc},gI:function(){return!this.x()&&!this.cc&&!this.bc},gD:function(){return this.x()||this.bc},fv:function(){return!this.bc&&!this.cc},gF:function(){return this.bi.g()},gG:function(){return this.bi.h()},fu:function(){return this.bi.b()||this.bi.h()},dK:function(){return this.gJ()},cm:null,bi:null,cp:function(){return this.bv&&this.bP},gR:function(n){if(this.bv!==n){this.bv=n;this.by("ShowOneRibbon")}return n},fw:function(){this.bQ||(this.bQ=new _zz.G(this.u(),this.cd(),"OneRibbon"));return this.bQ},bl:function(){var n=this.V();return this.x()?_mcp.i.prototype.bl.call(this):250},l:null,gH:function(){return!!this.V()&&_mcp.E.isInstanceOfType(this.V())&&!!this.V().ba&&this.V().ba.ct()},E:function(){_mcp.i.prototype.E.call(this);this.cN();if(this.l){var n=this.x();var i=n&&!!this.cQ&&this.cQ.a().n()==="ChronologicalNewestOnBottom";var t=this.gH()?160:0;this.l.j(this.h.InlineComposeBody,this.u(),this.h.InlineComposeHeaderWrapper,this.h.InlineComposeBottomEdge,this.h.OneRibbonFiller,this.h.AttachmentWellViewWrapper,n,i,t);this.u()&&this.u().eR(this.l);this.h.EditorFocusHandler&&this.h.EditorFocusHandler.bf("focus",this.fq,"MailComposeDockableView");this.l.b(this.dG);this.l.e(this.dI);this.l.e(this.dH)}},H:function(){_mcp.i.prototype.H.call(this);if(this.B){this.h.InlineComposeBottomEdge=this.B.a("InlineComposeBottomEdge");this.h.InlineComposeBody=this.B.a("InlineComposeBody");this.h.InlineComposeHeaderWrapper=this.B.a("InlineComposeHeaderWrapper");this.h.OneRibbonFiller=this.B.a("OneRibbonFiller");this.h.OneRibbon=this.B.a("OneRibbon");this.h.Emoji=this.B.a("Emoji");this.h.EditorFocusHandler=this.B.a("EditorFocusHandler")}else{this.h.InlineComposeBottomEdge=null;this.h.InlineComposeBody=null;this.h.InlineComposeHeaderWrapper=null;this.h.OneRibbonFiller=null;this.h.OneRibbon=null;this.h.Emoji=null;this.h.EditorFocusHandler=null}},bu:function(){_mcp.i.prototype.bu.call(this);if(this.bQ){this.bQ.dispose();this.bQ=null}if(this.l){this.l.a(this.dG);this.l.f(this.dI);this.l.f(this.dH);this.l.i()}this.h.EditorFocusHandler&&this.h.EditorFocusHandler.bj("focus","MailComposeDockableView")},eU:function(n,t){_mcp.i.prototype.eU.call(this,n,t);this.cN()},cA:function(n){_mcp.i.prototype.cA.call(this,n);this.cs(!0)},eQ:function(n){switch(n.c()){case 7:if(!this.cp()){this.j("SendButton");n.a(!0)}break;case 14:this.gb();break;default:_mcp.i.prototype.eQ.call(this,n);break}},cN:function(){this.gQ(this.bR)},cK:function(){if(this.h){var n=this.h.OneRibbon;var t=this.h.OneRibbonFiller;if(n&&t){this.cp()&&n.bl();n.K(!this.cp())}}},fx:function(){this.cO||(this.cO=new _j.g(this.fs,this.I()));return this.cO},ch:function(n){_mcp.i.prototype.ch.call(this,n);this.cK()},gS:function(){if(this.bP){this.bv=!this.bv;this.l&&this.l.n(this.fp,this.h.InlineComposeBottomEdge.z);this.by("ShowOneRibbon");this.cK();this.bv&&this.h.OneRibbon.br()}},gK:function(){var n=this.bv?_zz.e.d(50):"0px";this.h.OneRibbonFiller.z.style.height=n},gM:function(){if(this.h){this.dL(this.h.ToReadWriteRecipientWellView);this.dL(this.h.CcReadWriteRecipientWellView);this.dL(this.h.BccReadWriteRecipientWellView)}},gL:function(n){n.c();n.d();this.j("EditorControl")},dL:function(n){if(_j.c.isInstanceOfType(n)){var t=n.V();t&&t.H().B(!1)}},gJ:function(){var n=null;var t=this.dJ.a();var u=t.jy().Enabled;var f=t.jz().Enabled;var i=t.jA().Enabled;var r=this.V();if((u||f||i)&&!r.bS().a()&&!r.ba.a()){var e=Math.floor(Math.random()*1001);e<200&&(u?n=_u.n.BS:f?n=_u.n.Jg:i&&(n=_u.n.Rc))}_j.h.a(n)&&(n=_u.n.Gr);return n},fy:function(){this.bX(["HighlightEditorBorder","HoverOnEditor","HoverOnEditorTopBorder","NormalEditorTopBorder","HighlightEditorTopBorder","NormalEditorBorder"])},gP:function(){this.cm.a(_mco.be.a,new _mco.be.a("MailComposeDockableView.RaiseComposeRecalcEvent"))}};_mcp.l=function(n){_mcp.l.initializeBase(this,[n])};_mcp.l.prototype={a:null,b:function(){this.a&&_rw.b.a(this.a.z)},H:function(){_j.c.prototype.H.call(this);this.a=this.B?this.B.a("FromPersona"):null}};_mcp.U=function(n,t){_mcp.U.initializeBase(this,[n]);this.i=t};_mcp.U.prototype={m:!1,i:null,h:null,l:!1,j:!1,n:null,k:null,o:function(n){if(n!==this.m){this.m=n;this.by("ReadyToScroll")}return n},t:function(){return _mcp.d.isInstanceOfType(this.V())?this.V().cU:!1},s:function(){return _mcp.d.isInstanceOfType(this.V())?this.V().cl:!1},p:function(){return this.t()||this.s()},q:function(){return this.i.g()},r:function(){return this.i.h()},H:function(){_j.c.prototype.H.call(this);if(this.B){this.h=this.B.a("ComposeControlId");this.h.be=this.B.a("ComposeAppsPane");if(this.l){this.n=null;this.l=!1}if(this.j){this.h.d(this.k);this.k=null;this.j=!1;this.o(!0)}}else if(this.h){this.h.be=null;this.h=null}},G:function(){this.h.l=new _cmc.j(this.B.a("scrollRegionId"),this.B.a("TopDockPanelId"),this.B.a("bottomDockPanelId"),this.V().bw,1,this.i);this.h.l.d(this.h);_j.c.prototype.G.call(this)},M:function(){if(this.h&&this.h.l){this.h.l.c();this.h.l=null}_j.c.prototype.M.call(this)},d:function(n){if(this.h){this.h.d(n);this.o(!0)}else{this.k=n;this.j=!0}},e:function(){this.h.e()},f:function(n){if(!this.h){this.n=n;this.l=!0}},g:function(){this.h.g()},c:function(){return this.h.c()},b:function(n){this.h.b(n)},a:function(n){this.h.a(n)}};_mcp.i=function(n,t,i,r,u,f,e,o){this.eE=Function.createDelegate(this,this.ig);this.ed=Function.createDelegate(this,this.hD);this.eq=Function.createDelegate(this,this.hN);this.fM=Function.createDelegate(this,this.im);this.fB=Function.createDelegate(this,this.he);this.fE=Function.createDelegate(this,this.ik);this.fL=Function.createDelegate(this,this.il);this.cV=Function.createDelegate(this,this.hT);this.fz=Function.createDelegate(this,this.gT);this.dO=Function.createDelegate(this,this.eL);this.dS=Function.createDelegate(this,this.eQ);this.dN=Function.createDelegate(this,this.hf);this.dQ=Function.createDelegate(this,this.hh);this.dP=Function.createDelegate(this,this.hg);this.dW=Function.createDelegate(this,this.hi);this.dR=Function.createDelegate(this,this.cA);this.eB=Function.createDelegate(this,this.ic);this.es=Function.createDelegate(this,this.hP);this.ew=Function.createDelegate(this,this.hU);this.er=Function.createDelegate(this,this.hO);this.cy=Function.createDelegate(this,this.fV);this.dX=Function.createDelegate(this,this.hv);this.dZ=Function.createDelegate(this,this.hx);this.dY=Function.createDelegate(this,this.hw);this.ey=Function.createDelegate(this,this.ia);this.da=Function.createDelegate(this,this.hZ);this.cZ=Function.createDelegate(this,this.hY);this.cX=Function.createDelegate(this,this.hX);this.cW=Function.createDelegate(this,this.hW);this.ej=Function.createDelegate(this,this.hF);this.db=Function.createDelegate(this,this.ib);this.cS=Function.createDelegate(this,this.hG);this.cu=Function.createDelegate(this,this.hA);this.cR=Function.createDelegate(this,this.hC);this.et=Function.createDelegate(this,this.fU);this.eC=Function.createDelegate(this,this.id);this.eo=Function.createDelegate(this,this.hL);this.eD=Function.createDelegate(this,this.ie);this.cx=Function.createDelegate(this,this.hS);this.eb=Function.createDelegate(this,this.hz);this.ep=Function.createDelegate(this,this.hM);this.ea=Function.createDelegate(this,this.hy);this.ev=Function.createDelegate(this,this.hR);this.eu=Function.createDelegate(this,this.hQ);this.ex=Function.createDelegate(this,this.hV);this.ec=Function.createDelegate(this,this.hB);this.em=Function.createDelegate(this,this.hK);this.ek=Function.createDelegate(this,this.hI);this.el=Function.createDelegate(this,this.hJ);this.eF=Function.createDelegate(this,this.ii);this.eG=Function.createDelegate(this,this.ij);this.ct=Function.createDelegate(this,this.gX);this.dd=Function.createDelegate(this,this.io);this.bd=Function.createDelegate(this,this.fO);this.fA=Function.createDelegate(this,this.gY);this.fD=Function.createDelegate(this,this.hj);this.cT=Function.createDelegate(this,this.hH);this.ei=Function.createDelegate(this,this.hE);this.en=Function.createDelegate(this,this.eU);this.fC=Function.createDelegate(this,this.dm);this.dc=Function.createDelegate(this,this.ih);this.r={};_mcp.i.initializeBase(this,[n]);this.n=t;this.w=i;this.eI=r;this.df=u;this.q=f;this.bZ=e;this.eS=o;this.h={};_j.e.a(_a.a.a,"View created with layout={0}",this.n)};_mcp.i.prototype={bR:!1,w:null,eI:null,df:null,p:null,s:null,m:null,cB:null,k:null,bs:!1,du:!1,dq:!1,dn:!1,cj:!1,cH:!1,cJ:!1,bW:!1,dE:!1,cG:!1,bY:!1,dr:!1,cf:!1,dt:!1,bZ:null,q:null,eS:null,bJ:!1,ds:!1,bU:null,de:null,cC:null,eT:!1,bg:null,ci:!1,dv:0,eX:0,eY:0,eW:0,u:function(){return this.h?this.h.EditorControl:null},bl:function(){var n;n=this.n==="TouchNarrow"?50:100;return n},dk:function(){var t=this.n==="Mouse"||this.eJ()?1:3;if(this.i())if(this.i().bn())t=2;else{var n=this.i().ba;this.n==="Mouse"||this.eJ()||n.l()&&(n.a()===1||n.a()===2||n.a()===3)&&(t=2)}return t},t:function(n){if(this.m!==n){this.ix(n,this.m);this.m=n;this.iy()}return n},eZ:function(n){if(this.de!==n){this.de=n;this.q.a(_y.bO,new _y.bO(this.de))}return n},fR:function(){return this.w.E()?"":_nbs.a.tF},hc:function(){return _y.c.a.i()||this.n==="Mouse"?!1:this.du},dD:function(n){if(this.du!==n){this.du=n;this.by("IsToRecipientWellPeoplePickerButtonShown")}return n},fQ:function(){return _y.c.a.i()||this.n==="Mouse"?!1:this.dq},dx:function(n){if(this.dq!==n){this.dq=n;this.by("IsCcRecipientWellPeoplePickerButtonShown")}return n},fP:function(){return _y.c.a.i()||this.n==="Mouse"?!1:this.dn},dw:function(n){if(this.dn!==n){this.dn=n;this.by("IsBccRecipientWellPeoplePickerButtonShown")}return n},h:null,n:0,cz:null,fH:function(){return!0},cF:function(n){if(this.bY!==n){this.bY=n;this.by("IsReadyToShowContent")}return n},fl:function(n){if(this.cf!==n){this.cf=n;this.by("IsReadyToShowEditor");this.cf&&this.fm()}return n},fk:function(n){if(this.dr!==n){this.dr=n;this.by("IsReadyToShowAppBarContent")}return n},v:function(n){if(this.bs!==n){this.bs=n;this.by("ShouldPreventShiftTabDefault")}return n},ip:function(n){this.dt=n;this.by("IsTabAnchorNeeded");return n},eJ:function(){return this.eI.b()},gZ:function(){return!this.w.a()||this.n!=="TouchNarrow"},I:function(){return _a.a.a},cd:function(){!this.cC&&this.V()&&this.V().bN()&&(this.cC=this.V().d());return this.cC},hd:function(){return!!this.i()&&this.i().et()&&!!this.h.FloatLeftWrapper&&!!this.h.FloatRightWrapper&&!!this.h.Emoji},fa:function(n){if(this.bJ!==n){this.bJ=n;this.ca();this.bD()}return n},fX:function(){this.cB?this.j(this.cB):this.iq()},iq:function(){if(!this.V()){_j.e.a(_a.a.a,"No data context yet, skipping set initial focus");return}if(this.it()){_j.e.a(_a.a.a,"Queue task to set initial focus to To well.");this.eH();this.r&&this.r.ToRecipientWellControl&&this.r.ToRecipientWellControl.removeAttribute("disabled");if(this.w.a()||this.w.e()){var n=this.h.ComposeViewContent;n.K(!1)}this.j("ToRecipientWellControl")}else if(this.ga()){_j.e.a(_a.a.a,"Set initial focus to subject. ");this.j("SubjectTextBox")}else{_j.e.a(_a.a.a,"Set initial focus to body. ");this.ir()}},it:function(){return this.i().bd().s()<1},ga:function(){return _j.h.a(this.h.SubjectTextBox.b)},f:function(n){},d:function(n){this.dE=!this.V();if(this.dE)_j.e.a(_a.a.a,"PostTransitionIn with null DataContext.");else{var t=this.i().bA();if(!t)return;if(t.e()){this.cG=!!this.h.EditorControl;this.cG?this.Z()?this.i().bN()&&!this.i().cO?this.i().apcl("IsReadyForViewInitialization",this.dc):this.E():_j.e.a(_a.a.a,"PostTransitionIn view not active yet. "):_j.e.a(_a.a.a,"PostTransitionIn template not applied yet. ")}else this.fZ(t,this.i().ba);this.n==="Mouse"&&this.i().fc()}this.bW=!0},g:function(){this.bW=!1;_j.e.a(_a.a.a,"PreTransitionOut view");var n=this.m;this.cB=n;if(n&&n in this.h)switch(n){case"FromFieldControl":case"ToRecipientWellControl":case"CcRecipientWellControl":case"BccRecipientWellControl":case"SubjectTextBox":this.eH();this.cj=!0;var t=this.r[n];if(t===document.activeElement){_j.e.a(_a.a.a,"Blur from {0}",n);t.blur()}this.m=null;this.cj=!1;break;case"EditorControl":this.cj=!0;this.h.EditorControl.cW();this.m=null;this.cj=!1;break}else _j.e.a(_a.a.a," Skip pre-transition out focus related processing for current focused control {0}, since it's not present in the controls dictionary",n)},e:function(){_j.e.a(_a.a.a,"PostTransitionOut view");this.dD(!0);this.dx(!1);this.dw(!1);this.fW();this.cF(!1);this.fl(!1);this.fk(!1)},R:function(){this.br();return!0},be:null,c:function(){return this.i().bf.b(5).f()},hb:function(){return this.i()?this.i().fw()&&this.n==="TouchNarrow":!1},ha:function(){return this.w.a()},b:function(n){if(this.i()){_cmc.f.g(n.a(),JsonParser.serialize(n))&&n.b(_cmc.f.e(n.a(),this.i().ba.k()));this.i().bc().M(_db.F.a(n))}},a:function(n){if(this.i()&&this.i().bc()&&this.i().bc().a()){var t=this.i().bc().a();t.N(n.d());t.O(n.c());t.M(n.b());t.co(n.f());t.cn(n.e());t.Q(n.a());t.p().a()}},bz:function(){_j.e.a(_a.a.a,"Disposing view");this.iv();this.iz();this.bu();this.r=null;this.h=null;this.m=null;if(this.i()){var t=this.i().bm();if(t&&!t.c())_j.e.a(_a.a.a,"MailComposeView.InternalDispose - Skipping post-transition out processing because either the navigation component is null or IsNavigatingAwayFromCompose is false.");else{var n=this.i().bg();n&&!n.k()&&this.i().dispose()}}if(this.ci){this.gc();this.ci=!1}_j.c.prototype.bz.call(this)},H:function(){_j.c.prototype.H.call(this);var n=this.B;var t=null;this.V()&&(t=this.V());if(n){this.h.SubjectTextBox=n.a("SubjectTextBox");this.h.FromFieldControl=n.a("FromFieldControl");this.h.ToRecipientWellControl=n.a("ToRecipientWellControl");this.h.CcRecipientWellControl=n.a("CcRecipientWellControl");this.h.BccRecipientWellControl=n.a("BccRecipientWellControl");var i=n.a("EditorControl");this.h.EditorControl=i;this.h.ComposeViewContent=n.a("ComposeViewContent");this.h.CancelConfirmDialog=n.a("CancelConfirmDialog");this.h.MessageBox=n.a("MessageBox");this.h.ComposeDockPanel=n.a("ComposeDockPanel");this.h.ToRecipientButton=n.a("ToRecipientButton");this.h.CcRecipientButton=n.a("CcRecipientButton");this.h.BccRecipientButton=n.a("BccRecipientButton");this.h.ToReadWriteRecipientWellView=n.a("ToReadWriteRecipientWellView");this.h.CcReadWriteRecipientWellView=n.a("CcReadWriteRecipientWellView");this.h.BccReadWriteRecipientWellView=n.a("BccReadWriteRecipientWellView");this.h.QuotedBodyHtmlLabel=n.a("QuotedBodyHtmlLabel");this.h.AttachmentWellViewWrapper=n.a("AttachmentWellViewWrapper");this.h.OnDemandUpgradeContainer=n.a("OnDemandUpgradeContainer");i.fE=!1;if(this.n==="Mouse"){this.h.SendButton=n.a("SendButton");this.h.DiscardButton=n.a("DiscardButton");this.h.InsertButton=n.a("InsertButton");this.h.ComposeResponsivnessWrapper=n.a("ComposeResponsivnessWrapper");this.h.FloatLeftWrapper=n.a("FloatLeftWrapper");this.h.FloatRightWrapper=n.a("FloatRightWrapper");this.h.Emoji=n.a("Emoji");t.bn()||(this.h.AppsButton=n.a("AppsButton"));this.h.AffordanceMenuButton=n.a("AffordanceMenuButton");this.h.OpenSeperateWindowButton=n.a("OpenSeperateWindowButton");this.be=this.be||n.a("ComposeAppsPane");this.bR=t.ba.h()==="HTML"}this.cz=new _j.g(this.fC,this.I());this.is();if(this.bW&&!this.cG){_j.e.a(_a.a.a,"Applied template, already in view and template was not applied at PostTransitionIn, calling PostTransitionIn. ");this.d(null)}else _j.e.a(_a.a.a,"Applying template. ");this.h.EditorControl&&this.h.EditorControl.apcl("IsPlainTextContent",this.en);this.gw()}else{_j.e.a(_a.a.a,"Applying null template. ");this.h.SubjectTextBox=null;this.h.FromFieldControl=null;this.h.ToRecipientWellControl=null;this.h.CcRecipientWellControl=null;this.h.BccRecipientWellControl=null;this.h.EditorControl=null;this.h.CancelConfirmDialog=null;this.h.MessageBox=null;this.h.ComposeDockPanel=null;this.h.AttachmentWellViewWrapper=null;this.h.OnDemandUpgradeContainer=null}this.u()&&this.h.OnDemandUpgradeContainer&&(this.u().eD=this.h.OnDemandUpgradeContainer)},bC:function(){var t=new _b.e(this.eS);t.j("ShowAddressBook");var r=this;t.l=new _j.g(function(){r.j("ToRecipientWellControl")},this.I());var n=new _fc.g;n.a([t]);var i=_j.i.prototype.bC.call(this);this.A(-1);return i?i.concat(n):[n]},Y:function(){_j.i.prototype.Y.call(this);if(this.V()){var t=this.i().ba;var n=this.i().bA();if(n){t.apcl("IsUpgraded",this.ei);this.bR=t.h()==="HTML";if(this.dE)if(n.e()){_j.e.a(_a.a.a,"DataContext updated, PostTransitionIn with null DataContext and view model initialized, call PostTransitionIn");this.d(null)}else this.fZ(n,t);n.c()||n.apcl("IsSecondInitializationComplete",this.cT);this.i().bd().bg(this.fD)}else this.i().fm||_j.e.b(_a.a.a,"MailCompseView.OnDataContextUpdated -- InitializerComponent should not be null if the state is not disposing..")}else _j.e.a(_a.a.a,"Updated DataContext to null")},G:function(){_j.c.prototype.G.call(this);if(this.bW&&this.V()&&this.cG){var n=this.i().bA();n.e()&&this.E()}this.V()&&!this.V().bN()&&(_fc.g.a=this);if(this.hd()){this.bg||this.ht();this.gW();this.ci=!0}},M:function(){this.fW();this.V()&&!this.V().bN()&&(_fc.g.a=null);if(this.ci){this.gc();this.iw();this.ci=!1}_j.c.prototype.M.call(this)},bS:function(){if(this.cJ){_j.e.a(_a.a.a,"Events already bound. ");return}if(this.w.a()){_j.k.b(window.document.body,"mousedown",this.fA,"MailComposeView");var f=this;_j.m.a().a(_a.a.a,"RemoveBodyFocusHandler",function(){_j.k.c(window.document.body,"mousedown","MailComposeView")},1e3)}this.p=new _j.q;if(this.n==="Mouse"){this.p.c(new _mcp.i.a("DiscardButton",this.bd));this.p.c(new _mcp.i.a("InsertButton",this.bd));this.i().bn()||this.p.c(new _mcp.i.a("AppsButton",this.bd));this.p.c(new _mcp.i.a("AffordanceMenuButton",this.bd));this.p.c(new _mcp.i.a("OpenSeperateWindowButton",this.bd));this.p.c(new _mcp.i.a("ToRecipientButton",this.bd))}this.p.c(new _mcp.i.a("SubjectTextBox",this.bd));this.p.c(new _mcp.i.a("FromFieldControl",this.bd));this.p.c(new _mcp.i.a("ToRecipientWellControl",this.dd));this.p.c(new _mcp.i.a("CcRecipientWellControl",this.dd));this.p.c(new _mcp.i.a("BccRecipientWellControl",this.dd));this.p.c(new _mcp.i.a("AttachmentWellViewWrapper",this.bd));this.s=new _j.q;this.s.c(new _mcp.i.a("FromFieldControl",this.ct));this.s.c(new _mcp.i.a("ToRecipientWellControl",this.ct));this.s.c(new _mcp.i.a("CcRecipientWellControl",this.ct));this.s.c(new _mcp.i.a("BccRecipientWellControl",this.ct));if(this.i().bN()){var n=this.cd();n.addEventListener("focus",this.eG,!0);n.addEventListener("blur",this.eF,!0);n.addEventListener("dragover",this.el,!0);n.addEventListener("dragleave",this.ek,!0);n.addEventListener("drop",this.em,!0)}else{for(var i=0;i<this.p.d.length;i++){var u=this.h[this.p.d[i].a];u&&_j.k.b(u.z,"focusin",this.p.d[i].c())}for(var t=0;t<this.s.d.length;t++)_j.k.b(this.h[this.s.d[t].a].z,"focusout",this.s.d[t].c())}this.fN();this.h.CancelConfirmDialog.apcl("IsHidden",this.ec);this.h.MessageBox.apcl("IsHidden",this.ex);this.i().bc().a()&&(this.bJ=!this.i().bc().a().m());this.bD();this.i().bb.apcl("ActionPerformed",this.eu);this.i().bb.apcl("Count",this.ev);this.i().bc().i(this.ea);if(this.bZ.b(this.bZ.d())&&this.n==="TouchWide"){var r=this.i().bj().a();if(r){r.j(this.ep);r.x(this.eb)}}this.i().bh.apcl("IsShown",this.cx);this.i().bq().apcl("IsDiscardConfirmDialogShown",this.cx);this.i().ba.apcl("SelectedDataCallContext",this.eD);this.i().ba.apcl("EditorCallContext",this.eo);this.i().bj().apcl("RequestCloseComposeForm",this.eC);this.h.FromFieldControl.apcl("IsHidden",this.et);this.h.CcRecipientWellControl.apcl("IsHidden",this.cR);this.h.BccRecipientWellControl.apcl("IsHidden",this.cu);this.gV();this.cJ=!0},bu:function(){var u=null;var f=null;if(this.i()){f=this.i().bA();if(f){f.rpcl("IsInitialized",this.cS);f.rpcl("IsSecondInitializationComplete",this.cT)}else _j.e.b(_a.a.a,"MailComposeView.UnbindEvent - InitializerComponent was null.");u=this.i().ba;u?u.rpcl("IsUpgraded",this.ei):_j.e.b(_a.a.a,"MailComposeView.UnbindEvent - Context was null.");this.i().rpcl("ReadyToSetInitialFocus",this.db)}if(!this.cJ){_j.e.a(_a.a.a,"Events aren't bound. ");return}if(this.h){this.h.CancelConfirmDialog&&this.h.CancelConfirmDialog.rpcl("IsHidden",this.ec);this.h.MessageBox&&this.h.MessageBox.rpcl("IsHidden",this.ex);this.ca();this.h&&this.h.BccRecipientWellControl&&this.h.BccRecipientWellControl.rpcl("IsHidden",this.cu);this.h.CcRecipientWellControl&&this.h.CcRecipientWellControl.rpcl("IsHidden",this.cR);this.h.FromFieldControl&&this.h.FromFieldControl.rpcl("IsHidden",this.et);if(this.i()&&this.i().bN()){var n=this.cd();if(n&&!n.closed)try{n.removeEventListener("focus",this.eG,!0);n.removeEventListener("blur",this.eF,!0);n.removeEventListener("dragover",this.el,!0);n.removeEventListener("dragleave",this.ek,!0);n.removeEventListener("drop",this.em,!0)}catch(y){}}else{for(var e=0;e<this.p.d.length;e++)this.h[this.p.d[e].a]&&_j.k.c(this.h[this.p.d[e].a].z,"focusin");for(var t=0;t<this.s.d.length;t++)this.h[this.s.d[t].a]&&_j.k.c(this.h[this.s.d[t].a].z,"focusout")}this.h.EditorControl&&this.h.EditorControl.rpcl("IsPlainTextContent",this.en)}if(this.i()){_j.e.a(_a.a.a,"Unbind view events on view model. ");this.i().by()&&this.i().by().a()&&this.i().by().a().rpcl("IsShown",this.ej);var r=this.i().cc();if(r){r.rpcl("DialogViewModel",this.cW);r.a()&&r.a().rpcl("IsShown",this.cX)}var i=this.i().cd();if(i){i.rpcl("DialogViewModel",this.cZ);i.a()&&i.a().rpcl("IsShown",this.da)}var c=this.i().bd();c&&c.rpcl("IsPeoplePickerShown",this.ey);var l=this.i().bc();if(l){l.h(this.ea);if(this.i().bc().a()){this.i().bc().a().w(this.dY);this.i().bc().a().ck(this.dZ)}}if(this.bZ.b(this.bZ.d())&&this.n==="TouchWide"){var o=this.i().bj().a();if(o){o.v(this.ep);o.K(this.eb)}}var h=this.i().bj();h&&h.rpcl("RequestCloseComposeForm",this.eC);if(u){this.i().ba.rpcl("SelectedDataCallContext",this.eD);this.i().ba.rpcl("EditorCallContext",this.eo)}var s=this.i().bb;if(s){s.rpcl("ActionPerformed",this.eu);s.rpcl("Count",this.ev)}var v=this.i().bh;v&&this.i().bh.rpcl("IsShown",this.cx);var a=this.i().bq();a&&this.i().bq().rpcl("IsDiscardConfirmDialogShown",this.cx);this.i().rpcl("IsReadyForViewInitialization",this.dc)}this.iA();this.cJ=!1},ch:function(n){if(n===1){var i="ComposeAppsPane";var t=this.h[i];t&&t.bp()&&this.j("ToRecipientWellControl")}this.fm();this.eV()},cA:function(n){_j.e.a(_a.a.a,"Focused in the RTE");this.m!=="EditorControl"&&this.t("EditorControl")},fO:function(n,t){var i=t.uiComponent;this.dj(i)},io:function(n,t){this.fO(n,t);this.eR()},gX:function(n,t){_j.e.a(_a.a.a,"User blured from {0}",this.m);if(this.V()&&_mcp.d.isInstanceOfType(this.V())&&!this.cj&&!this.V().bP){var i=this.V().bd();if(this.m==="FromFieldControl"&&i&&i.n()){var o=i.n().c();_j.h.a(o)||i.N(o,!0)}var r=null;var s=!0;switch(this.m){case"ToRecipientWellControl":r=this.h.ToReadWriteRecipientWellView;break;case"CcRecipientWellControl":r=this.h.CcReadWriteRecipientWellView;break;case"BccRecipientWellControl":r=this.h.BccReadWriteRecipientWellView;break;default:s=!1;break}if(s&&r&&i&&i.m()){var e=r.V();e&&!e.fm&&e.H()&&!e.H().cr()&&i.m().g()}if(_a.cD.a){var f=this;_j.m.a().a(this.I(),"Delayed MailTips retrieval",function(){if(f.V()&&!f.bM&&!f.bT){var n=f.V().de();n&&n.a(1)}},100)}if(_a.bu.a){var u=this;_j.m.a().a(this.I(),"Delayed PolicyTips retrieval",function(){if(u.V()&&!u.bM&&!u.bT){var n=u.V().df();n&&n.a(1)}},100)}}},br:function(){if(this.h&&this.Z()&&this.bW&&this.m&&this.V()&&!this.V().bP){_j.e.a(_a.a.a,"Restore focus to {0}",this.m);this.j(this.m)}else _j.e.a(_a.a.a,"Skip restore focus, controls={0}; Active={1}; InView={2}; Name={3}; VM={4}",this.h?"non-null":"null",this.Z(),this.bW,this.m,this.V()?"non-null":"null")},j:function(n){this.eH();switch(n){case"SubjectTextBox":case"BccRecipientWellControl":case"CcRecipientWellControl":case"ToRecipientWellControl":case"FromFieldControl":if(this.r&&this.r[n]){this.r[n].focus();this.t(n);this.eR()}break;case"EditorControl":if(this.h&&this.h[n]){var i=this.h.EditorControl;i.bi(new _cmc.F(!1));this.t(n)}break;case"ToRecipientButton":case"CcRecipientButton":case"BccRecipientButton":case"OpenSeperateWindowButton":case"SendButton":case"DiscardButton":case"InsertButton":case"AppsButton":if(this.h&&this.o(n)){this.h[n].R();this.t(n)}break;case"AttachmentWellViewWrapper":var t=this.V().bc();if(this.h&&this.o(n)&&this.V()&&t&&t.x()>0){this.h[n].R();this.t(n)}break}},eH:function(){if(this.r&&!("SubjectTextBox"in this.r)){this.r.SubjectTextBox=this.h.SubjectTextBox.z;this.r.FromFieldControl=this.h.FromFieldControl.z.querySelector("input");this.r.ToRecipientWellControl=this.h.ToRecipientWellControl.z.querySelector("input");this.r.CcRecipientWellControl=this.h.CcRecipientWellControl.z.querySelector("input");this.r.BccRecipientWellControl=this.h.BccRecipientWellControl.z.querySelector("input")}},eU:function(n,t){this.fN();this.bR=this.i().ba.h()==="HTML";this.bR||this.fS();this.fX()},i:function(){return this.V()},hO:function(n){this.ch(5)},hU:function(n){this.ch(3)},hv:function(n,t){this.ch(1)},gV:function(){if(this.n==="Mouse"){this.be&&this.be.apcl("IsHidden",this.dX);if(_y.c.a.b())if(this.i().bN()){var i=this.cd();var t=_j.x.b(i);var n=this;t.b("resize",function(t){n.fV()})}else{_y.c.a.n(this.cy);this.q.b(_a.dA,this.er);this.q.b(_a.cI,this.ew);_g.a.a().b().o(this.es)}else _y.c.a.n(this.cy)}},iA:function(){if(this.n==="Mouse"){this.be&&this.be.rpcl("IsHidden",this.dX);if(_y.c.a.b())if(this.i().bN()){var t=this.cd();var n=_j.x.b(t);n.c("resize",null)}else{_y.c.a.p(this.cy);this.q.c(_a.dA,this.er);this.q.c(_a.cI,this.ew);_g.a.a().b().v(this.es)}else _y.c.a.p(this.cy)}},gY:function(n){_j.e.a(_a.a.a,"MouseDown event on Body is being ignored to prevent hiding the keyboard.");n.c()},is:function(){this.h.FromFieldControl.fG(this.eB)},ie:function(n,t){var r=this.m||this.cB;if(r==="SubjectTextBox"){this.i().ba.B().d("subject");this.h.SubjectTextBox.r(this.i().ba.B())}else if(r==="EditorControl"){if("EditorControl"in this.h){var i=this.h.EditorControl;if(i.bd)i.bi(this.i().ba.B());else if(_cmc.q.isInstanceOfType(this.i().ba.B()))this.i().ba.B().a=i.ea;else if(_cmc.y.isInstanceOfType(this.i().ba.B())){i.ea=this.i().ba.B().t;i.bi(this.i().ba.B())}}this.i().ba.B().d("body")}else this.i().ba.B().g(!0)},id:function(n,t){if(this.i()){var r=this.i().bf;var i=null;if(this.n==="Mouse"){var f=r.b(19);i=f.l()}else{var u=r.b(10);i=u.a()}i&&i.b&&i.a();this.n==="TouchNarrow"&&this.i().bj().a()&&this.i().bj().a().l()}},hL:function(n,t){"EditorControl"in this.h&&this.h.EditorControl.bi(this.i().ba.de())},iv:function(){var n=this.h.FromFieldControl;var r=this.h.ToRecipientWellControl;var i=this.h.CcRecipientWellControl;var t=this.h.BccRecipientWellControl;n&&n.kU(this.eB)},ic:function(n){if(this.h.FromFieldControl===n)for(var i=n.z.querySelectorAll("input"),t=0;t<i.length;t++)i[t].setAttribute("aria-labelledby","MailCompose.FromRecipientWellButton")},hj:function(){var n=this.h.FromFieldControl;n&&n.b()},eR:function(){var t=!0;switch(this.m){case"ToRecipientWellControl":this.dD(!0);this.dx(!1);this.dw(!1);break;case"CcRecipientWellControl":this.dx(!0);this.dD(!1);this.dw(!1);break;case"BccRecipientWellControl":this.dw(!0);this.dx(!1);this.dD(!1);break;default:t=!1;break}if(t){var n=this.V().bd();n&&n.m()&&n.m().j()}},dm:function(){var n=!0;if(this.bs){switch(this.m){case"DiscardButton":this.j("SendButton");break;case"InsertButton":this.j("DiscardButton");n=!1;break;case"AppsButton":this.j("InsertButton");n=!1;break;case"AffordanceMenuButton":var t=this.h.AppsButton;t&&!t.bp()?this.j("AppsButton"):this.j("InsertButton");n=!1;break;case"OpenSeperateWindowButton":this.j("AffordanceMenuButton");n=!1;break;case"ToRecipientButton":if(this.i().bd().ba()||this.i().bb.q.x.length)this.v(!1);else{var r=this.be;if(r.bp()){this.j("OpenSeperateWindowButton");n=!1}else this.v(!1)}break;case"ToRecipientWellControl":if(this.n==="Mouse"){this.j("ToRecipientButton");n=!1;this.v(!1)}else this.v(!1);break;case"CcRecipientWellControl":this.j("CcRecipientButton");break;case"BccRecipientWellControl":this.j("BccRecipientButton");break;case"AttachmentWellViewWrapper":this.j("SubjectTextBox");break}if(n){var i=this;_j.m.a().a(this.I(),"MailComposeView.HandleShiftTabOnRecipientWell",function(){i.v(!1)},100)}}},iy:function(){if(this.iu())switch(this.m){case"ToRecipientWellControl":this.i().bd().d(1);this.i().bd().d(2);break;case"CcRecipientWellControl":this.i().bd().d(0);this.i().bd().d(2);break;case"BccRecipientWellControl":this.i().bd().d(0);this.i().bd().d(1);break;default:this.i().bd().d(0);this.i().bd().d(1);this.i().bd().d(2);break}},iu:function(){return this.n==="Mouse"&&this.V()?!0:!1},hB:function(n,t){if(this.h.CancelConfirmDialog.bp()&&this.V()&&!this.V().bP){_j.e.a(_a.a.a,"Restore focus on hide of cancel confirm dialog.");this.br()}},hV:function(n,t){if(this.h.MessageBox.bp()){_j.e.a(_a.a.a,"Restore focus on hide of message box.");this.br()}},hG:function(n,t){if(this.i().bA().e()){this.ds&&this.i().bA().rpcl("IsInitialized",this.cS);_j.e.a(_a.a.a,"Calling PostTransitionIn on initialize of Data Context.");this.d(null)}else _j.e.a(_a.a.a,"InitializerComponent.IsInitialized = false.")},hE:function(n,t){this.i().ba.l()&&this.by("EditorSizingMode")},hS:function(n,t){if(this.w.g()&&this.i()){var i=!1;t==="IsShown"?i=this.i().bh?this.i().bh.r:i:t==="IsDiscardConfirmDialogShown"&&(i=this.i().bq()?this.i().bq().b():i);if(i){this.u().cW();this.u().jj()}}},hH:function(n,t){this.i().bA().rpcl("IsSecondInitializationComplete",this.cT);this.n==="Mouse"&&this.i().by()&&this.i().by().a()&&this.i().by().a().apcl("IsShown",this.ej);var u=this.i().cc();u.a()?u.a().apcl("IsShown",this.cX):u.apcl("DialogViewModel",this.cW);var r=this.i().cd();r.a()?r.a().apcl("IsShown",this.da):r.apcl("DialogViewModel",this.cZ);var f=this.i().bd();f&&f.apcl("IsPeoplePickerShown",this.ey);this.q.a(_mco.be.a,new _mco.be.a("MailComposeView.OnDataContextSecondInitialization"));var i=this;_j.m.a().a(_a.a.a,"MailComposeView.OnDataContextSecondInitialization",function(){i.i()&&i.i().eq()&&i.q.a(_mcp.O,new _mcp.O)},_mcp.bg.a)},hF:function(n,t){if(!this.i().by().a().q()){var r=this.i().cc();var u=this.i().cd();var i=this;_j.m.a().a(this.I(),"MailComposeView.OnContextMenuShownChanged",function(){var f=!r.a()||!r.a().r;var t=!u.a()||!u.a().r;var n=!i.i().bh||!i.i().bh.r;if(f&&n&&t){_j.e.a(_a.a.a,"Restore focus on hide of context menu");i.br()}},100)}},hW:function(n,t){var i=this.i().cc();i.rpcl("DialogViewModel",this.cW);i.a().apcl("IsShown",this.cX)},hX:function(n,t){var i=this;_j.m.a().a(this.I(),"MailComposeView.OnMessageOptionsShownChanged",function(){if(!i.i().cc().a().r){_j.e.a(_a.a.a,"Restore focus on hide of message options dialog");i.br()}},100)},hY:function(n,t){var i=this.i().cd();i.rpcl("DialogViewModel",this.cZ);i.a().apcl("IsShown",this.da)},hZ:function(n,t){var i=this;_j.m.a().a(this.I(),"MailComposeView.OnOmeOptionsShownChanged",function(){if(!i.i().cd().a().r){_j.e.a(_a.a.a,"Restore focus on hide of ome options dialog");i.br()}},100)},ia:function(n,t){if(!this.i().bd().bb()){_j.e.a(_a.a.a,"Restore focus on hide of people picker");this.br()}},hQ:function(n,t){this.br()},hR:function(n,t){this.gw();this.fm()},gw:function(){var l=this.B.a("InfoBarControl");if(l&&this.i().bb&&this.i().bb.q&&this.i().bb.q.x.length>0){for(var c=new _y.cM,e=_nbs.a.In+". ",n,u=0;u<this.i().bb.q.x.length;u++){n="";var t=this.i().bb.q.x[u];if(_db.C.isInstanceOfType(t)){var s=t;s&&(n=s.g)}else if(_db.D.isInstanceOfType(t)){var f=t;f&&(n=f.g)}else if(_db.K.isInstanceOfType(t)){var r=t;if(r&&_y.iS.isInstanceOfType(r.g)){var i=r.g;i&&i.a()&&(n=i.a())}}if(n===""){var o=t;o&&(n=c.a(o.d,null))}e+=n+". "}var h=this.B.a("InfoBarControl").z;h.setAttribute("aria-label",e)}},hy:function(n){n.a().u(this.dY);n.a().bA(this.dZ);this.fa(!n.a().m())},hx:function(n){this.fa(!n.m());this.u().hj=_j.k.g(this.h.AttachmentWellViewWrapper.z)},hw:function(n){if(n.bR()){n.cq(!1);this.t("EditorControl")}this.fa(!n.m());this.br()},fZ:function(n,t){if(this.ds)_j.e.a(_a.a.a,"PostTransitionIn before DataContext was initialized. DataContext initialization handler is already setup. ");else{_j.e.a(_a.a.a,"PostTransitionIn before DataContext was initialized. Adding handler to call PostTransitionIn after DataContext is initialized. ");n.apcl("IsInitialized",this.cS);this.ds=!0}},gU:function(){if(!this.cH){var t=this.V();if("EditorControl"in this.h&&this.h.EditorControl){var n=this.h.EditorControl;n.fM(this.dR);n.cm(this.dW);n.hC(this.dP);n.fL(this.dQ);n.b(this.dN);n.dK(this.dS);n.hz(this.dO);var f=t.bc();f&&f.I(n);var e=t.cI();e&&e.k(n);var u=t.cJ();u&&u.c(n);var i=t.fn();i&&i.a(n)}if(this.w.b()){var r=this.B.a("TabAnchor");r&&_j.k.b(r.z,"focusin",this.fz)}this.cH=!0}},eL:function(n){},iz:function(){if(this.cH){if("EditorControl"in this.h&&this.h.EditorControl){var n=this.h.EditorControl;n.gc(this.dR);n.ck(this.dW);n.hW(this.dP);n.gb(this.dQ);n.e(this.dN);n.dE(this.dS);n.hT(this.dO)}if(this.w.b()){var t=this.B.a("TabAnchor");t&&_j.k.c(t.z,"focusin")}this.cH=!1}},gT:function(n){this.j("EditorControl");n.c()},dl:function(n){_j.h.a(this.k)||this.j(this.k);n.a(!0)},bD:function(){this.k=null;this.bJ&&(this.k="AttachmentWellViewWrapper");this.i().ba.bx()||_j.h.a(this.k)&&this.o("SubjectTextBox")&&(this.k="SubjectTextBox");_j.h.a(this.k)&&this.o("BccRecipientWellControl")&&(this.k="BccRecipientWellControl");if(_j.h.a(this.k)&&this.o("CcRecipientWellControl")){this.k="CcRecipientWellControl";this.h.BccRecipientWellControl.rpcl("IsHidden",this.cu);this.h.BccRecipientWellControl.apcl("IsHidden",this.cu)}_j.h.a(this.k)&&this.o("ToRecipientWellControl")&&(this.k="ToRecipientWellControl");!_j.h.a(this.k)&&this.h&&this.h[this.k]&&_j.k.b(this.h[this.k].z,"keydown",this.cV)},ca:function(){!_j.h.a(this.k)&&this.h&&this.h[this.k]&&_j.k.c(this.h[this.k].z,"keydown")},o:function(n){if(!this.h)return!1;var t=this.h[n];return!!t&&!t.bp()},hA:function(n,t){this.o("BccRecipientWellControl")&&this.m&&this.j("BccRecipientWellControl");this.ca();this.bD()},hC:function(n,t){this.h.CcRecipientWellControl.rpcl("IsHidden",this.cR);this.o("CcRecipientWellControl")&&this.m&&this.j("CcRecipientWellControl");this.ca();this.bD()},fU:function(n,t){},hi:function(n){if(this.i()){this.i().ba.eu(n.f());this.i().ba.dT(n.e());this.i().ba.ee(n.c())}},hg:function(n){if(this.i()){var t=this.i().bc().a().D();t.b(n.c());t.a(n.c())}},hh:function(n){if(this.i()){var t=this.i().bc().a();t.T(n.c())}},hf:function(n){this.fS()},eQ:function(n){if(this.i()){var u=this.i().bf;switch(n.c()){case 1:var o=this.i().bg();var r=o.a();r&&r.b&&r.a();break;case 2:this.q&&this.q.a(_y.gS,new _y.gS);break;case 3:var i=this.i().bl().d();i&&i.b&&i.a();break;case 4:var t=null;if(this.n==="Mouse"){var e=u.b(19);t=e.a()}else{var f=u.b(10);t=f.a()}t&&t.b&&t.a();break;case 5:this.j("ToRecipientWellControl");break;case 8:this.dl(n);break}}},fm:function(){if(this.h&&this.i()){var n;n=this.h.EditorControl;n&&n.bd&&this.i().cN&&this.bY&&this.cf&&n.ek()}},fW:function(){if(this.h&&this.h.EditorControl){var n=this.h.EditorControl;n.bd&&n.bi(new _cmc.k(!1))}},fS:function(){var t=this.V();if(this.bR&&this.h&&this.h.EditorControl){var n=this.h.EditorControl;if(n.bd&&!n.ch()){n.bi(new _cmc.bA);t.ba.cD(n.bQ.b)}}else t.ba.cD(0)},hP:function(n,t){},fV:function(){this.ch(0)},eV:function(){if(this.h){var i=this.h.ToReadWriteRecipientWellView;var t=this.h.CcReadWriteRecipientWellView;var n=this.h.BccReadWriteRecipientWellView;this.fn(i);this.fn(t);this.fn(n)}},fn:function(n){if(n&&_rw.d.isInstanceOfType(n.V())){var t=n.V();t.bM(!0);t.bM(!1)}},hM:function(){var n=this.h.QuotedBodyHtmlLabel;if(n){this.h.QuotedBodyHtmlLabel.bf("touchstart",this.fL,"MailComposeView");this.h.QuotedBodyHtmlLabel.bf("touchend",this.fE,"MailComposeView")}},hz:function(){var n=this.h.QuotedBodyHtmlLabel;if(n){this.h.QuotedBodyHtmlLabel.bj("touchstart","MailComposeView");this.h.QuotedBodyHtmlLabel.bj("touchend","MailComposeView")}},ik:function(n){if(n.b().tagName==="A"){var t=n.b().getAttribute("href");this.bZ.d().a(t);n.d();n.c()}},il:function(n){if(n.b().tagName==="A"){n.d();n.c()}},E:function(){var n=this.h.EditorControl;this.w.g()&&this.h&&this.h.SubjectTextBox&&_zz.P.c(this.h.SubjectTextBox.z,null,!1);this.gU();this.n==="TouchNarrow"?this.fk(!1):this.fk(!0);this.u().eQ(this);this.u().lq(this);this.cF(!0);this.fl(!0);_j.e.a(_a.a.a,"PostTransitionIn active view. ");this.i().ba.bM()||this.fY()||this.V().apcl("ReadyToSetInitialFocus",this.db);this.bS()},ih:function(n,t){var i=n;i.rpcl("IsReadyForViewInitialization",this.dc);this.E()},ir:function(){if(this.h&&this.h.EditorControl){var n=this.h.EditorControl;n.bi(new _cmc.F(!0));this.t("EditorControl")}},ij:function(n){if(Node.isInstanceOfType(n.target))for(var i=0;i<this.p.d.length;i++){var r=this.p.d[i];var t=this.h[r.a];if(t&&(n.target===t.z||t.z.contains(n.target))){this.dj(r.a);this.eR();break}}return!0},ii:function(n){if(Node.isInstanceOfType(n.target))for(var t=0;t<this.s.d.length;t++){var r=this.s.d[t];var i=this.h[r.a];if(n.target===i.z||i.z.contains(n.target)){r.b(null,null);break}}return!0},hJ:function(n){_b.r.b(n);var t=n.dataTransfer.types;this.eZ(t);this.bU&&(this.bU=_j.m.a().b(this.bU));return!1},hI:function(n){if(!this.bU){var t=this;this.bU=_j.m.a().a(_a.a.g,"OnDragLeave",function(){t.eZ(null);t.bU=null},50)}return!0},hK:function(n){_b.r.b(n);this.eZ(null);return!1},fT:function(n){return n==="ToRecipientWellControl"||n==="BccRecipientWellControl"||n==="CcRecipientWellControl"},hu:function(){return!!this.df&&this.df.a().kJ().Enabled},ix:function(n,t){if(this.hu()&&!this.fT(n)&&this.fT(t)){var i=this;_j.m.a().a(this.I(),"Delayed PeopleRecommendations recipients retrieval",function(){if(i.V()&&i.i()&&!i.i().fm){var n=i.V().es();n&&n.b(1)}},100)}},dj:function(n){_j.e.a(_a.a.a,"Focused in {0}",n);this.t(n);this.v(n==="CcRecipientWellControl"||n==="BccRecipientWellControl"||n==="ToRecipientWellControl"||n==="ToRecipientButton"||n==="OpenSeperateWindowButton"||n==="AffordanceMenuButton"||n==="InsertButton"||n==="DiscardButton"||n==="AppsButton");if(this.V()&&_mcp.d.isInstanceOfType(this.V())&&this.m==="FromFieldControl"){var t=this.i().bd();t&&t.L(!1)}},fN:function(){this.i()&&this.ip(this.w.b()&&this.i().ba.h()==="Text"?!0:!1)},hT:function(n){var t=n.a();if(t===9&&!n.p()&&this.k!=="AttachmentWellViewWrapper"&&this.k!=="SubjectTextBox"){this.j("EditorControl");this.gl(n)}},ib:function(n,t){this.fY()},fY:function(){if(this.i()&&!this.eT&&(this.i().cT||!(this.n==="Mouse"))){this.eT=!0;this.fX();this.i().rpcl("ReadyToSetInitialFocus",this.db);return!0}return!1},he:function(){var n=_j.k.h(this.h.ComposeResponsivnessWrapper.z);var i=_j.k.h(this.h.FloatLeftWrapper.z);var t=_j.k.h(this.h.FloatRightWrapper.z);if(n>0){this.eW=this.bg.a;this.dv=n;this.eX=i;this.eY=t}return n-i-t},gb:function(){var n=this.h.Emoji;if(n&&!n.bp()&&_zz.v.isInstanceOfType(n)&&n.h){var t=n.z.querySelectorAll("button");t&&t.length>0&&t[0].click()}},ht:function(){var s=this,o=this,e=this,l=this,c=this;var h=[function(){s.i().eE(!0)},function(){o.i().eR(!0)},function(){e.i().eG(!0)},function(){l.i().eI(!0)},function(){c.i().eH(!0)}];var i=this,t=this,n=this,f=this,u=this;var r=[function(){i.i().eE(!1)},function(){t.i().eR(!1)},function(){n.i().eG(!1)},function(){f.i().eI(!1)},function(){u.i().eH(!1)}];this.bg=new _mco.be(this.fB,h,r,this.fM,this.q,this.cC)},im:function(){return!!this.i()},gW:function(){this.q.b(_mco.be.b,this.eq);this.q.b(_mco.be.a,this.ed);this.q.b(_mcp.P,this.eE);this.bg.o()},gc:function(){this.q.c(_mco.be.b,this.eq);this.q.c(_mco.be.a,this.ed);this.q.c(_mcp.P,this.eE);this.bg.p()},hN:function(n){this.bg.b()},hD:function(n){var t=this;_j.m.a().c(_a.a.a,"MailComposeView.OnComposeRecalcEvent",function(){t.bg.b()})},ig:function(n){this.gb()},iw:function(){if(this.bg&&this.dv>0){var t=_a.b.b(_a.a.a,"MailComposeResponsivness",!1,null);var n=new _a.l;n.b("TW",this.dv);n.b("LW",this.eX);n.b("RW",this.eY);n.b("CS",this.eW);n.b("MS",this.bg.c);t.m=n.toString();_a.b.a(t)}}};_mcp.i.a=function(n,t){this.a=n;this.b=t};_mcp.i.a.prototype={a:null,b:null,c:function(){var n=this;return function(t){n.b(t,{uiComponent:n.a})}}};_mcp.bh=function(n){this.h=Function.createDelegate(this,this.p);this.g=Function.createDelegate(this,this.o);this.b={};_mcp.bh.initializeBase(this,[n])};_mcp.bh.prototype={c:null,a:null,d:null,e:function(){this.b.UpconvertButton.R();this.c="UpconvertButton";_mcp.n.isInstanceOfType(this.a)&&(this.a.bN=!0)},H:function(){_j.c.prototype.H.call(this);this.b.ShowCcButton=this.B.a("ShowCcButton");this.b.ShowBccButton=this.B.a("ShowBccButton");this.b.UpconvertButton=this.B.a("UpconvertButton")},dT:function(){_j.i.prototype.dT.call(this);this.q()},M:function(){this.i();_j.c.prototype.M.call(this)},bz:function(){this.i();_j.c.prototype.bz.call(this)},j:function(n){if(this.b[n]){this.b[n].R();this.c=n}},q:function(){this.d=this.X;this.a=this.d.X;_mcp.l.isInstanceOfType(this.a)&&(this.a=this.a.X);_mcp.n.isInstanceOfType(this.a)&&this.a.iH(this);_j.k.b(this.d.z,"focusout",this.g);_j.k.b(this.d.z,"keydown",this.h)},f:function(n){var t=this.b?this.b[n]:null;return!!t&&!t.bp()},p:function(n){var t=n.a();if(t===9&&n.g())if(this.b.UpconvertButton.iZ()){this.c="UpconvertButton";this.n()}else if(this.b.ShowBccButton.iZ()){this.c="ShowBccButton";this.k()}else if(this.b.ShowCcButton.iZ()){this.c="ShowCcButton";this.l()}},n:function(){if(this.f("ShowBccButton")){this.j("ShowBccButton");_mcp.n.isInstanceOfType(this.a)&&(this.a.bN=!0)}else this.f("ShowCcButton")&&this.k()},k:function(){if(this.f("ShowCcButton")){this.j("ShowCcButton");_mcp.n.isInstanceOfType(this.a)&&(this.a.bN=!0)}else this.l()},l:function(){this.c=null;if(_mcp.n.isInstanceOfType(this.a)){this.a.iI();this.a.bN=!1}},i:function(){this.m();_j.k.c(this.d.z,"focusout");_j.k.c(this.d.z,"keydown")},o:function(n){this.m()},m:function(){this.c=null;_mcp.n.isInstanceOfType(this.a)&&(this.a.bN=!1)}};_mcp.n=function(n,t,i,r,u,f,e,o){this.gy=Function.createDelegate(this,this.iE);this.gz=Function.createDelegate(this,this.iF);this.fo=Function.createDelegate(this,this.iD);this.gx=Function.createDelegate(this,this.iC);this.gA=Function.createDelegate(this,this.iG);_mcp.n.initializeBase(this,[n,t,i,r,u,f,e,o])};_mcp.n.prototype={dF:!1,cb:null,bN:!1,iH:function(n){n&&(this.cb=n)},iI:function(){if(this.o("FromFieldControl"))this.j("FromFieldControl");else{this.dF=!0;this.j("ToRecipientWellControl")}},iB:function(){return!this.x()&&!!this.V()&&!this.V().ba.bk()},H:function(){_mcp.cq.prototype.H.call(this);if(this.B){this.h.InsertPictureButton=this.B.a("InsertPictureButton");this.h.FormatButton=this.B.a("FormatButton");this.h.InsertAvailableTime=this.B.a("InsertAvailableTime");this.h.ShowOriginalMessage=this.B.a("ShowOriginalMessage");this.h.AggregatedReadOnlyHeader=this.B.a("AggregatedReadOnlyHeader");this.h.ReadWriteHeader=this.B.a("ReadWriteHeader");this.h.ComposeBodyContainer=this.B.a("ComposeBodyContainer")}else{this.h.InsertPictureButton=null;this.h.FormatButton=null;this.h.InsertAvailableTime=null;this.h.Emoji=null;this.h.ShowOriginalMessage=null;this.h.AggregatedReadOnlyHeader=null;this.h.ReadWriteHeader=null;this.h.ComposeBodyContainer=null}},E:function(){_mcp.E.isInstanceOfType(this.V())&&(this.l=this.V().h);_mcp.cq.prototype.E.call(this)},iC:function(n){this.ck(!1);this.j("ToRecipientWellControl")},ck:function(n){if(this.V()&&_mcp.d.isInstanceOfType(this.V())){var t=this.V();t.bk().a("ShowFullRecipient");this.cs(n);t.bd()&&t.bd().M(n)}},j:function(n){if(this.h)switch(n){case"Emoji":if(this.h[n]){this.h[n].R();this.t(n)}break;case"FormatButton":case"InsertPictureButton":case"ShowOriginalMessage":case"InsertAvailableTime":if(this.o(n)){this.h[n].R();this.t(n)}break;case"EditorControl":var t=this.h.EditorControl;this.bi.b()&&t.cC()||t.bi(new _cmc.F(!1));this.t(n);break;default:_mcp.i.prototype.j.call(this,n);break}},cA:function(n){_mcp.cq.prototype.cA.call(this,n);this.x()&&this.cm.a(IMailInlineComposeFocusEvent,new _mcp.bl)},bD:function(){this.k=null;this.bJ&&(this.k="AttachmentWellViewWrapper");for(var t=this.x()?["BccRecipientWellControl","CcRecipientWellControl","ToRecipientWellControl"]:["SubjectTextBox","BccRecipientWellControl","CcRecipientWellControl","ToRecipientWellControl"],n=0;!this.k&&n<t.length;n++)this.o(t[n])&&(this.k=t[n]);!_j.h.a(this.k)&&this.o(this.k)&&_j.k.b(this.h[this.k].z,"keydown",this.cV)},ca:function(){!_j.h.a(this.k)&&this.h&&this.h[this.k]&&_j.k.c(this.h[this.k].z,"keydown")},dm:function(){this.bs&&(this.x()?this.gB():_mcp.i.prototype.dm.call(this))},dl:function(n){if(!_j.h.a(this.k)){this.bJ||this.ck(!1);this.j(this.k);this.k!=="ToRecipientWellControl"||this.o("FromFieldControl")||this.cb.e()}n.a(!0)},dj:function(n){_j.e.a(_a.a.a,"Focused in {0}",n);this.t(n);var t=n==="CcRecipientWellControl"||n==="CcRecipientButton"||n==="BccRecipientWellControl"||n==="BccRecipientButton"||n==="ToRecipientWellControl"||n==="ToRecipientButton"||n==="FromFieldControl";this.v(t||n==="AttachmentWellViewWrapper");this.cs(!t&&n!=="SubjectTextBox");t&&this.cm.a(IMailInlineComposeFocusEvent,new _mcp.bl);if(this.V()&&_mcp.d.isInstanceOfType(this.V())){var r=this.V();if(this.m==="FromFieldControl"){var i=r.bd();i&&i.L(!1)}}},bS:function(){_mcp.i.prototype.bS.call(this);var i=this.h.ShowOriginalMessage;i&&_j.k.b(i.z,"keydown",this.gA);var t=this.h.AggregatedReadOnlyHeader;if(t){_j.k.b(t.z,"click",this.gx);t.apcl("IsHidden",this.fo)}var n=this.h.ComposeBodyContainer;if(n){_j.k.b(n.z,"mouseover",this.gz);_j.k.b(n.z,"mouseout",this.gy)}},bu:function(){_mcp.cq.prototype.bu.call(this);var i=this.h.ShowOriginalMessage;i&&_j.k.c(i.z,"keydown");var t=this.h.AggregatedReadOnlyHeader;if(t){_j.k.c(t.z,"click");t.rpcl("IsHidden",this.fo)}var n=this.h.ComposeBodyContainer;if(n){_j.k.c(n.z,"mouseover");_j.k.c(n.z,"mouseout")}},fU:function(n,t){this.ca();this.bD();this.ck(!1)},cN:function(){_mcp.cq.prototype.cN.call(this);this.iJ(!this.bP)},iJ:function(n){this.o("FormatButton")&&this.h.FormatButton.fi(n);this.o("InsertPictureButton")&&this.h.InsertPictureButton.fi(n);this.o("Emoji")&&this.h.Emoji.fi(n);this.o("InsertAvailableTime")&&this.h.InsertAvailableTime.fi(n)},iG:function(n){var t=n.a();if(t===9&&!n.p()){this.j("SendButton");this.gl(n)}},gB:function(){if(!this.bN)switch(this.m){case"BccRecipientWellControl":this.j("BccRecipientButton");break;case"BccRecipientButton":this.o("CcRecipientWellControl")?this.j("CcRecipientWellControl"):this.o("FromFieldControl")?this.j("ToRecipientWellControl"):this.cb.e();break;case"CcRecipientWellControl":this.j("CcRecipientButton");break;case"CcRecipientButton":this.o("FromFieldControl")?this.j("ToRecipientWellControl"):this.cb.e();break;case"ToRecipientWellControl":this.dF?this.dF=!1:this.j("ToRecipientButton");break;case"ToRecipientButton":this.o("FromFieldControl")?this.cb.e():this.v(!1);break;case"FromFieldControl":this.bN||this.v(!1);break;case"ShowOriginalMessage":this.j("EditorControl");break;case"SendButton":this.j("ShowOriginalMessage");break;case"AttachmentWellViewWrapper":this.ck(!1);this.o("FromFieldControl")?this.j("ToRecipientWellControl"):this.cb.e();break;default:this.v(!1);break}},iE:function(n){this.cM(!1)},iF:function(n){this.cM(!0)},iD:function(n,t){this.eV()}};_mcp.a=function(){};_mcp.a.$$cctor=function(){_mcp.a._I()};_mcp.a.eG=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <span></span> </div><div> <div class='ms-font-weight-regular ms-font-color-neutralSecondaryAlt InfobarImmediateTextContainer'> <span class='_mcp_2'></span> <a class='_mcp_3 ms-font-weight-regular ms-font-color-themeDark ms-font-s'></a> <span class='ms-font-weight-regular ms-font-color-themeDark ms-font-s'></span> <a class='_mcp_3 ms-font-weight-regular ms-font-color-themeDark ms-font-s'></a> </div> </div><div> <span class='_mcp_4'></span> <span class='_mcp_4'></span> </div><div> <span class='_mcp_5'></span> <div class='_mcp_6'></div>  </div><div> <div class='ms-font-weight-regular ms-font-s ms-font-color-neutralDark'> <span class='ms-font-weight-regular ms-font-s _mcp_8'></span> <span class='ms-font-weight-regular ms-font-s _mcp_8'></span> <span class='irmInfoAction'> <a class='ms-font-weight-regular ms-font-color-themeDark ms-font-s _mcp_8'></a> <span class='ms-font-weight-regular ms-font-s _mcp_8'></span> <a class='ms-font-weight-regular ms-font-color-themeDark ms-font-s _mcp_8'></a> <span class='ms-font-weight-regular ms-font-s _mcp_8'></span> <a class='ms-font-weight-regular ms-font-color-themeDark ms-font-s _mcp_8'></a> </span> </div> </div><div> <div class='_mcp_z ms-font-weight-regular ms-font-color-neutralDark'></div> </div><div> <button type='button' class='_mcp_m'></button> <div class='_mcp_B'></div> <div class='_mcp_k'></div> <div class='_mcp_k'></div> </div><div> <span class='_mcp_q ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_y'> <span class='_mcp_r ms-font-weight-regular ms-font-color-black'></span> <button type='button' class='_mcp_D ms-font-m'></button> </div> </div><div> <span class='_mcp_x'></span> <span class='_mcp_x'></span> </div><div> <span class='_mcp_x'></span> </div><div> <span class='_mcp_q ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_y'> <span class='_mcp_u _mcp_v _mcp_w ms-font-weight-regular ms-font-color-neutralSecondary'></span> <div></div> </div> </div><div> <span class='_mcp_q ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_y'> <span class='_mcp_w ms-font-weight-regular ms-font-color-neutralSecondary'></span> </div> </div><div> <span class='_mcp_q ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_y'> <div class='_mcp_f'></div> </div> </div><div> <button autoid=\"_mcp_5\" type='button'></button> <div></div> </div><div> <div class='_mcp_51 _mcp_61'></div> </div><div> <span class='_mcp_o ms-font-weight-semibold ms-font-color-black'></span> <span class='_mcp_n'></span> </div><div> <div class='_mcp_M'></div>  <div class='ms-bg-color-themePrimary'></div> <div class='_mcp_O'> <div class='_mcp_P ms-font-weight-regular ms-font-color-neutralPrimary'></div> <div class='ms-bg-color-themePrimary'></div> <div>  <div class='_mcp_V'></div> <div class='_mcp_T'> <div class='_mcp_i'> <div class='_mcp_d _mcp_U _mcp_j ms-border-color-neutralTertiary ms-bg-color-white'></div> </div> <div class='_mcp_d _mcp_Y _mcp_j ms-border-color-neutralTertiary ms-bg-color-white'> <button type='button' class='_mcp_p ms-font-weight-regular ms-font-color-black _mcp_L'></button> <div> <div class='_mcp_K'> <button type='button'></button> </div> <div autoid=\"_mcp_0\" class='_mcp_g _mcp_E'></div> </div> <div> <div class='_mcp_g _mcp_E'></div> </div> </div> <div class='_mcp_d _mcp_Y _mcp_j ms-border-color-neutralTertiary ms-bg-color-white'> <button type='button' class='_mcp_p ms-font-weight-regular ms-font-color-black _mcp_L'></button> <div> <div class='_mcp_K'> <button type='button'></button> </div> <div autoid=\"_mcp_1\" class='_mcp_g _mcp_E'></div> </div> <div> <div class='_mcp_g _mcp_E'></div> </div> </div> <div class='_mcp_d _mcp_Y _mcp_j ms-border-color-neutralTertiary ms-bg-color-white'> <button type='button' class='_mcp_p ms-font-weight-regular ms-font-color-black _mcp_L'></button> <div> <div class='_mcp_K'> <button type='button'></button> </div> <div autoid=\"_mcp_2\" class='_mcp_g _mcp_E'></div> </div> <div> <div class='_mcp_g _mcp_E'></div> </div> </div> <div class='_mcp_d _mcp_h _mcp_j ms-border-color-neutralTertiary ms-bg-color-white'> <div class='_mcp_y'> <button type='button' class='_mcp_D _mcp_t'></button> <span class='_mcp_D _mcp_s'></span> <span class='_mcp_D _mcp_s'></span> <span class='_mcp_D _mcp_s'></span> <button type='button' class='_mcp_D ms-font-xl'></button> <div class='_mcp_E'> <input autoid=\"_mcp_3\" class='_mcp_z _mcp_A ms-font-weight-regular ms-font-color-neutralSecondary'/> </div> </div> </div> <div> <div class='_mcp_e ms-bg-color-white'></div> <div class='_mcp_e ms-bg-color-white'></div> <div class='_mcp_e ms-bg-color-white'></div> <div class='_mcp_e ms-bg-color-white'></div> </div> <div> <div class='_mcp_d ms-bg-color-white'> <div></div> </div> </div> <span></span> </div> <div class='_mcp_T ms-bg-color-white'> <div autoid=\"_mcp_4\" class='_mcp_F'></div> <div class='_mcp_Q ms-border-color-neutralTertiary'></div> </div> <div class='_mcp_T ms-bg-color-white'> <span class='_mcp_H ms-font-weight-regular'></span> </div> </div> </div> <div></div> <div></div> <div></div> <div></div> <div></div> <div></div> <div class='_mcp_N'></div>  </div><div> <iframe autoid=\"_mcp_6\" class='_mcp_91'></iframe> </div><div> <div class='_mcp_a1'> <button type='button' class='_mcp_b1 _mcp_81 ms-font-weight-regular'></button> <span></span> </div> </div><div> <span class='_mcp_C2'></span> </div><div> <span class='_mcp_D2'></span> </div><div>  <span></span> </div><div> <div class='_mcp_Q1 ms-font-weight-regular ms-bg-color-white-hover ms-font-color-neutralSecondaryAlt'></div> </div><div> <button autoid=\"_mcp_7\" type='button' class='ms-font-weight-semibold ms-font-s _mcp_D1'></button> <div class='_mcp_T1'></div> <div class='_mcp_A1'></div> <div class='_mcp_A1'></div> <div></div> </div><div> <span class='_mcp_H1 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_L1'> <span autoid=\"_mcp_d\" class='_mcp_I1 ms-font-weight-regular ms-font-color-black'></span> </div> </div><div> <span class='_mcp_02 _mcp_A2'></span> <span class='_mcp_02 _mcp_A2'></span> </div><div> <span class='_mcp_02 _mcp_A2'></span> </div><div> <span class='_mcp_H1 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_L1'> <div> <span class='_mcp_02 _mcp_Z1 ms-font-weight-regular ms-font-color-neutralSecondary _mcp_12'></span> <div></div> </div> </div> </div><div> <span class='_mcp_H1 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_L1'> <span autoid=\"_mcp_e\" class='_mcp_Z1 ms-font-weight-regular ms-font-color-neutralPrimary'></span> </div> </div><div> <span class='_mcp_H1 ms-font-weight-semibold ms-font-color-black _mcp_J1'></span> <div class='_mcp_L1'> <div class='_mcp_s1'></div> </div> </div><div> <span></span> <span></span> </div><div>  <span class='_mcp_a2'></span> <span class='_mcp_b2'></span> </div><div> <div></div> </div><div> <span class='_mcp_F1 ms-font-weight-regular'></span> <span class='_mcp_E1'></span> </div><div> <div class='_mcp_x2'></div> <button type='button' class='ms-font-s ms-font-weight-regular _mcp_m1'></button> <button type='button' class='ms-font-s ms-font-weight-regular _mcp_m1'></button> <button type='button' class='_mcp_m1 ms-border-color-neutralTertiary _mcp_n1'></button> </div><div> <div class='_mcp_l1'></div> </div><div> <span class='_mcp_m1'></span> <span autoid=\"_mcp_o\" class='_mcp_m1'></span> <span autoid=\"_mcp_p\" class='_mcp_m1'></span> <span class='_mcp_m1'></span> </div><div> <div class='_mcp_d1 ms-border-color-neutralLight'> <div> <div class='_mcp_B2'></div> <div class='_mcp_B2'></div> </div> <div class='_mcp_e1 ms-bg-color-white'> <div class='_mcp_k1 ms-font-weight-regular'></div> <div> <div class='_mcp_f1'> <div class='ms-bg-color-white customScrollBar'>  <div class='_mcp_t1'> <div></div>  </div>  <div> <div class='_mcp_o1 _mcp_q1 _mcp_w1'></div> <div class='_mcp_o1'> <button autoid=\"_mcp_8\" type='button' class='_mcp_G1 ms-font-weight-semibold ms-font-s _mcp_e2'></button> <div class='_mcp_L1 _mcp_M1'>  <div autoid=\"_mcp_9\" class='_mcp_c2'></div> </div> <div class='_mcp_L1 _mcp_M1 _mcp_N1'> <div class='_mcp_c2'></div> </div> <div></div>  </div> <div class='_mcp_o1 _mcp_x1'> <button type='button' class='_mcp_G1 ms-font-weight-semibold ms-font-s _mcp_e2'></button> <div class='_mcp_L1 _mcp_M1'>  <div autoid=\"_mcp_a\" class='_mcp_c2'></div> </div> <div class='_mcp_L1 _mcp_N1'> <div class='_mcp_c2'></div> </div>  </div> <div class='_mcp_o1 _mcp_x1'> <button type='button' class='_mcp_G1 ms-font-weight-semibold ms-font-s _mcp_e2'></button> <div class='_mcp_L1 _mcp_M1'>  <div autoid=\"_mcp_b\" class='_mcp_c2'></div> </div> <div class='_mcp_L1 _mcp_N1'> <div class='_mcp_c2'></div> </div>  </div> <div class='_mcp_o1'> <span class='_mcp_G1 ms-font-weight-semibold ms-font-color-black _mcp_K1 '></span> <span class='_mcp_G1 ms-font-weight-semibold ms-font-color-black _mcp_K1 '></span> </div> <div class='_mcp_o1 _mcp_r1 _mcp_x1 ms-border-color-neutralTertiaryAlt'> <div class='_mcp_y2'></div>  <div class='_mcp_c2'> <div spellcheck=\"true\"> <input autoid=\"_mcp_c\" class='_mcp_Q1 _mcp_R1 ms-font-weight-regular ms-bg-color-white-hover ms-font-color-neutralPrimary'/> </div> </div> </div> <div class='_mcp_z2 _mcp_x1 ms-border-color-neutralTertiaryAlt'> <div class='_mcp_v1'></div> <div class='_mcp_v1'></div> <div class='_mcp_v1'></div> <div class='_mcp_v1'></div> </div> </div> </div> <div class='_mcp_w1'></div> </div> <span></span> <span></span> <div class='_mcp_z1'>  <div>  <div class='_mcp_V1 ms-font-weight-regular ms-font-color-neutralPrimary _mcp_W1 ms-border-color-neutralLight'></div> </div> <div></div> <div class='_mcp_22'> <div></div> </div> <div class='_mcp_k2'> <button autoid=\"_mcp_f\" type='button' class='ms-font-s ms-font-weight-regular'></button> <div></div> </div> <div class='_mcp_l2'></div> </div> </div>  <div class='_mcp_g1 _mcp_x1 ms-bg-color-white'> <div class='_mcp_n2 ms-border-color-neutralTertiaryAlt'> <div class='_mcp_p2'></div> <div class='_mcp_o2'></div> <div class='_mcp_q2'></div> </div> <div class='_mcp_i1'> <div class='_mcp_I2'> <button autoid=\"_mcp_g\" type='button' class='_mcp_62'></button> <button type='button' class='_mcp_62'></button> <button autoid=\"_mcp_h\" type='button' class='_mcp_62'></button> <div class='_mcp_82'> <button type='button' class='_mcp_92'></button> <button autoid=\"_mcp_i\" type='button' class='_mcp_72'></button> </div> <button type='button' class='_mcp_72 _mcp_s2'></button>  <div class='_mcp_K2'>  <div></div> </div> <button type='button' class='_mcp_72'></button> <button type='button' class='_mcp_72'></button> <button autoid=\"_mcp_j\" type='button' class='_mcp_72'></button> <button autoid=\"_mcp_k\" type='button' class='_mcp_72'></button> </div> <div class='_mcp_J2'>  <span class='_mcp_u2 ms-font-weight-semilight ms-font-color-neutralSecondary'></span>  <div class='_mcp_v2'></div> </div> </div> <div class='_mcp_j1 ms-font-weight-regular ms-font-color-neutralSecondary'></div> </div> </div> </div> <div></div> <div class='_mcp_d2 ms-bg-color-white'></div> <div autoid=\"_mcp_l\"></div> <div></div> <div></div> <div></div> <div></div> <div></div>  <div autoid=\"_mcp_m\"></div> <div autoid=\"_mcp_n\"></div>   </div><div> <span class='_mcp_M2 _mcp_N2 ms-font-weight-regular ms-font-color-neutralPrimary'></span> <div class='_mcp_P2'></div> </div><div> <span class='_mcp_S2'></span> <span class='_mcp_S2'></span> <button type='button' class='ms-font-s ms-font-weight-regular ms-font-color-neutralPrimary _mcp_S2 _mcp_T2'></button> </div><div> <div class='ms-font-color-neutralSecondary ms-font-s _mcp_O2'> <div class='_mcp_P2'></div> <div class='_mcp_Q2'></div> </div> </div><div> <div class='_mcp_33'></div> <span class='_mcp_43'></span> <div class='_mcp_03 ms-bg-color-white'> <div class='_mcp_53'></div> <div></div> <div class='_mcp_13 ms-font-weight-regular ms-font-color-neutralSecondary'></div> </div> <div class='_mcp_U2'> <div class='_mcp_V2 _mcp_63'></div>  <div class='_mcp_V2 _mcp_63'></div> <div class='ms-border-color-neutralTertiary ms-bg-color-white _mcp_W2'></div> <div class='_mcp_V2'>  <div class='_mcp_a3'></div> </div> <div class='ms-border-color-neutralTertiary ms-bg-color-white _mcp_73'></div> </div> </div><div> <button autoid=\"_mcp_t\" type='button' class='_mcp_d3'></button> <button autoid=\"_mcp_u\" type='button' class='_mcp_d3'></button> </div><div> <span class='_mcp_b3 ms-font-weight-regular ms-font-color-neutralPrimary'></span> <div autoid=\"_mcp_q\" class='_mcp_c3'></div> <button autoid=\"_mcp_r\" type='button' class='_mcp_d3'></button> <button autoid=\"_mcp_s\" type='button' class='_mcp_d3'></button>  <div></div> <div class='_mcp_e3'></div>  </div><div> <span class='_mcp_f3 ms-font-weight-regular ms-font-color-neutralPrimary'></span> <div class='_mcp_g3'></div> <button type='button' class='_mcp_h3'></button> <button type='button' class='_mcp_h3'></button>  </div><div> <div class='_mcp_k3'> <label></label> </div> <div class='_mcp_k3'> <label class='_mcp_q3'></label> <div class='_mcp_o3'> <input class='_mcp_m3'/> <input class='_mcp_m3'/> <input class='_mcp_m3'/> </div> </div> </div><div> <span class='_mcp_i3 ms-font-weight-regular ms-font-color-neutralPrimary'></span> <div class='_mcp_l3'></div> <span class='_mcp_j3 ms-font-weight-regular ms-font-color-neutralPrimary'></span> </div><div> <div class='_mcp_r3'> <div class='_mcp_y3'> <button type='button' class='_mcp_u3'></button> <span class='_mcp_x3 ms-font-xl  ms-font-weight-semilight ms-font-color-neutralPrimary'></span> </div>  <div class='_mcp_v3'> <div class='ms-border-color-neutralTertiaryAlt _mcp_w3'></div> </div> <div class='_mcp_s3'> <button type='button' class='_mcp_t3'></button> <button type='button' class='_mcp_t3'></button> </div> </div> </div>";_j.i.a().appendChild(n);return n};_mcp.a.fx=function(n){return n.e()};_mcp.a.fy=function(n){return n.f()};_mcp.a.fv=function(n){return n.b};_mcp.a.fw=function(n){return n.c};_mcp.a.gt=function(n){return n.b};_mcp.a.gs=function(n){return n.a};_mcp.a.bb=function(n){return n.V()};_mcp.a.go=function(n){return n.c};_mcp.a.gq=function(n){return n.b};_mcp.a.gp=function(n){return n.a};_mcp.a.ch=function(n){return n.b()};_mcp.a.gC=function(n){return n.l};_mcp.a.gv=function(n){return n.d};_mcp.a.gA=function(n){return n.i};_mcp.a.gy=function(n){return n.g};_mcp.a.ea=function(n){return n.a};_mcp.a.gw=function(n){return n.b};_mcp.a.gD=function(n){return n.m};_mcp.a.gB=function(n){return n.j};_mcp.a.gx=function(n){return n.f};_mcp.a.gu=function(n){return n.c};_mcp.a.cB=function(n){return n.e};_mcp.a.gz=function(n){return n.h};_mcp.a.d=function(n){return n.bd()};_mcp.a.F=function(n){return _mcp.f.isInstanceOfType(n)?n.bq:null};_mcp.a.dS=function(n){return n.n()};_mcp.a.bp=function(n){return n.ci()};_mcp.a.bk=function(n){return n.a()};_mcp.a.A=function(n){return n.q()};_mcp.a.W=function(n){return n.k()};_mcp.a.dT=function(n){return n.x()};_mcp.a.f=function(n){return n.ba};_mcp.a.bj=function(n){return n.w()};_mcp.a.eA=function(n){return _mcp.i.isInstanceOfType(n)?n.gZ():null};_mcp.a.S=function(n){return n.by()};_mcp.a.O=function(n){return n.a()};_mcp.a.r=function(n){return n.er()};_mcp.a.dO=function(n){return n.d()};_mcp.a.bU=function(n){return n.a()};_mcp.a.bW=function(n){return _mcp.h.isInstanceOfType(n)?n.j():null};_mcp.a.ec=function(n){return _mcp.b.isInstanceOfType(n)?_u.P.R:null};_mcp.a.dN=function(n){return n.c()};_mcp.a.dM=function(n){return n.b()};_mcp.a.V=function(n){return n.bO()};_mcp.a.ga=function(n){return n.a()};_mcp.a.dW=function(n){return n.h()};_mcp.a.dV=function(n){return n.d()};_mcp.a.fh=function(n){return n.d()};_mcp.a.dc=function(n){return n.be};_mcp.a.db=function(n){return n.v()};_mcp.a.H=function(n){return n.bY};_mcp.a.eB=function(n){return n.dr};_mcp.a.ef=function(n){return _a.g.b};_mcp.a.y=function(n){return n.bj()};_mcp.a.bF=function(n){return n.a()};_mcp.a.bS=function(n){return n.b()};_mcp.a.gG=function(n){return n.fj()};_mcp.a.cK=function(n){return n.co};_mcp.a.ca=function(n){return n.ce};_mcp.a.fq=function(n){return n.u()};_mcp.a.eP=function(n){return n.j()};_mcp.a.hv=function(n){return n.hb()};_mcp.a.hu=function(n){return n.ha()};_mcp.a.cL=function(n){return n.bM()};_mcp.a.fW=function(n){return n.a()};_mcp.a.bG=function(n){return n.bl()};_mcp.a.cy=function(n){return n.d()};_mcp.a.C=function(n){return n.bg()};_mcp.a.cA=function(n){return _mcp.u.isInstanceOfType(n)?n.C:null};_mcp.a.cC=function(n){return n.dd()};_mcp.a.bV=function(n){return n.a()};_mcp.a.cw=function(n){return n.w()};_mcp.a.p=function(n){return n.X};_mcp.a.cY=function(n){return _mcp.i.isInstanceOfType(n)?n.cz:null};_mcp.a.bq=function(n){return _mcp.i.isInstanceOfType(n)?n.bs:null};_mcp.a.cE=function(n){return n.bb};_mcp.a.s=function(n){return n.eo()};_mcp.a.bZ=function(n){return n.dy()};_mcp.a.ez=function(n){return n.eJ()};_mcp.a.bT=function(n){return n.z()};_mcp.a.R=function(n){return n.c()};_mcp.a.B=function(n){return n.Q()};_mcp.a.l=function(n){return n.en()};_mcp.a.v=function(n){return n.v()};_mcp.a.hx=function(n){return n.hc()};_mcp.a.cF=function(n){return n.fp()};_mcp.a.bm=function(n){return n.a};_mcp.a.bc=function(n){return _rw.c.isInstanceOfType(n)?n.er():null};_mcp.a.bl=function(n){return n.b};_mcp.a.Q=function(n){return n.h()};_mcp.a.ht=function(n){return n.fQ()};_mcp.a.cs=function(n){return n.Y()};_mcp.a.P=function(n){return n.o()};_mcp.a.hs=function(n){return n.fP()};_mcp.a.bD=function(n){return n.bk()};_mcp.a.bn=function(n){return n.bL()};_mcp.a.fD=function(n){return n.f()};_mcp.a.ct=function(n){return n.a()};_mcp.a.dC=function(n){return n.v()};_mcp.a.dB=function(n){return n.o()};_mcp.a.cD=function(n){return n.em()};_mcp.a.cv=function(n){return n.a()};_mcp.a.cr=function(n){return n.X()};_mcp.a.bw=function(n){return n.b};_mcp.a.eb=function(n){return _mcp.b.isInstanceOfType(n)?255:null};_mcp.a.dA=function(n){return n.bx()};_mcp.a.dx=function(n){return n.bK()};_mcp.a.x=function(n){return n.bc()};_mcp.a.bE=function(n){return n.a()};_mcp.a.fd=function(n){return n.m()};_mcp.a.G=function(n){return _mcp.b.isInstanceOfType(n)?n.gh():null};_mcp.a.bX=function(n){return _mcp.b.isInstanceOfType(n)?n.gg():null};_mcp.a.dw=function(n){return n.y()};_mcp.a.dh=function(n){return n.ca()};_mcp.a.dv=function(n){return n.h()};_mcp.a.di=function(n){return n.ch()};_mcp.a.ee=function(n){return n.bD()};_mcp.a.dJ=function(n){return n.b()};_mcp.a.dg=function(n){return n.bQ};_mcp.a.hr=function(n){return n.dk()};_mcp.a.hq=function(n){return n.bl()};_mcp.a.ed=function(n){return n.ej()};_mcp.a.dU=function(n){return n.c()};_mcp.a.dz=function(n){return n.dv()};_mcp.a.ei=function(n){return n.bh};_mcp.a.fX=function(n){return n.h()};_mcp.a.fY=function(n){return n.i()};_mcp.a.t=function(n){return n.c()};_mcp.a.dI=function(n){return n.c()};_mcp.a.bg=function(n){return n.r};_mcp.a.bh=function(n){return n.y};_mcp.a.bd=function(n){return n.q};_mcp.a.be=function(n){return n.x};_mcp.a.bf=function(n){return n.p};_mcp.a.ej=function(n){return n.cc()};_mcp.a.dQ=function(n){return n.a()};_mcp.a.bB=function(n){return n.H};_mcp.a.bu=function(n){return n.bU};_mcp.a.ek=function(n){return n.cd()};_mcp.a.dR=function(n){return n.a()};_mcp.a.gL=function(n){return n.bP};_mcp.a.U=function(n){return n.cI()};_mcp.a.fO=function(n){return n.i()};_mcp.a.fK=function(n){return n.f()};_mcp.a.fL=function(n){return n.h()};_mcp.a.cH=function(n){return n.bW};_mcp.a.bo=function(n){return n.ep()};_mcp.a.dY=function(n){return _mcp.f.isInstanceOfType(n)?n.co:null};_mcp.a.bY=function(n){return!n.dI};_mcp.a.fg=function(n){return n.c()};_mcp.a.cJ=function(n){return n.bn()};_mcp.a.dy=function(n){return n.cs()};_mcp.a.fS=function(n){return n.B()};_mcp.a.fR=function(n){return n.A()};_mcp.a.cG=function(n){return n.bm()};_mcp.a.dX=function(n){return _mcp.t.isInstanceOfType(n)?n.B:null};_mcp.a.dL=function(n){return n.m()};_mcp.a.bH=function(n){return n.x()};_mcp.a.gN=function(n){return n.dA()};_mcp.a.fo=function(n){return n.q};_mcp.a.eN=function(n){return n.x.length};_mcp.a.bA=function(n){return n.bp()};_mcp.a.cV=function(n){return n.bc};_mcp.a.T=function(n){return n.bq()};_mcp.a.cu=function(n){return n.a()};_mcp.a.cx=function(n){return n.y()};_mcp.a.gm=function(n){return _mcp.f.isInstanceOfType(n)?n.dY():null};_mcp.a.gn=function(n){return _mcp.f.isInstanceOfType(n)?n.ea():null};_mcp.a.gl=function(n){return _mcp.f.isInstanceOfType(n)?n.dV():null};_mcp.a.gk=function(n){return _mcp.f.isInstanceOfType(n)?n.dU():null};_mcp.a.cz=function(n){return _mcp.f.isInstanceOfType(n)?n.dt():null};_mcp.a.fn=function(n){return n.bS()};_mcp.a.hz=function(n){return n.iB()};_mcp.a.hy=function(n){return n.fR()};_mcp.a.hh=function(n){return n.gE()};_mcp.a.hk=function(n){return n.gI()};_mcp.a.hf=function(n){return n.gD()};_mcp.a.hw=function(n){return n.dt};_mcp.a.fe=function(n){return n.n()};_mcp.a.hi=function(n){return n.fu()};_mcp.a.he=function(n){return n.bl()};_mcp.a.hl=function(n){return n.dK()};_mcp.a.gF=function(n){return n.bk()};_mcp.a.gE=function(n){return _mcp.b.isInstanceOfType(n)?n.gi():null};_mcp.a.gM=function(n){return n.bF};_mcp.a.gh=function(n){return _mcp.s.isInstanceOfType(n)?n.v:null};_mcp.a.gi=function(n){return _mcp.s.isInstanceOfType(n)?n.l():null};_mcp.a.gj=function(n){return _mcp.t.isInstanceOfType(n)?n.v:null};_mcp.a.cW=function(n){return n.cp()};_mcp.a.hj=function(n){return n.fv()};_mcp.a.hg=function(n){return n.ft()};_mcp.a.hm=function(n){return n.fw()};_mcp.a.fV=function(n){return n.f()};_mcp.a.gH=function(n){return n.ft()};_mcp.a.dH=function(n){return n.l()};_mcp.a.dG=function(n){return n.w()};_mcp.a.gb=function(n){return _mcp.m.isInstanceOfType(n)?n.N:null};_mcp.a.gJ=function(n){return n.fv()};_mcp.a.fz=function(n){return n.f()};_mcp.a.cU=function(n){return n.bP};_mcp.a.gI=function(n){return!n.dH};_mcp.a.hp=function(n){return n.u()};_mcp.a.gO=function(n){return n.eq()};_mcp.a.gP=function(n){return n.cJ()};_mcp.a.fT=function(n){return n.a()};_mcp.a.hn=function(n){return n.fx()};_mcp.a.gf=function(n){return _mcp.A.isInstanceOfType(n)?n.bI():null};_mcp.a.fI=function(n){return n.n()};_mcp.a.M=function(n){return n.q()};_mcp.a.dZ=function(n){return _mcp.z.isInstanceOfType(n)?n.w:null};_mcp.a.ff=function(n){return n.C()};_mcp.a.gQ=function(n){return n.cn};_mcp.a.fE=function(n){return n.f()};_mcp.a.fF=function(n){return n.b()};_mcp.a.gc=function(n){return _mcp.p.isInstanceOfType(n)?n.m:null};_mcp.a.gd=function(n){return _mcp.p.isInstanceOfType(n)?n.n:null};_mcp.a.cq=function(n){return n.z};_mcp.a.fU=function(n){return n.j()};_mcp.a.fk=function(n){return n.j()};_mcp.a.fl=function(n){return n.l()};_mcp.a.fi=function(n){return n.h()};_mcp.a.fj=function(n){return n.i()};_mcp.a.fN=function(n){return n.b()};_mcp.a.fM=function(n){return n.a()};_mcp.a.gR=function(n){return n.ev()};_mcp.a.eg=function(n){return n.bA()};_mcp.a.gg=function(n){return _mcp.L.isInstanceOfType(n)?n.M():null};_mcp.a.cX=function(n){return n.m};_mcp.a.eH=function(n){return n.j};_mcp.a.fJ=function(n){return n.a()};_mcp.a.eh=function(n){return n.dB()};_mcp.a.fC=function(n){return n.a()};_mcp.a.ho=function(n){return n.p()};_mcp.a.fB=function(n){return n.b()};_mcp.a.cI=function(n){return n.cU};_mcp.a.fH=function(n){return n.K()};_mcp.a.fp=function(n){return n.a()};_mcp.a.ew=function(n){return n.q()};_mcp.a.ex=function(n){return n.r()};_mcp.a.gK=function(n){return n.cl};_mcp.a.gT=function(n){return n.b};_mcp.a.gU=function(n){return n.i};_mcp.a.gV=function(n){return n.c};_mcp.a.gW=function(n){return n.j};_mcp.a.eo=function(n){return n.s()};_mcp.a.en=function(n){return n.d};_mcp.a.el=function(n){return n.e};_mcp.a.ep=function(n){return!_a.g.b};_mcp.a.em=function(n){return n.f};_mcp.a.eq=function(n){return!_a.g.b};_mcp.a.gS=function(n){return n.h};_mcp.a.eu=function(n){return n.m()};_mcp.a.cb=function(n){return n.c};_mcp.a.cN=function(n){return n.d()};_mcp.a.cP=function(n){return n.a};_mcp.a.cO=function(n){return n.e()};_mcp.a.cR=function(n){return n.d};_mcp.a.cl=function(n){return n.t()};_mcp.a.cM=function(n){return n.c};_mcp.a.cc=function(n){return n.e};_mcp.a.cd=function(n){return n.f};_mcp.a.ha=function(n){return n.a};_mcp.a.eJ=function(n){return n.a()};_mcp.a.gZ=function(n){return n.g};_mcp.a.ev=function(n){return n.p()};_mcp.a.hc=function(n){return n.a};_mcp.a.hd=function(n){return n.q()};_mcp.a.h=function(n,t){n.a(t)};_mcp.a.i=function(n,t){n.T(t)};_mcp.a.ci=function(n,t){n.c(t)};_mcp.a.gr=function(n,t){n.d(t)};_mcp.a.cj=function(n,t){n.d(t)};_mcp.a.b=function(n,t){n.K(t)};_mcp.a.g=function(n,t){n.ba(t)};_mcp.a.m=function(n,t){n.l(t)};_mcp.a.k=function(n,t){n.k(t)};_mcp.a.j=function(n,t){n.Q(t)};_mcp.a.Y=function(n,t){n.c(t)};_mcp.a.N=function(n,t){n.m(t)};_mcp.a.X=function(n,t){n.j(t)};_mcp.a.dP=function(n,t){n.f(t)};_mcp.a.dr=function(n,t){n.a(t)};_mcp.a.br=function(n,t){n.m(t)};_mcp.a.D=function(n,t){n.r(t)};_mcp.a.I=function(n,t){n.b(t)};_mcp.a.bt=function(n,t){n.d(t)};_mcp.a.q=function(n,t){n.a(t)};_mcp.a.dd=function(n,t){n.c(t)};_mcp.a.eQ=function(n,t){n.c(t)};_mcp.a.n=function(n,t){n.l=t};_mcp.a.ba=function(n,t){n.n=t};_mcp.a.ck=function(n,t){n.m=t};_mcp.a.df=function(n,t){n.d(t)};_mcp.a.E=function(n,t){n.Q(t)};_mcp.a.by=function(n,t){n.g(t)};_mcp.a.dF=function(n,t){n.t(t)};_mcp.a.bz=function(n,t){n.c(t)};_mcp.a.bx=function(n,t){n.a(t)};_mcp.a.fA=function(n,t){n.D(t)};_mcp.a.cn=function(n,t){n.gu(t)};_mcp.a.dn=function(n,t){n.gx(t)};_mcp.a.dE=function(n,t){n.r(t)};_mcp.a.dk=function(n,t){n.ci(t)};_mcp.a.dD=function(n,t){n.i(t)};_mcp.a.dm=function(n,t){n.cy(t)};_mcp.a.dK=function(n,t){n.a(t)};_mcp.a.dj=function(n,t){n.bi(t)};_mcp.a.dl=function(n,t){n.cd=t};_mcp.a.eS=function(n,t){n.bS(t)};_mcp.a.dp=function(n,t){n.cu=t};_mcp.a.ds=function(n,t){n.L=t};_mcp.a.du=function(n,t){n.bP(t)};_mcp.a.dt=function(n,t){n.bN(t)};_mcp.a.bR=function(n,t){n.bV(t)};_mcp.a.dq=function(n,t){n.a(t)};_mcp.a.cp=function(n,t){n.k(t)};_mcp.a.co=function(n,t){n.b(t)};_mcp.a.fZ=function(n,t){n.k(t)};_mcp.a.u=function(n,t){n.a(t)};_mcp.a.bi=function(n,t){n.f(t)};_mcp.a.K=function(n,t){n.o(t)};_mcp.a.L=function(n,t){n.j(t)};_mcp.a.Z=function(n,t){n.n(t)};_mcp.a.J=function(n,t){n.m(t)};_mcp.a.bC=function(n,t){n.A(t)};_mcp.a.bv=function(n,t){n.dQ(t)};_mcp.a.o=function(n,t){n.bk(t)};_mcp.a.eL=function(n,t){n.a(t)};_mcp.a.eO=function(n,t){n.D(t)};_mcp.a.ce=function(n,t){n.cF(t)};_mcp.a.cT=function(n,t){n.a=t};_mcp.a.eM=function(n,t){n.s(t)};_mcp.a.eR=function(n,t){n.cA=t};_mcp.a.fc=function(n,t){n.k=t};_mcp.a.eY=function(n,t){n.cS(t)};_mcp.a.eX=function(n,t){n.cc(t)};_mcp.a.eZ=function(n,t){n.ef(t)};_mcp.a.eT=function(n,t){n.bn(t)};_mcp.a.fb=function(n,t){n.f=t};_mcp.a.fa=function(n,t){n.p=t};_mcp.a.eI=function(n,t){n.b=t};_mcp.a.bs=function(n,t){n.o(t)};_mcp.a.eW=function(n,t){n.m=t};_mcp.a.eU=function(n,t){n.q=t};_mcp.a.eV=function(n,t){n.bg(t)};_mcp.a.fu=function(n,t){n.b=t};_mcp.a.fr=function(n,t){n.b=t};_mcp.a.ft=function(n,t){n.f=t};_mcp.a.fs=function(n,t){n.d=t};_mcp.a.z=function(n,t){n.p(t)};_mcp.a.fG=function(n,t){n.i(t)};_mcp.a.ge=function(n,t){n.o(t)};_mcp.a.cg=function(n,t){n.bc(t)};_mcp.a.fm=function(n,t){n.m(t)};_mcp.a.fQ=function(n,t){n.d(t)};_mcp.a.fP=function(n,t){n.c(t)};_mcp.a.ey=function(n,t){n.o(t)};_mcp.a.gX=function(n,t){n.q(t)};_mcp.a.gY=function(n,t){n.r(t)};_mcp.a.et=function(n,t){n.p(t)};_mcp.a.er=function(n,t){n.n(t)};_mcp.a.es=function(n,t){n.o(t)};_mcp.a.de=function(n,t){n.a=t};_mcp.a.cQ=function(n,t){n.f(t)};_mcp.a.cS=function(n,t){n.j(t)};_mcp.a.cm=function(n,t){n.m(t)};_mcp.a.hb=function(n,t){n.o(t)};_mcp.a.eK=function(n,t){n.b(t)};_mcp.a.eF=function(){_mcp.a.bP||(_mcp.a.bP=new _mcp.ca);return _mcp.a.bP};_mcp.a.w=function(){_mcp.a.bL||(_mcp.a.bL=new _fc.l);return _mcp.a.bL};_mcp.a.c=function(){_mcp.a.bI||(_mcp.a.bI=new _fc.k);return _mcp.a.bI};_mcp.a.cf=function(){_mcp.a.bO||(_mcp.a.bO=new _n.B);return _mcp.a.bO};_mcp.a.cZ=function(){_mcp.a.bM||(_mcp.a.bM=new _b.bv);return _mcp.a.bM};_mcp.a.eE=function(){_mcp.a.bN||(_mcp.a.bN=new _n.bh);return _mcp.a.bN};_mcp.a.eC=function(){_mcp.a.bJ||(_mcp.a.bJ=new _fce.t);return _mcp.a.bJ};_mcp.a.eD=function(){_mcp.a.bK||(_mcp.a.bK=new _fce.G);return _mcp.a.bK};_mcp.a.da=function(){_mcp.a.bQ||(_mcp.a.bQ=new _mcp.cb);return _mcp.a.bQ};_mcp.a._I=function(){var nt="AddOriginalAttachmentInfoBarView._tid1";new _j.d(nt,function(){_mcp.a.a[nt]===undefined&&(_mcp.a.a[nt]=[[[-1,0,["IncludeButtonText"],[_mcp.a.fx],null,"Text",null,_mcp.a.h,0,null,null,null]]]);var n=_mcp.a.e.childNodes[0].cloneNode(!0);var t=new _fc.a(n.children[0]);return new _j.a(n,[t])},"",_mcp.Q,_fc.e,function(n){return new _fc.e(n)},!1,!0,!1,0,_mcp.a.a);var g="AddOriginalAttachmentInfoBarView._tid2";new _j.d(g,function(){_mcp.a.a[g]===undefined&&(_mcp.a.a[g]=[[[-1,4,null,null,null,"Text",null,_mcp.a.h,0,null,null,null,_u.n.Mh]]]);var n=_mcp.a.e.childNodes[0].cloneNode(!0);var t=new _fc.a(n.children[0]);return new _j.a(n,[t])},"",_mcp.Q,_fc.e,function(n){return new _fc.e(n)},!1,!0,!1,0,_mcp.a.a);var it="AddOriginalAttachmentInfoBarView";new _j.d(it,function(){_mcp.a.a[it]===undefined&&(_mcp.a.a[it]=[[[-1,0,["InfoBarText"],[_mcp.a.fy],null,"Text",null,_mcp.a.h,1,null,null,null]],[[-1,0,["AddAttachmentCommand"],[_mcp.a.fv],null,"ClickCommand",null,_mcp.a.i,0,null,null,null]],null,[[-1,0,["DismissInfoBarCommand"],[_mcp.a.fw],null,"ClickCommand",null,_mcp.a.i,0,null,null,null]]]);var n=_mcp.a.e.childNodes[1].cloneNode(!0);var r=new _fc.e(_j.a.a(n,[0,3]));r.y("AddOriginalAttachmentInfoBarView._tid2");var i=new _fc.a(_j.a.a(n,[0,2]));i.a("|");var t=new _fc.e(_j.a.a(n,[0,1]));t.y("AddOriginalAttachmentInfoBarView._tid1");var u=new _fc.a(_j.a.a(n,[0,0]));return new _j.a(n,[u,t,i,r])},"",_mcp.Q,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_mcp.a.a);var tt="IrmDialogView";new _j.d(tt,function(){_mcp.a.a[tt]===undefined&&(_mcp.a.a[tt]=[[[-1,0,["Description"],[_mcp.a.gt],null,"Text",null,_mcp.a.h,1,null,null,null]],[[-1,0,["ConversationOwner"],[_mcp.a.gs],null,"Text",null,_mcp.a.h,1,null,null,null]]]);var n=_mcp.a.e.childNodes[2].cloneNode(!0);var i=new _fc.a(n.children[1]);var t=new _fc.a(n.children[0]);return new _j.a(n,[t,i])},"",_mcp.bn,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_mcp.a.a);var b="IrmChangePermissionDialogView.PickerOption";new _j.d(b,function(){_mcp.a.a[b]===undefined&&(_mcp.a.a[b]=[[[-1,1,["DataContext"],[_mcp.a.bb],null,"Text",null,_mcp.a.h,1,_mcp.a.eF(),null,null]]]);var n=_mcp.a.e.childNodes[0].cloneNode(!0);var t=new _fc.a(n.children[0]);return new _j.a(n,[t])},"",String,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_mcp.a.a);var w="IrmChangePermissionDialogView";new _j.d(w,function(){_mcp.a.a[w]===undefined&&(_mcp.a.a[w]=[[[-1,0,["MenuText"],[_mcp.a.go],null,"Text",null,_mcp.a.h,1,null,null,null]],[[-1,0,["TemplateLists"],[_mcp.a.gq],null,"Options",null,_mcp.a.ci,1,null,null,null],[-1,0,["Rmstemplate"],[_mcp.a.gp],_mcp.a.gr,"SelectedValue",_mcp.a.ch,_mcp.a.cj,2,null,null,null]]]);var n=_mcp.a.e.childNodes[3].cloneNode(!0);var t=new _fce.k(n.children[1]);t.a("IrmChangePermissionDialogView.PickerOption");var i=new _fc.a(n.children[0]);return new _j.a(n,[i,t])},"",_mcp.bm,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_mcp.a.a);var d="IrmInfoView._tid3";new _j.d(d,function(){_mcp.a.a[d]===undefined&&(_mcp.a.a[d]=[[[-1,0,["ShowMoreLink"],[_mcp.a.gC],null,"Text",null,_mcp.a.h,1,null,null,null]]]);var n=_mcp.a.e.childNodes[0].cloneNode(!0);var t=new _fc.a(n.children[0]);return new _j.a(n,[t])},"",_mcp.v,_fc.e,function(n){return new _fc.e(n)},!1,!0,!1,0,_mcp.a.a);var k="IrmInfoView._tid4";new _j.d(k,function(){_mcp.a.a[k]===undefined&&(_mcp.a.a[k]=[[[-1,0,["ChangeRestrictionLink"],[_mcp.a.gv],null,"Text",null,_mcp.a.h,1,null,null,null]]]);var n=_mcp.a.e.childNodes[0].cloneNode(!0);var t=new _fc.a(n.children[0]);return new _j.a(n,[t])},"",_mcp.v,_fc.e,function(n){return new _fc.e(n)},!1,!0,!1,0,_mcp.a.a);var st="IrmInfoView._tid5";new _j.d(st,function(){_mcp.a.a[st]===undefined&&(_mcp.a.a[st]=[[[-1,0,["RemoveRestrictionLink"],[_mcp.a.gA],null,"Text",null,_mcp.a.h,1,null,null,null]]]);var n=_mcp.a.e.childNodes[0].cloneNode(!0);var t=new _fc.a(n.children[0]);return new _j.a(n,[t])},"",_mcp.v,_fc.e,function(n){return new _fc.e(n)},!1,!0,!1,0,_mcp.a.a);var ot="IrmInfoView";new _j.d(ot,function(){_mcp.a.a[ot]===undefined&&(_mcp.a.a[ot]=[[[-1,0,["PreviewText"],[_mcp.a.gy],null,"Text",null,_mcp.a.h,1,null,null,null],[-1,0,["Expanded"],[_mcp.a.ea],null,"IsHidden",null,_mcp.a.b,1,null,null,!0]],[[-1,0,["FullText"],[_mcp.a.gw],null,"Text",null,_mcp.a.h,1,null,null,null],[-1,0,["ShowPreview"],[_mcp.a.gD],null,"IsHidden",null,_mcp.a.b,1,null,null,!0]],[[-1,0,["ShowMoreCommand"],[_mcp.a.gB],null,"ClickCommand",null,_mcp.a.i,1,null,null,null],[-1,0,["Expanded"],[_mcp.a.ea],null,"IsHidden",null,_mcp.a.b,1,null,null,!0]],[[-1,0,["HideFirstSeparator"],[_mcp.a.gx],null,"IsHidden",null,_mcp.a.b,1,null,null,!0]],[[-1,0,["ChangeRestrictionCommand"],[_mcp.a.gu],null,"ClickCommand",null,_mcp.a.i,1,null,null,null],[-1,0,["HideComplianceOptions"],[_mcp.a.cB],null,"IsHidden",null,_mcp.a.b,1,null,null,!0]],[[-1,0,["HideComplianceOptions"],[_mcp.a.cB],null,"IsHidden",null,_mcp.a.b,1,null,null,!0]],[[-1,0,["RemoveRestrictionCommand"],[_mcp.a.gz],null,"ClickCommand",null,_mcp.a.i,1,null,null,null],[-1,0,["HideComplianceOptions"],[_mcp.a.cB],null,"IsHidden",null,_mcp.a.b,1,null,null,!0]]]);var n=_mcp.a.e.childNodes[4].cloneNode(!0);var u=new _fc.e(_j.a.a(n,[0,2,4]));u.y("IrmInfoView._tid5");var f=new _fc.a(_j.a.a(n,[0,2,3]));f.a("|");var r=new _fc.e(_j.a.a(n,[0,2,2]));r.y("IrmInfoView._tid4");var t=new _fc.a(_j.a.a(n,[0,2,1]));t.a("|");var i=new _fc.e(_j.a.a(n,[0,2,0]));i.y("IrmInfoView._tid3");var o=new _fc.a(_j.a.a(n,[0,1]));var e=new _fc.a(_j.a.a(n,[0,0]));return new _j.a(n,[e,o,i,t,r,f,u])},"",_mcp.v,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_mcp.a.a);var ct="MailComposeView._tid6._tid8";new _j.d(ct,function(){_mcp.a.a[ct]===undefined&&(_mcp.a.a[ct]=[[[-1,0,["RecipientComponent","FromPersonaViewModel"],[_mcp.a.d,_mcp.a.F],null,"DataContext",null,_mcp.a.g,1,null,null,null]]]);var t=_mcp.a.e.childNodes[0].cloneNode(!0);var n=new _pe.d(t.children[0],_j.b.Instance.a(_a.r),_j.b.Instance.a(_pe.e));n.j("_mcp_C ms-font-weight-regular ms-font-color-black bidi");n.y("PersonaView.BasicDetailsPopup");n.bb("MailCompose.FromRecipientWellButton");return new _j.a(t,[n])},"",_mcp.d,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var ht="MailComposeView._tid6._tid9";new _j.d(ht,function(){_mcp.a.a[ht]===undefined&&(_mcp.a.a[ht]=[[[-1,0,["RecipientComponent","FromFindRecipientViewModel"],[_mcp.a.d,_mcp.a.dS],null,"DataContext",null,_mcp.a.g,1,null,null,null]]]);var t=_mcp.a.e.childNodes[5].cloneNode(!0);var n=new _fp.f(t.children[0],_j.b.Instance.a(_y.a),_j.b.Instance.a(_j.j));n.bb("MailCompose.FromRecipientWellButton");return new _j.a(t,[n])},"",_mcp.d,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var ut="MailComposeView._tid6";new _j.d(ut,function(){_mcp.a.a[ut]===undefined&&(_mcp.a.a[ut]=[[[-1,4,null,null,null,"ImageId",null,_mcp.a.m,0,null,null,null,_b.l.b()],[-1,4,null,null,null,"Text",null,_mcp.a.k,0,null,null,null,_nbs.a.QK],[-1,4,null,null,null,"AriaLabel",null,_mcp.a.j,0,null,null,null,_nbs.a.sP],[-1,5,["SendAsContextMenuComponent","Menu","IsShown"],[_mcp.a.bp,_mcp.a.bk,_mcp.a.A],null,"contextMenu",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","FromPersonaViewModel"],[_mcp.a.d,_mcp.a.F],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.w(),null,!0]],[[-1,0,["RecipientComponent","FromPersonaViewModel"],[_mcp.a.d,_mcp.a.F],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.w(),null,!0]],[[-1,0,["RecipientComponent","FromPersonaViewModel"],[_mcp.a.d,_mcp.a.F],null,"IsHidden",null,_mcp.a.b,1,new _j.r([_mcp.a.w(),_mcp.a.c()],[null,null]),null,!0],[-1,5,["RecipientComponent","ShouldHighlightFromAsInvalid"],[_mcp.a.d,_mcp.a.dT],null,"_mcp_l",null,null,0,null,null,null]]]);var t=_mcp.a.e.childNodes[6].cloneNode(!0);var u=new _j.c(t.children[3]);u.y("MailComposeView._tid6._tid9");var f=new _j.c(t.children[2]);var r=new _j.c(t.children[1]);r.y("MailComposeView._tid6._tid8");var n=new _fc.b(t.children[0]);n.y("MailComposeView.FromButtonTemplate");n.f("ms-bg-color-neutralLighter");n.c("ms-bg-color-neutralLight");n.e("ms-font-color-white ms-bg-color-themePrimary");n.O("MailCompose.FromRecipientWellButton");n.A(0);var i=new _fce.f(_j.b.Instance.a(_fc.f),_j.b.Instance.a(_j.j),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));i.U(_j.f.a(["SendAsContextMenuComponent","Menu"],[_mcp.a.bp,_mcp.a.bk],null,"MenuDataContext",null,_mcp.a.Y,1)).U(_j.f.a(["SendAsContextMenuComponent","Menu","IsShown"],[_mcp.a.bp,_mcp.a.bk,_mcp.a.A],_mcp.a.N,"IsShown",_mcp.a.W,_mcp.a.X,2,null,null,!1));i.a=3;i.b=1;n.C([i]);return new _j.a(t,[n,r,f,u]).l({FromPersona:r})},"",_mcp.d,_mcp.l,function(n){return new _mcp.l(n)},!1,!0,!1,0,_mcp.a.a);var rt="MailComposeView._tide";new _j.d(rt,function(){_mcp.a.a[rt]===undefined&&(_mcp.a.a[rt]=[[[-1,4,null,null,null,"Text",null,_mcp.a.h,0,null,null,null,_u.P.e]],[[-1,0,["Context","Subject"],[_mcp.a.f,_mcp.a.bj],null,"Text",null,_mcp.a.h,1,null,null,null]],[[-1,4,null,null,null,"ImageId",null,_mcp.a.m,0,null,null,null,_mcp.e.q()],[-1,1,["HideSubjectAffordanceButton"],[_mcp.a.eA],null,"IsHidden",null,_mcp.a.b,1,null,null,!0]]]);var t=_mcp.a.e.childNodes[7].cloneNode(!0);var i=new _fc.b(_j.a.a(t,[1,1]));var n=new _fce.f(_j.b.Instance.a(_fc.f),_j.b.Instance.a(_j.j),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));n.U(_j.f.a(["ContextMenuComponent","Menu"],[_mcp.a.S,_mcp.a.O],null,"MenuDataContext",null,_mcp.a.Y,1)).U(_j.f.a(["ContextMenuComponent","Menu","IsShown"],[_mcp.a.S,_mcp.a.O,_mcp.a.A],_mcp.a.N,"IsShown",_mcp.a.W,_mcp.a.X,2,null,null,!1));n.a=3;n.b=5;i.C([n]);var u=new _fc.a(_j.a.a(t,[1,0]));var r=new _fc.a(t.children[0]);return new _j.a(t,[r,u,i])},"",_mcp.d,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var et="MailComposeView._tidg._tidh";new _j.d(et,function(){_mcp.a.a[et]===undefined&&(_mcp.a.a[et]=[[[-1,0,["MeetingComponent","SenderDetailsViewModel"],[_mcp.a.r,_mcp.a.dO],_mcp.a.dP,"DataContext",_mcp.a.bb,_mcp.a.g,2,null,null,null]],[[-1,0,["MeetingComponent","FromDetailsViewModel"],[_mcp.a.r,_mcp.a.bU],null,"DataContext",null,_mcp.a.g,1,null,null,null]]]);var i=_mcp.a.e.childNodes[8].cloneNode(!0);var t=new _pe.d(i.children[1],_j.b.Instance.a(_a.r),_j.b.Instance.a(_pe.e));t.j("_mcp_r ms-font-weight-regular ms-font-color-black bidi");t.y("PersonaView.PresenceBasicDetailsPopup");var n=new _pe.d(i.children[0],_j.b.Instance.a(_a.r),_j.b.Instance.a(_pe.e));n.j("_mcp_r ms-font-weight-regular ms-font-color-black bidi");n.y("PersonaView.PresenceBasicDetailsPopup");return new _j.a(i,[n,t])},"",_mcp.d,_b.g,function(n){return new _b.g(n)},!1,!0,!1,0,_mcp.a.a);var ft="MailComposeView._tidg._tidi";new _j.d(ft,function(){_mcp.a.a[ft]===undefined&&(_mcp.a.a[ft]=[[[-1,0,["MeetingComponent","FromDetailsViewModel"],[_mcp.a.r,_mcp.a.bU],null,"DataContext",null,_mcp.a.g,1,null,null,null]]]);var t=_mcp.a.e.childNodes[9].cloneNode(!0);var n=new _pe.d(t.children[0],_j.b.Instance.a(_a.r),_j.b.Instance.a(_pe.e));n.j("_mcp_r ms-font-weight-regular ms-font-color-black bidi");n.y("PersonaView.PresenceBasicDetailsPopup");return new _j.a(t,[n])},"",_mcp.d,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var f="MailComposeView._tidg";new _j.d(f,function(){_mcp.a.a[f]===undefined&&(_mcp.a.a[f]=[[[-1,4,null,null,null,"Text",null,_mcp.a.h,0,null,null,null,_nbs.a.iv]],[[-1,4,null,null,null,"FormatString",null,_mcp.a.dr,0,null,null,null,_u.n.Ri],[-1,0,["MeetingComponent","IsMeetingForwardOnBehalfOf"],[_mcp.a.r,_mcp.a.bW],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,0,["MeetingComponent","IsMeetingForwardOnBehalfOf"],[_mcp.a.r,_mcp.a.bW],null,"IsHidden",null,_mcp.a.b,1,null,null,!0]]]);var n=_mcp.a.e.childNodes[10].cloneNode(!0);var i=new _j.c(_j.a.a(n,[1,1]));i.y("MailComposeView._tidg._tidi");var t=new _b.g(_j.a.a(n,[1,0]));t.y("MailComposeView._tidg._tidh");var r=new _fc.a(n.children[0]);return new _j.a(n,[r,t,i])},"",_mcp.d,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var u="MailComposeView._tidj";new _j.d(u,function(){_mcp.a.a[u]===undefined&&(_mcp.a.a[u]=[[[-1,0,["Context","WhenLabel"],[_mcp.a.f,_mcp.a.ec],null,"Text",null,_mcp.a.h,1,null,null,null]],[[-1,0,["MeetingComponent","MeetingCalendarTimePeriod"],[_mcp.a.r,_mcp.a.dN],null,"Text",null,_mcp.a.h,1,null,null,null]]]);var n=_mcp.a.e.childNodes[11].cloneNode(!0);var i=new _fc.a(_j.a.a(n,[1,0]));var t=new _fc.a(n.children[0]);return new _j.a(n,[t,i])},"",_mcp.d,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var o="MailComposeView._tidk";new _j.d(o,function(){_mcp.a.a[o]===undefined&&(_mcp.a.a[o]=[[[-1,4,null,null,null,"Text",null,_mcp.a.h,0,null,null,null,_u.P.J]],[[-1,0,["MeetingComponent","LocationViewModel"],[_mcp.a.r,_mcp.a.dM],null,"DataContext",null,_mcp.a.g,1,null,null,null]]]);var t=_mcp.a.e.childNodes[12].cloneNode(!0);var n=new _j.c(_j.a.a(t,[1,0]));n.y("LocationView");n.L(!0);var i=new _fc.a(t.children[0]);return new _j.a(t,[i,n])},"",_mcp.d,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var e="MailComposeView._tidm";new _j.d(e,function(){_mcp.a.a[e]===undefined&&(_mcp.a.a[e]=[[[-1,4,null,null,null,"ImageId",null,_mcp.a.m,0,null,null,null,_b.l.a()],[-1,4,null,null,null,"HoveredImageId",null,_mcp.a.br,0,null,null,null,_n.b.m()],[-1,4,null,null,null,"PressedImageId",null,_mcp.a.D,0,null,null,null,_n.b.m()],[-1,4,null,null,null,"Text",null,_mcp.a.k,0,null,null,null,_nbs.a.lE],[-1,4,null,null,null,"AriaLabel",null,_mcp.a.j,0,null,null,null,_nbs.a.lE],[-1,0,["UpgradeComponent","CompleteBodyUpgradeCommand"],[_mcp.a.V,_mcp.a.ga],null,"ClickCommand",null,_mcp.a.i,1,null,null,null],[-1,0,["UpgradeComponent","ShouldShowQuoteBodyButton"],[_mcp.a.V,_mcp.a.dW],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,4,null,null,null,"SpinnerSize",null,_mcp.a.I,0,null,null,0,0],[-1,4,null,null,null,"BusyText",null,_mcp.a.bt,0,null,null,null,_nbs.a.lE],[-1,0,["UpgradeComponent","IsWaitingForQuotedBody"],[_mcp.a.V,_mcp.a.dV],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]]]);var t=_mcp.a.e.childNodes[13].cloneNode(!0);var n=new _fce.h(t.children[1],_j.b.Instance.a(_j.p),_j.b.Instance.a(_ff.a));n.a=0;n.A(-1);var i=new _fc.b(t.children[0]);i.A(0);return new _j.a(t,[i,n])},"",_mcp.d,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var t="MailComposeView._tidn";new _j.d(t,function(){_mcp.a.a[t]===undefined&&(_mcp.a.a[t]=[[[-1,0,["IsXOwaExtensibilityActive"],[_mcp.a.fh],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]]]);var i=_mcp.a.e.childNodes[14].cloneNode(!0);var n=new _j.c(i.children[0]);n.y("XComposeExtensibilityView");return new _j.a(i,[n])},"",_y.hP,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var n="MailComposeView.FromButtonTemplate";new _j.d(n,function(){_mcp.a.a[n]===undefined&&(_mcp.a.a[n]=[[[-1,1,["Text"],[_mcp.a.dc],null,"Text",null,_mcp.a.h,1,null,null,null]],[[-1,1,["CurrentImageId"],[_mcp.a.db],null,"Id",null,_mcp.a.q,1,null,null,null]]]);var t=_mcp.a.e.childNodes[15].cloneNode(!0);var r=new _fc.d(t.children[1],_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));var i=new _fc.a(t.children[0]);return new _j.a(t,[i,r]).l({Label:i,Image:r})},"",Object,_fc.b,function(n){return new _fc.b(n)},!1,!1,!1,0,_mcp.a.a);var r="MailComposeView";new _j.d(r,function(){_mcp.a.a[r]===undefined&&(_mcp.a.a[r]=[[[-1,4,null,null,null,"SpinnerSize",null,_mcp.a.I,0,null,null,0,1],[-1,1,["IsReadyToShowContent"],[_mcp.a.H],null,"IsBusy",null,_mcp.a.dd,1,_mcp.a.c(),null,!1]],[[-1,1,["IsReadyToShowAppBarContent"],[_mcp.a.eB],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0],[-1,5,["GenericMailMode"],[_mcp.a.ef],null,"_mcp_X",null,null,0,_mcp.a.c(),null,null]],[[-1,5,["ExtensibilityComponent","ExtensibilityViewModel","AppPaneIsHidden"],[_mcp.a.y,_mcp.a.bF,_mcp.a.bS],null,"_mcp_71",null,null,0,_mcp.a.c(),null,null],[-1,5,["IsReadyToShowAppBarContent"],[_mcp.a.eB],null,"_mcp_W",null,null,1,null,null,null],[-1,5,["GenericMailMode"],[_mcp.a.ef],null,"_mcp_01",null,null,0,null,null,null],[-1,5,["DisableMomemtumScrolling"],[_mcp.a.gG],null,"_mcp_S",null,null,0,null,null,null]],[[-1,4,null,null,null,"SpinnerSize",null,_mcp.a.I,0,null,null,0,0],[-1,0,["ToolbarMessage"],[_mcp.a.cK],null,"BusyText",null,_mcp.a.bt,1,null,null,null],[-1,0,["ShouldShowToolbarMessage"],[_mcp.a.ca],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,1,["IsShowTopAppBar"],[_mcp.a.hv],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0],[-1,0,["TopAppBarViewModel"],[_mcp.a.fq],null,"DataContext",null,_mcp.a.g,1,null,null,null],[0,0,["Mode"],[_mcp.a.eP],null,"Mode",null,_mcp.a.eQ,1,null,null,0],[0,5,["IsIos"],[_mcp.a.hu],null,"_mcp_11:_mcp_21",null,null,1,null,null,null]],[[-1,1,["IsReadyToShowContent"],[_mcp.a.H],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,0,["InfoBarViewModel"],[_mcp.a.cE],null,"DataSource",null,_mcp.a.df,1,null,null,null],[-1,5,["IsFirefox"],[_mcp.a.s],null,"_mcp_41",null,null,0,null,null,null],[-1,5,["IsInternetExplorer"],[_mcp.a.bZ],null,"_mcp_31",null,null,0,null,null,null]],[[-1,5,["DoesSupportRichText"],[_mcp.a.ez],null,"_mcp_c",null,null,1,null,null,null]],[[-1,0,["Context","IsFromShown"],[_mcp.a.f,_mcp.a.bT],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,4,null,null,null,"Text",null,_mcp.a.k,0,null,null,null,_u.n.By],[-1,4,null,null,null,"AriaLabel",null,_mcp.a.j,0,null,null,null,_nbs.a.WI],[-1,0,["RecipientComponent","To","RichPeoplePickerCommand"],[_mcp.a.d,_mcp.a.R,_mcp.a.B],null,"ClickCommand",null,_mcp.a.i,1,null,null,null],[-1,5,["IsFirefox"],[_mcp.a.s],null,"_mcp_41",null,null,0,null,null,null],[-1,5,["IsChrome"],[_mcp.a.l],null,"chr",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp.a.d,_mcp.a.v],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],null,[[-1,4,null,null,null,"ImageId",null,_mcp.a.m,0,null,null,null,_mcp.e.d()],[-1,4,null,null,null,"PressedImageId",null,_mcp.a.D,0,null,null,null,_mcp.e.e()],[-1,1,["IsToRecipientWellPeoplePickerButtonShown"],[_mcp.a.hx],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0],[-1,0,["RecipientComponent","To","RichPeoplePickerCommand"],[_mcp.a.d,_mcp.a.R,_mcp.a.B],null,"ClickCommand",null,_mcp.a.i,1,null,null,null],[-1,5,["IsAndroid"],[_mcp.a.cF],null,"_mcp_Z",null,null,0,null,null,null]],[[-1,4,null,null,null,"AriaLabel",null,_mcp.a.E,0,null,null,null,_nbs.a.fZ],[-1,0,["RecipientComponent","To","ReadWriteRecipientWellViewModel"],[_mcp.a.d,_mcp.a.R,_mcp.a.bm],null,"DataContext",null,_mcp.a.g,1,null,null,null],[0,5,["IsAndroid"],[_mcp.a.bc],null,"_mcp_Z",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp.a.d,_mcp.a.v],null,"IsHidden",null,_mcp.a.b,1,null,null,!0]],[[-1,0,["RecipientComponent","To","ReadOnlyRecipientWellViewModel"],[_mcp.a.d,_mcp.a.R,_mcp.a.bl],null,"DataContext",null,_mcp.a.g,1,null,null,null],[0,5,["IsAndroid"],[_mcp.a.bc],null,"Android",null,null,0,null,null,null]],null,[[-1,4,null,null,null,"Text",null,_mcp.a.k,0,null,null,null,_u.n.Nk],[-1,4,null,null,null,"AriaLabel",null,_mcp.a.j,0,null,null,null,_nbs.a.nx],[-1,0,["RecipientComponent","Cc","RichPeoplePickerCommand"],[_mcp.a.d,_mcp.a.Q,_mcp.a.B],null,"ClickCommand",null,_mcp.a.i,1,null,null,null],[-1,5,["IsFirefox"],[_mcp.a.s],null,"_mcp_41",null,null,0,null,null,null],[-1,5,["IsChrome"],[_mcp.a.l],null,"chr",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp.a.d,_mcp.a.v],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],null,[[-1,4,null,null,null,"ImageId",null,_mcp.a.m,0,null,null,null,_mcp.e.d()],[-1,4,null,null,null,"PressedImageId",null,_mcp.a.D,0,null,null,null,_mcp.e.e()],[-1,1,["IsCcRecipientWellPeoplePickerButtonShown"],[_mcp.a.ht],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0],[-1,0,["RecipientComponent","Cc","RichPeoplePickerCommand"],[_mcp.a.d,_mcp.a.Q,_mcp.a.B],null,"ClickCommand",null,_mcp.a.i,1,null,null,null],[-1,5,["IsAndroid"],[_mcp.a.cF],null,"_mcp_Z",null,null,0,null,null,null]],[[-1,4,null,null,null,"AriaLabel",null,_mcp.a.E,0,null,null,null,_nbs.a.bB],[-1,0,["RecipientComponent","Cc","ReadWriteRecipientWellViewModel"],[_mcp.a.d,_mcp.a.Q,_mcp.a.bm],null,"DataContext",null,_mcp.a.g,1,null,null,null],[0,5,["IsAndroid"],[_mcp.a.bc],null,"_mcp_Z",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp.a.d,_mcp.a.v],null,"IsHidden",null,_mcp.a.b,1,null,null,!0]],[[-1,0,["RecipientComponent","Cc","ReadOnlyRecipientWellViewModel"],[_mcp.a.d,_mcp.a.Q,_mcp.a.bl],null,"DataContext",null,_mcp.a.g,1,null,null,null],[0,5,["IsAndroid"],[_mcp.a.bc],null,"_mcp_Z",null,null,0,null,null,null]],[[-1,0,["Context","IsBccShown"],[_mcp.a.f,_mcp.a.cs],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,4,null,null,null,"Text",null,_mcp.a.k,0,null,null,null,_u.n.KV],[-1,4,null,null,null,"AriaLabel",null,_mcp.a.j,0,null,null,null,_nbs.a.nL],[-1,0,["RecipientComponent","Bcc","RichPeoplePickerCommand"],[_mcp.a.d,_mcp.a.P,_mcp.a.B],null,"ClickCommand",null,_mcp.a.i,1,null,null,null],[-1,5,["IsFirefox"],[_mcp.a.s],null,"_mcp_41",null,null,0,null,null,null],[-1,5,["IsChrome"],[_mcp.a.l],null,"chr",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp.a.d,_mcp.a.v],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],null,[[-1,4,null,null,null,"ImageId",null,_mcp.a.m,0,null,null,null,_mcp.e.d()],[-1,4,null,null,null,"PressedImageId",null,_mcp.a.D,0,null,null,null,_mcp.e.e()],[-1,1,["IsBccRecipientWellPeoplePickerButtonShown"],[_mcp.a.hs],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0],[-1,0,["RecipientComponent","Bcc","RichPeoplePickerCommand"],[_mcp.a.d,_mcp.a.P,_mcp.a.B],null,"ClickCommand",null,_mcp.a.i,1,null,null,null],[-1,5,["IsAndroid"],[_mcp.a.cF],null,"_mcp_Z",null,null,0,null,null,null]],[[-1,4,null,null,null,"AriaLabel",null,_mcp.a.E,0,null,null,null,_nbs.a.TU],[-1,0,["RecipientComponent","Bcc","ReadWriteRecipientWellViewModel"],[_mcp.a.d,_mcp.a.P,_mcp.a.bm],null,"DataContext",null,_mcp.a.g,1,null,null,null],[0,5,["IsAndroid"],[_mcp.a.bc],null,"_mcp_Z",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp.a.d,_mcp.a.v],null,"IsHidden",null,_mcp.a.b,1,null,null,!0]],[[-1,0,["RecipientComponent","Bcc","ReadOnlyRecipientWellViewModel"],[_mcp.a.d,_mcp.a.P,_mcp.a.bl],null,"DataContext",null,_mcp.a.g,1,null,null,null],[0,5,["IsAndroid"],[_mcp.a.bc],null,"_mcp_Z",null,null,0,null,null,null]],[[-1,0,["Context","IsMeetingForward"],[_mcp.a.f,_mcp.a.bD],null,"IsHidden",null,_mcp.a.b,1,null,null,!0]],[[-1,4,null,null,null,"ImageId",null,_mcp.a.m,0,null,null,null,_mcp.e.c()],[-1,0,["ComplianceComponent","ShowIrmInformationCommand"],[_mcp.a.bn,_mcp.a.fD],null,"ClickCommand",null,_mcp.a.i,1,null,null,null],[-1,0,["ComplianceComponent","IsIrmProtected"],[_mcp.a.bn,_mcp.a.ct],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,4,null,null,null,"Id",null,_mcp.a.q,0,null,null,null,_n.b.Z()],[-1,0,["Context","SmimeSignMessage"],[_mcp.a.f,_mcp.a.dC],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,4,null,null,null,"Id",null,_mcp.a.q,0,null,null,null,_n.b.be()],[-1,0,["Context","SmimeEncryptMessage"],[_mcp.a.f,_mcp.a.dB],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,0,["ImportanceComponent","IsNormalImportance"],[_mcp.a.cD,_mcp.a.cv],null,"IsHidden",null,_mcp.a.b,1,null,null,!0],[-1,0,["Context","Importance"],[_mcp.a.f,_mcp.a.cr],null,"Id",null,_mcp.a.q,1,_mcp.a.cf(),!1,null]],[[-1,4,null,null,null,"ImageId",null,_mcp.a.m,0,null,null,null,_mcp.e.q()],[-1,1,["HideSubjectAffordanceButton"],[_mcp.a.eA],null,"IsHidden",null,_mcp.a.b,1,null,null,!0]],[[-1,4,null,null,null,"Placeholder",null,_mcp.a.by,0,null,null,null,_nbs.a.tF],[-1,0,["Context","Subject"],[_mcp.a.f,_mcp.a.bj],_mcp.a.dF,"Text",_mcp.a.bw,_mcp.a.bz,2,null,null,null],[-1,0,["Context","MaxSubjectLength"],[_mcp.a.f,_mcp.a.eb],null,"MaxLength",null,_mcp.a.bx,1,null,null,0]],[[-1,0,["Context","ShowMeetingReadonlyFields"],[_mcp.a.f,_mcp.a.dA],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,0,["Context","IsMeetingForward"],[_mcp.a.f,_mcp.a.bD],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,0,["Context","IsMeetingForward"],[_mcp.a.f,_mcp.a.bD],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],null,[[-1,0,["Context","HasLocation"],[_mcp.a.f,_mcp.a.dx],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,0,["AttachmentComponent","AttachmentWellViewModel","ShouldBeHidden"],[_mcp.a.x,_mcp.a.bE,_mcp.a.fd],null,"IsHidden",null,_mcp.a.b,1,null,null,!0]],[[-1,0,["AttachmentComponent","AttachmentWellViewModel"],[_mcp.a.x,_mcp.a.bE],_mcp.a.fA,"DataContext",_mcp.a.bb,_mcp.a.g,2,null,null,null]],[[-1,4,null,null,null,"Text",null,_mcp.a.h,0,null,null,null,_nbs.a.HG],[-1,0,["Context","IsPrintRestricted"],[_mcp.a.f,_mcp.a.G],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0],[-1,5,["Context","IsPrintRestricted"],[_mcp.a.f,_mcp.a.G],null,"noScreen:hiddenMsg",null,null,0,null,null,null]],null,[[-1,4,null,null,null,"EditorAriaLabel",null,_mcp.a.dl,0,null,null,null,_nbs.a.Qh],[-1,1,["EditorSizingMode"],[_mcp.a.hr],null,"SizingMode",null,_mcp.a.eS,1,null,null,0],[-1,1,["EditorMinHeight"],[_mcp.a.hq],null,"MinHeight",null,_mcp.a.dp,1,null,null,0],[-1,1,["IsReadyToShowContent"],[_mcp.a.H],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0],[-1,0,["Context","IsCopyRestricted"],[_mcp.a.f,_mcp.a.bX],null,"IsCopyRestricted",null,_mcp.a.cn,1,null,null,!1],[-1,0,["Context","IsPrintRestricted"],[_mcp.a.f,_mcp.a.G],null,"IsPrintRestricted",null,_mcp.a.dn,1,null,null,!1],[-1,0,["Context","EditorContent"],[_mcp.a.f,_mcp.a.dw],_mcp.a.dE,"Content",_mcp.a.dh,_mcp.a.dk,2,null,null,null],[-1,0,["Context","BodyType"],[_mcp.a.f,_mcp.a.dv],_mcp.a.dD,"IsPlainTextContent",_mcp.a.di,_mcp.a.dm,2,_mcp.a.cZ(),null,!1],[-1,0,["EditorComponent","EditorCallContext"],[_mcp.a.ee,_mcp.a.dJ],_mcp.a.dK,"CallContext",_mcp.a.dg,_mcp.a.dj,2,null,null,null],[-1,5,["Context","IsPrintRestricted"],[_mcp.a.f,_mcp.a.G],null,"noPrint",null,null,0,null,null,null]],[[-1,1,["IsReadyToShowContent"],[_mcp.a.H],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0],[-1,5,["UpgradeComponent","IsOnDemandUpgradePending"],[_mcp.a.V,_mcp.a.dU],null,"_mcp_R",null,null,0,_mcp.a.c(),null,null]],[[-1,1,["DoesSupportRichText"],[_mcp.a.ez],null,"IsHidden",null,_mcp.a.b,1,null,null,!0],[-1,0,["Context","IsCopyRestricted"],[_mcp.a.f,_mcp.a.bX],null,"TextSelectionType",null,_mcp.a.bR,1,_mcp.a.eE(),null,0]],[[-1,0,["Context","IsCopyRestricted"],[_mcp.a.f,_mcp.a.bX],null,"IsCopyRestricted",null,_mcp.a.cn,1,null,null,!1],[-1,0,["Context","QuotedBody"],[_mcp.a.f,_mcp.a.dz],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.w(),null,!0],[-1,0,["Context","QuotedBody"],[_mcp.a.f,_mcp.a.dz],null,"Html",null,_mcp.a.dq,1,null,null,null]],[[-1,0,["ExtensibilityComponent","ExtensibilityViewModel"],[_mcp.a.y,_mcp.a.bF],null,"DataContext",null,_mcp.a.g,1,null,null,null],[0,0,["AppPaneIsHidden"],[_mcp.a.bS],null,"IsHidden",null,_mcp.a.b,1,null,null,!0]],[[-1,0,["MessageBoxViewModel"],[_mcp.a.ei],null,"DataContext",null,_mcp.a.g,1,null,null,null]],[[-1,4,null,null,null,"DialogTitle",null,_mcp.a.cp,0,null,null,null,_nbs.a.IX],[-1,0,["TouchComponent","CloseConfirmDialogButtonData"],[_mcp.a.cL,_mcp.a.fX],null,"ButtonDataList",null,_mcp.a.co,1,null,null,null],[-1,0,["TouchComponent","IsCloseConfirmDialogShown"],[_mcp.a.cL,_mcp.a.fY],_mcp.a.fZ,"IsShown",_mcp.a.t,_mcp.a.u,2,null,null,!1]],[[-1,0,["ComplianceComponent","DialogViewModel"],[_mcp.a.bn,_mcp.a.dI],null,"DataContext",null,_mcp.a.g,1,null,null,null],[0,0,["IsShown"],[_mcp.a.bg],_mcp.a.bi,"IsShown",_mcp.a.t,_mcp.a.u,2,null,null,!1],[0,0,["Title"],[_mcp.a.bh],null,"DialogTitle",null,_mcp.a.K,1,null,null,null],[0,0,["CloseCommand"],[_mcp.a.bd],null,"CloseCommand",null,_mcp.a.L,1,null,null,null],[0,0,["ContentDataContext"],[_mcp.a.be],null,"ContentDataContext",null,_mcp.a.Z,1,null,null,null],[0,0,["FooterButtons"],[_mcp.a.bf],null,"ButtonDataList",null,_mcp.a.J,1,null,null,null]],[[-1,0,["MessageOptionsComponent","DialogViewModel"],[_mcp.a.ej,_mcp.a.dQ],null,"DataContext",null,_mcp.a.g,1,null,null,null],[0,0,["IsBusy"],[_mcp.a.bB],_mcp.a.bC,"IsBusy",_mcp.a.bu,_mcp.a.bv,2,null,null,!1],[0,0,["IsShown"],[_mcp.a.bg],_mcp.a.bi,"IsShown",_mcp.a.t,_mcp.a.u,2,null,null,!1],[0,0,["Title"],[_mcp.a.bh],null,"DialogTitle",null,_mcp.a.K,1,null,null,null],[0,0,["CloseCommand"],[_mcp.a.bd],null,"CloseCommand",null,_mcp.a.L,1,null,null,null],[0,0,["ContentDataContext"],[_mcp.a.be],null,"ContentDataContext",null,_mcp.a.Z,1,null,null,null],[0,0,["FooterButtons"],[_mcp.a.bf],null,"ButtonDataList",null,_mcp.a.J,1,null,null,null]],[[-1,0,["OmeComponent","DialogViewModel"],[_mcp.a.ek,_mcp.a.dR],null,"DataContext",null,_mcp.a.g,1,null,null,null],[0,0,["IsBusy"],[_mcp.a.bB],_mcp.a.bC,"IsBusy",_mcp.a.bu,_mcp.a.bv,2,null,null,!1],[0,0,["IsShown"],[_mcp.a.bg],_mcp.a.bi,"IsShown",_mcp.a.t,_mcp.a.u,2,null,null,!1],[0,0,["Title"],[_mcp.a.bh],null,"DialogTitle",null,_mcp.a.K,1,null,null,null],[0,0,["CloseCommand"],[_mcp.a.bd],null,"CloseCommand",null,_mcp.a.L,1,null,null,null],[0,0,["ContentDataContext"],[_mcp.a.be],null,"ContentDataContext",null,_mcp.a.Z,1,null,null,null],[0,0,["FooterButtons"],[_mcp.a.bf],null,"ButtonDataList",null,_mcp.a.J,1,null,null,null]],[[-1,0,["IsNavigatingAway"],[_mcp.a.gL],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]]]);var n=_mcp.a.e.childNodes[16].cloneNode(!0);var yi=new _j.i(n.children[9]);var pt=new _fce.m(n.children[8],_j.b.Instance.a(_fc.f),_j.b.Instance.a(_j.j),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));pt.b("OmeExpirationView");var kt=new _fce.m(n.children[7],_j.b.Instance.a(_fc.f),_j.b.Instance.a(_j.j),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));kt.b("MessageOptionsView");var wt=new _fce.m(n.children[6],_j.b.Instance.a(_fc.f),_j.b.Instance.a(_j.j),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));wt.b("IrmDialogView");var ht=new _b.o(n.children[5],_j.b.Instance.a(_y.a),_j.b.Instance.a(_fc.f),_j.b.Instance.a(_j.j),_j.b.Instance.a(_ff.b));ht.h(!1);var ut=new _j.c(n.children[4]);ut.y("MessageBoxDefaultView");var gt=new _j.c(n.children[3]);gt.y("MailComposeView._tidn");var dt=new _b.p(_j.a.a(n,[2,2,3,0]),_j.b.Instance.a(_a.e));var sr=new _j.i(_j.a.a(n,[2,2,3]));var et=new _j.c(_j.a.a(n,[2,2,2,1]));et.y("MailComposeView._tidm");var t=_j.b.Instance.a(_j.bF.$$(_zz.o)).a(_j.a.a(n,[2,2,2,0]));t.bv("_mcp_G ms-font-weight-regular ms-font-color-neutralPrimary customScrollBar");t.L(!0);t.A(-1);t.cj="0";var vt=new _zz.m(_j.b.Instance.a(_b.a),_j.b.Instance.a(_zz.j),_j.b.Instance.a(_ff.b));vt.k="PasteFlyout";var tr=new _zz.y;var gi=new _zz.x(_j.b.Instance.a(_fc.f),_j.b.Instance.a(_ff.b),_j.b.Instance.a(_j.j),_j.b.Instance.a(_ff.a));var ft=new _zz.r(_j.b.Instance.a(_b.a),_j.b.Instance.a(_zz.j),_j.b.Instance.a(_ff.b),_j.b.Instance.a(_a.e),_j.b.Instance.a(_j.cc.$$(_y.cj)));ft.U(_j.f.a(["AtMentionComponent"],[_mcp.a.ed],null,"MentionsHandler",null,_mcp.a.ds,1)).U(_j.f.a(["Context","Subject"],[_mcp.a.f,_mcp.a.bj],null,"Topic",null,_mcp.a.du,1)).U(_j.f.b(_cmc.c.g,null,null,null,"Scenario",null,_mcp.a.dt,0));ft.k="MentionsPicker";t.C([vt,tr,gi,ft]);var ki=new _j.i(_j.a.a(n,[2,2,2]));var ir=new _fc.a(_j.a.a(n,[2,2,1,7]));var o=new _j.c(_j.a.a(n,[2,2,1,6,0,0]));o.y("AttachmentWellViewWrapper");o.cn(!0);o.L(!0);var ur=new _j.i(_j.a.a(n,[2,2,1,6]));var ti=new _j.c(_j.a.a(n,[2,2,1,5,3]));ti.y("MailComposeView._tidk");var ui=new _j.c(_j.a.a(n,[2,2,1,5,2]));ui.y("MailComposeView._tidj");var yt=new _j.c(_j.a.a(n,[2,2,1,5,1]));yt.y("MailComposeView._tidg");var ii=new _j.c(_j.a.a(n,[2,2,1,5,0]));ii.y("MailComposeView._tide");var vi=new _j.i(_j.a.a(n,[2,2,1,5]));var v=new _cmc.t(_j.a.a(n,[2,2,1,4,0,5,0]));v.i("ms-font-color-neutralTertiary");v.A(0);var ri=new _fc.b(_j.a.a(n,[2,2,1,4,0,4]));var y=new _fce.f(_j.b.Instance.a(_fc.f),_j.b.Instance.a(_j.j),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));y.U(_j.f.a(["ContextMenuComponent","Menu"],[_mcp.a.S,_mcp.a.O],null,"MenuDataContext",null,_mcp.a.Y,1)).U(_j.f.a(["ContextMenuComponent","Menu","IsShown"],[_mcp.a.S,_mcp.a.O,_mcp.a.A],_mcp.a.N,"IsShown",_mcp.a.W,_mcp.a.X,2,null,null,!1));y.a=3;y.b=5;ri.C([y]);var ei=new _fc.d(_j.a.a(n,[2,2,1,4,0,3]),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));var hi=new _fc.d(_j.a.a(n,[2,2,1,4,0,2]),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));var si=new _fc.d(_j.a.a(n,[2,2,1,4,0,1]),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));var oi=new _fc.b(_j.a.a(n,[2,2,1,4,0,0]));var fr=new _j.i(_j.a.a(n,[2,2,1,4]));var a=new _j.c(_j.a.a(n,[2,2,1,3,2,0]));a.y("ReadOnlyRecipientWellView");a.cn(!0);a.L(!0);var hr=new _j.i(_j.a.a(n,[2,2,1,3,2]));var h=new _j.c(_j.a.a(n,[2,2,1,3,1,1]));h.y("ReadWriteRecipientWellView");h.D(26);h.cn(!0);var c=new _fc.b(_j.a.a(n,[2,2,1,3,1,0,0]));c.i=!0;c.A(-1);c.N(!0);var bi=new _j.i(_j.a.a(n,[2,2,1,3,1,0]));var wi=new _j.i(_j.a.a(n,[2,2,1,3,1]));var f=new _fc.b(_j.a.a(n,[2,2,1,3,0]));f.f("ms-bg-color-neutralLighter");f.c("ms-bg-color-neutralLight");f.e("ms-font-color-white ms-bg-color-themePrimary");f.A(-1);var ni=new _j.i(_j.a.a(n,[2,2,1,3]));var p=new _j.c(_j.a.a(n,[2,2,1,2,2,0]));p.y("ReadOnlyRecipientWellView");p.cn(!0);p.L(!0);var nr=new _j.i(_j.a.a(n,[2,2,1,2,2]));var s=new _j.c(_j.a.a(n,[2,2,1,2,1,1]));s.y("ReadWriteRecipientWellView");s.cn(!0);s.D(26);s.L(!0);var nt=new _fc.b(_j.a.a(n,[2,2,1,2,1,0,0]));nt.i=!0;nt.A(-1);nt.N(!0);var di=new _j.i(_j.a.a(n,[2,2,1,2,1,0]));var ai=new _j.i(_j.a.a(n,[2,2,1,2,1]));var u=new _fc.b(_j.a.a(n,[2,2,1,2,0]));u.f("ms-bg-color-neutralLighter");u.c("ms-bg-color-neutralLight");u.e("ms-font-color-white ms-bg-color-themePrimary");u.A(-1);var at=new _j.i(_j.a.a(n,[2,2,1,2]));var ot=new _j.c(_j.a.a(n,[2,2,1,1,2,0]));ot.y("ReadOnlyRecipientWellView");ot.L(!0);var or=new _j.i(_j.a.a(n,[2,2,1,1,2]));var e=new _j.c(_j.a.a(n,[2,2,1,1,1,1]));e.y("ReadWriteRecipientWellView");e.D(26);e.L(!0);var w=new _fc.b(_j.a.a(n,[2,2,1,1,1,0,0]));w.i=!0;w.A(-1);w.N(!0);var er=new _j.i(_j.a.a(n,[2,2,1,1,1,0]));var rr=new _j.i(_j.a.a(n,[2,2,1,1,1]));var i=new _fc.b(_j.a.a(n,[2,2,1,1,0]));i.f("ms-bg-color-neutralLighter");i.c("ms-bg-color-neutralLight");i.e("ms-font-color-white ms-bg-color-themePrimary");i.A(0);var it=new _mcp.l(_j.a.a(n,[2,2,1,0,0]));it.y("MailComposeView._tid6");var fi=new _j.i(_j.a.a(n,[2,2,1]));var rt=_j.b.Instance.a(_j.bF.$$(_db.f)).a(_j.a.a(n,[2,2,0]));rt.c="_mcp_J";var k=new _j.i(_j.a.a(n,[2,2]));k.A(-1);var bt=new _fc.g;var st=new _fc.c;st.U(_j.f.a(["TouchComponent","CloseCommand"],[_mcp.a.cL,_mcp.a.fW],null,"Command",null,_mcp.a.n,1));st.j("ESC");var g=new _fc.c;g.U(_j.f.a(["SaveComponent","SaveCommand"],[_mcp.a.bG,_mcp.a.cy],null,"Command",null,_mcp.a.n,1));g.j("S");g.k=2;var b=new _fc.c;b.U(_j.f.a(["SendComponent","AltSSendCommand"],[_mcp.a.C,_mcp.a.cA],null,"Command",null,_mcp.a.n,1)).U(_j.f.a(["DoesSupportAltSForSend"],[_mcp.a.cC],null,"PreventDefault",null,_mcp.a.ba,1,null,null,!1));b.j("S");b.k=4;var d=new _fc.c;d.U(_j.f.a(["SendComponent","SendCommand"],[_mcp.a.C,_mcp.a.bV],null,"Command",null,_mcp.a.n,1));d.j("ENTER");d.k=2;var tt=new _fc.c;tt.U(_j.f.a(["RecipientComponent","ResolveCommand"],[_mcp.a.d,_mcp.a.cw],null,"Command",null,_mcp.a.n,1));tt.j("K");tt.k=2;var l=new _fc.c;l.W(_j.f.a(["ContextParent","ContextParent","ShiftTabCommand"],[_mcp.a.p,_mcp.a.p,_mcp.a.cY],null,"Command",null,_mcp.a.n,1)).W(_j.f.a(["ContextParent","ContextParent","ShouldPreventShiftTabDefault"],[_mcp.a.p,_mcp.a.p,_mcp.a.bq],null,"PreventDefault",null,_mcp.a.ba,1,null,null,!1)).W(_j.f.a(["ContextParent","ContextParent","ShouldPreventShiftTabDefault"],[_mcp.a.p,_mcp.a.p,_mcp.a.bq],null,"StopPropagation",null,_mcp.a.ck,1,null,null,!1));l.j("TAB");l.k=1;bt.a([st,g,b,d,tt,l]);k.C([bt]);var lt=new _n.A(_j.a.a(n,[2,1]));lt.cn(!0);var pi=new _fce.h(_j.a.a(n,[2,0]),_j.b.Instance.a(_j.p),_j.b.Instance.a(_ff.a));var ci=new _fce.g(n.children[2],_j.b.Instance.a(_j.p),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_j.j));var li=new _j.i(n.children[1]);var ct=new _fce.h(n.children[0],_j.b.Instance.a(_j.p),_j.b.Instance.a(_ff.a));ct.a=0;ct.d("");return new _j.a(n,[ct,li,ci,pi,lt,k,rt,fi,it,i,rr,er,w,e,or,ot,at,u,ai,di,nt,s,nr,p,ni,f,wi,bi,c,h,hr,a,fr,oi,si,hi,ei,ri,v,vi,ii,yt,ui,ti,ur,o,ir,ki,t,et,sr,dt,gt,ut,ht,wt,kt,pt,yi]).l({ComposeViewContent:k,InfoBarControl:rt,FromFieldControl:it,ToRecipientButton:i,ToRecipientWellControl:e,CcRecipientWellControl:at,CcRecipientButton:u,BccRecipientWellControl:ni,BccRecipientButton:f,SubjectTextBox:v,AttachmentWellViewWrapper:o,EditorControl:t,OnDemandUpgradeContainer:et,QuotedBodyHtmlLabel:dt,MessageBox:ut,CancelConfirmDialog:ht})},"",_mcp.d,_mcp.i,function(n){return new _mcp.i(n,_j.b.Instance.a(_j.bw),_j.b.Instance.a(_j.o),_j.b.Instance.a(_a.x),_j.b.Instance.a(_a.e),_j.b.Instance.a(_j.j),_j.b.Instance.a(_a.E),_j.b.Instance.a(_b.d))},!0,!1,!1,0,_mcp.a.a);var i="MailComposeCompactRecipientWellView._tidf1";new _j.d(i,function(){_mcp.a.a[i]===undefined&&(_mcp.a.a[i]=[[[-1,4,null,null,null,"Text",null,_mcp.a.h,0,null,null,null,_u.n.QO]],[[-1,0,["RecipientComponent"],[_mcp.a.d],null,"DataContext",null,_mcp.a.g,1,null,null,null]]]);var t=_mcp.a.e.childNodes[38].cloneNode(!0);var n=new _rw.l(t.children[1]);n.d=0;n.c="calc(100% - 150px)";var r=new _fc.a(t.children[0]);return new _j.a(t,[r,n])},"",_mcp.d,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var v="MailComposeCompactRecipientWellView._tidg1";new _j.d(v,function(){_mcp.a.a[v]===undefined&&(_mcp.a.a[v]=[[[-1,0,["ImportanceComponent","IsNormalImportance"],[_mcp.a.cD,_mcp.a.cv],null,"IsHidden",null,_mcp.a.b,1,null,null,!0],[-1,0,["Context","Importance"],[_mcp.a.f,_mcp.a.cr],null,"Id",null,_mcp.a.q,1,_mcp.a.cf(),!1,null]],[[-1,4,null,null,null,"Id",null,_mcp.a.q,0,null,null,null,_mcp.e.c()],[-1,0,["ComplianceComponent","IsIrmProtected"],[_mcp.a.bn,_mcp.a.ct],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,4,null,null,null,"ImageId",null,_mcp.a.m,0,null,null,null,_mcp.e.k()],[-1,4,null,null,null,"HoveredImageId",null,_mcp.a.br,0,null,null,null,_mcp.e.l()],[-1,4,null,null,null,"PressedImageId",null,_mcp.a.D,0,null,null,null,_mcp.e.m()],[-1,4,null,null,null,"AriaLabel",null,_mcp.a.j,0,null,null,null,_nbs.a.aJ],[-1,4,null,null,null,"Title",null,_mcp.a.o,0,null,null,null,_nbs.a.aJ],[-1,0,["ShouldShowExpandButton"],[_mcp.a.gR],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0],[-1,0,["NavigationComponent","UpconvertOnMoreOptionsCommand"],[_mcp.a.cG,_mcp.a.dX],null,"ClickCommand",null,_mcp.a.i,1,null,null,null]]]);var n=_mcp.a.e.childNodes[39].cloneNode(!0);var t=new _fc.b(n.children[2]);t.c("ms-font-color-black");t.A(-1);var r=new _fc.d(n.children[1],_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));var i=new _fc.d(n.children[0],_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));return new _j.a(n,[i,r,t])},"",_mcp.d,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var a="MailComposeCompactRecipientWellView";new _j.d(a,function(){_mcp.a.a[a]===undefined&&(_mcp.a.a[a]=[null,[[-1,0,["ShouldApplyInlineCompose"],[_mcp.a.cJ],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0],[-1,5,["IsFirefox"],[_mcp.a.s],null,"_mcp_R2",null,null,0,null,null,null]]]);var n=_mcp.a.e.childNodes[40].cloneNode(!0);var i=new _j.c(_j.a.a(n,[0,1]));i.y("MailComposeCompactRecipientWellView._tidg1");var t=new _j.c(_j.a.a(n,[0,0]));t.y("MailComposeCompactRecipientWellView._tidf1");return new _j.a(n,[t,i])},"",_mcp.d,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_mcp.a.a);var p="MessageOptionsView._tidj1";new _j.d(p,function(){_mcp.a.a[p]===undefined&&(_mcp.a.a[p]=[[[-1,4,null,null,null,"Text",null,_mcp.a.k,0,null,null,null,_nbs.a.Ob],[-1,0,["SmimeEncryptMessage"],[_mcp.a.gT],_mcp.a.gX,"IsChecked",_mcp.a.M,_mcp.a.z,2,null,null,!1],[-1,0,["SmimeEncryptMessageIsEnabled"],[_mcp.a.gU],null,"IsEnabled",null,_mcp.a.bs,1,null,null,!1]],[[-1,4,null,null,null,"Text",null,_mcp.a.k,0,null,null,null,_nbs.a.PK],[-1,0,["SmimeSignMessage"],[_mcp.a.gV],_mcp.a.gY,"IsChecked",_mcp.a.M,_mcp.a.z,2,null,null,!1],[-1,0,["SmimeSignMessageIsEnabled"],[_mcp.a.gW],null,"IsEnabled",null,_mcp.a.bs,1,null,null,!1]]]);var n=_mcp.a.e.childNodes[42].cloneNode(!0);var i=new _fc.h(n.children[1],_j.b.Instance.a(_ff.a));var t=new _fc.h(n.children[0],_j.b.Instance.a(_ff.a));return new _j.a(n,[t,i])},"",_mcp.S,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var y="MessageOptionsView.SensitivityTemplate";new _j.d(y,function(){_mcp.a.a[y]===undefined&&(_mcp.a.a[y]=[[[-1,1,["DataContext"],[_mcp.a.bb],null,"Text",null,_mcp.a.h,1,_mcp.a.da(),null,null]]]);var n=_mcp.a.e.childNodes[0].cloneNode(!0);var t=new _fc.a(n.children[0]);return new _j.a(n,[t])},"",Object,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_mcp.a.a);var h="MessageOptionsView";new _j.d(h,function(){_mcp.a.a[h]===undefined&&(_mcp.a.a[h]=[[[-1,4,null,null,null,"Text",null,_mcp.a.h,0,null,null,null,_nbs.a.Xx]],[[-1,0,["SensitivityOptions"],[_mcp.a.eo],null,"Options",null,_mcp.a.ci,1,null,null,null],[-1,0,["Sensitivity"],[_mcp.a.en],_mcp.a.et,"SelectedValue",_mcp.a.ch,_mcp.a.cj,2,null,null,null]],[[-1,4,null,null,null,"Text",null,_mcp.a.k,0,null,null,null,_nbs.a.bN],[-1,0,["IsDeliveryReceiptRequested"],[_mcp.a.el],_mcp.a.er,"IsChecked",_mcp.a.M,_mcp.a.z,2,null,null,!1],[-1,0,["ShowDeliveryReceiptRequest"],[_mcp.a.ep],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,4,null,null,null,"Text",null,_mcp.a.k,0,null,null,null,_nbs.a.fO],[-1,0,["IsReadReceiptRequested"],[_mcp.a.em],_mcp.a.es,"IsChecked",_mcp.a.M,_mcp.a.z,2,null,null,!1],[-1,0,["ShowReadReceiptRequest"],[_mcp.a.eq],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,0,["ShowSmimeOptions"],[_mcp.a.gS],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]]]);var n=_mcp.a.e.childNodes[43].cloneNode(!0);var i=new _j.c(n.children[4]);i.y("MessageOptionsView._tidj1");var u=new _fc.h(n.children[3],_j.b.Instance.a(_ff.a));var f=new _fc.h(n.children[2],_j.b.Instance.a(_ff.a));var t=new _fce.k(n.children[1]);t.a("MessageOptionsView.SensitivityTemplate");var r=new _fc.a(n.children[0]);return new _j.a(n,[r,t,f,u,i])},"",_mcp.S,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_mcp.a.a);var s="OmeExpirationView._tidk1";new _j.d(s,function(){_mcp.a.a[s]===undefined&&(_mcp.a.a[s]=[[[-1,4,null,null,null,"Title",null,_mcp.a.o,0,null,null,null,_nbs.a.cB],[-1,4,null,null,null,"Text",null,_mcp.a.k,0,null,null,null,_nbs.a.cB],[-1,4,null,null,null,"Data",null,_mcp.a.de,0,null,null,null,0]],[[-1,4,null,null,null,"Title",null,_mcp.a.o,0,null,null,null,_nbs.a.Lb],[-1,4,null,null,null,"Text",null,_mcp.a.k,0,null,null,null,_nbs.a.Lb],[-1,4,null,null,null,"Data",null,_mcp.a.de,0,null,null,null,1],[-1,0,["IsOmeTimeExpirationEnabled"],[_mcp.a.eu],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,5,["IsOmeTimeExpirationEnabled"],[_mcp.a.eu],null,"_mcp_p3",null,null,0,_mcp.a.c(),null,null]],[[-1,4,null,null,null,"TextSelectionType",null,_mcp.a.bR,0,null,null,0,2],[-1,0,["FirstTextBox","MaxLength"],[_mcp.a.cb,_mcp.a.cN],null,"MaxLength",null,_mcp.a.bx,0,null,null,0],[-1,0,["FirstTextBox","TextInput"],[_mcp.a.cb,_mcp.a.cP],_mcp.a.cQ,"Text",_mcp.a.bw,_mcp.a.bz,2,null,null,null],[-1,0,["FirstTextBox","PlaceholderText"],[_mcp.a.cb,_mcp.a.cO],null,"Placeholder",null,_mcp.a.by,0,null,null,null],[-1,0,["IsTimeExpirationSelected"],[_mcp.a.cR],_mcp.a.cS,"IsEnabled",_mcp.a.cl,_mcp.a.cm,2,null,null,!1],[-1,5,["FirstTextBox","IsYear"],[_mcp.a.cb,_mcp.a.cM],null,"_mcp_n3",null,null,0,null,null,null]],[[-1,4,null,null,null,"TextSelectionType",null,_mcp.a.bR,0,null,null,0,2],[-1,0,["SecondTextBox","MaxLength"],[_mcp.a.cc,_mcp.a.cN],null,"MaxLength",null,_mcp.a.bx,0,null,null,0],[-1,0,["SecondTextBox","PlaceholderText"],[_mcp.a.cc,_mcp.a.cO],null,"Placeholder",null,_mcp.a.by,0,null,null,null],[-1,0,["SecondTextBox","TextInput"],[_mcp.a.cc,_mcp.a.cP],_mcp.a.cQ,"Text",_mcp.a.bw,_mcp.a.bz,2,null,null,null],[-1,0,["IsTimeExpirationSelected"],[_mcp.a.cR],_mcp.a.cS,"IsEnabled",_mcp.a.cl,_mcp.a.cm,2,null,null,!1],[-1,5,["SecondTextBox","IsYear"],[_mcp.a.cc,_mcp.a.cM],null,"_mcp_n3",null,null,0,null,null,null]],[[-1,4,null,null,null,"TextSelectionType",null,_mcp.a.bR,0,null,null,0,2],[-1,0,["ThirdTextBox","MaxLength"],[_mcp.a.cd,_mcp.a.cN],null,"MaxLength",null,_mcp.a.bx,0,null,null,0],[-1,0,["ThirdTextBox","PlaceholderText"],[_mcp.a.cd,_mcp.a.cO],null,"Placeholder",null,_mcp.a.by,0,null,null,null],[-1,0,["ThirdTextBox","TextInput"],[_mcp.a.cd,_mcp.a.cP],_mcp.a.cQ,"Text",_mcp.a.bw,_mcp.a.bz,2,null,null,null],[-1,0,["IsTimeExpirationSelected"],[_mcp.a.cR],_mcp.a.cS,"IsEnabled",_mcp.a.cl,_mcp.a.cm,2,null,null,!1],[-1,5,["ThirdTextBox","IsYear"],[_mcp.a.cd,_mcp.a.cM],null,"_mcp_n3",null,null,0,null,null,null]]]);var n=_mcp.a.e.childNodes[45].cloneNode(!0);var u=new _fc.i(_j.a.a(n,[1,1,2]));var f=new _fc.i(_j.a.a(n,[1,1,1]));var e=new _fc.i(_j.a.a(n,[1,1,0]));var t=new _j.i(_j.a.a(n,[1,1]));var i=new _fce.j(_j.a.a(n,[1,0]));var r=new _fce.j(_j.a.a(n,[0,0]));return new _j.a(n,[r,i,t,e,f,u])},"",_mcp.be,_fce.i,function(n){return new _fce.i(n)},!1,!0,!1,0,_mcp.a.a);var l="OmeExpirationView";new _j.d(l,function(){_mcp.a.a[l]===undefined&&(_mcp.a.a[l]=[[[-1,4,null,null,null,"Text",null,_mcp.a.h,0,null,null,null,_nbs.a.uB]],[[-1,0,["SelectedOption"],[_mcp.a.ha],_mcp.a.hb,"SelectedOptionData",_mcp.a.eJ,_mcp.a.eK,2,null,null,null]],[[-1,0,["ErrorText"],[_mcp.a.gZ],null,"Text",null,_mcp.a.h,1,null,null,null]]]);var n=_mcp.a.e.childNodes[46].cloneNode(!0);var i=new _fc.a(n.children[2]);i.K(!1);var t=new _fce.i(n.children[1]);t.y("OmeExpirationView._tidk1");var r=new _fc.a(n.children[0]);return new _j.a(n,[r,t,i])},"",_mcp.be,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_mcp.a.a);var c="SendAvailabilityPopupView";new _j.d(c,function(){_mcp.a.a[c]===undefined&&(_mcp.a.a[c]=[[[-1,4,null,null,null,"ImageId",null,_mcp.a.m,0,null,null,null,_mcp.e.B()],[-1,0,["CancelCommand"],[_mcp.a.ev],null,"ClickCommand",null,_mcp.a.i,1,null,null,null]],[[-1,4,null,null,null,"Text",null,_mcp.a.h,0,null,null,null,_nbs.a.CB]],[[-1,0,["ConsensusSchedulingViewModel"],[_mcp.a.hc],null,"DataContext",null,_mcp.a.g,1,null,null,null]],[[-1,4,null,null,null,"Text",null,_mcp.a.k,0,null,null,null,_nbs.a.pL],[-1,0,["SubmitCommand"],[_mcp.a.hd],null,"ClickCommand",null,_mcp.a.i,1,null,null,null]],[[-1,4,null,null,null,"Text",null,_mcp.a.k,0,null,null,null,_nbs.a.Tb],[-1,0,["CancelCommand"],[_mcp.a.ev],null,"ClickCommand",null,_mcp.a.i,1,null,null,null]]]);var n=_mcp.a.e.childNodes[47].cloneNode(!0);var r=new _fc.b(_j.a.a(n,[0,2,1]));r.d(1);var i=new _fc.b(_j.a.a(n,[0,2,0]));i.d(4);var t=new _j.c(_j.a.a(n,[0,1,0]));t.y("ConsensusSchedulingView.Wrapper");t.L(!0);var f=new _fc.a(_j.a.a(n,[0,0,1]));var u=new _fc.b(_j.a.a(n,[0,0,0]));return new _j.a(n,[u,f,t,i,r])},"",_mcp.bu,_j.c,function(n){return new _j.c(n)},!0,!1,!1,0,_mcp.a.a)};_mcp.N.registerClass("_mcp.N",_db.e);_mcp.bx.registerClass("_mcp.bx",_h.fN);_mcp.V.registerClass("_mcp.V",_a.dn);_mcp.bi.registerClass("_mcp.bi",_h.dx.$$(_gg.oB,_gg.oD));MailComposeComponent.registerClass("MailComposeComponent",null,_a.kh,_j.ce);_mcp.W.registerClass("_mcp.W");_mcp.X.registerClass("_mcp.X");_mcp.x.registerClass("_mcp.x",_a.gd);_mcp.O.registerClass("_mcp.O");_mcp.bB.registerClass("_mcp.bB");_mcp.bA.registerClass("_mcp.bA",_h.fN);_mcp.P.registerClass("_mcp.P");_mcp.bC.registerClass("_mcp.bC",null,_h.co,_h.eV);_mcp.w.registerClass("_mcp.w",_h.dx.$$(_gg.pf,_g.dE));_mcp.by.registerClass("_mcp.by",_h.fN);_mcp.bz.registerClass("_mcp.bz",_h.fN,_a.fF);_mcp.Q.registerClass("_mcp.Q",_y.ll);_mcp.H.registerClass("_mcp.H",null,_db.bd);_mcp.bo.registerClass("_mcp.bo",null,_y.t);_mcp.bq.registerClass("_mcp.bq",null,_y.V,_bc.bm);_mcp.br.registerClass("_mcp.br",_mcp.bq,_y.iq,_y.V,_bc.bm);_mcp.bn.registerClass("_mcp.bn",_a.bw);_mcp.bm.registerClass("_mcp.bm",_a.bw);_mcp.v.registerClass("_mcp.v",_y.ll);_mcp.M.registerClass("_mcp.M",null,Sys.IDisposable);_mcp.bb.registerClass("_mcp.bb",_j.S,_y.lf);_mcp.b.registerClass("_mcp.b",_a.gd,_g.kW,_y.dO,_bc.bT,IContext,_j.bs,Sys.IDisposable,_dg.ICalendarTimePeriod);_mcp.C.registerClass("_mcp.C",null,_y.hv,_y.ka);_mcp.D.registerClass("_mcp.D",null,_y.io);_mcp.c.registerClass("_mcp.c",_a.ec);_mcp.cf.registerClass("_mcp.cf");_mcp.d.registerClass("_mcp.d",_y.lJ,_y.g,_y.C,_bc.w,_a.kU,_j.bs,Sys.IDisposable,_y.fg,_y.dH,_bc.j,_bc.s,_y.L,IMailComposeOverridable,_mco.h);_mcp.bp.registerClass("_mcp.bp",_mcp.d);_mcp.E.registerClass("_mcp.E",_mcp.d);_mcp.j.registerClass("_mcp.j");_mcp.bs.registerClass("_mcp.bs",_a.bw,_y.lg);_mcp.bt.registerClass("_mcp.bt",null,_y.is);_mcp.S.registerClass("_mcp.S",_a.bw);_mcp.be.registerClass("_mcp.be",_a.bw);_mcp.bd.registerClass("_mcp.bd");_mcp.bf.registerClass("_mcp.bf");_mcp.ch.registerClass("_mcp.ch");_mcp.bu.registerClass("_mcp.bu",_a.bw,_bc.j,_bc.s,_bc.w,_a.kU,_j.bs,Sys.IDisposable);_mcp.cd.registerClass("_mcp.cd",null,_b.cq,Sys.IDisposable);_mcp.I.registerClass("_mcp.I",_j.S,IMailComposeComponent,_j.bs,Sys.IDisposable);_mcp.q.registerClass("_mcp.q",_mcp.I,IMailComposeContextMenuProvider);_mcp.bD.registerClass("_mcp.bD",_mcp.q,IMailComposeAccCheckerComponent,_y.lK);_mcp.bE.registerClass("_mcp.bE",_mcp.I,_mcp.cn,IMailComposeComponent,_j.bs,Sys.IDisposable,_y.jZ);_mcp.m.registerClass("_mcp.m",_mcp.I,IMailComposeAttachmentComponent,IMailComposeComponent,_j.bs,Sys.IDisposable,_y.kk,IMailComposeOverridable,IMailComposeContextMenuProvider);_mcp.z.registerClass("_mcp.z",_mcp.q,IMailComposeSaveComponent,IMailComposeComponent,_j.bs,Sys.IDisposable,IMailComposeContextMenuProvider,IMailComposeOverridable);_mcp.Y.registerClass("_mcp.Y",_mcp.z,IMailComposeAutoSaveComponent,IMailComposeComponent,_j.bs,Sys.IDisposable);_mcp.y.registerClass("_mcp.y",_mcp.I,IMailComposeCommandingBarComponent,IMailComposeComponent,_j.bs,Sys.IDisposable);_mcp.F.registerClass("_mcp.F",_mcp.q,IMailComposeComplianceComponent,IMailComposeComponent,_j.bs,Sys.IDisposable,IMailComposeContextMenuProvider);_mcp.bF.registerClass("_mcp.bF",_mcp.q,IMailComposeComponent,_j.bs,Sys.IDisposable);_mcp.bH.registerClass("_mcp.bH",null,Sys.IDisposable);_mcp.bI.registerClass("_mcp.bI",_mcp.q,IMailComposeContentConversionComponent,IMailComposeComponent,_j.bs,Sys.IDisposable,IMailComposeContextMenuProvider);_mcp.J.registerClass("_mcp.J",_mcp.I,IMailComposeContextMenuComponent,IMailComposeComponent,_j.bs,Sys.IDisposable);_mcp.bJ.registerClass("_mcp.bJ",_mcp.J,IMailComposeContextMenuComponent,IMailComposeComponent,_j.bs,Sys.IDisposable);_mcp.u.registerClass("_mcp.u",_mcp.I,IMailComposeSendComponent,IMailComposeOverridable);_mcp.K.registerClass("_mcp.K",_mcp.u);_mcp.p.registerClass("_mcp.p",_mcp.I,IMailComposeDiscardComponent,IMailComposeComponent,_j.bs,Sys.IDisposable);_mcp.bK.registerClass("_mcp.bK",_mcp.I,IMailComposeEditorComponent,IMailComposeComponent,_j.bs,Sys.IDisposable);_mcp.bL.registerClass("_mcp.bL",_mcp.bK);_mcp.bM.registerClass("_mcp.bM",_mcp.I,_mcp.co,IMailComposeComponent,_j.bs,Sys.IDisposable);_mcp.bO.registerClass("_mcp.bO",_mcp.q,IMailComposeImportanceComponent,IMailComposeComponent,_j.bs,Sys.IDisposable,IMailComposeContextMenuProvider);_mcp.s.registerClass("_mcp.s",_mcp.I,IMailComposeLinkPreviewComponent,IMailComposeComponent,_j.bs,Sys.IDisposable);_mcp.Z.registerClass("_mcp.Z",_mcp.I,IMailComposeCalendaringInfobarComponent,IMailComposeComponent,_j.bs,Sys.IDisposable);_mcp.L.registerClass("_mcp.L",_mcp.I,IMailComposeInitializerComponent,IMailComposeComponent,_j.bs,Sys.IDisposable);_mcp.h.registerClass("_mcp.h",_mcp.I,IMailComposeMeetingComponent,IMailComposeComponent,_j.bs,Sys.IDisposable);_mcp.bQ.registerClass("_mcp.bQ",_mcp.q,IMailComposeMessageOptionsComponent,IMailComposeComponent,_j.bs,Sys.IDisposable,IMailComposeContextMenuProvider);_mcp.t.registerClass("_mcp.t",_mcp.q,IMailComposeNavigationComponent);_mcp.bR.registerClass("_mcp.bR",_mcp.q,IMailComposeOmeComponent,IMailComposeComponent,_j.bs,Sys.IDisposable,IMailComposeContextMenuProvider);_mcp.bS.registerClass("_mcp.bS",_mcp.I,IMailComposePALGenericAttachmentComponent,IMailComposeComponent,_j.bs,Sys.IDisposable);_mcp.bU.registerClass("_mcp.bU",_mcp.I,IMailComposePhotoComponent,IMailComposeComponent,_j.bs,Sys.IDisposable);_mcp.f.registerClass("_mcp.f",_mcp.q,_y.lO,IMailComposeRecipientComponent,IMailComposeComponent,_j.bs,Sys.IDisposable,_rw.r);_mcp.G.registerClass("_mcp.G",_mcp.I,IMailComposeRecipientSummarizationComponent,IMailComposeComponent,_j.bs,Sys.IDisposable);_mcp.B.registerClass("_mcp.B",_j.S);_mcp.r.registerClass("_mcp.r",_mcp.I,IMailComposeSendAsContextMenuComponent,IMailComposeComponent,_j.bs,Sys.IDisposable);_mcp.g.registerClass("_mcp.g",_mcp.I,_mcp.cp,IMailComposeComponent,_j.bs,Sys.IDisposable,IMailComposeContextMenuProvider);_mcp.bW.registerClass("_mcp.bW",_mcp.I,IMailComposeShareAttachmentComponent,IMailComposeComponent,_j.bs,Sys.IDisposable);_mcp.o.registerClass("_mcp.o",_mcp.q,IMailComposeSignatureComponent,IMailComposeComponent,_j.bs,Sys.IDisposable,IMailComposeContextMenuProvider);_mcp.bX.registerClass("_mcp.bX",_mcp.I,IMailComposeSmartReplyComponent,IMailComposeComponent,_j.bs,Sys.IDisposable);_mcp.bY.registerClass("_mcp.bY",_mcp.I,IMailComposeTouchComponent,IMailComposeComponent,_j.bs,Sys.IDisposable);_mcp.R.registerClass("_mcp.R",_mcp.I,IMailComposeUpgradeComponent,IMailComposeComponent,_j.bs,Sys.IDisposable);_mcp.bP.registerClass("_mcp.bP",_mcp.I,IMailComposeMailTipsComponent,IMailComposeComponent,_j.bs,Sys.IDisposable);_mcp.bT.registerClass("_mcp.bT",_mcp.I,IMailComposePeopleRecommendationsComponent,IMailComposeComponent,_j.bs,Sys.IDisposable);_mcp.bV.registerClass("_mcp.bV",_mcp.I,IMailComposePolicyTipsComponent,IMailComposeComponent,_j.bs,Sys.IDisposable);_mcp.A.registerClass("_mcp.A",_mcp.I,_y.eS,_y.hV,_y.kO,IMailComposeExtensibilityComponent,IMailComposeComponent,_j.bs,Sys.IDisposable);_mcp.bN.registerClass("_mcp.bN",_mcp.I,IMailComposeHashtagComponent,IMailComposeComponent,_j.bs,Sys.IDisposable);_mcp.bZ.registerClass("_mcp.bZ",_mcp.I,IMailComposeExtensibilityComponent,IMailComposeComponent,_j.bs,Sys.IDisposable);_mcp.bG.registerClass("_mcp.bG");_mcp.ca.registerClass("_mcp.ca",null,_j.bP);_mcp.cb.registerClass("_mcp.cb",null,_j.bP);_mcp.bg.registerClass("_mcp.bg",_lt.bg);_mcp.k.registerClass("_mcp.k",_j.i,_b.bF);_mcp.i.registerClass("_mcp.i",_j.c,_ff.k,_y.jV);_mcp.cq.registerClass("_mcp.cq",_mcp.i);_mcp.l.registerClass("_mcp.l",_j.c);_mcp.U.registerClass("_mcp.U",_j.c,_ff.k,_y.jV);_mcp.bh.registerClass("_mcp.bh",_j.c);_mcp.n.registerClass("_mcp.n",_mcp.cq);MailComposeComponent.$$cctor();_mcp.v.a="IrmInfoView";_mcp.v.b=new _y.cM;_mcp.b.bW=new _a.f("ViewModelId",String,_mcp.b);_mcp.b.c=new _a.f("Operation",_y.m,_mcp.b);_mcp.b.l=new _a.f("Mode",_y.fv,_mcp.b);_mcp.b.bt=new _a.f("OriginalId",_g.e,_mcp.b);_mcp.b.bs=new _a.f("OriginalDocumentId",Number,_mcp.b);_mcp.b.bu=new _a.f("OriginalItem",_g.f,_mcp.b);_mcp.b.J=new _a.f("DraftId",_g.e,_mcp.b);_mcp.b.bS=new _a.f("StoreId",String,_mcp.b);_mcp.b.bT=new _a.f("Subject",String,_mcp.b,"");_mcp.b.bF=new _a.f("SelectedDataCallContext",_h.dD,_mcp.b);_mcp.b.L=new _a.f("EditorCallContext",_h.dD,_mcp.b);_mcp.b.M=new _a.f("EditorContent",String,_mcp.b,"");_mcp.b.t=new _a.f("BodyType",String,_mcp.b);_mcp.b.bK=new _a.f("SmartReply",String,_mcp.b,"");_mcp.b.o=new _a.f("ToRecipients",_j.M,_mcp.b);_mcp.b.n=new _a.f("SpeechResultRecipients",_j.M,_mcp.b);_mcp.b.bU=new _a.f("ToQueryString",String,_mcp.b);_mcp.b.i=new _a.f("CcRecipients",_j.M,_mcp.b);_mcp.b.v=new _a.f("CcQueryString",String,_mcp.b);_mcp.b.h=new _a.f("BccRecipients",_j.M,_mcp.b);_mcp.b.s=new _a.f("BccQueryString",String,_mcp.b);_mcp.b.m=new _a.f("AutoAddSignature",Boolean,_mcp.b,!0);_mcp.b.W=new _a.f("Importance",String,_mcp.b,"Normal");_mcp.b.bB=new _a.f("QuotedBody",String,_mcp.b);_mcp.b.bL=new _a.f("SmimeContent",String,_mcp.b);_mcp.b.bN=new _a.f("SmimeErrorCode",Number,_mcp.b);_mcp.b.bO=new _a.f("SmimeRecipientCerts",Array,_mcp.b);_mcp.b.bP=new _a.f("SmimeSigningCert",String,_mcp.b);_mcp.b.p=new _a.f("AttachmentsToAdd",Array,_mcp.b);_mcp.b.bc=new _a.f("IsComplete",Boolean,_mcp.b);_mcp.b.k=new _a.f("IsMeeting",Boolean,_mcp.b);_mcp.b.bg=new _a.f("IsMeetingForward",Boolean,_mcp.b);_mcp.b.bn=new _a.f("IsReplyAllOnBcc",Boolean,_mcp.b);_mcp.b.br=new _a.f("Location",_dg.c,_mcp.b);_mcp.b.T=new _a.f("HasLocation",Boolean,_mcp.b);_mcp.b.Y=new _a.f("InternetMessageId",String,_mcp.b);_mcp.b.bC=new _a.f("Recurrence",_dg.y,_mcp.b);_mcp.b.bm=new _a.f("IsRecurringMaster",Boolean,_mcp.b);_mcp.b.bR=new _a.f("Start",_a.d,_mcp.b);_mcp.b.N=new _a.f("End",_a.d,_mcp.b);_mcp.b.cg=new _a.f("IsAllDayEventProperty",Boolean,_mcp.b);_mcp.b.P=new _a.f("From",_g.R,_mcp.b);_mcp.b.bG=new _a.f("Sender",_g.R,_mcp.b);_mcp.b.bq=new _a.f("IsUpgraded",Boolean,_mcp.b);_mcp.b.be=new _a.f("IsFromShown",Boolean,_mcp.b);_mcp.b.ba=new _a.f("IsCcShown",Boolean,_mcp.b);_mcp.b.Z=new _a.f("IsBccShown",Boolean,_mcp.b);_mcp.b.bx=new _a.f("ParentFolderNameToPost",String,_mcp.b);_mcp.b.bw=new _a.f("ParentFolderIdToPost",_g.m,_mcp.b);_mcp.b.f=new _a.f("AttachmentCollection",_j.l,_mcp.b);_mcp.b.g=new _a.f("AttachmentProviderFiles",_j.l,_mcp.b);_mcp.b.q=new _a.f("AttachmentsToHide",Array,_mcp.b);_mcp.b.I=new _a.f("DocLinks",_a.j,_mcp.b);_mcp.b.bV=new _a.f("UpgradeFailed",Boolean,_mcp.b);_mcp.b.r=new _a.f("Baseline",_mcp.c,_mcp.b);_mcp.b.S=new _a.f("HasBeenSavedByUser",Boolean,_mcp.b);_mcp.b.R=new _a.f("HasBeenAutoSaved",Boolean,_mcp.b);_mcp.b.D=new _a.f("DataUriCountProperty",Number,_mcp.b);_mcp.b.C=new _a.f("CustomDataUriCountProperty",Number,_mcp.b);_mcp.b.bo=new _a.f("IsReplyForward",Boolean,_mcp.b);_mcp.b.K=new _a.f("Draft",_g.f,_mcp.b);_mcp.b.Q=new _a.f("GroupEmailAddress",_g.g,_mcp.b);_mcp.b.bE=new _a.f("RightsManagementLicenseData",_g.cu,_mcp.b);_mcp.b.A=new _a.f("ComplianceId",String,_mcp.b);_mcp.b.bb=new _a.f("IsClassified",Boolean,_mcp.b);_mcp.b.x=new _a.f("ClassificationGuid",String,_mcp.b);_mcp.b.z=new _a.f("Classification",String,_mcp.b);_mcp.b.w=new _a.f("ClassificationDescription",String,_mcp.b);_mcp.b.y=new _a.f("ClassificationKeep",Boolean,_mcp.b);_mcp.b.bI=new _a.f("Sensitivity",String,_mcp.b,"Normal");_mcp.b.bd=new _a.f("IsDeliveryReceiptRequested",Boolean,_mcp.b);_mcp.b.bl=new _a.f("IsReadReceiptRequested",Boolean,_mcp.b);_mcp.b.bM=new _a.f("SmimeEncryptMessage",Boolean,_mcp.b);_mcp.b.bQ=new _a.f("SmimeSignMessage",Boolean,_mcp.b);_mcp.b.B=new _a.f("ConversationId",_g.e,_mcp.b);_mcp.b.bv=new _a.f("ParentConversationNodeId",String,_mcp.b);_mcp.b.u=new _a.f("CalendarItemModelType",_h.ed,_mcp.b);_mcp.b.bi=new _a.f("IsOccurrenceReferencingMaster",Boolean,_mcp.b);_mcp.b.bk=new _a.f("IsPoppedOutFromReadingPane",Boolean,_mcp.b);_mcp.b.bf=new _a.f("IsLoadedDraft",Boolean,_mcp.b);_mcp.b.bX=new _a.f("WasCleanNewMessageBeforePopout",Boolean,_mcp.b);_mcp.b.V=new _a.f("HideIncludeEntrypoint",Boolean,_mcp.b,!1);_mcp.b.bY=new _a.f("WasSavingBeforePopout",Boolean,_mcp.b,!1);_mcp.b.bh=new _a.f("IsMovedToDraftFromOutbox",Boolean,_mcp.b,!1);_mcp.b.bz=new _a.f("PerfContext",_a.bN,_mcp.b,null);_mcp.b.by=new _a.f("PerfContextE2E",_a.bN,_mcp.b,null);_mcp.b.bZ=new _a.f("WaterfallTraceStarted",Boolean,_mcp.b,null);_mcp.b.bD=new _a.f("RichTextEditorSupported",Boolean,_mcp.b,null);_mcp.b.H=new _a.f("DlpSenderOverride",String,_mcp.b,null);_mcp.b.G=new _a.f("DlpFalsePositive",String,_mcp.b,null);_mcp.b.F=new _a.f("DlpDetectedClassification",String,_mcp.b,null);_mcp.b.O=new _a.f("ExplicitLogonUser",String,_mcp.b,null);_mcp.b.X=new _a.f("IncludeOriginalFromInToRecipients",Boolean,_mcp.b,!1);_mcp.b.j=new _a.f("ExtendedPropertyCollection",_j.l,_mcp.b,null);_mcp.b.bj=new _a.f("IsOnDemandUpgradeRequested",Boolean,_mcp.b,!1);_mcp.b.bp=new _a.f("IsResumingSendFailure",Boolean,_mcp.b,!1);_mcp.b.U=new _a.f("HasSentViaNotification",Boolean,_mcp.b,!1);_mcp.b.bH=new _a.f("SendFailureInfobarMessageId",_bc.M,_mcp.b,45);_mcp.b.bJ=new _a.f("SentFromMailComposeInlineReply",Boolean,_mcp.b);_mcp.b.bA=new _a.f("PopoutPerfContext",_a.bN,_mcp.b);_mcp.b.E=new _a.f("DiagnosticContent",String,_mcp.b);_mcp.b.e="UseOverride";_mcp.b.cd=new RegExp("(\r)?\n","gi");_mcp.b.b=null;_mcp.b.d=null;_mcp.b.$$cctor();_mcp.c.u=new _a.f("Subject",String,_mcp.c,"");_mcp.c.m=new _a.f("EditorContent",String,_mcp.c,"");_mcp.c.h=new _a.f("ToRecipients",_j.l,_mcp.c);_mcp.c.v=new _a.f("ToQueryString",String,_mcp.c);_mcp.c.e=new _a.f("CcRecipients",_j.l,_mcp.c);_mcp.c.k=new _a.f("CcQueryString",String,_mcp.c);_mcp.c.d=new _a.f("BccRecipients",_j.l,_mcp.c);_mcp.c.j=new _a.f("BccQueryString",String,_mcp.c);_mcp.c.o=new _a.f("Importance",String,_mcp.c,"Normal");_mcp.c.n=new _a.f("From",_g.g,_mcp.c);_mcp.c.l=new _a.f("ComplianceId",String,_mcp.c);_mcp.c.r=new _a.f("Sensitivity",String,_mcp.c,"Normal");_mcp.c.p=new _a.f("IsDeliveryReceiptRequested",Boolean,_mcp.c);_mcp.c.q=new _a.f("IsReadReceiptRequested",Boolean,_mcp.c);_mcp.c.s=new _a.f("SmimeEncryptMessage",Boolean,_mcp.c);_mcp.c.t=new _a.f("SmimeSignMessage",Boolean,_mcp.c);_mcp.c.c=new _a.f("AttachmentCollection",_j.l,_mcp.c);_mcp.c.g=new _a.f("ExtendedPropertyCollection",_j.l,_mcp.c,null);_mcp.c.f=new _a.bC(_g.g);_mcp.c.$$cctor();_mcp.d.b=null;_mcp.d.c=null;_mcp.j.a=_a.a.a;_mcp.bs.a=_a.a.a;_mcp.m.a=new _a.f("AttachmentWellViewModel",_y.dG,_mcp.m);_mcp.Y.a=new _a.y("Auto");_mcp.y.a=_a.a.fc;_mcp.F.a=new _y.i(_u.P.g,null,null);_mcp.J.a=new _a.f("Menu",_fm.e,_mcp.J);_mcp.Z.a=[6800,3200,3205,3210,3215,3220,3100,3105,3110,3115,3120,3250,3255,3260];_mcp.h.c=new _a.f("FromDetailsViewModel",_bc.l,_mcp.h);_mcp.h.d=new _a.f("SenderDetailsViewModel",_bc.l,_mcp.h);_mcp.h.b=null;_mcp.h.a=null;_mcp.t.b=[84,85,86,87];_mcp.B.b=7;_mcp.B.a=1;_mcp.z.a=new _a.y("Group");_mcp.z.b=[60,40,43,1001,700,50,800,88,89];_mcp.r.b=10;_mcp.r.c=new _a.f("Menu",_fm.e,_mcp.r);_mcp.g.e="";_mcp.g.g=new RegExp("^[a-zA-Z]+");_mcp.g.d=null;_mcp.u.a=[62,45,46,47,700,55,70,65,97,66,75,800,88,80,48,89,90,91,92,101,102,103,104,93,94,98,99,100];_mcp.o.f="<P style='margin-top:0;margin-bottom:0'><BR></P>";_mcp.o.e=new RegExp("[\n\r]+","g");_mcp.o.c=new RegExp("(<img )([^>]*src=[\"']?data:image/[^<]+;base64,[a-zA-Z0-9+/=&#;]+[\"']?)([^>]*>)","gi");_mcp.o.b=new RegExp("(<[aA] [^>]*>)","gi");_mcp.o.d="EmojiInsert";_mcp.ba.a=new _mcp.ba(!0,!1);_mcp.bg.a=2e3;_mcp.a.e=_mcp.a.eG();_mcp.a.bP=null;_mcp.a.bL=null;_mcp.a.bI=null;_mcp.a.bO=null;_mcp.a.bM=null;_mcp.a.bN=null;_mcp.a.bJ=null;_mcp.a.bK=null;_mcp.a.bQ=null;_mcp.a.a={};_mcp.a.$$cctor();
window.scriptsLoaded['microsoft.owa.mail.compose.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.mail.compose.js'] = (new Date()).getTime();
