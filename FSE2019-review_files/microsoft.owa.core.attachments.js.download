window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.core.attachments.js'] = (new Date()).getTime();
Type.registerNamespace("_at");_at.bh=function(){this.a={}};_at.bh.prototype={e:function(n){return this.a[_g.q.toString(n).toLowerCase()]},b:function(n,t){this.a[_g.q.toString(n).toLowerCase()]=t;return t},d:function(n){return _g.q.toString(n).toLowerCase()in this.a},c:function(n){var u=n.toLowerCase();var i=this.a;for(var t in i){var r={key:t,value:i[t]};if(r.key===u)return!0}return!1},f:function(){return _ff.i.a(this.a)}};_at.cl=function(n,t,i,r,u,f){_at.cl.initializeBase(this);this.h=n;this.l=t;this.j=i;this.k=r;this.f=u;this.e=f};_at.cl.prototype={l:null,j:null,k:null,h:null,m:null,f:!1,e:null,K:function(n){var t=new _gg.oN(this.L);n.bl(this.h,this.l,this.j,this.k,t,this.I,this.H,this.f,this.e)},cU:function(n,t,i){try{_a.c.c(n,"result");this.m=n;t()}catch(r){i(r)}}};function AttachmentsComponent(){}AttachmentsComponent.$$cctor=function(){_a.t.a().a(AttachmentsComponent)};AttachmentsComponent.prototype={b:function(n,t,i){if(t.a()){var v=this;n.b(_at.J,function(){var t=_bc.o.isInstanceOfType(_g.k.a)?_g.k.a:null;return new _at.h(n.a(_a.E),t?t.d().j():null,t?t.j():null)}).a()}else{var a=this;n.b(_at.J,function(){return new _at.ce}).a()}var l=this;n.b(_at.k,function(){return _at.k.b()}).b(_at.U).b(_db.bI).a();var w=this;n.b(_at.V,function(){return _at.W.a?new _at.W:null}).a();var p=this;n.b(_a.eY,function(){return i.d()}).a();var y=this;n.b(_at.P,function(){return new _at.P(n.a(_a.q))}).a();var r=_at.z.b(i);var c=this;n.b(_at.L,function(){return new _at.L(n.a(_h.n),n.a(_j.o),n.a(_no.c),n.a(_a.q),n.a(_a.e),n.d(_at.Z),n.c(_db.A),n.a(_a.bv),r?null:n.a(_at.q),n.a(_a.E),n.c(_db.bl),n.a(_j.j),n.a(_at.w),n.a(_at.V),n.a(_a.eY),n.a(_y.H),n.a(_at.P))}).a();var f=this;n.b(_y.gk,function(){return new _at.cb(n.a(_y.a),n.a(_at.J),n.d(_y.hM),n.d(_bc.G),n.a(_y.iI),n.a(_at.U),r?n.a(_y.bJ):null,n.a(_at.L))}).a();var u=this;n.b(_at.by,function(){return new _at.by(n.a(_at.U),r?n.a(_at.z):null,n.a(_at.L))}).b(_y.iI).a();var h=this;n.b(_at.z,function(){var t=n.a(_g.a).c();var r=t.bH.UserEmailAddress;t.bH.IsShadowMailbox&&(r=t.bH.LogonEmailAddress);return new _at.z(n.a(_a.e),n.a(_g.a).n().bH.DownloadTokenRefreshMinutes,n.a(_g.a).n().bH.DownloadUrlBase,r,n.a(_g.a).n().bH.FirstDownloadToken,i.c(),n.a(_a.q))}).b(_y.bJ).a();var s=this;n.b(_at.q,function(){return new _at.q(n.a(_a.e),n.a(_g.a).n().bH.DownloadTokenRefreshMinutes,n.a(_g.a).n().bH.DownloadUrlBase,n.a(_g.a).c().bH.UserEmailAddress,n.a(_g.a).n().bH.FirstDownloadToken,i.c(),n.a(_a.q),!1)}).b(_y.cO).a();var e=this;n.b(_at.w,function(){return new _at.w(n.a(_a.e),i.c())}).a();var o=this;n.b(_at.G,function(){return new _at.G}).b(_h.du)},a:function(){return null}};_at.i=function(){};_at.i.f=function(n){if(!n.a())for(var t=0;t<n.b().b();t++)if(!n.b().a(t).Type)return t;return n.bH.DefaultScopeIndex};_at.i.c=function(n){var t=null;n&&(t=n.c());return t};_at.i.a=function(n,t,i){return t?n.f().ReferenceAttachmentsEnabled:i?!0:n.f().ClassicAttachmentsEnabled};_at.i.i=function(n){if(_j.h.a(n))return!1;try{var i=new _a.P(n);var t=i.a;if(t.indexOf("safelinks.protection.outlook.")>0||t.indexOf("safelinks.protection.office365.")>0)return!0}catch(r){}return!1};_at.i.g=function(n){try{if(n.indexOf("safelinks.protection.outlook.com")>0){var i=new _a.P(n);var t=_a.w.g(i.f);if("url"in t)return decodeURIComponent(t.url)}}catch(r){return n}return n};_at.i.m=function(n){switch(n){case 6:case 5:return!0;default:return!1}};_at.i.l=function(n){switch(n){case 4:case 3:return!0;default:return!1}};_at.i.k=function(n){if(_j.h.a(n))return n;var t=n.lastIndexOf("/");return t>=1?n.substr(0,t):n};_at.i.d=function(n){return!_j.h.a(n)&&(!!_at.i.b&&n.startsWith(_at.i.b)||n.startsWith(_at.i.j)||n==="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAEALAAAAAABAAEAAAIBTAA7")};_at.i.e=function(n){return n.e()===4&&!_j.h.a(n.bH.Location)};_at.i.h=function(n){for(var u=281474976710656,t=0,f=0;n&&f<n.length;f++){var e=n.charCodeAt(f);t=t*31+e;t=(t%u+u)%u}var s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var r=new Sys.StringBuilder;do{var o=t%64;var i=new Sys.StringBuilder;i.append(s.charAt(o));i.append(r.toString());r=i;t=Math.floor(t/64)}while(t>0);return r.toString()};_at.AttachmentPolicyLevel=function(){};_at.AttachmentPolicyLevel.prototype={undefined:0,block:1,forceSave:2,allow:3};_at.AttachmentPolicyLevel.registerEnum("_at.AttachmentPolicyLevel",!1);_at.U=function(){};_at.U.registerInterface("_at.U");_at.V=function(){};_at.V.registerInterface("_at.V");_at.z=function(n,t,i,r,u,f,e){this.e=t;this.d=i;this.c=r;this.g=f;this.h=e;this.f=n;this.i=!!n&&n.a().cf().Enabled&&!_j.h.b(this.d)&&!_j.h.b(this.c)&&!_j.h.b(u);_j.e.a(_a.a.c,"DownloadAuthenticatorFactory constructor: Use download URL base: {0}",this.i);t<1&&(t=1);this.b=new _at.q(this.f,this.e,this.d,this.c,u,this.g,this.h,!1)};_at.z.b=function(n){return n.e().a().iv().Enabled};_at.z.a=function(n,t,i){if(!n)return t.j;var r=_at.i.c(i);return n.a(r)};_at.z.prototype={b:null,i:!1,d:null,e:0,c:null,g:!1,h:null,f:null,a:function(n){_j.h.b(n)&&(n=this.c);var t=this.b;if(t&&t.e===n){_j.e.a(_a.a.c,"DownloadAuthenticatorFactory re-using authenticator for <PII>{0}</PII>",t.e);return t}t.v();_j.e.a(_a.a.c,"DownloadAuthenticatorFactory creating new authenticator for <PII>{0}</PII>",t.e);this.b=new _at.q(this.f,this.e,this.d,n,null,this.g,this.h,!0);return this.b}};_at.bS=function(){_at.bS.initializeBase(this)};_at.bS.prototype={K:function(n){var t=new _gg.rA(this.L);t.explicitLogonUser=this.R;n.bK(t,this.I,this.H)},cU:function(n,t,i){_j.h.b(n)?i(Error.create("Download token is missing or empty.")):t()}};_at.v=function(n,t,i,r,u,f){_at.v.initializeBase(this,[n]);this.d=t;this.b=i;this.e=r;this.c=u;this.f=f};_at.v.prototype={d:null,b:null,e:null,c:null,f:null,a:!1,g:function(){return this.a&&this.Id==="AttachmentsDataProvider_Groups"}};_at.bP=function(n,t){_at.bP.initializeBase(this,[n,t,!0])};_at.bQ=function(n,t,i){this.j={};_at.bQ.initializeBase(this,[n,null,t]);this.q=i};_at.bQ.prototype={q:!1,f:null,l:null,bD:function(){return _a.a.c},bK:function(n){return _at.B.a(n)},bk:function(n){if(!n)return null;var t=this.j[n.bH.Id];return t!==n?t:null},br:function(n){if(!n)return!1;for(var u=!1,t=0;t<n.x.length;t++){var r=n.x[t];var i=this.j[r.bH.Id];if(i){this.bS(r,i);u=!0}}return u},ca:function(n){this.l&&this.bP(this.r(this.l))},bN:function(n,t){if(!_h.o.isInstanceOfType(n))throw Error.argumentType("range",n?Object.getType(n):null,_h.o,"range needs to be an IndexedRange object");this.l=n;return this.r(n)},bR:function(n){return Object.getType(n)===_at.B?this.s(n):this.t(n)},cT:function(n){if(Object.getType(n)===_at.B){var i=n;return this.h()+i.N.Items.length>=i.N.TotalItemCount}else{var t=n;return this.h()+t.N.Items.length>=t.N.TotalItemCount}},cj:function(n){_h.t.prototype.cj.call(this,n);this.j[n.bH.Id]=n},ci:function(n){_h.t.prototype.ci.call(this,n);delete this.j[n.bH.Id]},s:function(n){var t=new _at.T(n.N.Items);this.ch(n.e.Paging.RequestedData.Offset);this.y(n.N.TotalItemCount);_j.e.a(_a.a.c,"AttachmentDataProviderItemsQueryTable.OnGetItemsRowsActionSucceeded - LoadedStartIndex = {0}, NumberOfItemsReturned = {1} and TableSize = {2}",this.h(),n.N.Items.length,this.bH);this.f=n.N.PagingMetadata;return t},t:function(n){var t=new _at.T(n.N.Items);this.ch(n.e.Paging.RequestedData.Offset);this.y(n.N.TotalItemCount);_j.e.a(_a.a.c,"AttachmentDataProviderItemsQueryTable.OnSearchItemsRowsActionSucceeded - LoadedStartIndex = {0}, NumberOfItemsReturned = {1} and TableSize = {2}",this.h(),n.N.Items.length,this.bH);this.f=n.N.PagingMetadata;return t},r:function(n){var t=this.bC;t.k&&(this.f=null);var i=this.f;i||(i=t.m);var r=this.bC.b();return _j.h.a(t.f)?new _at.B(t.e,r.Id,t.h,t.c,n.a,n.b,i,t.l,t.g,t.d,this.cf,this.q):new _at.bn(t.e,t.f,r.Id,t.h,t.c,n.a,n.b,i,t.d,t.g)}};_at.bl=function(n,t,i,r,u,f,e,o,s){_at.bl.initializeBase(this,[n]);if(i)this.c=i;else{this.c=new _gg.E;this.c.SortColumn=0;this.c.SortOrder=0}this.d=s;this.e=n.f;this.f=u;var h=t?String.format("_{0}",t.DisplayName):"";this.i=String.format("{0}_{1}{2}_{3}_{4}_{5}_{6}",this.i,this.e.bH.Id,h,this.c.SortColumn.toString(),this.c.SortOrder.toString(),this.d.toString(),this.f);this.h=r;this.l=t;this.g=f;this.m=e;this.k=o};_at.bl.prototype={c:null,h:null,f:null,e:null,l:null,g:null,m:null,k:!1,d:0};_at.k=function(n,t){this.e=n||_at.k.i();this.g=t;this.f=this.g?this.e.DirectFileAccessOnPublicComputersEnabled:this.e.DirectFileAccessOnPrivateComputersEnabled;this.h=_at.k.f(this.e.BlockedFileTypes,this.e.ForceSaveFileTypes,this.e.AllowedFileTypes);this.i=_at.k.f(this.e.BlockedMimeTypes,this.e.ForceSaveMimeTypes,this.e.AllowedMimeTypes);this.j=_at.k.g(this.e.ActionForUnknownFileAndMIMETypes)};_at.k.b=function(){_at.k.c||(_at.k.c=new _at.k(_g.a.a().bH.AttachmentPolicy,_g.a.a().U()));return _at.k.c};_at.k.h=function(){_at.k.d||(_at.k.d=new _at.k(_g.a.a().bH.AttachmentPolicy,!0));return _at.k.d};_at.k.g=function(n){var t;try{t=_j.u.b(_at.AttachmentPolicyLevel,n)}catch(i){t=1}return t};_at.k.i=function(){var n=new _g.fr;return JsonParser.deserialize('{"AllowedFileTypes":[".rpmsg", ".xlsx", ".xlsm", ".xlsb", ".tiff", ".pptx", ".pptm", ".ppsx", ".ppsm", ".docx", ".docm", ".zip", ".xls", ".wmv", ".wma", ".wav", ".vsd", ".vss", ".vst",  ".vdx", ".vsx", ".vtx", ".vsdx", ".vssx", ".vstx", ".vsdm", ".vssm", ".vstm",".txt", ".tif", ".rtf", ".pub", ".ppt", ".png", ".pdf", ".one", ".mp3", ".jpg", ".gif", ".doc", ".bmp", ".avi"],"AllowedMimeTypes":["image/jpeg", "image/png", "image/gif", "image/bmp"],"ForceSaveFileTypes":[".swf", ".spl", ".dir", ".dcr"],"ForceSaveMimeTypes":["Application/x-shockwave-flash", "Application/octet-stream", "Application/futuresplash", "Application/x-director"],"BlockedFileTypes":[".vsmacros", ".msh2xml", ".msh1xml", ".ps2xml", ".ps1xml", ".mshxml", ".gadget", ".mhtml", ".psc2", ".psc1", ".msh2", ".msh1", ".aspx", ".xml", ".wsh", ".wsf", ".wsc", ".vsw", ".vbs", ".vbp", ".vbe", ".url", ".tmp", ".shs", ".shb", ".sct", ".scr", ".scf", ".reg", ".pst", ".ps2", ".ps1", ".prg", ".prf", ".plg", ".pif", ".pcd", ".osd", ".ops", ".mst", ".msp", ".msi", ".msh", ".msc", ".mht", ".mdz", ".mdw", ".mdt", ".mde", ".mdb", ".mda", ".maw", ".mav", ".mau", ".mat", ".mas", ".mar", ".maq", ".mam", ".mag", ".maf", ".mad", ".lnk", ".ksh", ".jse", ".its", ".isp", ".ins", ".inf", ".htc", ".hta", ".hpj", ".hlp", ".fxp", ".exe", ".der", ".csh", ".crt", ".cpl", ".com", ".cnt", ".cmd", ".chm", ".cer", ".bat", ".bas", ".asx", ".asp", ".app", ".adp", ".ade", ".ws", ".vb", ".js"],"BlockedMimeTypes":["application/x-javascript", "application/javascript", "application/msaccess", "x-internet-signup", "text/javascript", "application/xml", "application/prg", "application/hta", "text/scriplet", "text/xml"], "ActionForUnknownFileAndMIMETypes":"ForceSave","BlockWacViewingThroughUI":false,"WacViewableFileTypes":[".doc", ".docx", ".ppt", ".pptx", "xls", ".xlsx"],"WacViewingOnPublicComputersEnabled":true,"WacViewingOnPrivateComputersEnabled":true,"ForceWacViewingFirstOnPublicComputers":false,"ForceWacViewingFirstOnPrivateComputers":false,"DirectFileAccessOnPrivateComputersEnabled":true,"DirectFileAccessOnPublicComputersEnabled":true}')};_at.k.j=function(n){return n===".one"||n===".onepkg"};_at.k.f=function(n,t,i){var r={};_at.k.e(r,i,3);_at.k.e(r,t,2);_at.k.e(r,n,1);return r};_at.k.e=function(n,t,i){if(t)for(var u=t,e=u.length,r=0;r<e;++r){var f=u[r];n[f]=i}};_at.k.a=function(n,t){if(!n)return!1;for(var r=n,f=r.length,i=0;i<f;++i){var u=r[i];if(u===t)return!0}return!1};_at.k.prototype={g:!1,f:!1,j:0,e:null,h:null,i:null,a:function(){return this.e},c:function(){return this.e.WacEditableFileTypes?this.e.WacEditableFileTypes.length:0},b:function(n,t,i,r,u,f,e){!!i!==i&&(i=!0);n&&(n=n.toLowerCase());var h;h=this.k(n,t);var o=!1;var l=!1;var s=!1;if(h!==1&&i&&!r){var c=u&&f&&(t==="application/onenote"||_at.k.j(n));this.n(n,c)&&(o=!0);!this.f&&u&&(o=!1);l=this.m(this.g,o);o&&!e&&(c?s=!0:this.e.WacEditableFileTypes&&n&&(s=u?_at.k.a(this.e.WacEditableFileTypes,n)&&!_at.k.a(this.e.WacConvertibleFileTypes,n):_at.k.a(this.e.WacEditableFileTypes,n)||_at.k.a(this.e.WacConvertibleFileTypes,n)))}o||this.f||(h=1);var a=u&&f&&_j.h.a(n)&&t==="application/onenote";return new _at.bR(this.f,h,o,l,s,a||e)},k:function(n,t){var r=this.h[n]||0;if(r===1)return 1;var i=this.i[t]||0;return i===1?1:r===2||i===2?2:r===3||i===3?3:this.j},d:function(n,t){var i=this.b(n,t).a;return i===1||!i},n:function(n,t){var i=this.g?this.e.WacViewingOnPublicComputersEnabled:this.e.WacViewingOnPrivateComputersEnabled;return i&&(t||this.o(n))},l:function(){return this.g?this.e.WacViewingOnPublicComputersEnabled||this.e.DirectFileAccessOnPublicComputersEnabled:this.e.WacViewingOnPrivateComputersEnabled||this.e.DirectFileAccessOnPrivateComputersEnabled},m:function(n,t){return t?n?this.e.ForceWacViewingFirstOnPublicComputers:this.e.ForceWacViewingFirstOnPrivateComputers:!1},o:function(n){return _at.k.a(this.e.WacViewableFileTypes,n)}};_at.bR=function(n,t,i,r,u,f){this.d=n;this.a=t;this.b=i;this.f=r;this.e=u;this.g=f};_at.bR.prototype={a:0,d:!1,f:!1,b:!1,e:!1,g:!1,c:function(){return!this.g&&this.a!==1&&this.d},toString:function(){return String.format("Attachment PolicyLevel: {0}, DirectFileAccessEnabled: {1}, WAC: {2}, ForceBrowserView: {3}, WacEdit: {4}",this.a,this.d,this.b,this.f,this.e)}};_at.S=function(){};_at.S.a=function(n,t,i,r){n.o(function(n){var e=n;var u=e.g();if(u.a().b()&&_at.S.c(u.a().a(0),t)){i();var f=u.a().a(0);f.bi()&&f.bi().n(function(n){var t=n;_at.S.b(t)&&r(f,t)})}})};_at.S.c=function(n,t){return!n.bH.IsDraft&&!(t&&_g.b.a.doesIdEqualName(n.bH.ParentFolderId,"deleteditems"))};_at.S.b=function(n){return!n.a()||_dg.b.isInstanceOfType(n)};_at.q=function(n,t,i,r,u,f,e,o){this.r=Function.createDelegate(this,this.u);this.q=Function.createDelegate(this,this.t);this.p=Function.createDelegate(this,this.s);this.g=i;this.e=r;this.m=f;this.o=e;this.n=o;this.i=n;this.h=u;this.j=-1;this.l=!!n&&n.a().cf().Enabled&&!_j.h.b(this.g)&&!_j.h.b(this.e);_j.e.a(_a.a.c,"DownloadAuthenticator: Creating new instance for {0}. Use download URL base: {1}, groups: {2}",this.e,this.l,this.n);t<1&&(t=1);if(this.l){this.s();this.f=_j.m.a().e(_at.q.a,"DownloadAuthenticator",this.p,6e4*t);if(this.f){_j.e.a(_at.q.a,"QueuePeriodicCallback succeeded.");this.k=_a.b.b(_at.q.a,"TokenRequestTimer",!1,null)}else _j.e.c(_at.q.a,"QueuePeriodicCallback returned null.");var s=new _a.l;s.c("S",!!this.f);_a.b.c(_at.q.a,"QueuePeriodicCallback",s.toString(),0)}};_at.q.prototype={l:!1,g:null,e:null,m:!1,o:null,n:!1,i:null,f:null,d:null,k:null,j:0,h:null,v:function(){if(this.f){_j.m.a().b(this.f);this.f=null;return!0}return!1},s:function(){var n=new _at.bS;n.c(this.q);n.b(this.r);this.d=_a.b.b(_at.q.a,"TokenRequest",!1,null);this.k&&_a.b.a(this.k);this.k=_a.b.b(_at.q.a,"TokenRequestTimer",!1,null);this.m||(n.R=this.e);this.o.a(n)},t:function(n){this.h=n.N;if(this.d){_a.b.a(this.d);this.d=null}this.j=_a.L.b()},u:function(n){if(this.d){this.d.p="Action failed.";this.d.n=n.O();n.G?_a.b.e(this.d,n.G):_a.b.a(this.d);this.d=null}},a:function(n,t,i,r,u){this.i&&this.i.a().dE().Enabled&&(u=!1);if(!n||!n.Id||n.Id.startsWith("smime-")){_j.e.b(_at.q.a,"Attachment URL requires a non-empty and non-SMIME attachment ID.");return null}i||(i=_g.C.a());var e=String.format(i,encodeURIComponent(n.Id));var s=!!_h.p.a&&!!_h.p.a.s&&_h.p.a.s.c();t&&(e+=_g.C.e());if(!this.l||u||!this.n&&!_j.h.a(r)){if(_j.h.a(r)){if(s){var l=_h.p.b(null);_j.h.a(l)||(e=String.format("{0}/{1}",l,e))}}else e=String.format("{0}/{1}",r,e);return e}var o=new _a.l;var a=this.j===-1;o.c("F",a);var v=a?_a.b.y():_a.L.b()-this.j;o.b("A",v);o.c("G",!_j.h.a(r));o.c("T",!_j.h.d(this.h));o.c("P",s);_a.b.c(_at.q.a,"CreateDownloadUrl",o.toString(),0);var f;if(_a.bs.a()&&this.g.indexOf("@")!==-1)f=this.g+e+"&token="+this.h;else{var h=this.e;if(s){var c=_h.p.b(null);_j.h.a(c)||(h=c)}f=this.g+encodeURIComponent(h)+"/"+e+"&token="+this.h}f=f+"&owa="+window.location.hostname;this.m&&(f=f+"&isc=1");_j.e.a(_at.q.a,"Download URL: {0}",f);return f},c:function(n,t,i,r,u){var f=this.a(n,t,r,u,i);f&&!i&&(f+="&isImagePreview=True");return f},b:function(n,t,i,r,u){var f=_at.w.c(this.i,n);return f?f.g(t,i,r,u):i}};_at.G=function(){this.g=new FileReader};_at.G.prototype={g:null,h:null,b:function(){return this.g.error},d:function(){return this.h},c:function(){return this.g.result},f:function(n){this.g.onloadend=n;return n},e:function(n){if(_db.bD.isInstanceOfType(n)){var i=n;this.g.readAsDataURL(i.c)}else if(_h.bG.isInstanceOfType(n)){var t=n;this.g.readAsDataURL(t.c)}},a:function(n,t,i,r,u){var f=this;this.g.onloadend=function(){if(!f.g.error&&f.g.result){var h=f.g.result.indexOf(",");var l=f.g.result.substring(h+1,f.g.result.length);var c=null;var e=0,o=0;if(u&&f.g.result.length>10&&f.g.result.substring(0,10)==="data:image"){var s=document.createElement("canvas");var a=s.getContext("2d");var n=new Image;n.onload=function(){if(n.height<n.width){o=250;n.height&&(e=o*n.width/n.height)}else{e=250;n.width&&(o=e*n.height/n.width)}_j.e.a(r,"Attachments canvas width={0}, height={1}",e,o);if(e&&o){s.width=e;s.height=o;try{a.drawImage(n,0,0,e,o);c=s.toDataURL("image/jpeg",1)}catch(i){_j.e.b(r,"Failed to get thumbnail with error {0}, ",i.message)}}f.i(f.g.result,l,h,t,c,e,o,r)};n.onerror=function(){_j.e.b(r,"Failed to load thumbnail into image object to get client thumbnail");f.i(f.g.result,l,h,t,c,e,o,r)};n.src=f.g.result}else f.i(f.g.result,l,h,t,c,e,o,r)}else{_j.e.b(r,"File reader failed with error code {0}",f.g.error);i()}};try{this.e(n)}catch(e){this.h=e;_a.o.a().K&&e.name==="NS_ERROR_FILE_ACCESS_DENIED"?_j.e.a(r,"Firefox: failed to read an attachment. Exception: {0}",e.message):_j.e.b(r,"Unexpected exception was thrown by FileReader.ReadAsDataURL: "+e.message);i()}},i:function(n,t,i,r,u,f,e,o){_j.e.a(o,"No error - Reading the file.");n.substring(0,i).indexOf("base64")!==-1?r(t,u,f,e):r(_a.bf.a(t),u,f,e)}};_at.bm=function(){};_at.bm.prototype={a:function(){return new _at.G}};_at.B=function(n,t,i,r,u,f,e,o,s,h,c,l){_at.B.initializeBase(this);this.e=new _gg.gX;this.e.AttachmentDataProviderId=n.bH.Id;this.h=n.a();this.j=c;this.l=l;var a=new _gg.dz;a.PagingMetadata=e;a.ItemsEndpointUrl=s;a.Sort=r;a.FolderId=t;a.Location=i;a.FilterBy=h;var v=new _g.L("Beginning");v.Offset=u;v.MaxEntriesReturned=f;a.RequestedData=v;this.e.Paging=a;this.e.Scope=o};_at.B.a=function(n){var t=n;return t.Type?t.Type===1?new _gg.i(n):t.Type===2?new _gg.j(n):new _gg.b(n):new _gg.h(n)};_at.B.prototype={e:null,k:null,f:0,h:0,j:null,l:!1,bb:function(){return this.o()?this.m():_h.cn.prototype.bb.call(this)},m:function(){if(this.h===5){_at.u.h(this.Q,this.e,this.I,this.H);return 1}else{var n=this;_at.f.v(this.Q,this.e,this.I,function(t){_j.e.b(_a.a.c,"Falling back to using Action Framework. Client side GetItems for ODB failed with exception: "+t.toString());_h.cn.prototype.bb.call(n)},this.l);return 1}},K:function(n){var t=new _gg.rx(this.L);n.bH(this.e,t,this.I,this.H)},cU:function(n,t,i){try{this.f=n.ResultCode;if(this.f)throw Error.create("Error retrieving data provider items");this.k=new Array(n.Items.length);for(var r=0;r<n.Items.length;r++)this.k[r]=_at.B.a(n.Items[r]);t()}catch(u){i(u)}},o:function(){var n=!this.h&&!this.e.Scope.Type&&!!this.j&&this.j.a().fo().Enabled&&!_j.h.a(this.e.Paging.ItemsEndpointUrl);return n||this.h===5}};_at.T=function(n){this.d=n};_at.T.prototype={d:null,c:function(){return this.d},b:function(n){return n.Id}};_at.bn=function(n,t,i,r,u,f,e,o,s,h){_at.bn.initializeBase(this);this.h=n.a();this.e=new _gg.jI;this.e.AttachmentDataProviderId=n.bH.Id;this.e.Query=t;var c=new _gg.dz;c.PagingMetadata=o;c.ItemsEndpointUrl=h;c.Sort=u;c.FolderId=i;c.Location=r;c.FilterBy=s;var l=new _g.L("Beginning");l.Offset=f;l.MaxEntriesReturned=e;c.RequestedData=l;this.e.Paging=c};_at.bn.a=function(n){var t=n;return t.Type?t.Type===1?new _gg.i(n):t.Type===2?new _gg.j(n):new _gg.b(n):new _gg.h(n)};_at.bn.prototype={e:null,f:null,j:0,h:0,bb:function(){if(this.h===5){_at.u.i(this.Q,this.e,this.I,this.H);return 1}return _h.cn.prototype.bb.call(this)},K:function(n){var t=new _gg.zW(this.L);n.cW(this.e,t,this.I,this.H)},cU:function(n,t,i){try{this.j=n.ResultCode;if(this.j)throw Error.create("Error searching for data provider items");this.f=new Array(n.Items.length);for(var r=0;r<n.Items.length;r++)this.f[r]=_at.bn.a(n.Items[r]);t()}catch(u){i(u)}}};_at.W=function(){};_at.W.b=function(){try{var n="dummyKey";var t="dummyValue";sessionStorage.setItem(n,t);sessionStorage.removeItem(n);return!0}catch(i){return!1}};_at.W.prototype={a:function(n){return sessionStorage.getItem(n)},b:function(n,t){sessionStorage.setItem(n,t)},c:function(n){sessionStorage.removeItem(n)}};_at.x=function(){this.b={}};_at.x.a=function(){_at.x.b||(_at.x.b=new _at.x);return _at.x.b};_at.x.prototype={a:function(n,t){this.b[n]=new _at.x.c(t)},c:function(n){if(n in this.b){var t=this.b[n];if(t.c())delete this.b[n];else return t.a}return null}};_at.x.c=function(n){this.a=n;this.b=Date.now()+36e5};_at.x.c.prototype={b:0,a:null,c:function(){return this.b<Date.now()}};_at.l=function(){};_at.l.g=function(n){return!!n&&_at.l.c(n.toString().toLowerCase())};_at.l.c=function(n){if(n in _at.l.b){var t=_at.l.b[n];if(t&&t.AccessTokenExpiry){var i=_a.d.b(t.AccessTokenExpiry);return!!i&&_a.d.get_utcNow().p(1).a(i)<0}}return!1};_at.l.a=function(n,t,i,r,u){var f;f=u?u.toString().toLowerCase():_g.q.toString(n);if(_at.l.c(f)){var e=_at.l.b[f];var o=_a.d.b(e.AccessTokenExpiry);t&&t(e.AccessToken);_a.d.get_utcNow().p(30).a(o)>0&&_at.l.e(n,null,null,r,u);return}_at.l.e(n,t,i,r,u)};_at.l.e=function(n,t,i,r,u){var e;var o=(e=new _dg.cv,e.DataProviderType=n,e);u&&(o.ResourceUrl=u.toString());var f=_at.l.f();f.onreadystatechange=function(){if(f.readyState===4)if(f.status===200){var s=Sys.Serialization.JavaScriptSerializer.deserialize(f.responseText);var e;e=u?u.toString().toLowerCase():_g.q.toString(n);_at.l.h(s,e,t,i,r)}else if(i){var o=Error.create(String.format("GetAccessToken failed with HTTP Status code {0}",f.status));i(o)}};f.open("GET",_g.C.p(),!0);f.setRequestHeader("X-OWA-UrlPostData",encodeURI(Sys.Serialization.JavaScriptSerializer.serialize(o)));_at.l.i(f);f.send(null)};_at.l.i=function(n){n.setRequestHeader("X-OWA-ActionName","GetAccessTokenforDataProvider");n.setRequestHeader(_a.w.c(),_a.w.d())};_at.l.h=function(n,t,i,r,u){if(n.TokenResultCode||_j.h.a(n.AccessToken)){var f=String.format("Access token request failed for token key {0} with response code {1}",t,n.TokenResultCode.toString());_j.e.b(_a.a.c,f);if(n.TokenResultCode===3&&u){_j.e.b(_a.a.c,"Invoking reauth callback. User will need to re-authenticate.");u()}else r&&r(Error.create(f))}else{_at.l.b[t]=n;i&&i(n.AccessToken)}};_at.l.f=function(){return _at.l.d?_at.l.d():new XMLHttpRequest};_at.u=function(){};_at.u.e=function(n,t,i,r){var u=new XMLHttpRequest;u.onreadystatechange=function(){if(u.readyState===4)if(u.status===200){var n=Sys.Serialization.JavaScriptSerializer.deserialize(u.responseText);var e=t?n.thumbnailLink:n.webContentLink;i(e)}else if(r){var f=Error.create(String.format("XHR GetContentUrl for GDrive failed with statusCode: {0}, response body: {1}",u.status,u.responseText));r(f)}};var f="https://www.googleapis.com/drive/v3/files"+(t?"/{0}?fields=thumbnailLink":"/{0}?fields=webContentLink");f=String.format(f,n);u.open("GET",f,!0);_at.u.a(u,null,r,null)};_at.u.g=function(n,t,i){var r=new XMLHttpRequest;r.onreadystatechange=function(){if(r.readyState===4)if(r.status===200)t(Sys.Serialization.JavaScriptSerializer.deserialize(r.responseText));else if(i){var n=Error.create(String.format("XHR GetMimeType for GDrive failed with statusCode: {0}, response body: {1}",r.status,r.responseText));i(n)}};var u=String.format("https://www.googleapis.com/drive/v3/files/{0}?fields={1}",n,"mimeType");r.open("GET",u,!0);_at.u.a(r,null,i,null)};_at.u.h=function(n,t,i,r){var f="name";var e="";switch(t.Paging.Sort.SortColumn){case 2:f="modifiedTime";break;case 1:f="quotaBytesUsed";break}e=t.Paging.Sort.SortOrder?"desc":"asc";var o=t.Paging.Location;var s=String.format("{0}&orderBy=folder,{1} {2}&q=mimeType!='application/octet-stream' and trashed=false and '{3}' in parents","maxResults=1000&fields=files(id,mimeType,name,size,modifiedTime,thumbnailLink)",f,e,_j.h.a(o)?"root":o);var h=String.format("{0}?{1}","https://www.googleapis.com/drive/v3/files",s);var u=new XMLHttpRequest;u.onreadystatechange=function(){if(u.readyState===4)if(u.status===200){var o=Sys.Serialization.JavaScriptSerializer.deserialize(u.responseText);var e=_at.u.c(o,t.AttachmentDataProviderId);i(n,e)}else{var f=Error.create(String.format("XHR GetItems for GDrive failed with statusCode: {0}, response body: {1}",u.status,u.responseText));r(f)}};u.open("GET",h,!0);_at.u.a(u,null,r,function(){var t;var r=(t=new _gg.ct,t.ResultCode=2,t);i(n,r)})};_at.u.c=function(n,t){var r=_at.u.b(n,t);var i;return i=new _gg.ct,i.ResultCode=0,i.TotalItemCount=n.files.length,i.Items=r,i};_at.u.i=function(n,t,i,r){var e=t.Paging.Location;var o=t.Query;var f=_j.h.c("{0}&q=mimeType!='application/octet-stream' and trashed=false and fullText contains '{1}'","maxResults=1000&fields=files(id,mimeType,name,size,modifiedTime,thumbnailLink)",o);_j.h.a(e)||(f=f+_j.h.c(" and '{0}' in parents",e));var s=_j.h.c("{0}?{1}","https://www.googleapis.com/drive/v3/files",f);var u=new XMLHttpRequest;u.onreadystatechange=function(){if(u.readyState===4)if(u.status===200){var o=Sys.Serialization.JavaScriptSerializer.deserialize(u.responseText);var e=_at.u.d(o,t.AttachmentDataProviderId);i(n,e)}else{var f=Error.create(_j.h.c("XHR SearchItems for GDrive failed with statusCode: {0}, response body: {1}",u.status,u.responseText));r(f)}};u.open("GET",s,!0);_at.u.a(u,null,r,null)};_at.u.d=function(n,t){var r=_at.u.b(n,t);var i;return i=new _gg.jJ,i.ResultCode=0,i.TotalItemCount=n.files.length,i.Items=r,i};_at.u.f=function(n){var t=n.indexOf("/d/");return n.substring(t+3,n.indexOf("/",t+3))};_at.u.a=function(n,t,i,r){_at.l.a(5,function(i){_at.u.j(n,i);n.send(t)},i,r,null)};_at.u.j=function(n,t){n.setRequestHeader("Authorization",String.format("Bearer {0}",t))};_at.u.b=function(n,t){for(var e=new Array(n.files.length),u=0;u<n.files.length;u++){var r=n.files[u];var f,i;var o=(i=new _gg.D,i.Name=r.name,i.Size=parseInt(r.size),i.Thumbnail=(f=new _gg.dB,f.Url=r.thumbnailLink,f),i.Modified=r.modifiedTime,i.MimeType=r.mimeType,i.Location=r.id,i.Id=r.id,i.AttachmentProviderId=t,i.ProviderType=5,i.Type=r.mimeType==="application/vnd.google-apps.folder"?1:0,i);e[u]=o}return e};_at.cm=function(){};_at.cm.prototype={files:null};_at.cn=function(){};_at.cn.prototype={id:null,name:null,mimeType:null,thumbnailLink:null,webContentLink:null,modifiedTime:null,size:null};_at.f=function(){};_at.f.s=function(n,t,i,r,u){if(!i){u(Error.create("Can't get file metadata for non-sharing link"));return}_at.f.t(t,n,r,u)};_at.f.t=function(n,t,i,r){var f=String.format("{0}?{1}&{2}",n,"api=srt","expand=thumbnails(select= medium, large)");var u=_at.f.a();u.onreadystatechange=function(){if(u.readyState===4){if(u.status===200){var n=u.responseText;if(!_j.h.a(n)&&_a.P.b(n)){_at.f.u(n,i,r,_at.f.b(n));return}}if(r){var t=Error.create(String.format("XHR GetFileMetadata failed with statusCode: {0}, response body: {1}",u.status,u.responseText));r(t)}}};u.open("GET",f,!0);u.send(null)};_at.f.u=function(n,t,i,r){var u=_at.f.a();u.onreadystatechange=function(){if(u.readyState===4)if(u.status===200){var n=Sys.Serialization.JavaScriptSerializer.deserialize(u.responseText);var e=n["@content.downloadUrl"];var o=_at.f.k(n,0);var r=_at.f.k(n,1);t(e,o,r)}else if(i){var f=Error.create(String.format("XHR GetFileMetadata failed with statusCode: {0}, response body: {1}",u.status,u.responseText));i(f)}};u.open("GET",n,!0);_at.f.c(u,null,i,r)};_at.f.v=function(n,t,i,r,u){var e="lastModifiedDateTime";switch(t.Paging.Sort.SortColumn){case 0:e="name";break;case 1:e="size";break}var s="desc";t.Paging.Sort.SortOrder||(s="asc");var c=String.format("orderby={0} {1}",e,s);var v="expand=thumbnails(select=medium)";var a=u?"filter=folder%20ne%20null&":"";var p=String.format("select={0},{1},{2},{3},{4},{5},{6},{7}","name","size","lastModifiedDateTime","file","folder","id","webDavUrl","package");var y=String.format("{0}&{1}&{2}",v,c,p);var h=_j.h.a(t.Paging.FolderId)?"root":t.Paging.FolderId;var o=new _a.P(t.Paging.ItemsEndpointUrl);var l=String.format("{0}/{1}/{2}/children?{3}{4}",String.format("{0}://{1}",o.b,o.a),"_api/v2.0/drive/items",h,a,y);var f=new XMLHttpRequest;f.onreadystatechange=function(){if(f.readyState===4)if(f.status===200){var o=Sys.Serialization.JavaScriptSerializer.deserialize(f.responseText);var e=_at.f.q(o,t.AttachmentDataProviderId,t.Paging.ItemsEndpointUrl);i(n,e)}else{var u=Error.create(String.format("XHR GetItems failed with statusCode: {0}, response body: {1}",f.status,f.responseText));r(u)}};f.open("GET",l,!0);f.setRequestHeader("Prefer","HonorNonIndexedQueriesWarningMayFailRandomly");_at.f.c(f,null,r,null)};_at.f.w=function(n){return n.package&&n.package.type==="oneNote"?"application/onenote":n.file?n.file.mimeType:null};_at.f.q=function(n,t,i){for(var s=new Array(n.value.length),e=0;e<n.value.length;e++){var u=n.value[e];var o,r;var h=(r=new _gg.D,r.Name=u.name,r.Size=u.size,r.Thumbnail=(o=new _gg.dB,o.Url=u.thumbnails&&u.thumbnails[0]&&u.thumbnails[0].medium?u.thumbnails[0].medium.url:null,o),r.Modified=u.lastModifiedDateTime,r.MimeType=_at.f.w(u),r.Location=new _a.P(u.webDavUrl).d,r.Id=u.id,r.ProviderEndpointUrl=i,r.ChildCount=u.folder?u.folder.childCount:0,r.AttachmentProviderId=t,r.ProviderType=0,r.Type=u.folder?1:0,r);s[e]=h}var f;return f=new _gg.ct,f.ResultCode=0,f.TotalItemCount=n.value.length,f.Items=s,f};_at.f.n=function(n,t,i,r,u,f,e,o,s,h,c,l){var v="";c&&(v=_at.f.h());var y=String.format("{0}/content?{1}{2}",_at.f.j(n,t,i,r,h),"@name.conflictBehavior=rename",v);var a=_at.f.a();a.onreadystatechange=function(){_at.f.d(a,l);if(a.readyState===4)if(a.status===200||a.status===201){var t=Sys.Serialization.JavaScriptSerializer.deserialize(a.responseText);e(t,!0)}else{var n=Error.create(String.format("XHR UploadAsSingleSlice failed with statusCode: {0}, response body: {1}",a.status,a.responseText));o(n)}};f&&_at.f.l(f,a);a.open("PUT",y,!0);s?_at.f.f(a,u,o,_at.f.b(n)):_at.f.f(a,u,o,null)};_at.f.g=function(n,t,i,r,u,f,e,o,s){var l=String.format("{0}/upload.createSession",_at.f.j(n,t,i,r,o));var c='{ "item": {"@name.conflictBehavior": "rename"} }';var h=_at.f.a();h.open("POST",l,!0);h.setRequestHeader("Content-Type","application/json");h.onreadystatechange=function(){_at.f.d(h,s);if(h.readyState===4)if(h.status===200){var i=Sys.Serialization.JavaScriptSerializer.deserialize(h.responseText);var t=i.uploadUrl;u(t)}else{var n=Error.create(String.format("CreateAttachment XHR failed with statusCode: {0}, response body: {1}",h.status,h.responseText));f(n)}};e?_at.f.c(h,c,f,_at.f.b(n)):_at.f.c(h,c,f,null)};_at.f.o=function(n,t,i,r,u,f,e,o,s,h,c){var l=_at.f.a();l.onreadystatechange=function(){_at.f.d(l,h);if(l.readyState===4)if(l.status===200||l.status===201){var t=Sys.Serialization.JavaScriptSerializer.deserialize(l.responseText);e(t,!0)}else if(l.status===202)e(null,!1);else{var n=Error.create(String.format("XHR UploadSlice failed with statusCode: {0}, response body: {1}",l.status,l.responseText));o(n)}};f&&_at.f.l(f,l);var v="";s&&(v=_at.f.h());l.open("PUT",n+v,!0);var a=i*r;var y=Math.min(a+r,u);l.setRequestHeader("Content-Range",String.format("bytes {0}-{1}/{2}",a,Math.max(0,y-1),u));_at.f.f(l,t,o,c)};_at.f.p=function(n,t){var i=_at.f.a();i.open("DELETE",n);_at.f.c(i,null,null,t)};_at.f.b=function(n){var i=null;if(!_j.h.a(n)){var t=new _a.P(n);var r=t.b+"://"+t.a;i=new _a.P(r)}return i};_at.f.x=function(n,t,i,r,u,f,e,o){var a=String.format("select={0},{1},{2},{3},{4},{5},{6}","name","size","lastModifiedDateTime","file","folder","id","webDavUrl");var c=null;if(t)c=String.format("{0}/{1}/{2}/driveItem?{3}",n,"_api/v2.0/shares",_at.f.r(u),a);else{var h=u;var v=String.format("{0}{1}/",i.c,r,"/");u.startsWith(v)&&(h=u.substr(v.length));var l=h.indexOf("?");l>0&&(h=h.substring(0,l));c=String.format("{0}/{1}:/{2}?{3}&{4}",n,"_api/v2.0/drive/root",h,"@name.conflictBehavior=rename",a)}var s=_at.f.a();s.onreadystatechange=function(){if(s.readyState===4)if(s.status===200||s.status===201){var t=Sys.Serialization.JavaScriptSerializer.deserialize(s.responseText);e&&e(t.webDavUrl)}else{var n=Error.create(String.format("XHR MoveItem failed with statusCode: {0}, response body: {1}",s.status,s.responseText));o&&o(n)}};s.open("PATCH",c,!0);s.setRequestHeader("Content-Type","application/json");f===""&&(f="root");var y='{"parentReference": {"id": "'+f+'" } }';_at.f.c(s,y,o,null)};_at.f.h=function(){return String.format("&select={0},{1},{2},{3},{4},{5},{6},{7}","name","size","lastModifiedDateTime","file","folder","id","parentReference","webDavUrl")};_at.f.r=function(n){var t=_a.bf.a(n);if(_j.h.a(t))return t;t.endsWith("=")&&(t=t.substring(0,t.length-1));return"u!"+t.replace("/","_").replace("+","-")};_at.f.k=function(n,t){var i=n.thumbnails;if(!i||!i.length)return null;var r=t?i[0].large:i[0].medium;return r?r.url:null};_at.f.f=function(n,t,i,r){_at.l.a(0,function(i){_at.f.m(n,i);_at.f.y(t,n)},i,null,r)};_at.f.c=function(n,t,i,r){_at.l.a(0,function(i){_at.f.m(n,i);n.send(t)},i,null,r)};_at.f.m=function(n,t){n.setRequestHeader("Authorization",String.format("Bearer {0}",t))};_at.f.l=function(n,t){t.upload.onprogress=n};_at.f.y=function(n,t){t.send(n)};_at.f.j=function(n,t,i,r,u){var f=null;f=i===""?_at.f.i(n,r):i?String.format("{0}/{1}/{2}:/{3}:",n,"_api/v2.0/drive/items",i,r):u?String.format("{0}/{1}:/{2}:",n,"_api/v2.0/drive/special/attachments",r):_j.h.a(t)?_at.f.i(n,r):String.format("{0}/{1}:/{2}/{3}:",n,"_api/v2.0/drive/root",t,r);return f};_at.f.i=function(n,t){return String.format("{0}/{1}:/{2}:",n,"_api/v2.0/drive/root",t)};_at.f.a=function(){return _at.f.e?_at.f.e():new XMLHttpRequest};_at.f.d=function(n,t){if(n.readyState===2&&t){var r=n.getResponseHeader("SPRequestGuid");var i=new _a.l;i.a("ODReqId",r);_j.h.a(t.k())?t.i(i.toString()):t.i(t.k()+("|"+i.toString()))}};_at.f.C=function(){};_at.f.C.prototype={name:null,webUrl:null,webDavUrl:null,size:0,id:null,file:null,folder:null,parentReference:null,thumbnails:null,lastModifiedDateTime:null,package:null};_at.f.E=function(){};_at.f.E.prototype={type:null};_at.f.A=function(){};_at.f.A.prototype={childCount:0};_at.f.z=function(){};_at.f.z.prototype={mimeType:null};_at.f.G=function(){};_at.f.G.prototype={id:null,small:null,medium:null,large:null};_at.f.F=function(){};_at.f.F.prototype={height:null,width:null,url:null};_at.f.B=function(){};_at.f.B.prototype={value:null};_at.f.D=function(){};_at.f.D.prototype={id:null,path:null};_at.D=function(n){_at.D.initializeBase(this);this.f=n};_at.D.b=function(){_at.D.a={}};_at.D.prototype={e:null,f:0,K:function(n){var i=new _gg.rr(this.L);var t=new _gg.gY;t.ClientVersion=this.f;n.bE(t,i,this.I,this.H)},cU:function(n,t,i){try{this.e=new Array(n.length);for(var r=0;r<n.length;r++){var u=n[r].Id;_at.D.a[u]||(_at.D.a[u]=_a.n.c(_gg.x,n[r],_gg.x));this.e[r]=_at.D.a[u]}t()}catch(f){i(f)}}};_at.bG=function(n,t,i,r,u){_at.bG.initializeBase(this);this.h=new _gg.fV(n,t,i,r);this.e=u};_at.bG.prototype={h:null,f:null,e:null,K:function(n){var t=new _gg.nW(this.L);t.actionName="CheckPendingAttachmentOperation";if(!_j.h.a(this.e)){t.explicitLogonUser=this.e;t.actionName+="_Group"}n.dE(this.h,t,this.I,this.H)},cU:function(n,t,i){try{_a.c.a(n,"result");this.f=n.NotificationPayloads;t()}catch(r){i(r)}}};_at.bC=function(n){_at.bC.initializeBase(this);this.e=n};_at.bC.prototype={e:null,K:function(n){var t=new _gg.nQ(this.L);n.bb(this.e,t,this.I,this.H)},cU:function(n,t,i){n?t():i(null)}};_at.bD=function(n){_at.bD.initializeBase(this);this.e=new _gg.fT;this.e.cancellationId=n};_at.bD.prototype={e:null,K:function(n){var t=new _gg.nR(this.L);n.bc(this.e,t,this.I,this.H)},cU:function(n,t,i){n?t():i(null)}};_at.bE=function(n){_at.bE.initializeBase(this);this.e=new _gg.fU;this.e.cancellationId=n};_at.bE.prototype={e:null,K:function(n){var t=new _gg.nS(this.L);n.bd(this.e,t,this.I,this.H)},cU:function(n,t,i){n?t():i(null)}};_at.bF=function(n){_at.bF.initializeBase(this);this.e=n};_at.bF.prototype={e:null,K:function(n){var t=new _gg.nT(this.L);n.dD(this.e,t,this.I,this.H)},cU:function(n,t,i){n?t():i(null)}};_at.bH=function(n,t){_at.bH.initializeBase(this);this.e=new _gg.ga;this.e.ewsAttachmentId=n;this.e.itemId=t};_at.bH.prototype={e:null,f:null,K:function(n){var t=new _gg.oz(this.L);n.bf(this.e,t,this.I,this.H)},cU:function(n,t,i){try{_a.c.a(n,"result");if(n.ErrorMessage)throw Error.create(n.ErrorMessage);this.f=n.ContentId;t()}catch(r){i(r)}}};_at.bI=function(n,t,i,r){_at.bI.initializeBase(this);this.f=new _gg.gb;this.f.subscriptionId=i;this.f.ewsAttachmentId=n;this.f.itemId=t;this.f.channelId=_no.a.a;this.f.cancellationId=r;this.e=n.Id};_at.bI.prototype={f:null,e:null,K:function(n){var t=new _gg.oE(this.L);n.bh(this.f,t,this.I,this.H)},cU:function(n,t,i){try{_a.c.a(n,"result");t()}catch(r){i(r)}}};_at.bJ=function(n,t,i,r,u,f,e){_at.bJ.initializeBase(this);this.e=new _gg.gc;this.e.attachmentDataProviderId=t;this.e.ewsAttachmentId=n.Id;this.e.emailId=i;this.e.subscriptionId=r;this.e.channelId=_no.a.a;this.e.cancellationId=e;this.e.fullPathLocation=u;this.e.PermissionLevel=f;this.f=n.Id};_at.bJ.prototype={e:null,f:null,K:function(n){var t=new _gg.oF(this.L);n.bi(this.e,t,this.I,this.H)},cU:function(n,t,i){try{_a.c.a(n,"result");t()}catch(r){i(r)}}};_at.o=function(n,t,i,r,u,f,e,o,s,h,c){_at.o.initializeBase(this);this.o=n;this.k=t;this.q=i;this.s=r;this.r=s;this.m=h;this.p=u;this.u=f;this.t=e;this.D=o;this.l=c};_at.o.b=function(){var n=new XMLHttpRequest;return n.upload&&n.upload.onprogress!==undefined};_at.o.d=function(n,t,i,r,u,f){try{var o=JsonParser.deserialize(n);if(o&&o.Body)if(o.Body.ResponseMessages){var s=o.Body.ResponseMessages.Items[0];if(s.ResponseCode!=="NoError"){_j.e.c(_at.o.a,"Got a attachment error response with {0}",s.ResponseCode);var l=s.MessageText;var h={};h.ResponseCode=s.ResponseCode;f(Error.create(l,h),null)}else{var e=s.Attachments[0];t.g(e.AttachmentId);i.Id=e.AttachmentId.RootItemId;i.ChangeKey=e.AttachmentId.RootItemChangeKey;t.f(e.Size||0);t.j(e.ContentType);t.a()&&t.m(e.ContentId);u(o)}}else{_j.e.c(_at.o.a,"Got no response message in the body; assuming it is a fault response");var c=o;f(Error.create(c.Body.FaultMessage),c.Body)}else{_j.e.c(_at.o.a,"Got no response or response without body");f(Error.create(""),null)}}catch(a){_j.e.c(_at.o.a,"Got exception processing response: {0}, exception: {1}",n,a);n===""&&(a=Error.create(""));f(a,null)}};_at.o.c=function(n,t,i,r){if(!n.IsCancelled){n.Attachments.length>0&&t.g(n.Attachments[0].AttachmentId);if(r){t.a()&&t.m(n.Attachments[0].ContentId);n.Attachments[0].Size>0&&t.f(n.Attachments[0].Size);i.Id=n.Attachments[0].AttachmentId.RootItemId;i.ChangeKey=n.Attachments[0].AttachmentId.RootItemChangeKey}}};_at.o.prototype={u:!1,l:null,o:0,k:null,q:null,e:null,s:null,r:0,m:0,p:null,j:null,f:null,t:null,D:!1,bk:function(){if(this.G||!this.Q||!this.Q.response){_j.e.a(_at.o.a,"No success response because there's an error, or action is not complete.  Error: {0}",this.G);return null}return this.Q.response.result},bb:function(){return this.t&&_at.o.b()?this.bl():_h.cn.prototype.bb.call(this)},bg:function(){var n=null;!_j.h.a(this.p)&&this.u?n=this.p:this.e.Body&&this.e.Body.ParentItemId&&_a.bL.a(this.e.Body.ParentItemId.Id)&&(n=_h.p.b(null));return n},bl:function(){var n=new XMLHttpRequest;var t=this;n.onreadystatechange=function(){if(n.readyState===4)if(n.status===200){var r=Sys.Serialization.JavaScriptSerializer.deserialize(n.responseText);t.bh(t.Q,r)}else{var i=Error.create(String.format('CreateAttachment XHR failed with statusCode: "{0}", response body: "{1}"',n.status,n.responseText));t.bc(i)}};var r=this;var u=function(n){var t=Math.round(n.loaded*100/n.total);r.t(t)};n.upload.onprogress=u;n.open("POST",_g.C.n(),!0);this.e=this.be();this.bo(n);var i=Sys.Serialization.JavaScriptSerializer.serialize(this.e);if(_dg.e.isInstanceOfType(this.k)&&this.D){n.setRequestHeader("X-OWA-UrlPostData",encodeURI(i));n.send(this.k.c)}else n.send(i);return 1},bo:function(n){n.setRequestHeader("X-OWA-ActionName","P_CreateAttachmentFromLocalFile");n.setRequestHeader(_a.w.c(),_a.w.d());var t=this.bg();if(!_j.h.a(t)){n.setRequestHeader("X-OWA-ExplicitLogonUser",t);n.setRequestHeader("X-AnchorMailbox",t)}},K:function(n){this.e=this.be();if(this.s){this.j=new _gg.oM(this.L);this.j.explicitLogonUser=this.bg();this.j.clientStoreItem=this.o;this.j.isQueued=!1;this.j.palContext=new _g.fa(!1);_j.h.a(this.l)||(this.j.actionName="CreateAttachmentFromLocalFileAction"+this.l);n.bk(this.e,this.j,this.I,this.H)}else{this.f=new _gg.lN(this.L);this.f.explicitLogonUser=this.bg();this.f.clientStoreItem=this.o;this.f.isQueued=!1;this.f.palContext=new _g.fa(!1);_j.h.a(this.l)||(this.f.actionName="CreateAttachmentAction"+this.l);n.d(this.e,this.f,this.I,this.H)}},cJ:function(n){this.bj(n)},bj:function(n){_at.o.c(n,this.k,this.q,this.m<=this.r+1)},be:function(){var i=new _g.e(this.q.Id);i.ChangeKey=this.q.ChangeKey;var t=this.k.v();var n=new _gg.dJ(i);n.Attachments=[t];n.RequireImageType=t.IsInline;n.IncludeContentIdInResponse=t.IsInline;n.ClientSupportsIrm=!0;n.CancellationId=this.s;if(this.m!==1){n.SliceNumber=this.r;n.TotalSlices=this.m}return new _gg.dI(this.M(),n)}};_at.bK=function(n,t,i,r,u,f){_at.bK.initializeBase(this,[n,t,i,r,u,f,null,!1,0,1,null]);var e=t.c;this.bi=e};_at.bK.prototype={bi:null,K:function(n){var u=this.be();var t=new _gg.lN(this.L);this.u&&(t.explicitLogonUser=this.p);t.clientStoreItem=this.o;t.isQueued=!0;for(var r=u.Body.Attachments,e=r.length,i=0;i<e;++i){var f=r[i];if(f.IsInline){t.isQueued=!1;break}}t.palContext=new _g.fa(!0);t.dataFile=this.bi.g();n.d(u,t,this.I,this.H)},cJ:function(n){this.bj(n)}};_at.bb=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){_at.bb.initializeBase(this);this.p=n;this.h=t;this.q=i;this.e=u;this.t=f;this.j=r;this.k=e;this.l=o;this.D=s;this.s=h;this.o=c;this.u=l;this.r=a;this.f=v};_at.bb.prototype={p:null,h:null,q:null,e:null,t:null,j:null,k:null,l:null,D:null,s:null,o:!1,u:!1,r:null,f:null,m:null,K:function(n){var t=new _gg.pb(this.L);this.u&&(t.explicitLogonUser=this.e);t.actionName=_j.h.a(this.e)?"CreateReferenceAttachmentFromAttachmentDataProviderAction":"CreateReferenceAttachmentFromAttachmentDataProviderInGroupAction";_j.h.a(this.f)||(t.actionName=t.actionName+this.f);n.bo(this.p,this.h,this.q,this.j,this.k,this.t,t,this.I,this.H,this.l,this.D,this.s,this.o,this.r)},cU:function(n,t,i){try{_a.c.a(n,"result");this.m=n;t()}catch(r){i(r)}}};_at.bL=function(n,t,i){_at.bL.initializeBase(this);this.k=n;this.f=t;this.e=i;this.j=t.bH.AttachmentId||t.bH.TemporaryId};_at.bL.prototype={k:0,f:null,j:null,e:null,cJ:function(n){this.e.Id=n.RootItemId.RootItemId;this.e.ChangeKey=n.RootItemId.RootItemChangeKey;this.f.bH.TemporaryId&&this.f.g(this.f.bH.TemporaryId)},K:function(n){var r=new _gg.dN;r.ClientSupportsIrm=!0;var i=new _gg.pu(this.L);i.itemContexts=new Array(1);var t=new _gg.EC;t.clientStoreItem=this.k;t.parentItemId=new _g.e(this.e.Id);t.parentItemId.ChangeKey=this.e.ChangeKey;r.AttachmentIds=[new _g.bi(this.j.Id)];var u=new _gg.gp(this.M());u.Body=r;i.itemContexts[0]=t;_a.bL.a(this.e.Id)&&(i.explicitLogonUser=_h.p.b(null));n.r(u,i,this.I,this.H)}};_at.bM=function(n){_at.bM.initializeBase(this);this.f=n};_at.bM.prototype={f:null,e:null,K:function(n){var t=new _gg.rl(this.L);n.bC(this.f,t,this.I,this.H)},cU:function(n,t,i){if(_j.h.b(n))i(Error.create("AddIns is null or empty."));else{this.e=n;t()}}};_at.K=function(n,t,i){_at.K.initializeBase(this);this.f=n;this.j=t;this.R=i};_at.K.prototype={f:null,e:null,j:!1,M:function(){return this.W("Exchange2015")},K:function(n){var i=new _dg.di(this.L);i.explicitLogonUser=this.R;var t=new _gg.ha(this.M());t.Body.AttachmentIds=[new _g.bi(this.f)];t.Body.ShapeName="ItemAttachment";t.Body.AttachmentShape=_h.b.Z();if(this.j){t.Header.ManagementRole=new _g.cY;t.Header.ManagementRole.UserRoles=["MailboxSearch"]}n.bF(t,i,this.I,this.H)},cJ:function(n){var t=null;var u=n.Attachments.length;u!==1&&(t="GetAttachment response length = "+u);var r=n.Attachments[0];r||(t="GetAttachment response contained null attachment");var i=_a.n.c(_dg.j,r);this.e=i.k();this.e||(t="GetAttachment response contained null item");t?_j.e.b(_a.a.c,t):_j.e.a(_a.a.c,"GetAttachment succeeded for '{0}' on '{1}'",i.bH.Name,this.e.bH.Subject)}};_at.bN=function(n,t,i,r,u){_at.bN.initializeBase(this);this.j=n;this.e=t;this.h=i;this.k=r;this.l=u;this.f=t.bH.AttachmentId||t.bH.TemporaryId;if(!_dg.e.isInstanceOfType(t)&&!_dg.j.isInstanceOfType(t)&&!_g.B.isInstanceOfType(t))throw Error.notImplemented("Only FileAttachment, ItemAttachment and ItemIdAttachment are supported to get content.");};_at.bN.prototype={j:null,e:null,f:null,h:null,k:null,l:null,bb:function(){if(_dg.e.isInstanceOfType(this.e)){var n=this.e;if(_a.fE.isInstanceOfType(n.c)&&!n.u){var u=n.c;var r=new _at.bm;var f=r.a();var t=this,i=this;f.a(u,function(i,r,u,f){n.k(t.m(i));t.X(null)},function(){var t=String.format("Unable to read content of file {0}.",n.bH.Name);_j.e.b(i.j,t);i.X(Error.create(t))},this.j,!1);return 1}else if(n.u&&n.bH.Content&&n.bH.Content.length>0){this.X(null);return 1}else return this.o()}else return _dg.j.isInstanceOfType(this.e)?this.o():_h.cn.prototype.bb.call(this)},cU:function(n,t,i){var r=this.e;if(_j.h.a(n))i(Error.create(String.format("The MIME content of item {0} cannot be retrieved.",r.bH.ItemId.Id)));else{r.y(this.m(n));t()}},K:function(n){var t=new _g.e(this.e.bH.ItemId.Id);n.cg(t,null,this.I,this.H)},o:function(){var t=new XMLHttpRequest;var i;if(this.k&&this.k.a().dE().Enabled)i=this.l.a(this.f,!1,_dg.j.isInstanceOfType(this.e)?_g.C.a():_g.C.c(),this.h,!0);else{var r=_dg.j.isInstanceOfType(this.e)?_g.C.a():_g.C.c();r+="&Scenario=GetFileAttachmentContent";i=String.format(r,encodeURIComponent(this.f.Id));_j.h.a(this.h)||(i=String.format("{0}/{1}",this.h,i))}var n=this;t.onreadystatechange=function(){if(t.readyState===4)if(t.status===200){var r=n.m(t.responseText);_dg.e.isInstanceOfType(n.e)?n.e.k(r):_dg.j.isInstanceOfType(n.e)&&n.e.s(r);n.X(null)}else{var i=String.format("Unable to get file attachment content.\nAttachmentId = {0}\nResponseBody = {1}\nStatusText = {2}",n.f.Id,t.responseText,t.statusText);_j.e.c(n.j,i);n.X(Error.create(i))}};t.open("GET",i,!0);_a.m.R(t);t.send(null);return 1},m:function(n){if(n.startsWith("data:")){var t=";base64,";var i=n.indexOf(t);return n.substr(i+t.length)}else return n}};_at.n=function(n){_at.n.initializeBase(this);this.e=n};_at.n.e=function(n){var t=_at.n.c(n);return t?t.FolderName:null};_at.n.d=function(n){var t=_at.n.c(n);return t?t.FolderId:null};_at.n.f=function(){return _at.n.b>=2?!0:!1};_at.n.c=function(n){if(_j.h.a(n)){_j.e.a(_a.a.c,"An invalid key was passed in as an argument.");return null}if(!_at.n.a||!(n in _at.n.a)){_j.e.a(_a.a.c,String.format("No response objects were cached with the given key: {0}",n));return null}return _at.n.a[n]};_at.n.prototype={e:null,h:null,f:null,K:function(n){var t=new _gg.rz(this.L);t.explicitLogonUser=this.e;n.bJ(t,this.I,this.H);this.e||_at.n.b++},cU:function(n,t,i){if(!n){i(Error.create("Failed to get valid properties of the default upload folder."));return}var r=this.e||"PersonalOneDriveKey";_at.n.a||(_at.n.a={});this.f=n.FolderName;this.h=n.FolderId;_at.n.a[r]=n;t()}};_at.bO=function(n,t,i,r,u,f,e){_at.bO.initializeBase(this,[n,t,i,r,u,f]);this.f="GetSuiteExtensionsAttachmentInfo";this.p=_j.h.b(e)?null:e};_at.bO.prototype={p:null,K:function(n){var t=new _gg.rB(this.L);this.k&&(t.explicitLogonUser=this.k);this.f+=this.m?"Cloudy":"Classic";this.f+=this.h?"Edit":"Preview";t.actionName=this.f;this.l&&(t.isDiscovery=!0);n.eV(this.j,this.h,this.o,t,this.I,this.H,this.p)},cU:function(n,t,i){this.e=n;if(this.e)if(this.e.Status){var u=Error.create("GetAttachmentInfo was not successful.");i(u)}else{this.h||_at.x.a().a(this.j,this.e);t()}else{var r=new _dg.bu;r.Status=1;r.WacUrl="";this.e=r;i(Error.create("Server unavailable."))}}};_at.co=function(n,t,i,r,u,f){_at.co.initializeBase(this);this.j=n;this.h=t;this.o=i;this.m=r;this.k=u;this.l=f};_at.co.prototype={e:null,f:"GetAttachmentInfo",j:null,h:!1,o:null,m:!1,k:null,l:!1};_at.bk=function(n,t,i,r,u,f,e){_at.bk.initializeBase(this,[n,t,i,r,u,f]);this.f="GetWacAttachmentInfo";_j.h.a(e)||(this.f=this.f+e)};_at.bk.prototype={K:function(n){var t=new _gg.vx(this.L);this.k&&(t.explicitLogonUser=this.k);this.f+=this.m?"Cloudy":"Classic";this.f+=this.h?"Edit":"Preview";t.actionName=this.f;this.l&&(t.isDiscovery=!0);n.cE(this.j,this.h,this.o,t,this.I,this.H,null)},cU:function(n,t,i){this.e=n;if(this.e)if(this.e.Status){this.h||this.e.Status!==9||_at.x.a().a(this.j,this.e);var u=Error.create("GetWacAttachmentInfo was not successful. The status is "+this.e.Status.toString());i(u)}else{this.h||_at.x.a().a(this.j,this.e);t()}else{var r=new _dg.bu;r.Status=1;r.WacUrl="";this.e=r;i(Error.create("Server unavailable."))}}};_at.Q=function(n,t,i,r,u,f,e,o){_at.Q.initializeBase(this,[_at.i.g(n),t,i,r,f,e]);this.q=n;this.f="GetWacInfoAction";this.p=o};_at.Q.prototype={q:null,p:null,K:function(n){var i=new _gg.vz(this.L);this.k&&(i.explicitLogonUser=this.k);this.f+=this.m?"Cloudy":"Classic";this.f+=this.h?"Edit":"Preview";_j.h.a(this.p)||(this.f+=this.p);i.actionName=this.f;this.l&&(i.isDiscovery=!0);var t=new _gg.ix;t.Url=this.j;t.IsEdit=this.h;t.ProviderType=0;n.gK(t,i,this.I,this.H)},cU:function(n,t,i){this.e=n;if(this.e)if(this.e.Status){this.h||this.e.Status!==9||_at.x.a().a(this.j,this.e);var u=Error.create("GetWacInfo was not successful. The status is "+this.e.Status.toString());i(u)}else{this.h||_at.x.a().a(this.j,this.e);t()}else{var r=new _dg.bu;r.Status=1;r.WacUrl="";this.e=r;i(Error.create("Server unavailable."))}}};_at.bc=function(n,t,i,r,u){_at.bc.initializeBase(this);this.e=new _gg.jE;this.e.subscriptionId=i;this.e.ewsAttachmentId=n;this.e.channelId=_no.a.a;this.e.itemId=t;this.e.groupSmtpAddress=r;this.h=u};_at.bc.prototype={e:null,h:null,f:null,K:function(n){var t=new _gg.zM(this.L);t.actionName="SaveAttachmentsToCloud";if(!_j.h.a(this.e.groupSmtpAddress)){t.explicitLogonUser=this.e.groupSmtpAddress;t.actionName+="_Group"}_j.h.a(this.h)||(t.actionName+=this.h);n.cT(this.e,t,this.I,this.H)},cU:function(n,t,i){try{_a.c.a(n,"result");this.f=n;t()}catch(r){i(r)}}};_at.R=function(n,t,i,r){_at.R.initializeBase(this);this.k=n;this.e=t;this.f=this.e!==4&&this.e!==3?i:new Array(n.length);this.m=r};_at.R.prototype={k:null,e:0,l:!1,f:null,m:!1,j:null,h:!1,K:function(n){var i=new _gg.Ax(this.L);var t=new _gg.eS;t.AttachmentIds=this.k;t.PermissionLevel=this.e;t.NewAttachLongPathNames=this.f;t.SetToOriginalPermissionLevel=this.m;n.da(t,i,this.I,this.H)},cU:function(n,t,i){this.l=!0;if(n&&n.OperationSucceeded){this.j=n;t()}else i(Error.create("Error setting attachment permissions"))}};_at.cp=function(){};_at.cp.prototype={changePermission:0,convertLocalToRef:1,convertRefToLocal:2,copyLinkToClipboard:3,download:4,importIcsAttachment:5,moveAttachmentToInline:6,openInNewTab:7,preview:8,saveToCloud:9,viewInProvider:10,openInASeparateWindow:11,openInClient:12,arrange:13};_at.cp.registerEnum("_at.cp",!1);_at.cu=function(){};_at.cu.registerInterface("_at.cu");_at.bt=function(){};_at.bt.registerInterface("_at.bt");_at.cx=function(){};_at.cx.registerInterface("_at.cx");_at.cg=function(){};_at.cg.prototype={wacPreview:0,documentPreview:1};_at.cg.registerEnum("_at.cg",!1);_at.cw=function(){};_at.cw.registerInterface("_at.cw");_at.bu=function(){};_at.bu.registerInterface("_at.bu");_at.bv=function(){};_at.bv.registerInterface("_at.bv");_at.t=function(){};_at.t.registerInterface("_at.t");_at.bs=function(){};_at.bs.registerInterface("_at.bs");_at.Z=function(){};_at.Z.registerInterface("_at.Z");_at.J=function(){};_at.J.registerInterface("_at.J");_at.cv=function(){};_at.cv.registerInterface("_at.cv");_at.w=function(n,t){this.d=new _at.bh;this.b=new _at.bh;this.f=t;this.e=n};_at.w.c=function(n,t){var i;var u,r;return(r=_at.w.b(t,u={val:i}),i=u.val,r)?_at.w.a(n,i):null};_at.w.a=function(n,t){switch(t){case 0:return new _at.r(n,_u.n.FB);case 1:return new _at.H(n,_u.n.Ld);case 2:return new _at.O(n,_u.n.Pf);case 3:return new _at.N(n,_u.n.Dg);case 5:return new _at.A(n,_u.n.Fp);case 4:return new _at.be(n,_u.n.BO);case 6:return new _at.bq(n,_u.n.OR);case 7:return new _at.I(n,_u.n.Dg,_at.N.b());case 8:return new _at.I(n,_u.n.D,_at.I.b());case 9:return new _at.I(n,_u.n.Pf,_at.O.b());default:_j.e.b(_a.a.c,"TryParseDataProviderType: unimplemented data provider type: {0}",t);return null}};_at.w.b=function(n,t){try{t.val=_j.u.b(_g.q,n);return!0}catch(i){t.val=null;_j.e.b(_a.a.c,"TryParseDataProviderType: unknown data provider type: {0}",n);return!1}};_at.w.prototype={f:!1,e:null,h:function(){return this.b.f()>0},i:function(n){this.b!==n&&(this.b=n);return n},a:function(){return this.f?this.c(1):this.c(0)},g:function(n){var t;var r,i;return(i=_at.w.b(n,r={val:t}),t=r.val,i)?this.c(t):null},c:function(n){if(this.d.d(n))return this.d.e(n);var t=_at.w.a(this.e,n);t&&this.d.b(n,t);return t}};_at.L=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){this.l=n;this.f=t;this.n=i;this.g=r;this.c=u;this.d=f;this.q=e;this.m=o;this.j=s;this.a=h;this.h=c;this.k=l;this.e=a;this.p=v;this.o=y;this.b=p;this.i=w};_at.L.prototype={l:null,f:null,n:null,g:null,c:null,d:null,q:null,m:null,j:null,a:null,h:null,k:null,e:null,p:null,o:null,i:null,b:null};_at.M=function(n,t){this.a=n;this.b=t};_at.M.c=function(n,t){var i;i=t?_at.M.b(n):_at.M.a(n);return new _at.M(i,t)};_at.M.a=function(n){var t=!1;if(_at.e.isInstanceOfType(n)){var i=n;t=i.bR.a()}if(!n.bs.d||t||n.bs.f||n.bo.bH.IsSmimeDecoded)return n.bZ;switch(n.bs.a){case 3:return n.hf;case 2:return n.bZ;case 1:return n.bZ;case 0:default:return n.bZ}};_at.M.b=function(n){if(n.bo.bH.IsSmimeDecoded)return n.bZ;switch(n.bt()){case 5:return n.fg;case 3:return n.dm;case 1:case 2:return n.bs.a===3?new _j.g(function(){n.bp&&n.bp.cC(n)},_a.a.c):n.bZ;default:return _at.M.a(n)}};_at.M.prototype={a:null,b:!1};_at.E=function(n,t,i,r,u){this.c=n;this.e=t;this.d=i;this.b=r;this.a=u};_at.E.prototype={c:null,a:!1,e:null,d:0,b:0};_at.X=function(n,t,i){this.s=Function.createDelegate(this,this.v);this.t=Function.createDelegate(this,this.l);this.u=Function.createDelegate(this,this.C);_at.X.initializeBase(this);this.a=n};_at.X.prototype={p:null,a:null,n:null,d:null,m:null,j:null,b:null,q:!1,c:null,r:null,i:null,h:null,g:!1,e:null,f:!1,H:function(n){if(this.j!==n){this.j=n;this.eJ("SelectAttachmentDataProviderItemCommand")}return n},bx:function(){return 3},x:function(){return this.u},bU:function(){return this.n},bt:function(n){this.n=n;return n},y:function(){return this.d},o:function(n){this.d=n;return n},bz:function(){return!0},G:function(n){if(this.b!==n){this.b=n;this.eJ("OnMoveButtonClickCommand")}return n},B:function(){return this.g?_nbs.a.YB:_nbs.a.Qs},w:function(n,t,i,r,u){this.c=_a.b.b(_a.a.c,"AttachmentsFolderPicker",!1,null);this.i=t;this.h=r;this.g=n;this.e=u;this.D();this.i&&this.i(this);this.r=i;this.a.Y();this.p&&this.p.a().ci().Enabled&&_at.l.a(0,null,null,null,null)},eL:function(){var n;_a.h.a(n={val:this.b}),this.b=n.val;_a.gd.prototype.eL.call(this)},dw:function(){},du:function(){},dx:function(){if(this.c){this.c.m=this.A();_a.b.a(this.c);this.c=null}},dv:function(){},l:function(){if(this.d){this.z();this.r=null;this.d()}},A:function(){var n=new _a.l;_j.h.b(this.e)||n.h(this.e);n.a("O",this.g?"M":"C");n.a("FS",this.f?"1":"0");return n.toString()},C:function(n,t,i){if(!t){this.l();return!0}return!1},D:function(){this.f=!1;if(this.q)this.a.bb();else{this.m=new _j.g(this.t,_a.a.c);var t=this;this.H(new _j.g(function(){t.E()},_a.a.c));var n=this;this.G(new _j.w(function(){if(n.v()){var t=n.a.c;if(n.h){n.f=!0;n.h(t);n.l()}}},_a.a.c,this.a,"CurrentFolder",this.s));this.q=!0}},z:function(){this.a.b&&this.a.b.g()},E:function(){if(this.a.b&&this.a.b.x.length===1){var n=this.a.b.x[0];if(n.a()){if(n.a()===1){var r=n.bH.Id;var t=this.a.f;var i=t.b().a(_at.i.f(t));this.a.p(new _at.v(r,n.bH.Location,n.bH.Name,i,n.bH.ProviderEndpointUrl,t),!0,null,null)}}else return}},v:function(){return!!this.a.c}};_at.ca=function(n,t,i,r,u){_at.ca.initializeBase(this,[1,"AttachmentUploadDatapoint"]);this.a.S=n;this.a.T=t.toString();this.a.E=i;this.a.X=r;this.a.Z=u.toString()};_at.bd=function(n){_at.bd.initializeBase(this);this.e=n;var t=this;this.d=new _j.g(function(){t.a(!1)},_a.a.c)};_at.bd.prototype={b:!1,e:!1,d:null,c:function(){return this.b},a:function(n){if(this.b===n)return n;this.b=n;this.eJ("IsShown");return n},p:function(){return 600},q:function(){return 300},h:function(){return!0}};_at.b=function(n,t,i,r,u,f,e,o,s,h,c){this.hI=Function.createDelegate(this,this.km);this.hJ=Function.createDelegate(this,this.kn);this.hZ=Function.createDelegate(this,this.lu);this.ia=Function.createDelegate(this,this.lv);this.hW=Function.createDelegate(this,this.ls);this.hX=Function.createDelegate(this,this.lt);this.fO=Function.createDelegate(this,this.ku);this.fQ=Function.createDelegate(this,this.ly);this.iq=Function.createDelegate(this,this.mc);this.ir=Function.createDelegate(this,this.md);this.ic=Function.createDelegate(this,this.lz);this.id=Function.createDelegate(this,this.lA);this.hU=Function.createDelegate(this,this.lq);this.hR=Function.createDelegate(this,this.lf);this.hS=Function.createDelegate(this,this.lg);this.hQ=Function.createDelegate(this,this.kv);this.hC=Function.createDelegate(this,this.kf);this.hD=Function.createDelegate(this,this.iz);this.fN=Function.createDelegate(this,this.iA);this.ei=Function.createDelegate(this,this.ja);this.eg=Function.createDelegate(this,this.cy);this.eh=Function.createDelegate(this,this.es);this.fP=Function.createDelegate(this,this.lw);this.hT=Function.createDelegate(this,this.lo);this.hN=Function.createDelegate(this,this.kr);this.hO=Function.createDelegate(this,this.ks);this.ie=Function.createDelegate(this,this.jg);this.ig=Function.createDelegate(this,this.lC);this.fT=Function.createDelegate(this,this.lM);this.hL=Function.createDelegate(this,this.iB);this.ib=Function.createDelegate(this,this.lx);this.hM=Function.createDelegate(this,this.kq);this.fR=Function.createDelegate(this,this.lB);this.fM=Function.createDelegate(this,this.en);this.iu=Function.createDelegate(this,this.mI);this.hF=Function.createDelegate(this,this.kk);this.it=Function.createDelegate(this,this.mn);this.hV=Function.createDelegate(this,this.lr);this.im=Function.createDelegate(this,this.jm);this.ij=Function.createDelegate(this,this.lF);this.ii=Function.createDelegate(this,this.lE);this.iv=Function.createDelegate(this,this.mN);this.hK=Function.createDelegate(this,this.ko);this.hA=Function.createDelegate(this,this.kd);this.il=Function.createDelegate(this,this.lH);this.hE=Function.createDelegate(this,this.kg);this.hH=Function.createDelegate(this,this.Q);this.hG=Function.createDelegate(this,this.kl);this.ip=Function.createDelegate(this,this.js);this.hP=Function.createDelegate(this,this.kt);this.io=Function.createDelegate(this,this.jo);this.ik=Function.createDelegate(this,this.jk);this.is=Function.createDelegate(this,this.mf);this.hB=Function.createDelegate(this,this.ke);this.ih=Function.createDelegate(this,this.lD);this.gp=new _at.bm;_at.b.initializeBase(this);this.bW=c.l;this.ju=c.o;this.br=c.c;this.fd=c.d;this.gi=f;this.fe=e;this.cU=o;this.gd=c.h;this.cY=c.k;this.bO=c.e;this.dV=c.p;this.cM=c.i;c.b&&c.b.a&&(this.hh=c.b.a.bH.SPO_RootSiteUrl);this.eI=n.bH.ContentType==="image/gif";if(this.br){this.dL=this.br.a().b().Enabled;this.gF=this.br.a().eC().Enabled;this.gE=this.br.a().cv().Enabled;this.dg=this.br.a().s().Enabled;this.de=this.br.a().bS().Enabled;this.gD=this.br.a().dT().Enabled;this.dQ=this.br.a().kw().Enabled;this.gI=this.br.a().kx().Enabled;this.go=this.br.a().ip().Enabled;this.dd=this.br.a().dS().Enabled;this.gL=this.br.a().bj().Enabled}n||_j.e.c(_at.b.a,"Attachment is null in AttachmentViewModel ctor");var l="";var v,a;if(!_j.h.a(n.bH.Name)&&(a=_at.b.r(n.bH.Name,v={val:l}),l=v.val,a)){n.e(l);this.cX=!0}this.gZ(n);this.bJ=t;this.bu=c.f;this.dj=c.m;this.bD=c.g;this.dl=c.n;this.dk=c.a;this.cE=!1;this.dZ=!1;this.bp&&this.bp.d()&&(this.eY=this.bp.d().h());if(_dg.e.isInstanceOfType(n)){this.bT=n.bH.Content;this.gW=!_j.h.a(n.bH.AttachmentOriginalUrl)}this.by=i;this.bK=r;this.bP=h;this.bB=s;this.fl(!this.by);this.jv(_a.bc.a(n.bH.Name));this.bC=_at.i.c(u);this.jA(this.bB.b(this.bv,this.bo.bH.ContentType,!0,this.cR(),!!this.bq(),this.de,this.cX));this.bo&&this.bo.bH.AttachmentId&&this.fp(this.bs.b);this.cW();this.du();this.fB();this.hn();this.cG();this.bZ=new _j.g(this.ih,_at.b.a);this.gc=new _j.g(this.hB,_at.b.a);var y=this;this.ew=new _j.g(function(){y.dF(0)},_at.b.a);this.hf=new _j.g(this.is,_at.b.a);this.fg=new _j.g(this.ik,_at.b.a);this.dm=new _j.g(this.io,_at.b.a);this.ex=new _j.g(this.hP,_at.b.a);this.gX=new _j.g(this.ip,_at.b.a);this.gj=new _j.g(this.hG,_at.b.a);this.gk=new _j.g(this.hH,_at.b.a);this.gg=new _j.g(this.hE,_at.b.a);this.gM=new _j.g(this.il,_at.b.a);this.gb=new _j.g(this.hA,_at.b.a);this.gl=new _j.g(this.hK,_at.b.a);this.dv=new _j.g(this.iv,_at.b.a);this.gT=new _ff.q(this.ii,_at.b.a);this.gU=new _j.g(this.ij,_at.b.a);this.gV=new _j.g(this.im,_at.b.a);this.gP=new _j.g(this.hV,_at.b.a);if(this.br&&this.br.a().bQ().Enabled){this.hk=new _j.g(this.it,_at.b.a);this.er=new _j.g(this.hF,_at.b.a)}if(_dg.b.isInstanceOfType(n)&&!i){this.bQ=new _at.cf;this.bQ.c(this.cS(),this.y())}this.lV(u);this.br&&this.br.a().hn().Enabled&&this.iC();this.dw=new _y.bF;this.hg=c.q;this.fI();this.by||this.eE(null);this.eH()&&this.jf()};_at.b.t=function(){return"AttachmentViewModelSaveToCloudNotification"+(_a.d.a().h()+_ff.p.a(0,1e6)).toString()};_at.b.o=function(n,t){if(n.bH.IsSmimeDecoded){t.val=6;return!1}var r=!1;var i=_a.bc.a(n.bH.Name);i&&(r=_at.b.d.g(i.toLowerCase()));if(!r){t.val=6;return!1}var u=_dg.b.isInstanceOfType(n);_j.e.a(_at.b.a,"Attachment Type: {0}",u?"Cloudy":"Local");t.val=7;return!0};_at.b.p=function(n,t){if(n.bH.IsSmimeDecoded||_dg.b.isInstanceOfType(n)){t.val=6;return!1}var r=!1;var i=_a.bc.a(n.bH.Name);i&&(r=_at.b.g.g(i.toLowerCase()));if(!r){t.val=6;return!1}t.val=8;return!0};_at.b.r=function(n,t){t.val=n;if(n.endsWith(".7397C898-8104-4E2E-8926-98082ABAE229.PendingScan")){t.val=n.replace(".7397C898-8104-4E2E-8926-98082ABAE229.PendingScan","");return!0}return!1};_at.b.n=function(n,t){if(n.bH.IsSmimeDecoded){t.val=6;return!1}if(_dg.b.isInstanceOfType(n)){t.val=6;return!1}var r=!1;var i=_a.bc.a(n.bH.Name);i&&(r=_at.b.f.g(i.toLowerCase()));if(!r){t.val=6;return!1}_j.e.a(_at.b.a,"Attachment Type: Local");t.val=9;return!0};_at.b.prototype={br:null,eI:!1,gF:!1,gE:!1,de:!1,dd:!1,bC:null,dj:null,gd:null,bZ:null,ew:null,gc:null,hf:null,fg:null,dm:null,ex:null,gX:null,gb:null,gj:null,gk:null,gg:null,ev:null,gR:null,gS:null,gM:null,gl:null,dv:null,gT:null,gU:null,gV:null,gP:null,dw:null,dz:null,by:!1,bK:!1,dL:!1,bJ:null,bu:null,dk:null,bS:null,fd:null,bW:null,bD:null,dl:null,cY:null,gD:!1,dQ:!1,gI:!1,go:!1,bo:null,ck:null,cf:null,cz:null,fx:null,cI:0,bA:0,gW:!1,bV:0,bI:0,bE:0,fb:!1,cn:!1,gh:!1,eo:!1,hp:!1,jj:!1,bs:null,fh:null,bp:null,gK:!1,cV:!1,fw:null,fv:null,cK:0,cA:null,cZ:0,fC:null,db:null,dJ:null,eq:!1,dA:!1,cv:null,dT:!1,bG:!1,co:null,cw:!1,cu:0,ge:null,dM:!1,eR:!1,cE:!1,dZ:!1,bv:null,dn:null,ce:null,cr:!1,ft:!1,dK:null,dB:null,dN:!1,bT:null,fc:null,cJ:null,bH:null,cF:null,dU:null,dC:null,dD:null,cT:!1,et:null,bz:null,bY:!1,eG:!1,gi:null,cU:null,eb:null,hg:null,dc:!1,bX:!1,ep:null,cL:null,bM:0,ci:1,ea:0,bU:null,eY:!1,bP:null,bO:null,dV:null,cM:null,bB:null,dh:!1,fj:null,dS:null,dR:null,cd:0,cc:0,fy:null,cD:null,dy:null,hh:null,bL:null,fe:null,fD:null,hj:!1,dt:!1,cs:!1,hk:null,er:null,cp:0,bQ:null,ju:null,bw:null,dg:!1,di:null,dp:null,fi:null,gL:!1,cq:function(n){if(this.cp!==n&&this.cl()){this.cp=n;this.eJ("ProgressBarValue");this.eJ("ShowProgressBar");this.cp||this.ec()}return n},cX:!1,lb:function(){return!!this.cp},bF:function(){if(!this.fi){var u=this.cM?this.cM.b:null;if(u)for(var f=u,e=f.length,r=0;r<e;++r){var t=f[r];if(_g.q.toString(t.bH.Type)===_g.q.toString(0)){var i=new _a.P(t.bH.EndPointUrl);var n;this.fi=(n=new _at.b.s,n.e=t.bH.Id,n.a=i,n.b=String.format("{0}://{1}",i.b,i.a),n.d=t.bH.DocumentLibrary,n.c=_g.q.toString(0),n);break}}}return this.fi},hi:function(){_j.e.a(_at.b.a,"Starting attachment upload.");var t=this,n=this;_g.k.a.E("CreateAttachment",this.iu,this.kp(),function(n){_j.e.a(_at.b.a,"Upload attachment enqueued. UploadOnlineOnlyAttachment will be called when we have connection to the server.")},function(t){_j.e.b(_at.b.a,"Enqueueing upload attachment failed: {0}",t.message);n.ct(1,_at.s.a(t),!0);n.em(null)})},lT:function(n){this.dP=n;this.cj();return n},fW:!1,fU:null,fV:!1,ej:null,fZ:null,bj:function(n){this.fZ=n;return n},P:function(n){this.eO("OnUploadCompleteEvent",n)},D:function(n){this.eP("OnUploadCompleteEvent",n)},kb:function(n){this.eO("OnUploadFailedEvent",n)},bd:function(n){this.eP("OnUploadFailedEvent",n)},M:function(n){this.eO("OnDeleteCompleteEvent",n)},bb:function(n){this.eP("OnDeleteCompleteEvent",n)},N:function(n){this.eO("OnDownloadCompleteEvent",n)},bc:function(n){this.eP("OnDownloadCompleteEvent",n)},L:function(n){this.eO("OnCancelCompleteEvent",n)},lL:function(n){this.eP("OnCancelCompleteEvent",n)},O:function(n){this.eO("OnSetSharingSettings",n)},C:function(n){this.eP("OnSetSharingSettings",n)},ds:function(n){if(n!==this.fy){this.fy=n;this.eQ(["ThumbnailInfo","IsThumbnailImage","ShowDefaultImage","IsSuiteExtensionIconSupported"])}return n},dq:function(n){if(this.cI!==n){this.cI=n;this.eQ(["ShouldShowArrangeLabel","ArrangeStatus","ArrangeLabel","ShouldAttachmentInfoBeHidden","ShouldShowCompletedStatusIcon","ShouldShowFailedStatusIcon","ShouldShowActivityIndicatorInline"]);this.cG()}return n},gz:function(){return!!this.iE()},cg:function(n){if(this.bA!==n){this.bA=n;this.eQ(["ShouldShowSaveToCloudLabel","SaveFileToCloudStatus","SaveToCloudLabel","ShouldShowSaveToCloudCompletedClickableLabel","SaveToCloudCompletedClickableLabel","ShouldAttachmentInfoBeHidden","ShouldAffordanceMenuBeHidden","ShouldShowContextMenuOnClick","IsViewHovered","ShouldShowCompletedStatusIcon","ShouldShowFailedStatusIcon","ShouldShowActivityIndicatorInline"])}return n},hb:function(n){if(this.bV!==n){this.bV=n;this.eQ(["ShouldShowAddToCalendarLabel","AddToCalendarLabel","ShouldAttachmentInfoBeHidden","ShouldAffordanceMenuBeHidden","ShouldShowContextMenuOnClick","IsViewHovered","ShouldShowCompletedStatusIcon","ShouldShowFailedStatusIcon","ShouldShowActivityIndicatorInline"])}return n},kW:function(){return this.cn&&!!this.bA&&this.bA!==1&&!this.iT()},iT:function(){return this.dg&&this.bA===3},kP:function(){return this.bV===2||this.bV===1},kL:function(){if(!this.bq()||!this.b())return"";switch(this.n()){case 3:return _nbs.a.lQ;case 4:return _nbs.a.ws;case 6:return this.b().e(this.bp.e());case 5:return this.b().f(this.bp.e());case 1:return this.b().w();case 2:return this.b().i();case 0:return _nbs.a.Rn;default:return""}},iE:function(){switch(this.cI){case 2:return String.format(_nbs.a.WA,this.bp.e(),this.dx.b);case 3:return String.format(_nbs.a.Il,this.dx.b);case 4:return String.format(_nbs.a.sW,this.dx.b);default:return null}},iN:function(){switch(this.bA){case 1:return _j.h.a(this.bC)?String.format(_nbs.a.ud,this.bp.e()):_nbs.a.GT;case 2:return _j.h.a(this.bC)?String.format(_nbs.a.Jm,this.bp.e(),this.bp.i()):String.format(_nbs.a.od,this.bp.i());case 3:return String.format(_nbs.a.iZ,this.bp.i());case 4:return String.format(_nbs.a.Ye,this.bp.i());case 5:return _nbs.a.GQ;default:return null}},kM:function(){return String.format(_nbs.a.wQ,this.bp.e())},kw:function(){if(this.bV===2)return _nbs.a.EK;else if(this.bV===1)return _nbs.a.NI;return null},kO:function(){return this.bA===2||this.cI===2||this.bV===1||this.dG()},iR:function(){if(this.cl())return!1;var n=!1;(this.cE||this.bo&&!this.bo.bH.AttachmentId)&&(n=!0);if(n!==this.dZ){this.dZ=n;this.ec()}return this.dZ},dG:function(){return this.bI===2||this.bI===4||this.bE===2||this.bE===4},gx:function(){return this.gD&&!this.by},kI:function(){return this.gx()&&this.bp.C()===3},kH:function(){return this.gx()&&this.bp.C()===4},lK:function(n){this.eY=n;this.cj()},cl:function(){var n=new XMLHttpRequest;if(_at.o.b()&&this.br)return _dg.b.isInstanceOfType(this.bo)?this.br.a().ci().Enabled:this.br.a().hY().Enabled;else{_j.e.a(_at.b.a,"AttachmentViewModel.IsProgressBarEnabled: Unable to find Progress support in XHR");return!1}},iC:function(){var t=this;var r=function(){return t.bP.a(t.bo.bH.AttachmentId,t.bK,_g.C.a(),t.bC,!0)};if(_dg.e.isInstanceOfType(this.bo)){var n=_a.bc.a(this.bo.bH.Name).toLowerCase();if(this.bo.bH.IsSmimeDecoded)this.bw=new _at.bo;else if(this.eU())this.bw=new _at.bU;else if(this.bs.b)this.bw=new _at.bZ;else if(this.br.a().bW().Enabled&&SuiteExtensions.ControlFactory.CreateControl(n,1)){var i=!!SuiteExtensions.ControlFactory.CreateControl(n,0);this.bw=new _at.bX(i)}else this.bw=this.cb()?new _at.bW:this.dO()?new _at.bV:_at.b.d.g(n)?new _at.bT:_at.b.g.g(n)?new _at.bY:_at.b.f.g(n)?new _at.bp:new _at.bo}else _dg.b.isInstanceOfType(this.bo)?this.bw=null:(_dg.j.isInstanceOfType(this.bo)||_g.B.isInstanceOfType(this.bo))&&(this.bw=new _at.bp);this.bw&&this.bw.o(this.bu,this.bJ.a(),this.br,this.bK,this.by,r,this.bp)},fA:function(n){this.cE=n;this.cE||this.fn(!1);this.eN("ShouldShowActivityIndicator","IsViewHovered")},jF:function(){this.eQ(["ShouldShowFailedStatusIcon","ShouldShowActivityIndicatorInline","ShouldAffordanceMenuBeHidden","ShouldShowContextMenuOnClick","ShouldAttachmentInfoBeHidden","ShowDeleteButton","ShowCancelButton","IsConvertAttachmentInProgress"]);this.cG();this.iC()},p:function(n){if(this.bI!==n){this.bI=n;this.hn();this.eN("ShouldShowConvertLocalToRefAttachmentLabel","ConvertLocalToRefAttachmentLabel");this.jF()}return n},i:function(n){if(this.bE!==n){this.bE=n;this.bE===2&&this.dq(1);this.eV("ShouldShowConvertRefToLocalAttachmentLabel","ConvertRefToLocalAttachmentLabel","ShouldShowArrangeLabel");this.jF()}return n},iH:function(){if(this.bI){if(this.bI===3)return String.format(_nbs.a.Ye,this.bp.i());else if(this.bI===2)return String.format(_nbs.a.EQ,this.bp.e(),this.bp.i());else if(this.bI===4)return _nbs.a.Gg}else return null;return String.format(_nbs.a.bM,this.bp.e())},iI:function(){if(this.bE){if(this.bE===3)return _u.n.Jo;else if(this.bE===2)return _u.n.SY;else if(this.bE===4)return _nbs.a.Gg}else return null;return _u.n.NW},kT:function(){return this.eA()&&!!this.bI&&this.bI!==1},kU:function(){return this.eB()&&!!this.bE&&this.bE!==1},eA:function(){return!!this.bp&&!this.bp.f()&&!_dg.b.isInstanceOfType(this.bo)&&this.bt()!==4&&!this.bo.a()&&this.bp.B()&&!this.bp.c()&&!_j.h.a(this.bp.e())&&!!this.bB.e&&this.bB.e.ReferenceAttachmentsEnabled&&!this.ez()},eB:function(){return!!this.bp&&!!this.bB.e&&this.bB.e.ClassicAttachmentsEnabled&&!this.bp.f()&&_dg.b.isInstanceOfType(this.bo)&&!this.bo.k()&&this.bt()!==4&&this.bp.B()&&!this.bp.c()&&!_j.h.a(this.bp.e())&&!this.lm()&&!this.ez()&&!this.K()&&!!this.b()},bm:function(){this.dC=_a.b.b(_a.a.c,"ConvertLocalAttachmentToReferenceAttachment",!1,null);this.dC.r=new _a.bx(103,2,!0)},bn:function(){this.dD=_a.b.b(_a.a.c,"ConvertRefToLocalAttachment",!1,null);this.dD.r=new _a.bx(104,2,!0)},S:function(){_a.b.a(this.dC);this.dC=null},T:function(){_a.b.a(this.dD);this.dD=null},x:function(n,t){if(!this.bQ){_j.e.b(_a.a.c,"Cannot add sharing link. The handler is null.");return}this.bQ.c(n,t)},iw:function(n,t){if(!this.bQ){_j.e.b(_a.a.c,"Cannot add sharing capability. The handler is null.");return}this.bQ.d(n,t)},h:function(n){if(!this.bQ){_j.e.b(_a.a.c,"Cannot get sharing link. The handler is null.");return null}return this.bQ.f(n,this.bq().bH.ProviderType)},t:function(n){if(!this.bQ){_j.e.b(_a.a.c,"Cannot get sharing capability. The handler is null.");return!1}return this.bQ.e(n)},kJ:function(){this.cn&&this.bA&&this.bA!==1?this.dh=!0:this.iR()&&(this.dh=!0);return this.dh},fn:function(n){if(n!==this.dh){this.dh=n;this.eJ("IsViewHovered")}return n},be:function(n){this.cJ=n;return n},bt:function(){this.cK||(this.cK=this.eC());return this.cK},a:function(){return this.bo},gZ:function(n){var t=this.bo;if(t!==n){t&&t.F(this.fM);this.bo=n;var i=!n;if(!i){n.J(this.fM);_j.e.a(_a.a.c,"Attachment: {0}",n.bH.Name)}this.iX(i?null:n.bH.AttachmentId);this.eQ(["Attachment","ReferenceAttachment","ReferenceAttachmentUrlHostName","ShowReferenceAttachmentsColorTreatment","ShowRegularAttachmentsColorTreatment"]);this.cG();this.ec();this.eN("ShouldShowActivityIndicator","IsViewHovered")}return n},n:function(){return this.bq()?this.bq().s():0},q:function(n){this.bq()&&this.bq().s()!==n&&this.bq().G(n);this.cG();this.cj();return n},gv:function(){return this.bq()?this.bq().I():0},y:function(){return this.bq()?this.bq().bH.AttachLongPathName:null},E:function(n){this.bq()&&this.bq().bH.AttachLongPathName!==n&&this.bq().A(n);return n},V:function(){return this.dA},lN:function(n){this.dA=n;this.dA&&(this.eq=!0);return n},fY:!1,bq:function(){return _dg.b.isInstanceOfType(this.bo)?this.bo:null},kx:function(){var n=null;if(this.bq())n=this.iM();else{var t=new _b.Z;n=t.a(this.bo.b(),null)}return String.format("{0} {1}",this.bo.bH.Name,n)},iM:function(){if(this.bq()&&!_j.h.b(this.bL)){var t=new RegExp("^https?\\:\\/\\/([\\w\\.-]+)(?:\\:[0-9]{1,4})?.*$");var n=t.exec(this.bL);return n&&n.length>1?n[1].toLowerCase():this.bL}return""},b:function(){return this.bq()&&!_j.h.a(this.bq().bH.ProviderType)?this.bO.g(this.bq().bH.ProviderType):null},fX:null,r:function(){return this.fX},bx:function(){return this.bo&&this.bo.bH.AttachmentId?this.bo.bH.AttachmentId.Id:null},u:function(n){if(this.dz!==n){this.dz=n;this.eJ("ShouldAttachmentInfoBeHidden");this.eJ("ShouldSentByBeHidden");this.eJ("ShouldReferenceAttachmentUrlBeHidden")}return n},cQ:function(){if(!this.bq())return!1;if(this.bq().bH.ProviderType===_g.q.toString(5))return!!this.bq().bH.ContentType&&_db.m.f.g(this.bq().bH.ContentType.toLowerCase());else{var n=_a.bc.a(this.bq().bH.Name);return _j.h.a(n)?!1:_db.m.d.g(n.toLowerCase())}},cb:function(){return this.bt()===1||this.bt()===2||this.cQ()},kE:function(){return this.cQ()&&this.bu.c()},dW:function(n){this.gK=n;this.eJ("IsSelected");return n},iJ:function(){if(this.bw)return this.bw.c()===6;if(this.bs.b||!this.br||!this.br.a().bW().Enabled)return!1;if(this.bo&&!(this.dS!=null)){var n=_a.bc.a(this.bo.bH.Name).replace(".","");this.dS=!!SuiteExtensions.ControlFactory.CreateControl(n,1)}return this.dS!=null?this.dS:!1},gs:function(){if(this.bw)return this.bw.k();if(this.bs.b||this.B()||!this.br||!this.br.a().bW().Enabled)return!1;if(this.bo&&!(this.dR!=null)){var n=_a.bc.a(this.bo.bH.Name).replace(".","");this.dR=!!SuiteExtensions.ControlFactory.CreateControl(n,0)}return this.dR!=null?this.dR:!1},kC:function(){return this.b()?this.b().j():!1},dr:function(n){if(this.ck!==n){this.ck=n;_j.e.a(_at.b.a,"Attachment document preview URL: {0}",this.ck);this.eJ("DocumentPreviewUrl")}return n},dX:function(n){if(this.cf!==n){this.cf=n;_j.e.a(_at.b.a,"Attachment preview URL: {0}",this.cf);this.eJ("PreviewUrl")}return n},ha:function(n){if(this.cz!==n){this.cz=n;_j.e.a(_at.b.a,"Attachment download URL: {0}",this.cz);this.eJ("DownloadUrl")}return n},kK:function(){var n=this.bP.a(this.bo.bH.AttachmentId,this.bK,_g.C.l(),this.bC,!0);_j.e.a(_at.b.a,"Pdf Print URL: {0}",n);return n},bk:function(n){if(this.fb!==n){this.fb=n;this.eJ("IsTriggeredPolicyTip")}return n},fl:function(n){this.gh=n;this.eN("CanDelete","ShowDeleteButton");return n},ek:!1,G:function(n){this.ek=n;return n},bf:function(n){this.eo=n;this.eN("AttachmentWellPendingRefresh","ShowDeleteButton");return n},la:function(){return(this.gh||this.eo)&&!this.dG()&&!!this.bp&&!!this.bp.b()},kY:function(){return this.bI===2&&this.bI!==4||this.bE===2&&this.bE!==4},he:function(n){this.by||this.ey()||this.fl(!n);this.hp=n;this.eJ("UploadInProgress");return n},fp:function(n){this.jj=n;this.eJ("OpenDocumentInBrowserLinkVisible");return n},jA:function(n){this.bs=n;this.cK=this.eC();this.dY();return n},ba:function(){return this.bp},lV:function(n){if(n!==this.bp){this.bp&&this.bp.rpcl("ParentItemId",this.fR);this.bp=n;if(this.bp){this.li();this.bp.apcl("ParentItemId",this.fR)}this.eJ("ParentWell")}return n},c:function(){return this.cV},fq:function(n){if(this.cV!==n){this.cV=n;this.bp&&this.bp.bZ(this);this.eJ("ShouldBeHidden")}return n},hd:function(n){if(this.dT!==n){this.dT=n;this.eJ("PendingNonHtml5Upload")}return n},gw:function(){this.gz()&&(this.cr=!0);this.cn&&this.bA&&this.bA!==1&&(this.cr=!0);this.eA()&&this.bI&&this.bI!==1&&(this.cr=!0);this.eB()&&this.bE&&this.bE!==1&&(this.cr=!0);this.bV&&(this.cr=!0);return this.cr},lX:function(n){if(this.cr!==n){this.cr=n;this.eJ("ShouldAttachmentInfoBeHidden")}return n},gy:function(){return!this.kF()||!this.bo.z||!this.by||this.dz!=="CalendarItem_PeekForm"},iQ:function(){return!0},kV:function(){return this.bI===3||this.bE===3||this.bA===4||this.bV===3||this.cI===4},kR:function(){return this.bA===3&&!this.gW||this.bV===2||this.cI===3},iO:function(){return this.bV===1||this.cn&&this.bA===2||(this.eA()||this.eB())&&this.dG()||this.cE||!this.bo||!this.bo.bH.AttachmentId||!this.ca()||!this.ca().p.x.length},lW:function(n){if(this.bL!==n){this.bL=n;this.eJ("ReferenceAttachmentOpenUrl")}return n},cC:function(){return!1},iL:function(){return!1},jB:function(n){if(this.ft!==n){this.ft=n;this.eJ("ShowPermissionsTextInCompose")}return n},jv:function(n){if(this.bv!==n){this.bv=n;this.eJ("FileExtension")}return n},lZ:function(n){this.fw=n;this.eJ("SubmitUploadFormCommand");return n},lY:function(n){this.fv=n;this.eJ("SubmitUploadAndShareFormCommand");return n},o:function(){this.fx||(this.fx=_at.b.t());return this.fx},Z:function(){return this.bZ},z:function(){return this.ev},lR:function(n){this.cA=n;_j.e.b(_at.b.a,"Attachment form upload error: {0}",this.cA);this.eJ("FormUploadError");return n},lQ:function(n){this.cZ=n;_j.e.b(_at.b.a,"Attachment form upload error code: {0}",this.cZ);this.eJ("FormUploadAttachmentError");return n},jC:function(n){this.fC=n;this.eJ("UploadSuccessResponse");return n},gu:function(){return!1},m:function(){return this.bG},s:function(){return this.co},U:function(){return this.cu},j:function(){return this.ce},g:function(n){this.ce=n;return n},gr:function(){var n;n=this.eI?this.gB(_at.b.e,this.bo.bH.AttachmentId,_g.C.a()):this.gB(_at.b.e,this.bo.bH.AttachmentId,_g.C.f());_j.e.a(_at.b.a,"Image preview URL: {0}",n);return n},iK:function(){return this.bq()&&this.bL?this.bL:null},Y:function(){var n=this.bP.a(this.bo.bH.AttachmentId,this.bK,_g.C.a(),this.bC,!0);_j.e.a(_at.b.a,"Image preview URL: {0}",n);return n},gt:function(){var n=this.bP.a(this.bo.bH.AttachmentId,this.bK,_g.C.a(),this.bC,!0);_j.e.a(_at.b.a,"Media URL: {0}",n);return n},cP:function(){return this.gB(_at.b.h,this.bo.bH.AttachmentId,_g.C.d())},ma:function(n){if(this.dt!==n&&this.B()){this.dt=n;this.eN("ThumbnailLoadSucceeded","ShouldShowThumbnailPlaceholder")}return n},kX:function(){return this.B()&&!this.dt},B:function(){var n=this.cQ()&&!this.eH()&&!!this.b()&&(!_j.h.a(this.bq().bH.AttachmentThumbnailUrl)||this.b().n());return this.cQ()&&this.bq().bH.ProviderType===_g.q.toString(0)&&this.bp.s()?!1:n||this.iV()?this.bs.a===3:!1},kZ:function(){return!this.B()&&!this.gs()},kB:function(){if(this.dK)return this.dK;var n;n=this.bw?this.bw.a()===1:_a.g.b&&this.bt()===5?!1:this.cN()?this.bt()===5||!this.cm()&&(!this.bK||this.bK&&this.bt()!==3):this.bt()===5||this.bJ.a()==="Mouse"&&this.bt()!==3;_j.e.a(_at.b.a,"IconLinkViewModel preview = {0}",n);this.dK=_at.M.c(this,n);return this.dK},ca:function(){if(!this.dB){var n=new Array(0);this.dB=new _fm.e(n)}return this.dB},lO:function(n){this.dB=n;this.eJ("ContextMenu");return n},W:function(){return this.bS},jy:function(n){if(this.dN!==n){this.dN=n;this.du()}return n},A:function(){return this.dM},jx:function(n){if(this.dM!==n){this.dM=n;this.eJ("IsDeleted")}return n},kA:function(){if(this.bq())if(_j.h.b(this.bL)){if(this.bq().bH.AttachLongPathName)return this.bo.bH.Name+"\n \n"+this.bq().bH.AttachLongPathName}else return this.bo.bH.Name+"\n \n"+this.bL;return this.bo.bH.Name},lS:function(n){this.bX!==n&&(this.bX=n);return n},hc:function(n){if(this.dc!==n){this.dc=n;this.eJ("IsCancelling")}return n},gq:function(){_a.c.d(this.bt()===5,"Invalid Operation: EmbeddedItemClass should only be invoked when the Attachment is an ItemAttachment");return this.bo.y()},X:function(){return this.bT},bg:function(n){this.bT=n;return n},kD:function(){return!!this.br&&!!this.bB&&!!this.bB.e&&this.br.a().be().Enabled&&this.bB.e.AttachmentDataProviderAvailable},cN:function(){return this.bq()&&!this.b()?!1:this.bs.a===2?!1:this.bu.e()?!1:this.cR()?!1:this.bw?this.bw.b():this.kE()?!1:this.df(!this.dd)&&!this.gG()?!1:this.jd()||this.gJ()||this.je()||this.dO()||this.iJ()||this.bt()===1||this.bt()===2||this.bt()===7||this.bt()===10||this.bt()===8||this.bt()===12||this.lj()},cm:function(){return this.bu.e()||!this.by&&this.bJ.a()==="TouchWide"||!!this.br&&this.br.a().ir().Enabled},l:function(){return this.cT},v:function(n){this.cT=n;n&&this.fp(!1);return n},jz:function(n){if(this.bY!==n){this.bY=n;this.eQ(["IsOpenedInLightBox","ShowReferenceAttachmentsColorTreatment","ShowRegularAttachmentsColorTreatment"])}return n},lc:function(){return!this.bY&&!0},kF:function(){return!!this.br&&this.br.a().eQ().Enabled},ez:function(){_j.e.a(_a.a.a,"AttachementName={4}, IsComposedInLightBox={5}, ParentWellIsNULL={0}, isOpenedInLightBox = {1}, this.parentWell.IsReadOnly={2}, WacEdit={3}",!this.bp,this.bY,this.bp.f(),this.bs.e,this.bo?this.bo.bH.Name:"null",this.bY&&!this.bp.f()&&this.bs.e);return this.bp?this.bY&&!this.bp.f()&&this.bs.e&&this.eG:!1},jw:function(n){if(this.eG!==n){this.eG=n;this.eJ("IsComposedInLightBox");this.ez()?this.fl(!1):this.fl(!this.by);this.bp.f()||this.cj()}return n},bN:function(){!this.ep&&this.ey()&&(this.ep=(+new Date).toString());return this.ep},mb:function(n){if(this.fD!==n){this.fD=n;this.eJ("WacStaticAssetsPreloadUrl")}return n},kS:function(){return this.dH()&&!this.iO()},f:function(){return this.cd},bi:function(n){this.cd=n;return n},e:function(){return this.cc},bh:function(n){this.cc=n;return n},jD:function(n){if(this.dg&&!_j.h.a(n)){this.bo.H(n);this.cj()}},ey:function(){var n=!!this.br&&this.br.a().jK().Enabled;return!n||this.bu.c()||this.bu.t()?!1:!this.bp.c()||!!this.dj&&this.dj.a(this.bp.c(),"AttachmentUploadCancellation")},cB:function(){var n=!!this.bo.bH.AttachmentId;var i=n?this.bo.bH.AttachmentId.Id:null;var t=i?_bc.g.b(i):!1;var r=this.bs.c();_j.e.a(_at.b.a,"UpdateUrl: idExists={0}, isClientId={1}, policyInfo: {2}",n,t,this.bs.toString());return n&&r&&!t&&!this.bo.n()},iF:function(){this.fh||(this.fh=_at.k.h().b(this.bv,this.bo.bH.ContentType,!0,this.cR(),!!this.bq(),this.de,this.cX));var n=!!this.bo.bH.AttachmentId;var i=n?this.bo.bH.AttachmentId.Id:null;var t=i?_bc.g.b(i):!1;var r=this.fh.c();_j.e.a(_at.b.a,"CanDownloadForPublicComputer: idExists={0}, isClientId={1}, policyInfo: {2}",n,t,this.bs.toString());return n&&r&&!t&&!this.bo.n()},da:function(){return!this.bp.d()||this.bp.d().i()!==1},dH:function(){return this.bs.a===2&&this.bJ.a()==="Mouse"},kz:function(){return!_dg.b.isInstanceOfType(this.bo)&&!_j.h.a(this.bo.bH.AttachmentOriginalUrl)},iG:function(){return this.bq()?this.b()?this.b().b(this.cS()):[7]:_at.b.i},iV:function(){return!_a.g.b&&!!this.br&&this.br.a().dC().Enabled&&this.kG()&&!this.bo.a()&&!this.bq()&&(this.bo.b()<10485760||this.br.a().lZ().Enabled)},kG:function(){return this.cb()||this.by&&this.ln()&&this.br.a().it().Enabled},kN:function(){return!!this.br&&this.br.a().dC().Enabled&&!!this.dV&&!this.dL},iU:function(){return!!this.br&&this.br.a().dC().Enabled&&this.dL&&!_a.g.b&&!this.bq()},li:function(){this.bS=this.bp.bc();this.lU(this.kj());this.du();this.cG();if(!!this.bp){this.ev=new _j.g(this.hM,_at.b.a);this.gR=new _j.g(this.ib,_at.b.a);this.gS=new _j.g(this.hL,_at.b.a)}this.cj();this.jn();_at.b.b.b().e(this.eD())},lU:function(n){this.cn=this.bp.cm(n);this.bo.a()&&!this.bq()?this.bA=6:this.cn&&!_j.h.a(this.bo.bH.AttachmentOriginalUrl)&&(this.bA=3);return n},ky:function(){_j.e.a(_at.b.a,"Attachment class: {0}",this.cK);var n;switch(this.bt()){case 0:case 11:case 9:n=!0;break;case 5:_j.e.a(_at.b.a,"Embedded item class: {0}",this.gq());switch(this.gq()){case 6:case 3:case 1:case 2:case 5:case 7:n=!0;break;default:n=!1;break}break;default:n=!1;break}_j.e.a(_at.b.a,"Can open: {0}",n);return n},kQ:function(){return this.bp.s()&&this.bq()&&this.bq().k()?!1:!!this.b()&&Array.contains(this.b().b(this.cS()),0)&&this.kD()&&!!this.bq()&&!this.by},gA:function(){return this.bw?this.bw.d():this.bt()===4?!1:this.bt()===6&&!this.dO()?!1:this.cb()&&!this.bs.d?!1:this.b()?this.cb()&&this.eH()?!1:Array.contains(this.iG(),8)?this.df(!this.dd)&&!this.gG()?!1:!0:!1:!0},iS:function(){return this.bs.d?this.bt()===4?!1:!this.bq()||!!this.b()&&Array.contains(this.b().b(this.cS()),4)&&!this.bq().k()&&!this.K():!1},iP:function(){if(this.dP||this.df(!this.dd)&&!this.gG())return!0;var n=!!this.b()&&(this.b().o()||!this.bO.b.c(this.bq().bH.ProviderType));!n&&this.cO()&&(n=!this.bo.bH.ContentType||!this.cO().g(this.bo.bH.ContentType));return n},cO:function(){return this.b()?this.b().x(this.bu):null},K:function(){return this.de?!!this.bq()&&!this.bq().k()&&_j.h.a(this.bv)&&(_j.h.b(this.bq().bH.ContentType)||this.bq().bH.ContentType==="application/onenote"||this.bq().bH.ContentType==="image/png"):!!this.bq()&&!this.bq().k()&&_j.h.a(this.bv)&&(!this.cO()||!this.cO().g(this.bo.bH.ContentType))},el:null,dx:null,cR:function(){return!!this.bo&&(this.bo.bH.IsSmimeDecoded||this.bo.n())},du:function(){this.bp?this.fq(this.dN||this.bo.a()&&this.bp.bP()&&!_dg.b.isInstanceOfType(this.bo)):this.fq(this.dN||this.bo.a());this.fq(this.cV||this.bo.p)},lm:function(){return this.bo&&!_j.h.a(this.bo.bH.Name)?this.bo.bH.Name.endsWith(".one")||this.bo.bH.Name.endsWith(".onepkg"):!1},lx:function(){_j.e.a(_at.b.a,"File selected.");this.jy(!1);this.bp&&this.bp.cd(this)},js:function(){if(this.cn){_j.e.a(_at.b.a,"Saving attachment with Id:{0} to Cloud.",this.bx());this.dU=_a.b.b(_a.a.c,"SaveSingleAttachmentToCloud",!1,null);this.dU.r=new _a.bx(102,2,!0);this.cg(2);_db.m.b(this.dl,this.o(),this.fT,"AttachmentViewModel",String.format("NotificationHandler is NULL for AttachmentID:{0}",this.cv));var n=new _at.bc(this.bx(),null,this.o(),this.bC,null);n.c(this.ig);n.b(this.ie);this.bD.a(n);var t=_y.bT.isInstanceOfType(this.bp)?"ConversationAttachmentWellContextMenu.SaveToCloud":"AttachmentContextMenu.SaveToCloud";_a.b.c(_a.a.c,t,this.dI(),0)}},mH:function(){_j.e.a(_at.b.a,"submitting upload to server");this.bG=!1;this.co=null;if(_dg.e.isInstanceOfType(this.bo)){var n=this.bo;this.ho(n)}else(_g.B.isInstanceOfType(this.bo)||_dg.j.isInstanceOfType(this.bo)||_dg.b.isInstanceOfType(this.bo))&&this.hi()},ml:function(){_j.e.a(_at.b.a,"submitting delete to server");this.bG=!1;this.co=null;if(!this.bp.b()){this.ch(_nbs.a.KV);this.jc(null,"ParentItemId is null");return}var n=new _at.bL(2,this.bo,this.bp.b());n.b(this.hO);n.a(this.hN);_a.g.a.a(n)},le:function(){var i=this.bo;var r=i.c;var n=this.gp.a();var t=this;n.f(function(){if(n.b())_j.e.b(_at.b.a,"HTML5 file reader attach failed with error code {0}",n.b());else{var r=n.c().indexOf(",");var i=n.c().substring(r+1,n.c().length);t.bT=n.c().substring(0,r).indexOf("base64")!==-1?i:_a.bf.a(i);t.eT("OnUploadCompleteEvent",t)}});try{n.e(r)}catch(u){this.bu.f()&&u.name==="NS_ERROR_FILE_ACCESS_DENIED"?_j.e.a(_at.b.a,"Firefox: failed to read an attachment. Exception: {0}",u.message):_j.e.d(_at.b.a,u,"Unexpected exception was thrown by FileReader.ReadAsDataURL.")}},lJ:function(){this.bT=null;this.eT("OnDeleteCompleteEvent",this);if(this.bz){this.bz.m=this.eu(1);_a.b.a(this.bz);this.bz=null}},mo:function(){this.cF=_a.b.b(_a.a.c,"AttachmentUploadQueue",!1,null)},fz:function(n){if(this.cF){this.cF.n=n;this.cF.m=this.gm(!1);_a.b.a(this.cF);this.cF=null}},mp:function(){this.fz("");this.hl();if(this.cJ){this.bH=_a.b.b(_a.a.c,this.cJ,!1,null);this.bH.r=new _a.bx(100,2,!0);this.bH.r.e(1,this.cJ)}},hl:function(){if(this.bH){var n="";this.bG&&(n=this.ge);var t=n.match(new RegExp("[a-zA-Z]+Exception"));if(t&&t.length>0){this.bH.n=t[0];this.bH.p=n}else if(this.cu){this.bH.n=_y.bn.toString(this.cu);this.bH.p=n}else this.bH.n=n;this.bH.m=this.gm(!0);_a.b.a(this.bH);var r=this.bH.s.l&1024?+new Date:this.bH.s.i;var i=new _at.ca(this.bH.e(),r-this.bH.s.k,n,this.bv,this.bo.b());_a.A.b.a(i);this.bH=null}},R:function(){_j.e.a(_at.b.a,"Getting attachment content from server");this.bG=!1;this.co=null;var n=new _at.bN(_at.b.a,this.bo,this.bC,this.br,this.bP);var i=this;n.a(function(){i.eT("OnDownloadCompleteEvent",i);i.fp(!1)});var t=this;n.b(function(){_j.e.b(_at.b.a,"Download failed with error: {0}",n.G.message);t.bG=!0;t.co=n.O();t.cT||t.es(n)});_a.g.a.a(n)},ku:function(n,t){n&&this.dF(3)},eD:function(){if(this.bp&&this.bp.d()&&this.bp.d().a()&&_g.x.isInstanceOfType(this.bp.d().a())&&this.bo&&!_j.h.a(this.bo.bH.Name)){var n=this.bp.d().a().n();if(!_j.h.a(n))return _at.i.h(n+this.bo.bH.Name)}var t=this.bx();return t?_at.i.h(this.bx()):null},mh:function(n){var i=n.a();if(_g.B.isInstanceOfType(i)&&!i.bH.AttachmentId)this.di=i;else{var t=new _g.B;t.C(i.bH.AttachmentId.Id);t.e(i.bH.Name);t.h(!1);t.A(n.b());_dg.j.isInstanceOfType(i)?t.k(!0):_dg.e.isInstanceOfType(i)?t.k(!1):_g.B.isInstanceOfType(i)&&t.k(i.bH.IsAttachmentItemAttachment);t.J(this.hT);this.di=t}},dO:function(){return this.bt()===6&&!!this.bv&&_at.b.l.g(this.bv.toLowerCase())},eF:function(n){if(this.di){_j.e.a(_at.b.a,"Uploading id attachment.");this.jI(this.di)}else if(_g.B.isInstanceOfType(this.bo)||_dg.j.isInstanceOfType(this.bo)){_j.e.a(_at.b.a,"Uploading item or id attachment.");this.jI(this.bo)}else if(_dg.e.isInstanceOfType(this.bo)){var t=this.bo;if(this.bT){_j.e.a(_at.b.a,"Uploading file attachment with pasted image from clipboard.");this.fk(this.bT)}else if(t.bH.Content){_j.e.a(_at.b.a,"Uploading file attachment with content.");this.fk(null)}else if(t.a()&&_a.cH.isInstanceOfType(this.bo.c)&&_at.e.isInstanceOfType(this)){_j.e.a(_at.b.a,"Uploading inline PAL image with content.");this.jK()}else if(this.bu.r()){_j.e.a(_at.b.a,"Uploading HTML5 file attachment.");this.bU=t.c;this.jH()}else{_j.e.a(_at.b.a,"Uploading Non-HTML5 file attachment.");this.hq()}}else if(_dg.b.isInstanceOfType(this.bo)){this.eR=!0;if(this.bu.r()){_j.e.a(_at.b.a,"Uploading HTML5 reference attachment.");var i=this.bo;this.bU=i.c;this.jH()}else{_j.e.a(_at.b.a,"Uploading Non-HTML5 reference attachment.");this.hq()}}else{_j.e.c(_at.b.a,"Unsupported upload type.");n(null)}},eX:function(){if(this.dE){this.cM.rpcl("LastRetrievedAttachmentDataProviders",this.fP);this.dE=!1}_a.gd.prototype.eX.call(this)},eC:function(){if(this.bw)return this.bs.a===1?4:this.bw.j();var n=0;if(_dg.e.isInstanceOfType(this.bo))if(this.bs.a===1)n=4;else if(this.eU())n=this.ld();else if(this.bs.b)n=3;else{var e,f;if(f=_db.m.e(this.bo,e={val:n}),n=e.val,!f){var s,o,i,t;if((o=_at.b.o(this.bo,s={val:n}),n=s.val,!o)&&(t=_at.b.p(this.bo,i={val:n}),n=i.val,!t)){var u,r;(r=_at.b.n(this.bo,u={val:n}),n=u.val,r)||(n=6)}}}else n=_dg.j.isInstanceOfType(this.bo)?5:_g.B.isInstanceOfType(this.bo)?11:4;return n},ld:function(){if(this.bB.l()){if(this.gJ())return 10;else if(this.dQ)return 12;else if(this.bs.b)return 3}else return 4;return 6},cW:function(){if(!this.bP){_j.e.c(_a.a.c,"DownloadAuthenticator is NULL.");return}if(this.cB()||this.bo.a()){this.dX(this.bP.a(this.bo.bH.AttachmentId,this.bK,null,this.bC,!1));this.ha(this.bP.a(this.bo.bH.AttachmentId,this.bK,null,this.bC,!0))}else this.dX(null);if(this.iF()&&this.cB()){this.dr(this.bP.a(this.bo.bH.AttachmentId,this.bK,null,this.bC,!1));this.ix()&&this.dr(this.ck+"&isDocumentPreview=True")}else this.dr(null)},es:function(n){this.ct(1,_at.s.c(n),!0)},iA:function(n){this.bM<this.ci-1&&!this.bX&&this.jJ()},ct:function(n,t,i){this.bG=!0;this.co=t;this.fA(!1);if(this.bX)_j.e.a(_at.b.a,"Attachment create failed callback after cancellation with cancellationId:{0} error: {1}, {2}",this.bN(),n,t);else{_j.e.b(_at.b.a,"Attachment create failed with cancellationId: {0} error: {1}, {2}",this.bN(),n,t);this.cu=n;this.ge=t;if(this.bp&&this.bp.t(this.bS)){this.bp.o(this,!1);this.ek&&this.bp.K()}}this.eT("OnUploadFailedEvent",this)},cy:function(n){if(_at.o.isInstanceOfType(n)){var t=n;if(t.r<t.m-1)return}this.cq(100);var i=this;_j.m.a().a(_at.b.a,"CreateAttachmentActionCompleted",function(){i.cq(0)},500);this.em(n)},fB:function(){this.hd(!this.by&&this.bu.t()&&!this.bo.bH.AttachmentId&&!_g.B.isInstanceOfType(this.bo))},mF:function(n){this.bo.e(n);this.en(this.bo,"Name");this.eJ("Attachment")},en:function(n,t){if(t==="Thumbnail"){this.dY();return}t==="ProviderType"&&this.eQ(["PermissionsTextInCompose","ReferenceAttachmentUrlHostName","DataProviderInfo"]);if(t==="ContentType"||t==="Name"||t==="AttachmentId"||t==="ProviderType"||t==="AttachLongPathName"){t==="Name"&&this.jv(_a.bc.a(this.bo.bH.Name));if(t==="ContentType"||t==="Name"){this.jA(_at.k.b().b(this.bv,this.bo.bH.ContentType,!0,this.cR(),!!this.bq(),this.de,this.cX));this.du()}if(t==="AttachmentId"){this.iX(this.bo.bH.AttachmentId);this.fB();this.ec();this.dY()}this.eH()&&(!_j.h.a(this.bo.bH.ContentType)&&t===this.bo.bH.ContentType||this.bq()&&!_j.h.a(this.bq().bH.AttachLongPathName)&&t===this.bq().bH.AttachLongPathName)&&this.jf();this.cW();this.cj()}},lo:function(n,t){t==="AttachmentId"&&this.bo.g(this.di.bH.AttachmentId)},fk:function(n){var f=this.bo;if(n){f.k(n);if(this.bM===this.ci-1&&this.bo.a()){var i=0;var t=0;var u,r;_at.j.c(this.bo.bH.ContentType,n,u={val:i},r={val:t}),i=u.val,t=r.val;this.cd=i;this.cc=t;this.ce=this.bp.E(this.bo.bH.Name,this.cd,this.cc)}}this.jt(f,!1)},gY:function(n){var t=this.bo;if(n){t.c=n;t.k("")}this.jt(t,!0)},hq:function(){this.fw.a()},iB:function(){_j.h.a(this.cA)||this.ct(this.cZ,this.cA,!1);this.em(null)},ch:function(n){this.cY.a(_a.u,new _a.u([n],1,null,0,!1,_nbs.a.S,null,null,this.cU,null,null,null))},ho:function(n){this.hi()},jK:function(){_j.e.a(_at.b.a,"Submitting action for PAL attachment upload.");var n=new _at.bK(2,this.bo,this.bp.b(),this.bN(),this.bp.c(),this.da());n.b(this.eh);n.a(this.eg);_a.g.a.a(n)},gn:function(n){_j.e.a(_at.b.a,"Not a PAL file attachment.")},ff:function(n,t){this.gC(n,t)},gQ:function(n,t){this.cv=t;this.jn();_at.b.b.b().e(this.eD());_j.e.a(_at.b.a,"Attachment ID: {0}",this.cv?this.cv.Id:"null")},cS:function(){return this.by?this.gv():this.n()},gC:function(n,t){_j.e.b(_at.b.a,"Opening attachment with URL {0}",n);this.bW&&this.bp&&this.bp.b()&&this.bW.c(this.bp.b(),"Downloaded",this.bv,!!this.bq());if(this.bu.c())if(this.dk.b(this.dk.d())&&this.dk.d().b().a()){_j.e.a(_at.b.a,"Launch URL from nativeBridge");this.dk.d().a(n)}else{_j.e.a(_at.b.a,"Creating an anchor element to download file as OpenInTarget doesn't work in PAL");var r=document.createElement("a");r.href=n;var i=document.createEvent("MouseEvent");i.initMouseEvent("click",!1,!1,window.self,0,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,0,null);r.dispatchEvent(i)}else t?this.dw.a(n,"_self"):this.dw.a(n,"_blank")},cj:function(){for(var n=new _fm.e(new Array(0)),i=this.iG(),t=0;t<i.length;t++){switch(i[t]){case 0:this.mr(n);break;case 13:this.mq(n);break;case 1:this.ms(n);break;case 2:this.mt(n);break;case 3:this.mu(n);break;case 4:this.mv(n);break;case 5:this.mw(n);break;case 6:this.eY||this.mx(n);break;case 7:this.mA(n);break;case 8:this.mC(n);break;case 9:this.mD(n);break;case 10:this.mE(n);break;case 11:this.mz(n);break;case 12:this.mB(n);break}this.ec()}this.br&&this.br.a().bQ().Enabled&&n.K(this.er);this.lO(n)},mq:function(n){var t=!!this.bp.c();if(!this.by&&!this.dL&&!this.bp.s()&&!t&&this.br&&this.br.a().ch().Enabled)if(this.bF())this.bF().a&&this.bq()&&(this.bq().bH.AttachLongPathName&&this.bq().bH.AttachLongPathName.startsWith(this.bF().a.toString())||this.bq().bH.AttachmentOriginalUrl&&this.bq().bH.AttachmentOriginalUrl.startsWith(this.bF().a.toString())||this.bq().bH.ProviderEndpointUrl&&this.bq().bH.ProviderEndpointUrl.startsWith(this.bF().a.toString()))&&n.p.a(new _fm.c(_nbs.a.po,null,this.gc));else if(!this.dE){this.dE=!0;this.cM.apcl("LastRetrievedAttachmentDataProviders",this.fP)}},lw:function(n,t){this.cj()},kc:function(n){!this.bu.c()&&this.iS()&&n.p.a(new _fm.c(_nbs.a.Ka,null,this.ew))},lG:function(n){this.bu.c()?n.p.a(new _fm.c(_nbs.a.XH,null,this.ew)):this.bq()&&n.p.a(new _fm.c(_nbs.a.VP,null,this.gV))},lH:function(){this.bp.bm(this);_a.b.c(_a.a.c,"AttachmentContextMenu.ManagePermission")},jt:function(n,t){_j.e.a(_at.b.a,"Submitting server action for file attachment with content.");var r=null;if(this.cl()){r=this.ei;this.bM||this.cq(10)}var i=new _at.o(2,n,this.bp.b(),this.bN(),this.bp.c(),this.da(),r,t,this.bM,this.ci,null);i.b(this.eh);i.c(this.fN);i.a(this.eg);_a.g.a.a(i)},ja:function(n){var r=65;if(this.bU){var i=this.bU.b();var t=this.bM*14680064;var e=this.bM<this.ci-1?14680064:i-t;var f=e*n/100;var u=(t+f)*r/i;n===100&&this.bM===this.ci-1?this.mj():this.cq(10+u)}else this.cq(10+r*n/100)},mj:function(){var n=this;var t=_j.m.a().e(_at.b.a,"HandleUploadProgress.ShowFakeProgress",function(){n.cp>0&&n.cp<95&&n.cq(n.cp+1)},500);var i=this;_j.m.a().a(_at.b.a,"HandleUploadProgress.CancelFakeProgressTask",function(){_j.m.a().b(t)},1e4)},bl:function(n){this.fj=n;return n},kq:function(){if(!this.by&&!this.iY(0)){_j.e.a(_at.b.a,"Deleting attachment.");this.bz=_a.b.b(_a.a.c,"AttachmentDeleteAttachment",!1,null);this.jx(!0);var n="";var i=!!this.bo.bH.AttachmentId&&!!this.bo.bH.AttachmentId.Id&&!this.bo.bH.AttachmentId.Id.startsWith("smime-")&&!this.cE;if(i){_j.e.a(_at.b.a,"Deleting attachment from server.");this.bp.o(this,!1);this.bp.ci(this)}else if(this.hp)if(this.ey())this.gf();else{_j.e.c(_at.b.a,"Somehow a user was able to try to delete an attachment in the process of being uploaded.");this.bz.n=n="DeleteInProcess"}else{if(_dg.e.isInstanceOfType(this.bo)){var t=this.bo;this.gn(t)}else _j.e.a(_at.b.a,"Not a file attachment.");this.bp.o(this,!0);n="DeletedWhileInQueue"}this.cF&&this.fz(n)}},gf:function(){if(!this.dc){_j.e.a(_at.b.a,"Cancel attachment with cancellationId {0}",this.bN());this.cw=!1;this.hc(!0);var n=new _at.bC(this.bN());n.c(this.hD);n.b(this.hC);_a.g.a.a(n)}},mI:function(n,t,i){this.he(!0);if(this.dM){_j.e.a(_at.b.a,"Attachment skipped because it's been deleted while it was pending.",this.bo.bH.Name);t(null);return}var u=n;var r=u.Body.ParentItemId;this.bp.b().Id=r.Id;this.bp.b().ChangeKey=r.ChangeKey;this.dn=t;this.eF(t)},jH:function(){this.et=this.gp.a();this.cl()&&this.cq(3);if(this.bu.r()&&this.bN()){this.bM=-1;this.ea=_dg.b.isInstanceOfType(this.bo)?10485760:14680064;this.ci=Math.ceil(this.bU.b()/this.ea);_dg.b.isInstanceOfType(this.bo)||this.fA(!0);this.jJ()}else this.cl()&&!this.bo.a()?this.gY(this.bU):this.jL(this.bU)},jJ:function(){if(!this.bp||!this.bp.l()){_j.e.a(_at.b.a,"The attachment upload seems to have been stopped. Aborting further uploads.");return}var n=this.bU;this.bM++;var i=this.ea*this.bM;var r=Math.min(i+this.ea,n.c.size);var t=n.c.slice(i,r,n.c.type);this.cl()&&!this.bo.a()?this.gY(t):this.jL(new _db.bD(t))},jL:function(n){var t=this;this.et.a(n,function(n,i,r,u){t.fk(n)},this.hQ,_at.b.a,!1)},kv:function(){this.ct(2,_at.s.f(this.et),!1);this.em(null)},jI:function(n){_j.e.a(_at.b.a,"Submitting action for item or id attachment.");var i=null;if(this.cl()){i=this.ei;this.cq(10)}var t=new _at.o(2,n,this.bp.b(),this.bN(),this.bp.c(),this.da(),this.ei,!1,0,1,this.bp.q());t.b(this.eh);t.a(this.eg);_a.g.a.a(t)},kp:function(){var t=this.bp.b();var n=new _g.e(t.Id);n.ChangeKey=t.ChangeKey;var i=new _gg.dJ(n);return new _gg.dI(null,i)},em:function(n){var h=this.bG?_y.bn.toString(this.cu):"";_j.e.a(_at.b.a,"Attachment create completed. Status: {0} CancellationId: {1}",h,this.bN());this.fA(!1);if(!this.bX){if(this.dn){n&&_at.o.isInstanceOfType(n)&&this.jC(n.bk());this.dn(this.fC)}this.he(!1);this.fp(!this.bG&&this.bs.b);if(_dg.j.isInstanceOfType(this.bo)){this.bp.o(this,!1);this.gZ(n.k);this.cW();this.bp.Y(this)}if(this.mi()){_j.e.a(_at.b.a,"Incrementing parent well size.");(!n||this.bp.t(this.bS))&&this.bp.cb(this.bo.b());this.hn()}if(_dg.b.isInstanceOfType(this.bo)){var o=this.bq().c;if(_y.B.isInstanceOfType(o)){var r=o;this.fX=r.c();!_j.h.a(r.j())&&this.cQ()&&this.ds(new _at.E(r.j(),null,200,150,!0))}if(n){var t=null;var i=null;if(_at.bb.isInstanceOfType(n)){i=n.N;var s,u;(u=this.jE(i,s={val:t}),t=s.val,u)&&this.bo.j(t.Attachments[0].ContentType)}else if(_at.o.isInstanceOfType(n)){i=n.N.Body;var f,e;if(e=this.jE(i,f={val:t}),t=f.val,e){this.mg(this.bo,t.Attachments[0]);this.eE(i.SharingInformation)}}}}this.cj()}this.eT("OnUploadCompleteEvent",this)},eE:function(n){if(this.br&&this.br.a().fs().Enabled&&this.bq()&&this.bq().bH.ProviderType&&!_j.h.a(this.bq().bH.AttachLongPathName)){if(n){_j.e.a(_a.a.c,"We already possess the sharing information of the file for the user, so do not dispatch another Action.");this.jG(n);return}if(this.b().m())this.mm();else if(this.b().d()){this.iw(4,!0);this.iw(3,!0)}}},mm:function(){if(!this.db&&(this.gL||!_db.m.a(this.n()))){this.dJ=_a.b.b(_a.a.c,"AttachmentsGetSharingInfoAction",!1,null);this.dJ.r=new _a.bx(101,2,!0);this.db=new _db.N(this.bq().bH.AttachLongPathName);this.db.c(this.hS);this.db.b(this.hR);this.bD.a(this.db)}},lg:function(n){_j.e.a(_a.a.c,"GetSharingInfoAction succeeded for attachment id {0}.",this.bx());_a.b.a(this.dJ);if(_db.N.isInstanceOfType(n)){var t=n;this.jG(t.f)}},jG:function(n){if(this.bp&&this.bp.a()&&this.bp.a().w(this)&&!_j.h.a(this.bx())){if(!n){this.fY=!0;_a.b.c(_a.a.c,"Failed to retreive sharing info for reference attachment");return}if(!n.CanShareInternally){this.lN(!0);this.n()&&!_db.m.a(this.n())&&this.br&&this.br.a().fw().Enabled&&this.me()}n.CanShareExternally||(this.eq=!0);this.bp&&this.bp.V(!0);if(this.bQ){this.bQ.g(n);this.eS("OnSetSharingSettings")}}},lf:function(n){_a.b.a(this.dJ);_j.e.a(_a.a.c,"GetSharingInfoAction failed for attachment Id: {0}",this.bx())},me:function(){var i=[this.bo.bH.AttachmentId.Id];var t=[this.bo.bH.AttachLongPathName];var n=new _at.R(i,0,t,!1);this.bD.a(n);this.q(0)},mi:function(){if(this.bG||this.bX)return!1;if(this.bu.t()||_g.B.isInstanceOfType(this.bo)||_dg.b.isInstanceOfType(this.bo))return!0;if(_dg.e.isInstanceOfType(this.bo)){var n=this.bo.c;if(_y.cT.isInstanceOfType(n))return!0;if(_y.B.isInstanceOfType(n))return n.m()}return!1},iz:function(n){_j.e.a(_at.b.a,"Cancel attachment succeeded with cancellationId {0}",this.bN());this.he(!1);this.bp&&this.bp.t(this.bS)&&this.bp.o(this,!1);this.iy(n)},kf:function(n){_j.e.b(_at.b.a,"cancel failed with error: {0} and cancellationId: {1}",n&&n.G?n.G.message:"N/A",this.bN());this.cw=!0;this.iy(n)},iy:function(n){this.dn&&this.dn(null);this.hc(!1);this.lS(!this.cw);this.bX&&this.cE&&this.fA(!1);this.eT("OnCancelCompleteEvent",this);if(this.bz){this.bz.n=this.cw&&n?n.O():null;this.bz.m=this.eu(2);this.bz.o=n?n.P():null;_a.b.a(this.bz);this.bz=null}},ks:function(n){this.jc(n,n.O())},jc:function(n,t){_j.e.b(_at.b.a,"delete failed with error: {0}",t);this.bG=!0;this.co=t;this.jx(!1);this.bp.t(this.bS)&&!this.cT&&this.bp.Y(this);if(this.bz){this.bz.n=t;this.bz.m=this.eu(1);this.bz.o=n?n.P():null;_a.b.a(this.bz);this.bz=null}},kr:function(n){this.eT("OnDeleteCompleteEvent",this);if(this.bz){this.bz.m=this.eu(1);this.bz.o=n?n.P():null;_a.b.a(this.bz);this.bz=null}},mf:function(){_y.cs.a=this.bJ.a()==="Mouse"&&this.bJ.b()&&!this.cC();this.bW&&this.bp&&this.bp.b()&&this.bW.c(this.bp.b(),"Downloaded",this.bv,!!this.bq())},ke:function(){var t=new _at.br(this.bD,"Mouse",this.br,this.bO,this.cY,null,this.cM,!1);var n=new _at.X(t,this.br,this.bD);n.w(!0,this.fe,this.cU,this.hU,this.gm(!0))},lq:function(n){this.dx=n;this.dq(2);_at.f.x(this.bF().b,_db.m.a(this.bq().s()),this.bF().a,this.bF().d,this.bq().bH.AttachLongPathName,n.Id,this.id,this.ic)},lz:function(n){this.dq(4)},lA:function(n){if(this.n()===2||this.n()===1){var t=new _at.R([this.bx()],this.n(),[n],!1);t.c(this.ir);t.b(this.iq);this.bD.a(t)}else this.dq(3)},md:function(n){var t=n;this.E(t.j.NewAttachLongPathNames[0]);this.dq(3)},mc:function(n){this.dq(4)},lD:function(){if((this.by||this.bo.bH.AttachmentId)&&this.bt()!==4&&!this.iY(1)){if(_db.m.a(this.cS())&&!this.dP&&this.ca().p&&this.ca().p.x.length>0){var n=this.ca().p.x[0];n.j.a();return}if(this.gA()&&this.cN()&&!this.cm()&&!this.iP())this.jo();else if((_dg.j.isInstanceOfType(this.bo)||_g.B.isInstanceOfType(this.bo)||this.bt()===9)&&this.bJ.a()!=="TouchNarrow")this.jk();else if(this.bq()&&(this.iP()||this.bq().k()||this.K()))this.jm();else if(this.dH())return;else this.bs.c()?this.dF(2):this.ca().p.x.length>0&&this.ca().p.x[0].j.a()}},iY:function(n){if(this.eo&&this.fj){_j.e.a(_at.b.a,"AttachmentWellPendingRefresh was true, so triggering refresh of the attachment well with operation: "+n);this.bf(!1);this.fj(this.bo,n);return!0}return!1},dF:function(n){_y.cs.a=this.bJ.a()==="Mouse"&&this.bJ.b()&&!this.cC();var t=this.by&&!this.bq();if(this.bo.bH.AttachmentId){_a.g.b&&_j.e.a(_at.b.a,"GenericMailMode, always download the attachment.");this.jr(this.cz,4,t)}this.lp(n)},dI:function(){var n=new _a.l;n.a("T",this.bv);if(this.bq()){n.b("R",1);n.a("DP",this.bq().bH.ProviderType)}else n.b("R",0);n.a("HH",this.eD());return n.toString()},lp:function(n){var t="";switch(n){case 2:t=_y.bT.isInstanceOfType(this.bp)?"ConversationAttachmentWell.Download":"AttachmentView.Download";break;case 0:t=_y.bT.isInstanceOfType(this.bp)?"ConversationAttachmentWellContextMenu.Download":"AttachmentContextMenu.Download";break;case 4:t="AttachmentHubListItemContextMenu.Download";break;case 1:t="AttachmentWellBarButton.Download";break;case 3:t="AttachmentPreview.Download";break;default:_j.e.c(_at.b.a,"Unhandled AttachmentDownloadSource:{0}",n);return}_a.b.c(_a.a.c,t,this.dI(),0)},jk:function(){if(!this.ky()){_j.e.a(_at.b.a,"Unsupported item.");this.ch(_nbs.a.CX);return}this.bW&&this.bp&&this.bp.b()&&this.bW.c(this.bp.b(),"Downloaded",this.bv,!!this.bq());if(this.bo.n()){var n=this;this.iD(function(t){t.a();n.jl()})}else this.jl()},kd:function(){this.dy=_a.b.b(_at.b.a,"AddIcsToCalendarFromDropDownMenu",!0,null);if(this.cD)this.jb();else{var n=this;this.gd.a(function(t){n.cD=t.a();n.jb()})}_a.b.c(_a.a.c,"AttachmentContextMenu.ImportIcsAttachment")},jb:function(){this.cD.e(this.bo.bH.Name);this.cD.a(this.bo.bH.AttachmentId.Id);this.cD.b(this.fQ);this.hb(1);this.cD.c()},ly:function(n){if(_j.h.a(n)){this.hb(2);_a.b.a(this.dy)}else{this.hb(3);this.dy.p=n;_a.b.a(this.dy)}this.cD.d(this.fQ)},jl:function(){var n={};n.AttachmentItemID=this.bo.bH.AttachmentId.Id;this.bK&&(n.IsDiscovery="1");_j.e.a(_at.b.a,"Opening item attachment in pop-out window.");this.bJ.r(_y.gv,null,n,_bc.d.a())},jr:function(n,t,i){this.mG();this.bo?this.bo.bH.AttachmentId?_j.e.a(_at.b.a,"SafeOpenAttachment: Name={0}, ID={1}",this.bo.bH.Name,this.bo.bH.AttachmentId.Id):_j.e.b(_at.b.a,"SafeOpenAttachment: AttachmentId is null"):_j.e.b(_at.b.a,"SafeOpenAttachment: Attachment is null");_j.e.a(_at.b.a,"SafeOpenAttachment: Policy={0}",this.bs.toString());if(this.bs.f&&t!==7){_j.e.a(_at.b.a,"Attachment policy forces browser viewing.");this.bJ.a()==="Mouse"?this.ch(_nbs.a.am):this.ch(_nbs.a.nl);return}if(!this.bs.d){this.ch(_nbs.a.Uh);return}if(this.bs.a===1){this.ch(_nbs.a.YC);return}if(this.cR()){var r=this;this.iD(function(n){r.bW&&r.bp&&r.bp.b()&&r.bW.c(r.bp.b(),"Downloaded",r.bv,!!r.bq());n.c()});return}if(this.bs.a===2&&this.bJ.a()!=="Mouse"){this.mk();return}this.bo&&this.cB()&&!_j.h.a(n)&&this.ff(n,i)},mk:function(){_j.e.a(_at.b.a,"Attachment policy forces save, but device doesn't support download.");this.ch(_nbs.a.He)},jo:function(){this.jq(!1);var t=_y.bT.isInstanceOfType(this.bp)?"ConversationAttachmentWell.Preview":"Attachment.Preview";var n=new _a.l;n.a("AttachmentLocation",this.dz);n.a("IsRelatedToCalendarEvent",this.bo.z.toString());_a.b.c(_a.a.c,t,n.toString(),0)},kt:function(){this.jq(!0);_a.b.c(_a.a.c,"AttachmentPreview.Edit")},jq:function(n){if(this.bo){if(!this.bp||!this.bp.b()){_j.e.a(_at.b.a,"this.parentWell.ParentItemId is null - compose form is not upgraded.");this.ch(_nbs.a.Um);return}this.bW&&this.bW.c(this.bp.b(),"Previewed",this.bv,!!this.bq());if(this.lk(this.bo.bH.Name)&&this.bo.b()>10485760){this.cY.a(_a.u,new _a.u([_nbs.a.nM],1,this.fO,1,!1,_nbs.a.Ka,_nbs.a.o,_nbs.a.NL,this.cU,null,null,null));return}if(this.cK===8&&this.bo.b()>1048576){this.cY.a(_a.u,new _a.u([_nbs.a.Oj],1,this.fO,1,!1,_nbs.a.Ka,_nbs.a.o,_nbs.a.NL,this.cU,null,null,null));return}this.lI(n)}},lI:function(n){if(this.fd)if(this.fc)this.jp(n);else{var t=this;this.fd.a(function(i){t.fc=i;t.jp(n)})}},jp:function(n){if(!this.eZ){var t=this.bp.d();var r=!0;t&&(r=!!t.a()&&t.a().fv());var i=this.fc.a(this.cU,this.fe,this.gi,this.bC,this.bK,r,!1,null,!1,null,!1);i.e(this,n);if(t){t.d()&&t.d().c(this.bx())&&t.n(t.d().b[this.bx()].bH.ItemId);i.b(t.b(),t.e(),t.j()||this.bp.b(),!1,!1,null)}i.a(r)}},lC:function(n){_j.e.a(_at.b.a,"Save to cloud action succeeded with Id:{0}.",this.bx());if(this.dg){if(this.bA===2){var i=this,t=this;this.dp=new _at.bw(this.bD,this.bx(),null,n.f,this.bC,0,function(n){i.iZ(n[0])},function(){t.jg(null)});this.dp.n()}}else{this.cg(3);this.hm()}},jg:function(n){_j.e.a(_at.b.a,"Failed to save attachment with Id:{0} to Cloud.",this.bx());this.cg(4);this.hm()},lM:function(n){var t=n;if(!t){_j.e.b(_a.a.c,String.format("Received NULL payload while saving attachment: {0} to cloud",this.bx()));return}this.iZ(t)},iZ:function(n){if(n.ResultCode===23)return;else if(n.ResultCode){_j.e.b(_a.a.c,String.format("Saving attachmentID: {0} failed with ResultCode: {1}. Exception: {2}",this.bx(),n.ResultCode,n.Exception));this.cg(4)}else{this.cg(3);this.jD(n.Item.Location);this.dg&&this.bp.cv(!1)}if(this.dp){this.dp.c();this.dp=null}this.hm()},hm:function(){_a.b.a(this.dU);this.dU=null;_db.m.c(this.dl,this.o(),this.fT)},kl:function(){if(this.bp){this.cL=(_a.d.a().h()+_ff.p.a(0,1e6)).toString();this.bp.bH(this,this.cL)}_a.b.c(_a.a.c,"AttachmentContextMenu.ConvertLocalToRef")},Q:function(){if(this.bp&&this.bo&&this.bq()&&!_j.h.a(this.bq().bH.AttachLongPathName)){this.cL=(_a.d.a().h()+_ff.p.a(0,1e6)).toString();this.bp.bI(this,this.bq().bH.AttachLongPathName,this.cL)}_a.b.c(_a.a.c,"AttachmentContextMenu.ConvertRefToLocal")},kg:function(){this.bq()?this.ki():this.kh()},kh:function(){if(this.bx()){_j.e.a(_a.a.c,"Canceling convert local to reference attachment. Attachment Id: {0}.",this.bx());var n=new _at.bD(this.cL);n.c(this.hX);n.b(this.hW);this.bD.a(n);this.p(4);this.eJ("ShowCancelButton")}},lt:function(n){_j.e.a(_a.a.c,"Cancel convert local to reference action succeeded for attachment id {0}.",this.bx())},ls:function(n){_j.e.a(_a.a.c,"Cancel convert local to reference action failed for attachment id {0}.",this.bx())},lB:function(n,t){this.eJ("ShowDeleteButton")},ki:function(){if(this.bx()){_j.e.a(_at.b.a,"Canceling convert reference to local attachment. Attachment Id:{0}.",this.bx());var n=new _at.bE(this.cL);n.c(this.ia);n.b(this.hZ);this.bD.a(n);this.i(4);this.eJ("ShowCancelButton")}},lv:function(n){_j.e.a(_a.a.c,"Cancel convert reference to local action succeeded for attachment id {0}.",this.bx())},lu:function(n){_j.e.a(_a.a.c,"Cancel convert reference to local action failed for attachment id {0}.",this.bx())},ko:function(){window.clipboardData?window.clipboardData.setData("Text",this.bL):prompt(_nbs.a.DH,this.bL);var n=_y.bT.isInstanceOfType(this.bp)?"ConversationAttachmentWellContextMenu.CopyLinkToClipboard":"AttachmentContextMenu.CopyLinkToClipboard";_a.b.c(_a.a.c,n)},mN:function(){var n=null;_dg.b.isInstanceOfType(this.bo)?n=_at.i.k(this.bL):this.bO&&this.bO.a()&&(n=this.bO.a().T(this.bo.bH.AttachmentOriginalUrl));if(_j.h.a(n)){_j.e.b(_a.a.c,"In order to view in provider, path name must be valid.");return}this.gC(n,!1);_a.b.c(_a.a.c,"AttachmentContextMenu.ViewInProvider",this.dI(),0)},lE:function(n){n.d();n.c();var t=this.bo.bH.AttachmentOriginalUrl;var i=this.bo.bH.AttachmentOriginalUrl.indexOf("?");i===-1&&(t+="?web=1");this.gC(t,!1)},lF:function(){if(this.bq()&&!_j.h.a(this.bq().bH.AttachLongPathName)&&this.bv in this.b().a()){var n=this.b().a()[this.bv].c(this.y());this.ff(n,!1);_a.b.c(_a.a.c,"AttachmentWell.OpenInClient",this.dI(),0)}},iX:function(n){var t=this.cv;t!==n&&this.gQ(t,n)},hn:function(){this.lX(this.dT||!!this.bo&&!this.bo.b())},cG:function(){if(this.bq())if(!this.bo.bH.AttachmentId||this.bI===3||this.bE===3||this.dG()||this.gz())this.jB(!1);else{this.jB(!0);this.eJ("PermissionsTextInCompose")}},mG:function(){if(!this.cR()&&this.gu()){var n=_g.k.a.q(this.bo.bH.AttachmentId);this.bo.bH.AttachmentId.Id!==n.Id&&this.bo.g(n)}},gm:function(n){var t=new _a.l;if(this.bq()){var i=this.bq().y?this.bq().y:this.bq().c?this.bq().c.b():0;t.b("S",i);t.b("D",this.iW())}else t.b("S",this.bo.b());t.b("W",this.bp.c()?1:0);t.b("C",this.bX?1:0);t.a("E",this.bv);if(n){_j.h.a(this.ej)||t.a("DP",this.ej);t.c("H",this.fW);t.a("P",this.fU);t.c("O",this.fV);this.bq()&&t.b("SL",this.cS())}return t.toString()},eu:function(n){var t=new _a.l;t.b("S",this.bo.b());var i="A";this.bq()?i="C":this.bt()===5?i="T":this.bo.a()&&(i="I");t.a("T",i);t.b("O",n);t.b("W",this.bp.c()?1:0);this.cJ&&t.a("Q",this.cJ);t.a("E",this.bv);this.bq()&&t.b("DP",this.iW());return t.toString()},iW:function(){var n=-1;try{n=_j.u.b(_g.q,this.bq().bH.ProviderType)}catch(t){}return n},ec:function(){this.eN("ShouldAffordanceMenuBeHidden","ShouldShowContextMenuOnClick")},iD:function(n){if(this.cR()){_j.e.a(_a.a.k,"[AttachmentViewModel] Creating Smime command factory.");var t=this;this.hg.a(function(i){if(!t.eb){_j.e.a(_a.a.k,"[AttachmentViewModel] Creating smimeAttachmentViewModelCommand instance.");t.eb=i.d();t.eb.b(t.bo)}_j.e.a(_a.a.k,"[AttachmentViewModel] Executing smime operation.");n(t.eb)})}},kj:function(){var t=!!this.bp.d()&&this.bp.d().b()===2;var n=this.bB.k(this.bv,this.bo.bH.ContentType);return this.bB.e.SaveAttachmentsToCloudEnabled&&n!==1&&!this.bp.s()&&this.bp.B()&&!_dg.b.isInstanceOfType(this.bo)&&!this.bo.a()&&this.bp.f()&&(!_j.h.a(this.bp.e())||t)},dY:function(){if(this.bo&&!this.dt){if(this.cQ()){_j.h.a(this.bo.bH.AttachmentThumbnailUrl)||this.ds(new _at.E(this.bo.bH.AttachmentThumbnailUrl,null,200,150,!0));return}if(this.iV()){if(!this.bo.bH.AttachmentId)return;if(!this.kN()){this.ds(new _at.E(this.cP(),null,0,0,!1));return}this.mM()}}},mM:function(){var e=this.bo.bH.AttachmentId.Id;var s=_a.d.a();var f=this.dV.a(e);if(!_j.h.a(f)){this.ds(new _at.E(f,null,0,0,!1));return}var r=document.createElement("canvas");var o=r.getContext("2d");var n=new Image;var u="image/jpeg";this.bv&&_at.b.m.g(this.bv.toLowerCase())&&(u="image/png");n.crossOrigin="Anonymous";var t=this;n.onload=function(){if(t&&!t.eZ){var f=n.width,s=n.height;r.width=f;r.height=s;var i=null;try{if(f>0&&s>0){o.drawImage(n,0,0,f,s);i=r.toDataURL(u,.5)}}catch(c){_j.e.b(_at.b.a,"Failed to get thumbnail via canvas error={0}",c.message)}t.bo&&t.ds(new _at.E(i?i:t.cP(),null,f,s,!1));if(i)try{t.dV.b(e,i)}catch(h){_j.e.b(_at.b.a,"Failed to save thumbnailinfo into session storage, error={0}",h.message)}}};var i=this;n.onerror=function(){i&&!i.eZ&&i.bo&&i.ds(new _at.E(i.cP(),null,0,0,!1))};n.src=this.cP()},jf:function(){if(this.bq()&&!_j.h.a(this.bq().bH.AttachLongPathName)&&!_j.h.a(this.bo.bH.ContentType)&&(this.cb()||this.bo.bH.ContentType==="application/pdf")){var t=this.bo.bH.ContentType==="application/pdf"?!1:!0;var i=_at.u.f(this.bq().bH.AttachLongPathName);if(!_j.h.a(i)){var n=this;_at.u.e(i,t,function(i){if(t){n.bq().C(i+"2");n.bq().D(i);n.dY()}else{i=i.substring(0,i.length-8);n.dX(i+"open")}},null)}}},jn:function(){if(this.cv&&this.bs&&this.jd()&&!_dg.j.isInstanceOfType(this.bo)&&this.gA()){if(this.bu&&this.bu.d()&&this.bu.d().a()!==1&&this.bo&&this.bo.bH.Name&&!_dg.b.isInstanceOfType(this.bo)&&this.bB&&this.bB.e&&this.bB.e.WacPreloadMappings&&this.bB.e.WacPreloadMappings.length>0){if(!_at.b.c){_at.b.c={};for(var t=0;t<this.bB.e.WacPreloadMappings.length;t++)_at.b.c[this.bB.e.WacPreloadMappings[t][0]]=this.bB.e.WacPreloadMappings[t][1]}var i=_a.bc.a(this.bo.bH.Name);if(i in _at.b.c){var s=_at.b.c[i];delete _at.b.c[i];this.mb(s)}}var o=this.cv.Id;var f=this;var e=function(n){if(n&&(n.Status===9||n.Status===6)){f.hj=!0;f.cj()}};var u=_at.x.a().c(o);if(u){e(u);return}if(this.bp){if(this.bp.cA())return;var r;(r=this.bp).cw(r.bW()+1)}var n=this;_j.m.a().d(_a.a.c,"AttachmentViewModel.PreloadWacAttachmentInfo",function(){if(n.bp){var t=new _at.bk(o,!1,null,!!n.bq(),n.bp.c(),n.bK,n.bp.q());t.b(function(n){e(t.e)});n.bD.a(t)}})}},gB:function(n,t,i){var r=t.Id+_a.d.bJ(_a.d.a());if(!this.iU()||!n.c(r)){var u=this.bP.a(t,this.bK,i,this.bC,!1);if(!this.iU())return u;n.a(r,u)}return n.b[r]},lh:function(){try{var t=new ActiveXObject("AcroPDF.PDF");return!0}catch(n){return!1}},mL:function(){return this.bu.d().a()===1&&this.lh()},mJ:function(){if(this.bu.d().a()!==2||this.go)return!1;if(!this.dQ)return!0;for(var n=0;n<window.navigator.plugins.length;n++)if(window.navigator.plugins[n].name==="Chrome PDF Viewer")return!0;return!1},lk:function(n){var t=_a.bc.a(n).toLowerCase();switch(t){case".xls":case".xlsx":case".xlsm":case".xlsb":return!0;default:return!1}},lj:function(){return(this.bt()===5||this.bt()===9)&&this.gF&&!this.ll()},jd:function(){return!this.hj&&this.bs.b&&!(this.eU()&&(this.bq()||this.bJ.a()==="TouchNarrow"))&&!(this.bu.c()&&this.bJ.a()==="TouchNarrow")&&!this.cO()},gJ:function(){if(!this.bu||!this.bu.d())return!1;if(this.eU()&&this.bB.l()){if(!(this.iF()&&this.cB())&&!this.bq())return!1;if(this.mJ()||this.bu.d().a()===6||this.mK()||this.mL())return!0}return!1},je:function(){if(!this.bu||!this.bu.d())return!1;if(this.cO())switch(this.bu.d().a()){case 2:case 6:case 4:case 1:return!!this.bo.bH.ContentType&&this.cO().g(this.bo.bH.ContentType);default:return!1}return!1},ix:function(){return this.bu&&this.bu.d()&&(this.bu.d().a()===2||this.bu.d().a()===6||this.bu.d().a()===4||this.bu.d().a()===1)?_at.b.j.g(this.bv.toLowerCase()):!1},eU:function(){return!!this.bo&&_a.bc.a(this.bo.bH.Name).toLowerCase()===".pdf"},ln:function(){if(this.bo){var n=_a.bc.a(this.bo.bH.Name);if(!_j.h.b(n))return _at.b.q.g(n.toLowerCase())}return!1},mK:function(){return this.bu.d().a()===4&&!(this.dQ&&this.gI)},ll:function(){return!!this.bp&&!!this.bp.d()&&!!this.bp.d().a()&&this.bp.d().a().fv()},jm:function(){this.jr(this.bL,7,!1);var n=_y.bT.isInstanceOfType(this.bp)?"ConversationAttachmentWellContextMenu.OpenInNewTab":"AttachmentContextMenu.OpenInNewTab";_a.b.c(_a.a.c,n,this.dI(),0)},lr:function(){var n=new _at.bH(this.bo.bH.AttachmentId,this.bp.b().Id);n.c(this.hJ);n.b(this.hI);this.cd=320;this.cc=220;if(_dg.e.isInstanceOfType(this.bo)&&this.bo.bH.Content){var i,t;_at.j.c(this.bo.bH.ContentType,this.bo.bH.Content,i={val:this.cd},t={val:this.cc}),this.cd=i.val,this.cc=t.val}this.ce=this.bp.E(this.bo.bH.Name,this.cd,this.cc);this.bD.a(n);_a.b.c(_a.a.c,"AttachmentContextMenu.MoveAttachmentToInline")},km:function(n){_j.e.b(_at.b.a,"AttachmentViewModel: ConvertToInlineAttachmentFailed. Deleting placeholder image");this.bp.bL(this.ce,n.O())},kn:function(n){var t=n.f;this.bo.h(!0);this.bo.m(t);this.du();this.bp.cl(this.ce,this.cf,t,this.bo.b(),this.bo.bH.ContentType)},mr:function(n){this.kQ()&&n.p.a(new _fm.c(this.b().c(),null,this.gM))},mt:function(n){if(this.eB()){this.i(1);n.p.a(new _fm.c(this.iI(),null,this.gk))}},ms:function(n){if(this.eA()){this.p(1);n.p.a(new _fm.c(this.iH(),null,this.gj))}},mv:function(n){this.df(!this.dd)||(this.bs.c()&&this.bs.a!==2&&!this.cm()||this.dH()||this.cm())&&this.kc(n)},mA:function(n){(this.bt()!==4&&this.bs.a!==2&&!this.cm()||this.dH()||this.cm())&&this.lG(n)},mC:function(n){(this.bt()===4||this.bs.a===2||this.cm())&&(this.dH()||!this.cm())||this.cN()&&this.gA()&&!this.dP&&n.p.a(new _fm.c(_nbs.a.MZ,null,this.dm))},mD:function(n){if(this.cn&&!this.kz()){this.bA=1;n.p.a(new _fm.c(this.iN(),null,this.gX))}},mE:function(n){if(!this.df(!0))if(this.bq())this.bC?n.p.a(new _fm.c(this.b().l(),null,this.dv)):n.p.a(new _fm.c(this.b().u(),null,this.dv));else if(this.bo&&!_j.h.a(this.bo.bH.AttachmentOriginalUrl)){if(!this.bO||!this.bO.a()){_j.e.b(_a.a.c,"DefaultDataProviderInfo must be available when the attachment has been saved to cloud.");return}this.bC?n.p.a(new _fm.c(this.bO.a().l(),null,this.dv)):n.p.a(new _fm.c(this.bO.a().u(),null,this.dv));return}},mB:function(n){if(!this.df(!0)&&this.bv in this.b().a()&&this.bu.z()){var t=String.format(_nbs.a.px,this.b().a()[this.bv].b);n.p.a(new _fm.c(t,null,this.gU))}},mu:function(n){this.bq()&&n.p.a(new _fm.c(_nbs.a.Ds,null,this.gl))},mw:function(n){this.dO()&&n.p.a(new _fm.c(_nbs.a.Ja,null,this.gb))},mx:function(n){this.bp&&this.bp.f()||!this.cb()||this.cQ()||n.p.a(new _fm.c(_nbs.a.IM,null,this.gP))},mz:function(n){this.cN()&&(_dg.j.isInstanceOfType(this.bo)||this.bt()===9)&&this.bJ.a()!=="TouchNarrow"&&n.p.a(new _fm.c(_u.n.Ly,null,this.fg))},df:function(n){if(!this.bq()||_j.h.a(this.bq().bH.AttachLongPathName))return!1;try{if(n&&_at.i.i(this.bq().bH.AttachLongPathName))return!0;var t=new _a.P(this.bq().bH.AttachLongPathName);if(!_j.h.a(t.f)&&t.f.toLowerCase().indexOf(_at.b.k)>0)return!0}catch(i){}return!1},gG:function(){return this.bq()?this.bq().bH.ProviderType?this.bq().bH.ProviderType!==_g.q.toString(1)?!1:this.cb()?!0:!1:!1:!1},eH:function(){return _dg.b.isInstanceOfType(this.bo)&&!!this.bq()&&this.bq().bH.ProviderType===_g.q.toString(5)},gH:function(){if(!this.bq())return!1;var n=this.bq();if(n.bH.ProviderType)return n.bH.ProviderType===_g.q.toString(1)||n.bH.ProviderType===_g.q.toString(0);if(n.c&&!_y.B.isInstanceOfType(n.c))return!!this.bp&&!this.bp.s();_a.b.c(_a.a.c,"UnknownIfReferenceAttachmentIsODSP");return!1},cx:null,dP:!1,dE:!1,lP:function(n){if(this.cx!==n){this.cx&&this.cx.d(!1);this.cx=n;this.cx&&this.cx.d(!0);this.eJ("ContextMenuSelectedItem")}return n},fs:function(n){if(this.cs!==n){this.cs=n;this.eJ("ShowConversationAttachmentContextMenu")}return n},mn:function(){this.fs(!this.cs);this.cs&&this.ca().n(null)},kk:function(){this.fs(!1)},mg:function(n,t){n.E(t.ProviderType);n.A(t.AttachLongPathName);n.K(t.ProviderEndpointUrl);n.m(t.ContentId);n.D(t.AttachmentThumbnailUrl);n.C(t.AttachmentPreviewUrl);n.Q(t.OriginalPermissionType);n.G(t.PermissionType);this.cG()},jE:function(n,t){if(n&&n.ResponseMessages&&n.ResponseMessages.Items&&n.ResponseMessages.Items.length>0&&n.ResponseMessages.Items[0].ResponseClass!=="Error"){t.val=n.ResponseMessages.Items[0];if(t.val&&t.val.Attachments&&t.val.Attachments.length>0)return!0}_j.e.c(_a.a.c,"An error happened while trying to get a valid response in TryGetValidAttachmentInfoResponseMessage(). Error: {0}, Message: {1}",n.ResponseMessages.Items[0].ResponseCode,n.ResponseMessages.Items[0].MessageText);t.val=null;return!1}};_at.b.s=function(){};_at.b.s.prototype={a:null,d:null,b:null,e:null,c:null};_at.b.b=function(){this.a=new Array(0);this.c=_a.G.a()};_at.b.b.b=function(){_at.b.b.a||(_at.b.b.a=new _at.b.b);return _at.b.b.a};_at.b.b.prototype={a:null,c:null,b:null,e:function(n){if(n&&!this.c.b[n]){this.c.a(n,!0);this.a.push(n);this.g()}},g:function(){this.b&&_j.m.a().b(this.b);var n=this;this.b=_j.m.a().a(_a.a.c,"AttachmentViewModel.AttachmentShownTracker",function(){n.f();n.b=null},3e4)},f:function(){for(var n=new Array(0),t=0;t<this.a.length;t++){n.push(this.a[t]);if(n.length>=20){this.d(n);n=new Array(0)}}this.d(n);this.a=new Array(0)},d:function(n){if(n&&n.length){var t=new _a.l;t.a("HH",n.join("!"));_a.b.c(_a.a.c,"AttachmentShown",t.toString(),0)}}};_at.cb=function(n,t,i,r,u,f,e,o){this.n=_at.b;_a.c.a(n,"owaShell");_a.c.a(t,"palDownloadManager");_a.c.a(o,"attachmentDependencies");_a.c.a(o.f,"userAgent");_a.c.a(o.a,"nativeBridge");_a.c.a(r,"itemStoreGetterFactory");this.c=n;this.i=t;this.b=i;this.g=e;this.a=o;this.h=r;this.j=u;this.f=f};_at.cb.prototype={c:null,a:null,i:null,h:null,b:null,e:null,j:null,g:null,n:null,f:null,k:function(n,t,i,r,u,f,e){n||_j.e.c(_a.a.c,"AttachmentViewModelFactory.Create passing null as attachment");if(this.m()&&(_dg.b.isInstanceOfType(n)||_dg.e.isInstanceOfType(n)&&_y.B.isInstanceOfType(n.c))){if(!this.e&&this.b){var s=this;this.b.a(function(n){s.e=n})}_a.c.b(this.e,"attachmentProviderItemViewModelFactory");return this.e.a(n,this.c,t,i,r,u,f,e)}else if(_dg.e.isInstanceOfType(n)&&_y.cT.isInstanceOfType(n.c)){_a.c.b(this.j,"uriFileAttachmentViewModelFactory");return this.j.a(n,this.c,t,i,r,u,f,e)}else{var o=_at.z.a(this.g,this.a,r);return new _at.e(n,this.c,t,i,r,this.i,this.h,u,f,e,this.f,o,this.a)}},d:function(n,t,i,r,u,f,e,o){n||_j.e.c(_a.a.c,"AttachmentViewModelFactory.CreateAsync passing null as attachment");if(this.m()&&this.b&&(_dg.b.isInstanceOfType(n)||_dg.e.isInstanceOfType(n)&&_y.B.isInstanceOfType(n.c))){var c=this;var l=function(s){var h=s.a(n,c.c,t,i,r,f,e,o);u(h)};this.b.a(l)}else{this.b||_j.e.c(_a.a.c,"attachmentProviderItemViewModelFactoryLazy is null");_dg.b.isInstanceOfType(n)&&_j.e.b(_a.a.c,"We shall not construct PALAttachmentViewModel for ReferenceAttachment.");var s=_at.z.a(this.g,this.a,r);var h=new _at.e(n,this.c,t,i,r,this.i,this.h,f,e,o,this.f,s,this.a);u(h)}},p:function(n,t,i,r,u,f,e,o,s){if(this.b&&_dg.b.isInstanceOfType(t)){var c=this;var h=function(h){var l=h.b(t,c.c,i,r,u,n,e,o,s);f(l)};this.b.a(h)}},o:function(n,t,i,r,u,f,e,o){if(!n){u(null);return}if(!n.length){u(new Array(0));return}this.l(n,0,new Array(0),t,i,r,u,f,e,o)},l:function(n,t,i,r,u,f,e,o,s,h){var c=this;this.d(n[t],r,u,f,function(l){Array.add(i,l);t<n.length-1?c.l(n,t+1,i,r,u,f,e,o,s,h):e(i)},o,s,h)},m:function(){return this.a.c?this.a.c.a().be().Enabled:!1}};_at.Y=function(n){this.a=n};_at.Y.prototype={a:null};_at.N=function(n,t){_at.N.initializeBase(this,[n,t])};_at.N.b=function(){return _fm.d.a("box48.png")};_at.N.prototype={E:function(){return _at.N.b()},B:function(){return!1},o:function(){return!0},u:function(){return""},l:function(){return""},w:function(){return _nbs.a.lQ},i:function(){return""},D:function(){return""},C:function(){return _nbs.a.co},k:function(){return""},h:function(){return""},t:function(){return""},v:function(){return""},c:function(){return""},g:function(n,t,i,r){return t},b:function(n){return _at.N.a}};_at.bq=function(n,t){_at.bq.initializeBase(this,[n,t])};_at.bq.a=function(){return _fm.d.a("facebook48.png")};_at.bq.prototype={E:function(){return _at.bq.a()},o:function(){return!1},b:function(n){return null},g:function(n,t,i,r){return null},B:function(){return!0},M:function(){return!0},u:function(){return""},l:function(){return""},w:function(){return""},i:function(){return""},D:function(){return""},C:function(){return""},k:function(){return""},h:function(){return""},t:function(){return""},v:function(){return""},c:function(){return""}};_at.O=function(n,t){_at.O.initializeBase(this,[n,t])};_at.O.b=function(){return _fm.d.a("dropbox48.png")};_at.O.prototype={E:function(){return _at.O.b()},B:function(){return!1},o:function(){return!0},u:function(){return""},l:function(){return""},w:function(){return _nbs.a.lQ},i:function(){return""},D:function(){return""},C:function(){return _nbs.a.co},k:function(){return""},h:function(){return""},t:function(){return""},v:function(){return""},c:function(){return""},g:function(n,t,i,r){var f=t.lastIndexOf("?");var u=t.substring(0,f);return u+"?dl=1"},b:function(n){return _at.O.a}};_at.A=function(n,t){_at.A.initializeBase(this,[n,t]);this.V()};_at.A.e=function(){return _fm.d.a("gdrive48.png")};_at.A.prototype={H:null,E:function(){return _at.A.e()},B:function(){return!0},p:function(){return!1},r:function(){return!1},q:function(){return!0},o:function(){return!1},j:function(){return!0},d:function(){return!0},u:function(){return""},l:function(){return""},w:function(){return _nbs.a.lQ},i:function(){return _nbs.a.ws},D:function(){return""},C:function(){return _nbs.a.Qb},k:function(){return _nbs.a.Kh},h:function(){return""},t:function(){return""},v:function(){return""},c:function(){return _nbs.a.OI},n:function(){return!0},I:function(){return new _db.C(null,11031,null)},y:function(n){n=n.toLowerCase();var t=_nbs.a.VP;n in this.H&&(t=String.format(_nbs.a.px,this.H[n]));return t},g:function(n,t,i,r){return t.replace("&rm=embedded","").replace("?rm=embedded","")},b:function(n){return _at.A.c},x:function(n){return n.h()?_at.A.b:_at.A.a},S:function(){return _at.A.d},V:function(){this.H={"application/vnd.google-apps.document":_nbs.a.qV,"application/vnd.google-apps.spreadsheet":_nbs.a.Xg,"application/vnd.google-apps.presentation":_nbs.a.WM}}};_at.br=function(n,t,i,r,u,f,e,o){_at.br.initializeBase(this,[n,t,i,r,u,f,e,o])};_at.br.prototype={L:function(){return _nbs.a.gO},M:function(n,t){var i=this;return _h.c.b(n,_h.h.a(),function(n){return new _at.bP(n,t)})}};_at.cs=function(n,t,i,r,u,f,e,o){this.B=Function.createDelegate(this,this.U);this.C=Function.createDelegate(this,this.V);this.s=Function.createDelegate(this,this.O);this.r=Function.createDelegate(this,this.ba);this.j=_a.G.a();_at.cs.initializeBase(this);this.h=new _gg.E;this.h.SortColumn=0;this.h.SortOrder=0;this.D=n;this.e=new _j.l;this.x=t;this.v=i;this.y(new _j.l);this.I=u;this.H=f;this.S=o;this.n=r;this.o=e};_at.cs.prototype={f:null,c:null,e:null,g:null,I:null,D:null,n:null,h:null,o:null,a:null,i:!1,d:null,l:null,x:0,w:!1,b:null,N:!1,S:!1,q:null,E:0,v:null,H:null,bc:function(n){if(this.c!==n){this.c=n;this.bf();this.eJ("CurrentFolder")}return n},Q:function(n){if(this.i!==n){this.i=n;this.eJ("IsDataInProgress");this.A()}return n},be:function(n){if(this.a===n)return n;if(this.a){this.a.bo(this.r);this.a.fg(this.q)}this.a=n;if(this.a){var i=this.f;var t=this;this.q=function(n,r){t.T(i)};this.a.be(this.r);this.a.eY(this.q);this.a.d()?this.Q(!0):this.t()}this.eJ("ItemsTable");return n},R:function(n){if(this.f!==n){this.f=n;this.f&&this.Z(this.f);this.A();this.eJ("SelectedDataProvider")}return n},y:function(n){if(this.b!==n){this.b&&this.b.e(this.s);this.b=n;this.b&&this.b.d(this.s);this.O(null,null);this.eJ("SelectedAttachmentDataProviderItems")}return n},m:function(n){if(this.l!==n){this.l=n;this.eJ("InfoMessage")}return n},P:function(n){if(this.g!==n){this.g=n;if(this.g&&this.c!==n){this.z();this.p(this.g,!0,this.h)}this.eJ("BreadCrumbsSelectedItem")}return n},L:function(){return _nbs.a.bI},K:function(){return this.x==="Mouse"?this.n.a().K():this.n.a().L()},bd:function(n){this.N=n;this.eJ("IsAnyFolderSelected");return n},Y:function(){this.G();this.o.d("AttachmentsFolderPickerGetDataProviders",this.w,this.C,this.B)},bb:function(){this.a&&this.a.O()},p:function(n,t,i,r){this.W(n,t,t,r,!1,i,null)},W:function(n,t,i,r,u,f,e){if(t){this.G();this.bc(n)}f||(f=this.h);var h=new _at.bl(n,n.e,f,n.d,e,n.c,r,u,this.E);var o=this.M(h,this.v);i&&this.be(o);var s=50;o.bx&&o.bx.x.length>0&&(s=o.bx.x.length);o.k(new _h.o(0,s),null,null);i&&this.A()},z:function(n){n||(n="AttachmentsFilePickerChangeFolder");if(this.d){var t=this.d;t.n="Abandoned";t.m=this.u();_a.b.a(this.d);this.d=null}this.d=_a.b.b(_a.a.c,n,!1,null)},G:function(){this.b.g()},Z:function(n){var t=new _gg.E;t.SortColumn=0;t.SortOrder=0;var r=n.b().a(_at.i.f(n));if(n){this.z("AttachmentsFolderPickerLoadRootFolder");var u=n.bH.DisplayName;var i=new _at.v("","",r.DisplayName,r,n.bH.EndPointUrl,n);i.a=!0;this.p(i,!0,t)}},bf:function(){if(this.c){if(this.g!==this.c||!this.e.x.length||this.e.x[this.e.x.length-1]!==this.c){var n=this.e.m(this.c);n>=0&&n<this.e.x.length-1?this.e.r(n+1,this.e.x.length-(n+1)):this.e.a(this.c);this.P(this.c)}}else this.e.g()},ba:function(n,t){this.Q(this.a.d());if(!this.i){if(this.d){this.d.m=this.u();_a.b.a(this.d);this.d=null;this.f}if(this.j.f()>0){for(var u=new _j.l,f=this.a.bx.x.length,i=f-1;i>=0;i--){var r=this.a.bx.x[i];if(this.j.c(r.bH.Id)){u.a(r);this.j.e(r.bH.Id)}}this.y(u);this.j.f()>0&&(this.j=_a.G.a())}}},T:function(n){if(this.a.bU){var u,i;var r=this.a.bQ;switch(r.f){case 2:u=_nbs.a.Ek;i="AccessDenied";break;case 4:u=_nbs.a.CA;i="NotFound";break;default:u=_nbs.a.Gz;i=_at.s.c(r);break}this.m(u);if(this.d){var t=this.d;t.n=r.O();t.p=i;t.o=r.P();t.m=this.u();_a.b.a(t);this.d=null}}},V:function(){var n=this.o.b;n.length<=0?this.f||this.m(this.K()):this.R(n[0])},U:function(){this.R(null);this.m(this.K())},A:function(){if(this.i){this.t();return}this.a&&(this.a.bx&&this.a.bx.x.length?this.t():this.l||this.m(this.L()))},t:function(){this.m(null)},u:function(){var n=new _a.l;n.b("W",this.w?1:0);return n.toString()},O:function(n,t){var r=!1,f=!1;if(this.b)for(var i=0;i<this.b.x.length;i++){var u=this.b.x[i];this.X(u)||(r=!0);if(r&&f)break}this.bd(r);this.eJ("SelectedAttachmentsChanged")},X:function(n){return!n.a()||_gg.h.isInstanceOfType(n)}};_at.be=function(n,t){_at.be.initializeBase(this,[n,t])};_at.be.prototype={B:function(){return!0},N:function(){return!0},Q:function(){return!0},P:function(){return!0},O:function(){return!1},o:function(){return!0},u:function(){return""},l:function(){return""},w:function(){return""},i:function(){return""},D:function(){return""},C:function(){return""},k:function(){return""},h:function(){return""},t:function(){return""},v:function(){return""},c:function(){return""},g:function(n,t,i,r){return""},b:function(n){return _at.be.a}};_at.H=function(n,t){_at.H.initializeBase(this,[n,t])};_at.H.c=function(){return _fm.b.b(_fm.a.Y,null,[_fm.WebfontSizes.a.i],null,null,null,null,null)};_at.H.prototype={E:function(){return _at.H.c()},B:function(){return this.H()},o:function(){return!this.H()},u:function(){return String.format(_nbs.a.Ot,_nbs.a.dx)},l:function(){return""},w:function(){return _nbs.a.lQ},i:function(){return _nbs.a.ws},D:function(){return _nbs.a.jn},C:function(){return _nbs.a.HJ},k:function(){return _nbs.a.j},h:function(){return _nbs.a.bT},t:function(){return _nbs.a.ws},v:function(){return _nbs.a.lQ},c:function(){return _nbs.a.OI},n:function(){return!0},g:function(n,t,i,r){n=encodeURIComponent(n);t=encodeURIComponent(t);return String.format(_g.C.r(),n,t)},b:function(n){return this.H()?_at.H.a:_at.H.b},H:function(){return _g.a.a().E}};_at.r=function(n,t){_at.r.initializeBase(this,[n,t])};_at.r.f=function(n,t,i){return _j.h.b(i)?n:_j.h.c(t,i)};_at.r.prototype={E:function(){return _fm.b.b(_fm.a.Y,null,[_fm.WebfontSizes.a.i],null,null,null,null,null)},a:function(){this.H();return _at.r.a},b:function(n){switch(n){case 4:case 3:return this.G&&this.G.a().hm().Enabled?_at.r.b:_at.r.d;case 6:case 5:return _at.r.b;case 0:return _at.r.e;default:return _at.r.c}},A:function(){return _nbs.a.dx},s:function(){return!0},d:function(){return!0},B:function(){return!0},J:function(){return!0},m:function(){return!0},o:function(){return!1},u:function(){return String.format(_nbs.a.Ot,_nbs.a.dx)},l:function(){return _nbs.a.iF},w:function(){return _nbs.a.Ge},i:function(){return _nbs.a.pG},D:function(){return _nbs.a.Nq},C:function(){return _nbs.a.Jo},k:function(){return _nbs.a.kR},h:function(){return _nbs.a.kx},t:function(){return _nbs.a.pG},v:function(){return _nbs.a.Ge},c:function(){return _nbs.a.OI},z:function(n){switch(n){case 2:case 1:case 6:case 5:case 0:return!0;default:return!1}},n:function(){return!!this.G&&this.G.a().fY().Enabled},e:function(n){return _at.r.f(_nbs.a.OY,_nbs.a.dw,n)},f:function(n){return _at.r.f(_nbs.a.kP,_nbs.a.OP,n)},g:function(n,t,i,r){n=encodeURIComponent(n);t=encodeURIComponent(t);var u=String.format(_g.C.s(),n,t,r);return _j.h.a(i)?u:String.format("{0}/{1}",i,u)},R:function(n,t,i,r,u){var f=n.s()?n.s():n.I();var e=_db.m.a(f);if(!e||_j.h.a(i)||_at.i.i(n.bH.AttachLongPathName)){_j.e.a(_a.a.c,"Avoiding client side metadata call, falling back to OWS.");var o=this.g(n.bH.AttachmentId.Id,n.bH.AttachLongPathName,t,f);r(o,null,null)}else{var s=this;_at.f.s(i,n.bH.AttachLongPathName,e,r,function(i){_j.e.b(_a.a.c,"Error getting download url for ref. attachment. "+i.toString());var e=s.g(n.bH.AttachmentId.Id,n.bH.AttachLongPathName,t,f);r(e,null,null);u&&u()})}},T:function(n){return _at.i.k(n)},H:function(){if(!_at.r.a){var i=new _at.bf(_nbs.a.JB,"ms-word:ofv|u|");var t=new _at.bf(_nbs.a.ml,"ms-PowerPoint:ofv|u|");var n=new _at.bf(_nbs.a.ZK,"ms-excel:ofv|u|");_at.r.a={".docx":i,".doc":i,".pptx":t,".ppt":t,".xlsx":n,".xls":n}}}};_at.P=function(n){_at.P.initializeBase(this);this.c=n};_at.P.prototype={c:null,b:null,a:null,h:function(n){this.b=n;this.eJ("LastRetrievedAttachmentDataProviders");return n},d:function(n,t,i,r){this.a=_a.b.b(_a.a.c,n,!1,null);var u=new _at.D(2);var e=this;u.c(function(n){e.g(n,t);i&&i()});var f=this;u.b(function(n){f.f(n,t);r&&r()});this.c.a(u)},g:function(n,t){var i=n;this.h(i.e);if(this.a){this.a.o=i.P();this.a.m=this.e(t);_a.b.a(this.a);this.a=null}},f:function(n,t){if(this.a){this.a.n=n?n.O():null;this.a.o=n?n.P():null;this.a.m=this.e(t);_a.b.a(this.a);this.a=null}},e:function(n){var t=new _a.l;t.b("W",n?1:0);return t.toString()}};_at.I=function(n,t,i){_at.I.initializeBase(this,[n,t]);this.H=i};_at.I.b=function(){return _fm.d.a("egnyte48.png")};_at.I.prototype={H:null,E:function(){return this.H},B:function(){return!1},o:function(){return!0},u:function(){return""},l:function(){return""},w:function(){return _nbs.a.lQ},i:function(){return""},D:function(){return""},C:function(){return _nbs.a.co},k:function(){return""},h:function(){return""},t:function(){return""},v:function(){return""},c:function(){return""},g:function(n,t,i,r){return""},b:function(n){return _at.I.a}};_at.bw=function(n,t,i,r,u,f,e,o){this.m=Function.createDelegate(this,this.o);this.g=n;this.b=t;this.j=i;this.d=r;this.i=u;this.k=f;this.e=e;this.f=o};_at.bw.prototype={g:null,b:null,i:null,j:null,d:null,k:0,e:null,f:null,l:null,a:0,h:null,n:function(){this.h=_a.b.b(_a.a.c,"SaveToCloudProgressManager",!1,null);this.l=_j.m.a().e(_a.a.c,"SaveToCloudProgressManager",this.m,5e3)},c:function(){var n=new _a.l;n.a("OID",this.d);n.b("AC",this.a);_a.b.a(this.h);_j.m.a().b(this.l);this.a=0},o:function(){this.a++;if(this.a>12){this.c();this.f&&this.f();return}var n=new _at.bG(this.k,this.b,this.j,this.d,this.i);var t=this;n.c(function(n){t.e&&t.e(n.f)});var i=this;n.b(function(n){_j.e.a(_a.a.c,"CheckPendingAttachmentOperationAction failed for attachment with Id:{0}",i.b)});this.g.a(n)}};_at.ct=function(){};_at.ct.prototype={b:null};_at.bf=function(n,t){_at.bf.initializeBase(this);this.b=n;this.a=t};_at.bf.prototype={a:null,c:function(n){var i=n.indexOf("?d=");var t;t=i!==-1?this.a+n.substr(0,i):this.a+n;return t}};_at.s=function(){};_at.s.c=function(n){var r;if(n){if(_h.bR.isInstanceOfType(n)&&(r=n.d())){var i=r.responseCode;if(i&&i!=="NoError")return i;var t=r.response;if(t){var f=t.fault;if(f){var u=_at.s.d(f);if(u)return u}if(t.statusCode)return"HTTP_"+t.statusCode}}if(n.G)return _at.s.a(n.G)}return"UnknownError_Action"};_at.s.a=function(n){if(n){var t;if((t=n.responseCode)&&t!=="NoError")return t.toString();if(t=n.StackTrace)return _at.s.e(t.toString());if(t=n.ErrorCode)return"HTTP_"+t;if(t=n.name){var i=t.toString();if(i!=="Error")return i;else if(n.message)return n.message}}return"UnknownError_Exception"};_at.s.d=function(n){if(n){if(n.ResponseCode&&n.ResponseCode!=="NoError")return n.ResponseCode;if(n.StackTrace)return _at.s.e(n.StackTrace);if(n.ErrorCode)return"HTTP_"+n.ErrorCode}return null};_at.s.e=function(n){var i;var t;if((i=n.indexOf(":"))!==-1||(i=n.indexOf("\n"))!==-1){t=n.substr(0,i);if((i=n.indexOf("\n"))!==-1){var u=new RegExp("[_a-zA-Z0-9.]+\\(");var r=u.exec(n.substr(i));r&&(t=t+"@"+r[0].substr(0,r[0].length-1))}}else t=n;return t};_at.s.f=function(n){var i=n.b();if(i){var t;t=Number.isInstanceOfType(i)?i:i.code;return t>=1&&t<_at.s.b.length?_at.s.b[t]:_at.s.a(i)}return n.d()?_at.s.a(n.d()):"UnknownError_FileReader"};_at.cc=function(n,t,i,r,u,f,e,o,s,h,c){this.fE=Function.createDelegate(this,this.mP);this.hs=Function.createDelegate(this,this.mO);_at.cc.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c])};_at.cc.a=function(n){if(n){if(n.ResultCode===10)return 5;if(n.ResultCode===17||n.ResultCode===20||n.ResultCode===21)return 6;if(n.ResultCode===15)return 7}return 1};_at.cc.prototype={fF:function(){_db.m.b(this.dl,this.o(),this.hs,this.ht(),"NULL NotificationHandler passed in from ExternalSourceAttachmentViewModel.")},jN:function(){_db.m.c(this.dl,this.o(),this.hs)},cy:function(n){this.jN();_at.b.prototype.cy.call(this,n)},mP:function(n){this.es(n);this.cy(null)},mO:function(n){var i=null;var t=n;i=n?_j.h.a(t.Exception)?this.hu(t.Response):String.format("Exception from Server: "+t.Exception):"The notification received is null";if(i){t&&(i+=". AttachmentProviderResultCode = "+t.ResultCode);this.ct(_at.cc.a(t),i,!0)}else this.jM(t);this.cy(null)},jM:function(n){},hu:function(n){var i=null;if(n&&n.ResponseMessages&&n.ResponseMessages.Items&&n.ResponseMessages.Items.length)if(n.ResponseMessages.Items[0].ResponseCode!=="NoError")i="ResponseMessages response code = "+n.ResponseMessages.Items[0].ResponseCode;else{var t=n.ResponseMessages.Items[0];this.bo.f(t.Attachments[0].Size);_at.o.c(t,this.bo,this.bp.b(),!0);if(_dg.b.isInstanceOfType(this.bo)&&t.Attachments.length>=1&&t.ResponseCode==="NoError"){var u=t.Attachments[0];this.mR(u);this.eE(n.SharingInformation)}if(_dg.e.isInstanceOfType(this.bo)&&this.bo.a()){var r=t.Attachments[0];this.bo.m(r.ContentId);this.bo.j(r.ContentType)}}else i="The response message received is null";return i},mR:function(n){if(n.PermissionType){this.bo.G(n.PermissionType);this.cG()}if(n.AttachLongPathName){this.bo.E(n.ProviderType);this.bo.A(n.AttachLongPathName);this.bo.K(n.ProviderEndpointUrl);this.bo.m(n.ContentId);this.bo.D(n.AttachmentThumbnailUrl);this.bo.C(n.AttachmentPreviewUrl)}this.bo.e(n.Name);this.mQ()},mQ:function(){this.bp.V(!0)}};_at.cq=function(n,t){this.F=t;this.G=n};_at.cq.prototype={G:null,F:null,E:function(){return null},A:function(){return this.F},s:function(){return!1},d:function(){return!1},M:function(){return!1},J:function(){return!1},j:function(){return!1},m:function(){return!1},N:function(){return!1},Q:function(){return!1},P:function(){return!1},O:function(){return!0},I:function(){var n=this.G.a().bS().Enabled?11032:11030;return new _db.C(null,n,[this.A()])},U:function(){return String.format(_nbs.a.PP,this.F)},K:function(){return String.format(_nbs.a.RM,this.F)},L:function(){return String.format(_nbs.a.RE,this.F)},a:function(){return null},n:function(){return!1},x:function(n){return null},S:function(){return null},z:function(n){return!1},p:function(){return this.B()},r:function(){return this.B()},q:function(){return!1},e:function(n){return null},f:function(n){return null},y:function(n){return""},R:function(n,t,i,r,u){var f=this.g(n.bH.AttachmentId.Id,n.bH.AttachLongPathName,t,0);r(f,null,null)},T:function(n){return n}};_at.j=function(){};_at.j.c=function(n,t,i,r){var u=_a.b.b(_a.a.c,"MailComposeImageSizeDecode",!1,null);i.val=r.val=0;if(!t){u.n="EmptyContent";_a.b.a(u);return}if(n==="image/png")_at.j.o(t,i,r,u);else if(n==="image/jpeg")_at.j.n(t,i,r,u);else if(n==="image/gif")_at.j.m(t,i,r,u);else if(n==="image/bmp")_at.j.l(t,i,r,u);else{u.n="UnsupportedImage";u.p=String.format("Image type {0} is not supported.",n);_a.b.a(u)}};_at.j.k=function(n){var t=_a.bc.a(n);return _db.m.d.g(t.toLowerCase())};_at.j.o=function(n,t,i,r){var p=n.length>100?100:n.length;var w=n.substring(0,p);var s=_at.j.b(_a.bf.b(w));if(s.length>24){for(var h=0,f=0,y=new Array(8),u=0;u<8;u++)y[u]=s[u];if(_at.j.a(y,_at.j.j)){for(var o=16,e=4,v=new Array(e),l=0;l<e;l+=1){v[l]=s[o];o+=1}for(var a=new Array(e),c=0;c<e;c+=1){a[c]=s[o];o+=1}h=_at.j.d(v);f=_at.j.d(a);if(h<=0||f<=0){_j.e.b(_a.a.c,"Width and height of a png image have to be > 0.");r.n="IllegalDimensions";r.p="png";h=f=0}}else{_j.e.b(_a.a.c,"The png image has unexpected headers, exiting.");r.n="InvalidHeaders";r.p="png"}t.val=h;i.val=f}else{r.n="NotEnoughData";r.p="png"}_a.b.a(r)};_at.j.m=function(n,t,i,r){var p=n.length>20?20:n.length;var w=n.substring(0,p);var s=_at.j.b(_a.bf.b(w));if(s.length>10){for(var h=0,f=0,a=new Array(6),u=0;u<6;u++)a[u]=s[u];if(_at.j.a(a,_at.j.h)||_at.j.a(a,_at.j.i)){for(var o=6,e=2,y=new Array(e),l=0;l<e;l+=1){y[l]=s[o];o+=1}for(var v=new Array(e),c=0;c<e;c+=1){v[c]=s[o];o+=1}h=_at.j.e(y);f=_at.j.e(v);if(h<=0||f<=0){_j.e.b(_a.a.c,"Width and height of a gif image have to be > 0.");r.n="InvalidDimensions";r.p="gif";h=f=0}}else{_j.e.b(_a.a.c,"The gif image has unexpected headers, exiting.");r.n="InvalidHeaders";r.p="gif"}t.val=h;i.val=f}else{r.n="NotEnoughData";r.p="gif"}_a.b.a(r)};_at.j.l=function(n,t,i,r){var p=n.length>50?50:n.length;var w=n.substring(0,p);var s=_at.j.b(_a.bf.b(w));if(s.length>26){for(var h=0,f=0,y=new Array(2),u=0;u<2;u++)y[u]=s[u];if(_at.j.a(y,_at.j.g)){for(var o=18,e=4,v=new Array(e),l=0;l<e;l+=1){v[l]=s[o];o+=1}for(var a=new Array(e),c=0;c<e;c+=1){a[c]=s[o];o+=1}h=_at.j.f(v);f=_at.j.f(a);if(h<=0||f<=0){_j.e.b(_a.a.c,"Width and height of a bmp image have to be > 0.");r.n="InvalidDimensions";r.p="bmp";h=f=0}}else{_j.e.b(_a.a.c,"The bmp image has unexpected headers, exiting.");r.n="InvalidHeaders";r.p="bmp"}t.val=h;i.val=f}else{r.n="NotEnoughData";r.p="bmp"}_a.b.a(r)};_at.j.n=function(n,t,i,r){for(var f=_at.j.b(_a.bf.b(n)),c=f.length,l=!1,a=!1,u=0,o=0,s=0;!l&&!a&&u+1<c;){u+=1;var h=f[u];u+=1;var e=0;switch(h){case 216:case 217:e=0;break;case 221:e=2;break;default:if(u+2<c){var y=f[u];u+=1;var v=f[u];u+=1;e=(y<<8|v)-2}else{_j.e.b(_a.a.c,"Malformed jpeg.");r.n="MalformedJpeg";_a.b.a(r);return}break}h===217&&(a=!0);if(e>0){if(h===192){if(u+4<c){o=f[u+3]<<8|f[u+4];s=f[u+1]<<8|f[u+2]}else{_j.e.b(_a.a.c,"Malformed segment in jpeg.");r.n="MalformedJpeg";_a.b.a(r);return}l=!0}u+=e}}if(o<=0||s<=0){if(l){_j.e.b(_a.a.c,"Width and height of a jpeg image have to be > 0.");r.n="InvalidDimensions";r.p="jpeg"}else{_j.e.b(_a.a.c,"Image dimension segment not found for jpeg image.");r.n="MissingDimension";r.p="jpeg"}o=s=0}t.val=o;i.val=s;_a.b.a(r)};_at.j.b=function(n){for(var i=n.length,r=new Array(i),t=0;t<i;t++)r[t]=n.charCodeAt(t);return r};_at.j.d=function(n){for(var i=0,t=0;t<4;t++)i=(i<<8)-0+n[t];return i};_at.j.e=function(n){for(var i=0,t=1;t>=0;t--)i=(i<<8)-0+n[t];return i};_at.j.f=function(n){for(var i=0,t=3;t>=0;t--)i=(i<<8)-0+n[t];return i};_at.j.a=function(n,t){if(n.length!==t.length)return!1;for(var i=0;i<t.length;i++)if(n[i]!==t[i])return!1;return!0};_at.cd=function(n){this.g=n;this.c={};this.a=new _j.q};_at.cd.prototype={g:null,c:null,a:null,b:function(n){_a.c.c(n,"attachmentId");return n in this.c},h:function(n){this.d(n);if(!this.b(n.a)){this.a.c(n);this.c[n.a]=""}},e:function(n,t){this.d(t);if(!this.b(t.a)){this.a.k(n,t);this.c[t.a]=""}},i:function(){if(this.a.d.length>0){var n=this.a.d[0];this.f(n);return n}else return null},f:function(n){this.d(n);if(this.b(n.a)){delete this.c[n.a];for(var i=-1,t=0;t<this.a.d.length;t++)if(this.a.d[t].a===n.a){i=t;break}i!==-1&&this.a.j(i)}},d:function(n){_a.c.a(n,"parameter");_a.c.a(n.a,"AttachmentId")}};_at.y=function(){};_at.y.e=function(n,t,i,r,u,f,e){_a.c.a(n,"initNativeBridge");_a.c.a(t,"initClientStore");_a.c.a(i,"initAttachmentInfoRecord");_a.c.c(r,"initMimeType");_a.c.c(u,"fileName");_a.c.a(f,"initOnOpenAttachmentSuccess");_a.c.a(e,"initOnOpenAttachmentError");if(_at.y.b){_j.e.a(_at.y.a,"Already opening an attachment so returning.");return}_j.e.a(_at.y.a,"OpenAttachment with record DataID {0}, Size {1}, id {2}",i.AttachmentId,i.DataID,i.Size);_at.y.b=!0;n.d().f(i.DataID,r,u,function(n){_at.y.d(n,i,t,f,e)});t.l(i.AttachmentId,function(n){},null)};_at.y.c=function(n){var t=null;switch(n){case 0:break;case 1:case 3:t=_nbs.a.nD;break;case 2:t=_nbs.a.EA;break;default:break}_j.e.a(_at.y.a,"OpenPalAttachment error code {0}, string: {1}",n,t);return t};_at.y.d=function(n,t,i,r,u){_at.y.b=!1;var f=!0;switch(n){case 0:f=!1;break;case 1:case 3:break;case 2:i.g(t.AttachmentId);break;default:break}if(f){_j.e.b(_at.y.a,"OnOpenDocument failed with errorCode {0}",n);u(n)}else{_j.e.a(_at.y.a,"OnOpenDocument succeeded");r()}};_at.h=function(n,t,i){this.r=Function.createDelegate(this,this.A);this.s=Function.createDelegate(this,this.B);this.t=Function.createDelegate(this,this.w);_a.c.a(n,"initNativeBridge");var r=t?t.j():null;this.l=n;this.q=i;this.k=n.q().a(r);this.v(t)};_at.h.prototype={k:!1,g:null,f:null,h:null,m:0,j:null,l:null,q:null,n:null,a:function(){if(!this.k&&_g.k.a){var n=_bc.o.isInstanceOfType(_g.k.a)?_g.k.a:null;this.k=this.l.q().a(n?n.h():null);this.v(n?n.d().j():null)}return this.k},d:function(n,t){_a.c.c(n,"attachmentId");_a.c.a(t,"callbacks");if(this.a()){this.j[n]=t;this.y(n,t)}else _j.e.a(_at.h.a,"PAL does not support download.")},b:function(n){_a.c.c(n,"attachmentId");this.a()&&n in this.j&&delete this.j[n]},c:function(n){_a.c.a(n,"parameters");_a.c.a(n.a,"AttachmentId");_a.c.a(n.e,"DownloadUrl");_j.e.a(_at.h.a,"DownloadAttachment:Begin download Attachment for parameters {0}",n);if(this.a()){if(!(n.a in this.j))throw Error.invalidOperation("Subscribe must be called before calling DownloadAttachment.");var t=this.C(n);if(_j.h.a(t)){if((!this.f||this.f.a!==n.a)&&!this.g.b(n.a)){_j.e.a(_at.h.a,"Starting download for {0}",n);if(n.h){this.g.e(0,n);if(this.f){this.u();this.g.e(1,this.h);this.i(this.h,2)}else{this.i(n,2);this.p()}}else{this.g.h(n);this.i(n,2);this.p()}}}else this.x(n,t)}},e:function(n){_a.c.a(n,"parameters");_a.c.a(n.a,"AttachmentId");_j.e.a(_at.h.a,"Cancel download for parameters {0}",n);if(this.a())if(this.g.b(n.a)){this.g.f(n);_j.e.a(_at.h.a,"Found and removed from queue {0}. Pending Items in queue {1}",n,this.g.a.d.length);this.i(n,1)}else if(this.f&&this.f.a===n.a){_j.e.a(_at.h.a,"Current Download was canceled. {0}",this.f);this.u();this.i(this.h,1)}},z:function(n){var t=null;switch(n){case 0:break;case 7:break;case 8:break;case 9:t=_nbs.a.sC;break;case 2:t=_nbs.a.Kp;break;default:break}return t},v:function(n){if(this.k){this.n=n;this.g=new _at.cd(_at.h.a);this.j={};this.h=null;this.f=null;this.m=0}},u:function(){_j.e.a(_at.h.a,"CancelCurrentDownload, canceling the current download");this.l.l().d();this.h=this.f;this.f=null},p:function(){_j.e.a(_at.h.a,"Inside StartDownloadInternal");if(this.h)_j.e.a(_at.h.a,"Still waiting for the canceled download to get canceled.");else if(this.f)_j.e.a(_at.h.a,"Still waiting for the current download to finish.");else{_j.e.a(_at.h.a,"StartDownloadInternal, pending items in queue {0}",this.g.a.d.length);this.f=this.g.i();this.m=0;if(this.f){_j.e.a(_at.h.a,"Starting download {0}",this.f);this.i(this.f,3);var n=this;this.q.c(this.n,this.l,this.t,function(t){_j.e.b(_at.h.a,"Scheduled cleanup failed due to error {0}",t);n.w()})}else _j.e.a(_at.h.a,"Download queue is empty.")}},w:function(){_j.e.a(_at.h.a,"Starting the download now for {0}",this.f);if(this.h){this.h=null;this.p()}else this.l.l().e(this.f.e,1,this.f.f,this.f.b,this.s,this.r)},B:function(n){if(this.f){this.m+=n;var t=this;this.o(this.f,function(n){n.H(t.m)})}},i:function(n,t){var i=this;this.o(n,function(n){n.d(t)})},x:function(n,t){var i=this;this.o(n,function(i){_j.e.b(_at.h.a,"Raising OnError event with error {0} for attachment {1}",t,n);i.I(t)})},o:function(n,t){var i=this.j[n.a];i&&t(i)},A:function(n,t,i){_j.e.a(_at.h.a,"OnDownloadComplete with errorCode = {0} httpStatusCode = {1} dataID = {2} for attachment {3}",n,t,i,this.f);if(this.h)this.h=null;else if(n||t!==200){var f=this.z(n);_j.h.a(f)||this.x(this.f,f);this.i(this.f,1)}else{var r=this.f;var u=new AttachmentInfoRecord(this.f.a,i,this.f.d,_a.d.get_utcNow().h(),this.f.g,0,_a.d.m(_a.d.get_utcNow()),!0);var e=this,s=this;this.n.q(u,function(n){_j.e.a(_at.h.a,"Successfully saved attachment in DB with dataID {0} and parameters {1}",i,r)},function(n){_j.e.b(_at.h.a,"Unable to save the attachment in DB with parameters {0} error {1}",r,n)});this.i(r,4);var o=this;this.o(r,function(n){_j.e.a(_at.h.a,"Raising OnAttachmentInfoRecordAvailable with record {0} for attachment {1}",u,r);n.w(u)})}this.f=null;this.p()},C:function(n){var t=null;if(_bc.g.b(n.a)){_j.e.a(_at.h.a,"The attachment is not uploaded to the server yet. {0}",n);t=_nbs.a.Lo}else if(_j.h.a(n.g)){_j.e.a(_at.h.a,"Attachment is a quick message {0}",n);t=_nbs.a.Lo}else if(_j.h.a(n.b)){_j.e.a(_at.h.a,"Attachment does not have content type set. {0}",n);t=_nbs.a.Kp}else if(_j.h.a(n.f)){_j.e.a(_at.h.a,"Attachment does not have a valid file name {0}.",n);t=_nbs.a.Kp}else if(this.g.a.d.length===10){_j.e.a(_at.h.a,"download queue max size reached. Rejecting attachment with params {0}.",n);t=String.format(_nbs.a.Qa,10)}return t},y:function(n,t){if(this.f&&n===this.f.a){_j.e.a(_at.h.a,"FindStatusAndFireCallback. currently downloading attachment with id {0}",n);t.d(3)}else if(this.g.b(n)){_j.e.a(_at.h.a,"FindStatusAndFireCallback. Found in the queue. attachment with id {0}",n);t.d(2)}else{var r=this,i=this;this.n.p(n,function(i){if(i){_j.e.a(_at.h.a,"FindStatusAndFireCallback Found the record in db {0} and AttachmentId {1}",i.DataID,i.AttachmentId);t.d(4);t.w(i)}else{_j.e.a(_at.h.a,"FindStatusAndFireCallback. Did not find attachment with id {0} in the db.",n);t.d(1)}},function(i){_j.e.b(_at.h.a,"FindStatusAndFireCallback. Got error {0} from DB while retreiving record with id {1}",i,n);t.d(1)})}}};_at.ba=function(){};_at.ba.b=function(n){_a.c.a(n,"viewModel");_a.c.a(n.cf,"DownloadUrl should not be empty");var t=null;n.bp&&n.bp.b()&&(t=n.bp.b().Id);return _at.ba.a(n.bo,n.bo.bH.Name,n.bo.bH.ContentType,n.cf,t,!1)};_at.ba.a=function(n,t,i,r,u,f){_a.c.a(n,"attachment");_a.c.a(n.bH.AttachmentId,"attachmentId");_a.c.a(r,"previewUrl");_a.c.a(r,"destinationFileName");var e=new _at.ba;e.a=n.bH.AttachmentId.Id;e.d=n.b();e.c=t;e.f=_a.bc.a(e.c);e.b=i;e.e=_a.P.a(r);e.g=u;e.h=f;_j.h.a(e.b)&&!_a.o.a().M&&(e.b="fakeMimeType");return e};_at.ba.prototype={b:null,c:null,f:null,a:null,g:null,e:null,d:0,h:!1,toString:function(){return String.format("Attachment with Name {0} Size {1} ContentType {2} AttachmentId{3}",this.c,this.d,this.b,this.a)}};_at.e=function(n,t,i,r,u,f,e,o,s,h,c,l,a){_at.e.initializeBase(this,[n,t,i,r,u,o,s,h,c,l,a]);_a.c.b(f,"palDownloadManager");_a.c.b(a.a,"nativeBridge");_a.c.b(e,"itemStoreGetter");this.bR=f;this.cH=a.a;this.ee=e;this.bo&&this.fH(null,this.bo.bH.AttachmentId)};_at.e.prototype={cH:null,bR:null,ee:null,ef:null,ed:0,fE:null,fF:function(n){this.ed=n;this.eJ("PALAttachmentDownloadStatus");return n},fL:function(n){this.fE=n;this.eJ("PALAttachmentCurrentDowloadedBytes");return n},gu:function(){return _at.b.prototype.gu.call(this)||_dg.e.isInstanceOfType(this.bo)&&_a.cH.isInstanceOfType(this.bo.c)},cN:function(){var n=_at.b.prototype.cN.call(this);if(n&&this.cH&&this.cH.b(this.cH.d())){var t=this.cH.h(_a.fx,2);_j.e.a(_at.e.a,"SetOneTimeAllowedUrlSupported is {0}",t);n=!!(n&t)}return n},iL:function(){return this.bu.c()&&this.by},fJ:function(){return this.cN()&&!this.cm()?!1:this.bR.a()&&this.by},ht:function(){this.hs()},d:function(n){_j.e.a(_at.e.a,"Got attachment status {0}",n);this.fF(n)},H:function(n){this.fL(String.format(_nbs.a.Pb,this.fG(n,1),this.fG(this.bo.b(),0)))},I:function(n){_j.e.b(_at.e.a,"Unable to download attachment with name {0} and error is {1}",this.bo.bH.Name,n);this.ch(n)},w:function(n){_j.e.a(_at.e.a,"Found/Saved the record in offline db {0} {1}",n.DataID,n.AttachmentId);this.ef=n},ho:function(n){_a.cH.isInstanceOfType(n.c)?n.a()?this.hi():this.jK():_at.b.prototype.ho.call(this,n)},gn:function(n){if(_a.cH.isInstanceOfType(n.c)){_j.e.a(_at.e.a,"Deleting file attachment via PAL.");var t=n.c;this.cH.i().a(t.c())}else _at.b.prototype.gn.call(this,n)},ff:function(n,t){if(this.bR.a()){_j.e.a(_at.e.a,"Will use PAL to open attachment.");this.fK()}else _at.b.prototype.ff.call(this,n,t)},gQ:function(n,t){this.fH(n,t);_at.b.prototype.gQ.call(this,n,t)},fK:function(){_j.e.a(_at.e.a,"OpenAttachmentUsingPAL, download status={0}",this.ed);if(!this.bp.t(this.bS)){_j.e.b(_at.e.a,"The context has changed from "+this.bS+" to "+this.bp.bc()+", opening attachment using PAL has been skipped.");return}if(this.bp.bf()||!this.by){_j.e.a(_at.e.a,"Returning because the attachment is a fake message. IsComposeReadOnlyWell = {0} and IsReadOnly {1}",this.bp.bf(),this.by);return}this.hu();var t=_at.ba.b(this);_j.e.a(_at.e.a,"PAL attachment download parameters: {0}",t.toString());switch(this.ed){case 0:case 1:this.H(0);_j.e.a(_at.e.a,"Starting PAL attachment download.");this.bR.c(t);break;case 3:case 2:_j.e.a(_at.e.a,"Canceling PAL attachment download.");this.bR.e(t);break;case 4:_j.e.a(_at.e.a,"PAL attachment download complete.");var n=this;this.ee.a(function(){var i=n.ee.b().a(_g.a.a().a().bH.TimeZone);_at.y.e(n.cH,i.j(),n.ef,t.b,t.c,function(){_j.e.a(_at.e.a,"Attachment opened successfully.")},function(t){_j.e.b(_at.e.a,"Attachment open failed with errorCode {0}",t);t===2&&n.fF(1);var i=_at.y.c(t);n.ch(i)})});break;default:break}},fH:function(n,t){if(this.bR)if(_dg.j.isInstanceOfType(this.bo)){_j.e.a(_at.e.a,"ItemAttachment for PAL status:Downloaded");this.fF(4)}else if(this.bR.a()){n&&n.Id&&this.bR.b(n.Id);t&&t.Id&&this.bR.d(t.Id,this)}},hs:function(){if(this.bR.a()&&this.bo&&this.bo.bH.AttachmentId&&!_dg.j.isInstanceOfType(this.bo)){_j.e.a(_at.e.a,"Unsubscribing for attachment with name {0} and id {1}",this.bo.bH.Name,this.bo.bH.AttachmentId);this.bR.b(this.bo.bH.AttachmentId.Id)}},fG:function(n,t){var i;var r=n;if(n>=1073741824){r/=1073741824;i=_u.R.GR}else if(n>=1048576){r/=1048576;i=_u.R.MQ}else if(n>=1024){r/=1024;i=_u.R.Hb}else i=_u.R.q;return String.format(i,Math.round(r*Math.pow(10,t))/Math.pow(10,t))},hu:function(){if(this.bu.e()&&(_j.h.b(this.bo.bH.ContentType)||_at.e.d===this.bo.bH.ContentType.toLowerCase())){var t=_a.bc.a(this.bo.bH.Name);var n;if(_j.h.b(t))n=_at.e.d;else{n=_at.e.f[t.toLowerCase()];_j.h.a(n)&&(n=_at.e.d)}_j.e.a(_at.e.a,"PAL GetMimeType File(Name:'{0}', Ext='{1}'), MimeType:(original:'{2}' is replaced with:'{3}')",this.bo.bH.Name||"<NULL>",t||"<NULL>",this.bo.bH.ContentType||"<NULL>",n);this.bo.j(n)}}};_at.ce=function(){};_at.ce.prototype={a:function(){return!1},d:function(n,t){throw Error.invalidOperation("This method is not implemented for BOWA.");},b:function(n){throw Error.invalidOperation("This method is not implemented for BOWA.");},c:function(n){throw Error.invalidOperation("This method is not implemented for BOWA.");},e:function(n){throw Error.invalidOperation("This method is not implemented for BOWA.");}};_at.cf=function(){};_at.cf.prototype={a:null,b:null,c:function(n,t){if(!_j.h.a(t)){this.a||(this.a={});switch(n){case 4:case 3:case 5:case 6:case 2:case 1:this.a[n.toString()]=t;break;default:_j.e.b(_a.a.c,String.format("Cannot add sharing link for permission type: {0}",n));break}}},d:function(n,t){this.b||(this.b={});switch(n){case 4:case 3:case 5:case 6:this.b[n.toString()]=t;break;default:_j.e.b(_a.a.c,"Cannot create link of this type. Skip adding to dictionary");break}},f:function(n,t){var i=null;if(this.a)switch(n){case 4:case 3:case 5:case 6:n.toString()in this.a&&(i=this.a[n.toString()]);break;case 2:case 1:if(t&&t===_g.q.toString(0)&&"2"in this.a){i=this.a["2"];break}n.toString()in this.a&&(i=this.a[n.toString()]);break;default:break}return i},e:function(n){if(this.b)switch(n){case 4:case 3:case 5:case 6:return n.toString()in this.b?this.b[n.toString()]:!1;case 1:case 2:return!0;default:_j.e.b(_a.a.c,String.format("Cannot create link of permission type: {0}. Returning false.",n));return!1}return!1},g:function(n){_j.h.a(n.AnonymousEditLink)?this.d(4,n.CanCreateAnonymousEditLink):this.c(4,n.AnonymousEditLink);_j.h.a(n.AnonymousViewLink)?this.d(3,n.CanCreateAnonymousViewLink):this.c(3,n.AnonymousViewLink);_j.h.a(n.OrganizationEditLink)?this.d(6,n.CanCreateOrganizationEditLink):this.c(6,n.OrganizationEditLink);_j.h.a(n.OrganizationViewLink)?this.d(5,n.CanCreateOrganizationViewLink):this.c(5,n.OrganizationViewLink)}};_at.bx=function(n,t,i,r,u,f,e,o,s,h,c){_at.bx.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c])};_at.bx.a=function(){return"UriFileAttachmentNotification"+(_a.d.a().h()+_ff.p.a(0,1e3)).toString()};_at.bx.prototype={d:null,o:function(){this.d||(this.d=_at.bx.a());return this.d},ht:function(){return"UriFileAttachmentViewModel"},ey:function(){return!1},eF:function(n){if(_dg.e.isInstanceOfType(this.bo)&&_y.cT.isInstanceOfType(this.bo.c)){_j.e.a(_a.a.i,"Uploading attachment from URL");var i=this.bo.c;this.fF();var t=new _at.cl(this.bp.b(),i.c(),i.a(),this.o(),this.bo.a(),this.bo.bH.ContentId);t.b(this.fE);this.bD.a(t)}else{_j.e.c(_a.a.i,"Unsupported upload type detected in addFileAttachment");n(null)}},fB:function(){this.hd(!1)}};_at.by=function(n,t,i){this.c=n;this.d=t;this.b=i};_at.by.prototype={c:null,d:null,b:null,a:function(n,t,i,r,u,f,e,o){var s=_at.z.a(this.d,this.b,u);return new _at.bx(n,t,i,r,u,f,e,o,this.c,s,this.b)}};_at.bY=function(){_at.bY.initializeBase(this)};_at.bY.prototype={a:function(){return 1},c:function(){return 8},b:function(){return!0},d:function(){return!0}};_at.cr=function(){};_at.cr.prototype={n:null,f:0,g:null,l:!1,m:!1,i:null,e:null,j:function(){Error.invalidOperation("Not supported");return 6},a:function(){return 2},c:function(){return 0},b:function(){return!1},k:function(){return!1},d:function(){return!1},o:function(n,t,i,r,u,f,e){this.n=n;this.f=t;this.g=i;this.l=r;this.m=u;this.i=f;this.e=e}};_at.bT=function(){_at.bT.initializeBase(this)};_at.bT.prototype={a:function(){return 1},c:function(){return 7},b:function(){return!0},d:function(){return!0}};_at.bU=function(){_at.bU.initializeBase(this)};_at.bU.prototype={j:function(){return 10},a:function(){return 1},c:function(){return 4},b:function(){return!0},d:function(){return!0}};_at.bX=function(n){_at.bX.initializeBase(this);this.h=n};_at.bX.prototype={h:!1,a:function(){return 1},c:function(){return 6},b:function(){return!0},k:function(){return this.h},d:function(){return!0}};_at.bZ=function(){_at.bZ.initializeBase(this)};_at.bZ.prototype={a:function(){return 1},c:function(){return 5},b:function(){return!0},d:function(){return!0}};_at.bo=function(){_at.bo.initializeBase(this)};_at.bo.prototype={a:function(){return 2}};_at.bV=function(){_at.bV.initializeBase(this)};_at.bV.prototype={a:function(){return 1},c:function(){return 3},b:function(){return!0},d:function(){return!0}};_at.bW=function(){_at.bW.initializeBase(this)};_at.bW.prototype={a:function(){return 1},c:function(){return 1},b:function(){return!0},d:function(){return!0}};_at.bp=function(){_at.bp.initializeBase(this)};_at.bp.prototype={a:function(){return _a.g.b?2:1},c:function(){return 2},b:function(){return this.f==="TouchNarrow"?!1:this.e.f()?this.g.a().eC().Enabled&&!this.h():!1},d:function(){return!0},h:function(){return!!this.e&&!!this.e.d()&&!!this.e.d().a()&&this.e.d().a().fv()}};_at.C=function(n){this.n=Function.createDelegate(this,this.x);_at.C.initializeBase(this,[n])};_at.C.prototype={b:null,e:0,i:!1,d:!1,g:!1,q:function(n){if(this.d!==n){this.d=n;this.by("ImageLoadSucceeded")}return n},p:function(n){if(n!==this.b){this.b=n;this.k()}return n},r:function(n){if(n!==this.e){this.e=n;this.k()}return n},f:function(n){_j.k.c(this.z,"error");this.a(_y.c.a.o(_y.e.a().c));this.v();this.i=!0},P:function(){_b.P.prototype.P.call(this);_j.k.b(this.z,"load",this.n);this.k();this.u()},bz:function(){_j.k.c(this.z,"load");_j.i.prototype.bz.call(this)},x:function(n){this.q(!this.i);this.d&&!this.g&&this.w(this.z)},u:function(){var t=_a.b.b(_a.a.c,"AttachmentExternalImage",!1,null);var n=new _a.l;n.c("L",!0);this.b?n.c("U",this.b.a):n.c("N",!0);t.m=n.toString();_a.b.a(t)},v:function(){var t=_a.b.b(_a.a.c,"AttachmentExternalImage",!1,null);var n=new _a.l;n.c("E",!0);this.b?n.c("U",this.b.a):n.c("N",!0);t.m=n.toString();_a.b.a(t)},k:function(){this.b&&this.e&&this.a(this.b.c)},w:function(n){this.g=!1;var f=n;if(_at.C.a){f=window.document.createElement("img");f.src=n.src}var i=f.naturalHeight;i||(i=f.height);var r=f.naturalWidth;r||(r=f.width);i||(i=this.b.b);r||(r=this.b.d);if(!i||!r){_j.e.b(_a.a.c,"Stopping processing image since either imageHeight or width is 0");return}var y=0;var c=1;var w=0;var p=1;var t=this.b.e;if(t&&t.b()>=4)if(t.a(0)<t.a(2)&&t.a(1)<t.a(3)){_j.e.a(_a.a.c,"Top={0}, Left={1}, Bottom={2}, Right={3}",t.a(0),t.a(1),t.a(2),t.a(3));var h=255;y=t.a(0)/h;w=t.a(1)/h;c=t.a(2)/h;p=t.a(3)/h}else _j.e.b(_a.a.c,"Something wrong with the salient region, Top={0}, Left={1}, Bottom={2}, Right={3}",t.a(0),t.a(1),t.a(2),t.a(3));else _j.e.b(_a.a.c,"Using default value as the salient regions");var g=r/i;var o;var s;var b,l;_at.bi.a(this.e,b={val:s},l={val:o}),s=b.val,o=l.val;var nt=o/s;var e;var a=0,v=0;if(g>nt){e=s/i;a=this.o(e,r,o,(w+p)/2)}else{e=o/r;v=this.o(e,i,s,(y+c)/2)}var tt=Math.round(r*e);var it=Math.round(i*e);var k=a*-1;var d=v*-1;var u={};u.width=tt.toString()+"px";u.height=it.toString()+"px";u.top=d.toString()+"px";u[_fc.n.a()]=k.toString()+"px";this.z.style.cssText="width: "+u.width+"; "+"height"+": "+u.height+"; "+"top"+": "+u.top+"; "+_fc.n.a()+": "+u[_fc.n.a()]+"; "+"position"+": "+"absolute"+";";this.g=!0},o:function(n,t,i,r){var o=.5;var e=t*n;var u=(e-i)/e;var f;f=r-o>=u/2?Math.round(e*u):o-r>=u/2?0:Math.round((r-o+u/2)*e);return f}};_at.bi=function(){};_at.bi.a=function(n,t,i){switch(n){case 3:i.val=160;t.val=120;break;case 4:i.val=200;t.val=150;break;case 5:i.val=260;t.val=195;break;case 6:i.val=40;t.val=40;break;default:i.val=50;t.val=50;break}};_at.bj=function(n){_at.bj.initializeBase(this,[n])};_at.bj.prototype={G:function(){_j.i.prototype.G.call(this);var n=this.V();if(n&&n.bo&&n.gs()){var i=_a.bc.a(n.bo.bH.Name).replace(".","");var t=SuiteExtensions.ControlFactory.CreateControl(i,0);t.Render(this.z)}}};_at.g=function(n){this.s=Function.createDelegate(this,this.br);this.r=Function.createDelegate(this,this.be);this.u=Function.createDelegate(this,this.bR);this.v=Function.createDelegate(this,this.bS);this.t=Function.createDelegate(this,this.bs);_at.g.initializeBase(this,[n]);this.a("about:blank");this.A(-1);_j.i.d(this.z,"load",this.t,"hiddenAttachmentUpload",!1)};_at.g.prototype={b:null,d:null,e:0,k:!1,n:null,m:0,p:null,h:!1,l:null,i:function(){return this.eM(_at.g.c)},bv:function(n){this.eK(_at.g.c,n);return n},j:function(){return this.eM(_at.g.e)},bJ:function(n){this.eK(_at.g.e,n);return n},bD:function(n){n||(this.e=-1);this.eK(_at.g.g,n);return n},bg:function(){return this.eM(_at.g.d)},bw:function(n){this.eK(_at.g.d,n);return n},bi:function(){return this.eM(_at.g.b)},bN:function(n){this.eK(_at.g.b,n);return n},E:function(n){if(this.l===n)return n;this.l=n;this.by("UploadAndShareAttachmentCommand");return n},bl:function(){return this.eM(_at.g.f)},bP:function(n){this.eK(_at.g.f,n);return n},y:function(n){this.n=n;this.by("Error");return n},x:function(n){this.m=n;this.by("AttachmentError");return n},B:function(n){this.p=n;this.by("SuccessResponse");return n},Y:function(){_j.i.prototype.Y.call(this);this.eK(_at.g.b,new _j.g(this.v,_at.g.a));this.E(new _j.g(this.u,_at.g.a))},bs:function(n){if(this.e){if(this.e===2){_j.e.a(_at.g.a,"Response received.");var t="";try{t=this.z.contentWindow.document.body.innerText}catch(u){if(!(_a.o.a().I&&u.number===-2146828218)){_j.e.d(_at.g.a,u,"Unhandled exception while executing HandleCreateAttachmentResponse");return}}if(this.k)_j.h.a(t)&&this.o(null,"Error sending the attachment upload form",1);else{var r=this,i=this;_at.o.d(t,this.i(),this.j(),_g.k.a,function(n){_j.e.a(_at.g.a,"HandleCreateAttachmentResponse completed.");r.o(n,null,0)},function(n,t){_j.e.a(_at.g.a,"HandleCreateAttachmentResponse failed: {0}",n.message);var r=1;if(n.ResponseCode){var u=n.ResponseCode.toString();i.i().a()&&u==="ErrorInvalidOperation"?r=4:u==="ErrorMessageSizeExceeded"&&(r=3)}var f=_at.s.d(t)||_at.s.a(n);i.o(null,f,r)})}}}else{_j.e.a(_at.g.a,"Initializing.");this.e=1;this.bu();_j.m.a().a(_at.g.a,"ExecuteOpenFilePicker",this.r,0)}},o:function(n,t,i){this.B(n);this.y(t);this.x(i);this.e=3;this.bl().a();this.h=!1},bu:function(){var n=this.z;n.contentWindow.document.body.innerHTML="";this.b=n.contentWindow.document.createElement("form");this.b.method="POST";this.b.encType="multipart/form-data";this.b.encoding="multipart/form-data";this.bd(this.b);this.d=n.contentWindow.document.createElement("input");this.d.type="file";this.d.name="fileInput";_j.k.b(this.d,"change",this.s);this.b.appendChild(this.d)},bd:function(n){this.z.contentWindow.document.body.appendChild(n)},br:function(n){if(!this.h){this.h=!0;var t=this.d.value;if(!_j.h.a(t)){this.i().e(this.bQ(t));this.bg().a()}}},bQ:function(n){var t=n.lastIndexOf("\\");return n.substr(t+1)},be:function(){this.d.click()},bS:function(){this.k=!1;this.b.action=_g.C.h();this.w()},bR:function(){this.k=!0;this.b.action=_g.C.k();this.f("subscriptionId",this.V().o());this.w()},w:function(){_j.e.a(_at.g.a,"Uploading attachment via form submit.");this.f("parentItemId",this.j().Id);this.f("parentChangeKey",this.j().ChangeKey);this.f("isInline",this.i().a().toString());this.f("cancellationId",this.V().bN());this.f(_a.w.c(),_a.w.d());this.b.submit();this.e=2},f:function(n,t){var i=this.b.ownerDocument.createElement("input");i.type="hidden";i.name=n;i.value=t;this.b.appendChild(i)}};_at.F=function(n,t,i,r,u){this.p=Function.createDelegate(this,this.y);this.n=Function.createDelegate(this,this.w);this.o=Function.createDelegate(this,this.x);this.f=-1;this.a=n;this.k=u;u&&this.z(t,i,r);var f=this.B();_j.k.b(this.a,"load",this.o,"InlineImageAttachment");_j.k.b(this.a,"error",this.n,"InlineImageAttachment");!f&&this.c&&this.s()};_at.F.b=function(n,t){return t?n.getNamedItem("blockedimagesrc").value:n.getNamedItem("src").value};_at.F.a=function(n,t,i,r){var u=new _a.l;u.a("P",n);u.b("C",t);u.b("BL",i);r&&u.a("U",r);_a.b.c(_a.a.c,"ProxyExternalImg",u.toString(),0)};_at.F.c=function(n){return n.hasOwnProperty("data-imageproxyid")||n.hasOwnProperty("data-imageproxyendpoint")};_at.F.prototype={k:!1,j:null,a:null,e:null,g:0,l:null,i:!1,b:null,d:null,c:null,h:null,m:!1,F:function(){if(this.a.attributes.hasOwnProperty("blockedimagesrc")){this.a.attributes.removeNamedItem("blockedimagesrc");this.c?this.s():this.a.src=this.d}},dispose:function(){_j.k.c(this.a,"click","InlineImageAttachment");_j.k.c(this.a,"load","InlineImageAttachment");_j.k.c(this.a,"error","InlineImageAttachment");this.a=null;this.e=null;this.j=null;this.l=null;if(this.b){this.b.onreadystatechange=null;this.b.ontimeout=null;this.b=null}},z:function(n,t,i){if(_j.k.o(this.a,"a").length>0){this.k=!1;return}this.e=n;this.g=t;this.j=i;this.l=this.e[this.g];this.r()?this.e[this.g]=null:this.q()},B:function(){var n=this.a.attributes;var t=n.hasOwnProperty("blockedimagesrc");this.d=_at.F.b(n,t);if(!_at.i.d(this.d)){this.m=_at.F.c(n);this.m&&this.D(n,t)}return t},D:function(n,t){this.C(n,t);this.E(n)},C:function(n,t){t?n.hasOwnProperty("data-imageproxyendpoint")?this.c=n.getNamedItem("data-imageproxyendpoint").value:_j.e.c(_a.a.c,"Image proxy should be in use, but '{0}' attribute is null or empty","data-imageproxyendpoint"):this.c=this.a.src;n.removeNamedItem("data-imageproxyendpoint")},E:function(n){if(n.hasOwnProperty("data-imageproxyid")){var t=n.getNamedItem("data-imageproxyid").value;if(_j.h.a(t)){_j.e.b(_a.a.c,"Image proxy id attribute is empty.");this.h="EMPTY"}else this.h=t}else{_j.e.b(_a.a.c,"Image proxy id attribute is missing.");this.h="MISSING"}},s:function(){this.f=_a.L.b();this.a.src!==this.c&&(this.a.src=this.c)},v:function(n){this.b=new XMLHttpRequest;var i=this;this.b.ontimeout=function(){_j.e.a(_a.a.c,String.format("Image proxy timed out trying to fetch image at URL: {0}",i.d));_at.F.a(i.h,-1,i.f,i.d)};var t=this;this.b.onreadystatechange=function(){if(t.b.readyState===4){var n=t.b.status;_j.e.a(_a.a.c,String.format("Image proxy returned HTTP status code: {0}, status text: {1}, for image at URL: {2}",n,t.b.statusText,t.d));_at.F.a(t.h,n,t.f,t.d)}};this.b.open("GET",this.c,!0);this.b.timeout=15e3;this.b.send(null)},G:function(n,t,i){var r=this.e[this.g];if(r){r.ImageUrl=n;r.PhotoPageUrl=t;r.ThumbnailUrl=i}},A:function(){this.j&&this.j(this.e,this.g,!1,"InlineImageClicked")},y:function(n){n.a()-1||this.A()},x:function(n){if(this.c){this.f=_a.L.b()-this.f;_at.F.a(this.h,200,this.f,this.d)}if(this.k)if(this.r()){this.e[this.g]=null;this.t()}else{this.e[this.g]=this.l;this.q();var t=this.a.src;var r=this.a.getAttribute("data-downloadImage");var i=this.a.getAttribute("data-thumbnailImage");this.G(t,r||t,i||t)}},w:function(n){this.t();if(this.c){this.f=_a.L.b()-this.f;this.u(!1)}},u:function(n){_j.k.c(this.a,"error","InlineImageAttachment");this.v(n)},r:function(){var n=this.a;return!n||n.naturalWidth<50||n.naturalHeight<50},q:function(){if(!this.i){this.a.style.cursor="pointer";_j.k.b(this.a,"click",this.p,"InlineImageAttachment");this.i=!0}},t:function(){if(this.i){this.a.style.cursor="default";_j.k.c(this.a,"click","InlineImageAttachment");this.i=!1}}};_at.p=function(){};_at.p.registerInterface("_at.p");_at.ch=function(){};_at.ch.prototype={a:function(n,t){return String.format(_nbs.a.JL,n)},b:function(n,t){throw Error.notImplemented();}};_at.bz=function(n){this.b=Function.createDelegate(this,this.c);_at.bz.initializeBase(this,[n])};_at.bz.prototype={a:null,d:function(n){if(this.B){var t=this.B.a("MainPanel");if(t.Z())t.R();else{var i=this;t.fG(function(){t.R()})}}},f:function(n){},g:function(){},e:function(){},H:function(){_j.c.prototype.H.call(this);if(this.B){this.a=this.B.a("InfoMessageLabel");this.a.apcl("IsHidden",this.b)}},G:function(){_j.c.prototype.G.call(this);this.z.focus()},c:function(n,t){this.a.R()}};_at.bg=function(n){_at.bg.initializeBase(this,[n]);this.y("BreadCrumbsView")};_at.bg.prototype={b:null,a:null,c:null,f:function(n){if(this.c!==n){this.c=n;this.by("DisplayName")}return n},e:function(n){if(this.b!==n){this.b=n;this.by("BreadCrumbsSelectedItem")}return n},d:function(n){if(this.a!==n){this.a=n;this.by("BreadCrumbs")}return n}};_at.d=function(){};_at.d.z=function(){return _fm.d.a("cloud_40.png")};_at.d.w=function(){return _fm.d.a("c_wv.png")};_at.d.bY=function(){return _fm.d.a("c_mpg.png")};_at.d.cf=function(){return _fm.d.a("c_zip.png")};_at.d.u=function(){return _fm.d.a("c_access.png")};_at.d.cb=function(){return _fm.d.a("c_word.png")};_at.d.G=function(){return _fm.d.a("c_google_doc.png")};_at.d.bT=function(){return _fm.d.a("c_word_cloud_aw.png")};_at.d.br=function(){return _fm.d.a("c_google_doc_cloud.png")};_at.d.d=function(){return _fm.d.a("c_generic.png")};_at.d.p=function(){return _fm.d.a("c_generic_cloud_aw.png")};_at.d.o=function(){return _fm.d.a("c_onenote.png")};_at.d.T=function(){return _fm.d.a("c_notebook.png")};_at.d.W=function(){return _fm.d.a("c_pdf.png")};_at.d.Z=function(){return _fm.d.a("c_powerpoint.png")};_at.d.I=function(){return _fm.d.a("c_google_slide.png")};_at.d.bK=function(){return _fm.d.a("c_powerpoint_cloud_aw.png")};_at.d.bt=function(){return _fm.d.a("c_google_slide_cloud.png")};_at.d.bW=function(){return _fm.d.a("c_txt.png")};_at.d.bf=function(){return _fm.d.a("c_irm_msg.png")};_at.d.h=function(){return _fm.d.a("c_eml.png")};_at.d.ca=function(){return _fm.d.a("c_visio.png")};_at.d.bd=function(){return _fm.d.a("c_publisher.png")};_at.d.K=function(){return _fm.d.a("c_infopath.png")};_at.d.Q=function(){return _fm.d.a("c_lync.png")};_at.d.B=function(){return _fm.d.a("c_excel.png")};_at.d.H=function(){return _fm.d.a("c_google_sheet.png")};_at.d.bm=function(){return _fm.d.a("c_excel_cloud_aw.png")};_at.d.bs=function(){return _fm.d.a("c_google_sheet_cloud.png")};_at.d.bh=function(){return _fm.d.a("c_access_cloud_aw.png")};_at.d.s=function(){return _fm.d.a("c_onenote_cloud_aw.png")};_at.d.bE=function(){return _fm.d.a("c_notebook_cloud_aw.png")};_at.d.bH=function(){return _fm.d.a("c_pdf_cloud_aw.png")};_at.d.bi=function(){return _fm.d.a("c_wv_cloud_aw.png")};_at.d.bQ=function(){return _fm.d.a("c_mpg_cloud_aw.png")};_at.d.bV=function(){return _fm.d.a("c_zip_cloud_aw.png")};_at.d.bO=function(){return _fm.d.a("c_irm_msg_cloud_aw.png")};_at.d.bP=function(){return _fm.d.a("c_txt_cloud_aw.png")};_at.d.n=function(){return _fm.d.a("c_jpg.png")};_at.d.q=function(){return _fm.d.a("c_jpg_cloud_aw.png")};_at.d.y=function(){return _fm.d.a("c_bmp.png")};_at.d.bk=function(){return _fm.d.a("c_bmp_cloud_aw.png")};_at.d.F=function(){return _fm.d.a("c_gif.png")};_at.d.bq=function(){return _fm.d.a("c_gif_cloud_aw.png")};_at.d.Y=function(){return _fm.d.a("c_png.png")};_at.d.bJ=function(){return _fm.d.a("c_png_cloud_aw.png")};_at.d.bS=function(){return _fm.d.a("c_visio_cloud_aw.png")};_at.d.bN=function(){return _fm.d.a("c_publisher_cloud_aw.png")};_at.d.bx=function(){return _fm.d.a("c_infopath_cloud_aw.png")};_at.d.bC=function(){return _fm.d.a("c_lync_cloud_aw.png")};_at.d.r=function(){return _fm.d.a("c_msg_cloud_aw.png")};_at.d.e=function(){return _fm.d.a("c_msg.png")};_at.d.S=function(){return _fm.d.a("c_ndr.png")};_at.d.bD=function(){return _fm.d.a("c_ndr_cloud_aw.png")};_at.d.by=function(){return _fm.d.a("c_cal_cloud_aw.png")};_at.d.L=function(){return _fm.d.a("c_cal.png")};_at.d.bz=function(){return _fm.d.a("c_contact_cloud_aw.png")};_at.d.M=function(){return _fm.d.a("c_contact.png")};_at.d.bA=function(){return _fm.d.a("c_task_cloud_aw.png")};_at.d.N=function(){return _fm.d.a("c_task.png")};_at.d.bb=function(){return _fm.d.a("project_20.png")};_at.d.bc=function(){return _fm.d.a("c_project.png")};_at.d.bM=function(){return _fm.d.a("c_project_cloud_aw.png")};_at.d.j=function(){return _fm.d.a("c_folder_cloud_aw.png")};_at.d.t=function(){return _fm.d.a("dc-accdb_20.png")};_at.d.bg=function(){return _fm.d.a("dc-accdb-cloud_20.png")};_at.d.v=function(){return _fm.d.a("dc-aspx_20.png")};_at.d.J=function(){return _fm.d.a("c_html.png")};_at.d.bw=function(){return _fm.d.a("c_html_cloud.png")};_at.d.R=function(){return _fm.d.a("dc-mpg_20.png")};_at.d.x=function(){return _fm.d.a("dc-bmp_20.png")};_at.d.bj=function(){return _fm.d.a("dc-bmp-cloud_20.png")};_at.d.A=function(){return _fm.d.a("dc-docx_20.png")};_at.d.bl=function(){return _fm.d.a("dc-docx-cloud_20.png")};_at.d.C=function(){return _fm.d.a("dc-exe_20.png")};_at.d.D=function(){return _fm.d.a("c_exe.png")};_at.d.bn=function(){return _fm.d.a("c_exe_cloud.png")};_at.d.E=function(){return _fm.d.a("dc-gif_20.png")};_at.d.bp=function(){return _fm.d.a("dc-gif-cloud_20.png")};_at.d.O=function(){return _fm.d.a("dc-jpg_20.png")};_at.d.bB=function(){return _fm.d.a("dc-jpg-cloud_20.png")};_at.d.P=function(){return _fm.d.a("dc-lync_20.png")};_at.d.bX=function(){return _fm.d.a("dc-txt_20.png")};_at.d.f=function(){return _fm.d.a("dc-msg_20.png")};_at.d.U=function(){return _fm.d.a("dc-pblsh_20.png")};_at.d.bF=function(){return _fm.d.a("dc-pblsh-cloud_20.png")};_at.d.c=function(){return _fm.d.a("dc-one_20.png")};_at.d.g=function(){return _fm.d.a("dc-one-cloud_20.png")};_at.d.V=function(){return _fm.d.a("dc-pdf_20.png")};_at.d.bG=function(){return _fm.d.a("dc-pdf-cloud_20.png")};_at.d.X=function(){return _fm.d.a("dc-png_20.png")};_at.d.bI=function(){return _fm.d.a("dc-png-cloud_20.png")};_at.d.ba=function(){return _fm.d.a("dc-pptx_20.png")};_at.d.bL=function(){return _fm.d.a("dc-pptx-cloud_20.png")};_at.d.be=function(){return _fm.d.a("dc-rpmsg_20.png")};_at.d.bZ=function(){return _fm.d.a("dc-vsd_20.png")};_at.d.bR=function(){return _fm.d.a("dc-vsd-cloud_20.png")};_at.d.cc=function(){return _fm.d.a("dc-wv_20.png")};_at.d.cd=function(){return _fm.d.a("dc-xlsx_20.png")};_at.d.bU=function(){return _fm.d.a("dc-xlsx-cloud_20.png")};_at.d.ce=function(){return _fm.d.a("dc-zip_20.png")};_at.d.b=function(){return _fm.d.a("dc-generic_20.png")};_at.d.a=function(){return _fm.d.a("dc-generic-cloud_20.png")};_at.d.k=function(){return _fm.d.a("dc-gdoc_20.png")};_at.d.bo=function(){return _fm.d.a("dc-gdoc-cloud_20.png")};_at.d.l=function(){return _fm.d.a("dc-gsheet_20.png")};_at.d.bu=function(){return _fm.d.a("dc-gsheet-cloud_20.png")};_at.d.m=function(){return _fm.d.a("dc-gslide_20.png")};_at.d.bv=function(){return _fm.d.a("dc-gslide-cloud_20.png")};_at.d.i=function(){return _fm.b.a(_fm.a.S,"owa-color-folder-brown",_fm.WebfontSizes.a.d)};_at.m=function(n,t,i){_at.m.initializeBase(this,[n,t]);this.c=i;this.bn(32)};_at.m.prototype={c:null,b:null,a:!1,d:function(n){this.b!==n&&(this.b=n);return n},dx:function(n){if(this.w&&this.w.a)for(var u=this.a?0:-1,r=this.w.a,i=0;i<r.b();i++){var t=r.c(i);t&&t.bp()?t.A(-1):t&&t.A(u)}},iE:function(){if(this.b&&this.b.b){this.c&&this.c.c()&&this.c.c().e(0);if(this.bS()===this.cb){this.b.a();return}}_fce.a.prototype.iE.call(this)},cD:function(n){_j.i.prototype.cD.call(this,n);this.cH(null)}};_at.c=function(){};_at.c.n=function(){_at.c.g||(_at.c.g=new _at.c.b(_at.d.e(),_at.d.f(),_at.d.r(),_at.d.a()));return _at.c.g};_at.c.u=function(){_at.c.l||(_at.c.l=new _at.c.b(_at.d.N(),_at.d.b(),_at.d.bA(),_at.d.a()));return _at.c.l};_at.c.d=function(){_at.c.e||(_at.c.e=new _at.c.b(_at.d.L(),_at.d.b(),_at.d.by(),_at.d.a()));return _at.c.e};_at.c.m=function(){_at.c.j||(_at.c.j=new _at.c.b(_at.d.J(),_at.d.v(),_at.d.bw(),_at.d.a()));return _at.c.j};_at.c.q=function(){_at.c.f||(_at.c.f=new _at.c.b(_at.d.M(),_at.d.b(),_at.d.bz(),_at.d.a()));return _at.c.f};_at.c.t=function(){_at.c.k||(_at.c.k=new _at.c.b(_at.d.S(),_at.d.b(),_at.d.bD(),_at.d.a()));return _at.c.k};_at.c.r=function(){_at.c.h||(_at.c.h=new _at.c.b(_at.d.j(),_at.d.i(),_at.d.j(),_at.d.a()));return _at.c.h};_at.c.o=function(){if(!_at.c.c){_at.c.c={};_at.c.c["application/vnd.google-apps.document"]=new _at.c.b(_at.d.G(),_at.d.k(),_at.d.br(),_at.d.bo());_at.c.c["application/vnd.google-apps.spreadsheet"]=new _at.c.b(_at.d.H(),_at.d.l(),_at.d.bs(),_at.d.bu());_at.c.c["application/vnd.google-apps.presentation"]=new _at.c.b(_at.d.I(),_at.d.m(),_at.d.bt(),_at.d.bv());_at.c.c["application/onenote"]=new _at.c.b(_at.d.o(),_at.d.c(),_at.d.s(),_at.d.g())}return _at.c.c};_at.c.p=function(){if(!_at.c.a){_at.c.a={};var o=new _at.c.b(_at.d.u(),_at.d.t(),_at.d.bh(),_at.d.bg());_at.c.a[".accdb"]=o;_at.c.a[".accde"]=o;_at.c.a[".acs"]=o;_at.c.a[".mdb"]=o;var r=new _at.c.b(_at.d.B(),_at.d.cd(),_at.d.bm(),_at.d.bU());_at.c.a[".xlsx"]=r;_at.c.a[".xlsm"]=r;_at.c.a[".xlsb"]=r;_at.c.a[".xls"]=r;_at.c.a[".xltx"]=r;_at.c.a[".xltm"]=r;_at.c.a[".xlt"]=r;_at.c.a[".xlam"]=r;_at.c.a[".xla"]=r;_at.c.a[".ods"]=r;var t=new _at.c.b(_at.d.Z(),_at.d.ba(),_at.d.bK(),_at.d.bL());_at.c.a[".pptx"]=t;_at.c.a[".pptm"]=t;_at.c.a[".ppt"]=t;_at.c.a[".potx"]=t;_at.c.a[".potm"]=t;_at.c.a[".pot"]=t;_at.c.a[".ppsx"]=t;_at.c.a[".ppsm"]=t;_at.c.a[".pps"]=t;_at.c.a[".ppam"]=t;_at.c.a[".ppa"]=t;_at.c.a[".odp"]=t;var u=new _at.c.b(_at.d.cb(),_at.d.A(),_at.d.bT(),_at.d.bl());_at.c.a[".docx"]=u;_at.c.a[".docm"]=u;_at.c.a[".doc"]=u;_at.c.a[".dot"]=u;_at.c.a[".dotx"]=u;_at.c.a[".dotm"]=u;_at.c.a[".wps"]=u;_at.c.a[".odt"]=u;_at.c.a[".one"]=new _at.c.b(_at.d.o(),_at.d.c(),_at.d.s(),_at.d.g());_at.c.a[".onepkg"]=new _at.c.b(_at.d.T(),_at.d.c(),_at.d.bE(),_at.d.g());_at.c.a[".pdf"]=new _at.c.b(_at.d.W(),_at.d.V(),_at.d.bH(),_at.d.bG());var i=new _at.c.b(_at.d.w(),_at.d.cc(),_at.d.bi(),_at.d.a());_at.c.a[".wav"]=i;_at.c.a[".aiff"]=i;_at.c.a[".mp3"]=i;_at.c.a[".mp4"]=i;_at.c.a[".aac"]=i;_at.c.a[".wma"]=i;_at.c.a[".m4a"]=i;_at.c.a[".ogg"]=i;_at.c.a[".flac"]=i;_at.c.a[".ape"]=i;var n=new _at.c.b(_at.d.bY(),_at.d.R(),_at.d.bQ(),_at.d.a());_at.c.a[".mpg"]=n;_at.c.a[".avi"]=n;_at.c.a[".mov"]=n;_at.c.a[".wmv"]=n;_at.c.a[".3g2"]=n;_at.c.a[".3gp"]=n;_at.c.a[".asf"]=n;_at.c.a[".asx"]=n;_at.c.a[".flv"]=n;_at.c.a[".mp4"]=n;_at.c.a[".srt"]=n;_at.c.a[".swf"]=n;_at.c.a[".vob"]=n;_at.c.a[".zip"]=new _at.c.b(_at.d.cf(),_at.d.ce(),_at.d.bV(),_at.d.a());_at.c.a[".rpmsg"]=new _at.c.b(_at.d.bf(),_at.d.be(),_at.d.bO(),_at.d.a());var s=new _at.c.b(_at.d.bW(),_at.d.bX(),_at.d.bP(),_at.d.a());_at.c.a[".txt"]=s;_at.c.a[".rtf"]=s;var f=new _at.c.b(_at.d.n(),_at.d.O(),_at.d.q(),_at.d.bB());_at.c.a[".jpg"]=f;_at.c.a[".jpeg"]=f;_at.c.a[".jpe"]=f;_at.c.a[".jfif"]=f;_at.c.a[".ico"]=f;_at.c.a[".tif"]=f;_at.c.a[".tiff"]=f;_at.c.a[".gif"]=new _at.c.b(_at.d.F(),_at.d.E(),_at.d.bq(),_at.d.bp());_at.c.a[".png"]=new _at.c.b(_at.d.Y(),_at.d.X(),_at.d.bJ(),_at.d.bI());_at.c.a[".bmp"]=new _at.c.b(_at.d.y(),_at.d.x(),_at.d.bk(),_at.d.bj());var e=new _at.c.b(_at.d.ca(),_at.d.bZ(),_at.d.bS(),_at.d.bR());_at.c.a[".vdx"]=e;_at.c.a[".vsd"]=e;_at.c.a[".vsdx"]=e;_at.c.a[".vsl"]=e;_at.c.a[".vss"]=e;_at.c.a[".vst"]=e;var l=new _at.c.b(_at.d.bc(),_at.d.bb(),_at.d.bM(),_at.d.a());_at.c.a[".mpp"]=l;var c=new _at.c.b(_at.d.bd(),_at.d.U(),_at.d.bN(),_at.d.bF());_at.c.a[".pub"]=c;_at.c.a[".xsn"]=new _at.c.b(_at.d.K(),_at.d.b(),_at.d.bx(),_at.d.a());var h=new _at.c.b(_at.d.Q(),_at.d.P(),_at.d.bC(),_at.d.a());_at.c.a[".lync"]=h;_at.c.a[".msg"]=_at.c.n();_at.c.a[".eml"]=new _at.c.b(_at.d.h(),_at.d.f(),_at.d.h(),_at.d.a());_at.c.a[".ics"]=_at.c.d();_at.c.a[".ical"]=_at.c.d();_at.c.a[".icalendar"]=_at.c.d();_at.c.a[".vcs"]=_at.c.d();_at.c.a[".htm"]=_at.c.m();_at.c.a[".html"]=_at.c.m();_at.c.a[".mht"]=_at.c.m();_at.c.a[".exe"]=new _at.c.b(_at.d.D(),_at.d.C(),_at.d.bn(),_at.d.a())}return _at.c.a};_at.c.s=function(){_at.c.i||(_at.c.i=new _at.c.b(_at.d.d(),_at.d.b(),_at.d.p(),_at.d.a()));return _at.c.i};_at.c.prototype={c:function(n){return n?n.toLowerCase()in _at.c.p():!1},b:function(n,t,i,r){return this.g(n,t,r,!1)},a:function(n,t,i,r){return this.g(n,t,r,i)},d:function(n,t,i){return this.h(n,t,i)},e:function(n,t){return this.f(_at.c.r(),t,n)},h:function(n,t,i){var r=null;switch(n){case 1:r=_at.c.n();break;case 2:r=_at.c.u();break;case 3:case 5:case 6:r=_at.c.d();break;case 4:r=_at.c.q();break;case 7:r=_at.c.t();break}return this.f(r,i,t)},g:function(n,t,i,r){var u=null;t=t?t.toLowerCase():null;!_j.h.a(t)&&t in _at.c.o()?u=_at.c.o()[t]:_j.h.a(n)||(u=_at.c.p()[n.toLowerCase()]);return this.f(u,i,r)},f:function(n,t,i){var r=null;n||(n=_at.c.s());switch(t){case 1:r=i?n.c:n.a;break;case 2:r=i?n.d:n.b;break}return r}};_at.c.b=function(n,t,i,r){this.a=n;this.b=t;this.c=i;this.d=r};_at.c.b.prototype={a:null,b:null,c:null,d:null};_at.cj=function(){};_at.cj.prototype={imageAttachmentNotLoaded:1,attachmentSize:2,attachmentDownloadingProgress:3,attachmentOverlay:4,attachmentWaitingDownloadText:5,attachmentNotDownloadedOverlay:6};_at.cj.registerEnum("_at.cj",!1);_at.bA=function(){this.c=new _at.c};_at.bA.prototype={c:null,a:function(n,t){if(_gg.i.isInstanceOfType(n))return _at.d.i();if(_gg.h.isInstanceOfType(n)){var i=n.bH.MimeType;if(!_j.h.a(i))if(i==="application/vnd.google-apps.document")return _at.d.k();else if(i==="application/vnd.google-apps.spreadsheet")return _at.d.l();else if(i==="application/vnd.google-apps.presentation")return _at.d.m();else if(i==="application/onenote")return _at.d.c();var u=n.bH.Name;if(u){var f=_a.bc.a(u);var e=_at.i.e(n);var r=this.c.a(f,i,e,2);if(r)return r}return _at.d.b()}return _y.e.a()},b:function(n,t){throw Error.notImplemented();}};_at.ci=function(){};_at.ci.prototype={a:function(n,t){if(_gg.b.isInstanceOfType(n)){var i=n;var u=i.bH.Name;var r=_gg.i.isInstanceOfType(i)||i.a()===1;return String.format(r?_nbs.a.Nm:_nbs.a.IT,u,"")}return""},b:function(n,t){throw Error.notImplemented();}};_at.bB=function(){};_at.bB.prototype={a:function(n,t){_j.h.a(t)&&Error.argument("parameter","Parameter to BooleanToStringConverter must be a non-empty string");var f=t;var i=f.split("|");var u=i.length>0?i[0]:"";var r=i.length>1?i[1]:"";return Boolean.isInstanceOfType(n)&&n?u:r},b:function(n,t){throw Error.notImplemented();}};_at.ck=function(){};_at.ck.prototype={a:function(n,t){var i=n;var r=!0;try{var u=_j.u.d(_at.cj,t.toString());switch(u){case 1:i&&i!==1||(r=!1);break;case 2:i&&i!==1&&i!==4||(r=!1);break;case 3:i===3&&(r=!1);break;case 4:(i===3||i===2)&&(r=!1);break;case 5:i===2&&(r=!1);break;case 6:i!==1&&i||(r=!1);break}}catch(f){r=!0}return r},b:function(n,t){throw Error.notImplemented();}};_at.a=function(){};_at.a.$$cctor=function(){_at.a._I()};_at.a.K=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <div autoid=\"_at_1\" class='_at_b _at_c'> <div class='_at_d _at_e ms-font-m ms-font-color-neutralPrimary ms-font-weight-semilight'> <span class='_at_f ms-font-color-neutralSecondary'></span> <span autoid=\"_at_2\" class='_at_h'></span> </div> </div> </div><div>   <div class='_at_j'> <div> <div></div> </div> </div> </div><div><div></div></div><div> <div autoid=\"_at_0\" class='_at_6 ms-font-s ms-font-weight-semilight ms-font-color-neutralPrimary'>  <div class='ms-bg-color-white _at_k'> <span class='_at_2 ms-font-xl ms-font-weight-semilight ms-font-color-neutralPrimary'></span> </div> <div class='ms-bg-color-white _at_k'>  <div class='_at_7'> <div></div> <div class='_at_8'></div> </div> </div>  <div> </div> <div>  <span class='_at_9 ms-font-color-neutralSecondary ms-bg-color-neutralLighter'></span> <div>  <div class='_at_a'> <div></div> </div> </div> </div>  <div class='_at_l'> <div class='_at_5'>  <div class='_at_i ms-font-m ms-font-weight-semilight ms-font-color-neutralPrimary'> <span></span> <span class='ms-font-weight-semibold'></span> </div> <button autoid=\"_at_3\" type='button' class='_at_3 _at_a ms-bg-color-themePrimary ms-font-m ms-font-weight-semibold'></button> <button autoid=\"_at_4\" type='button' class='_at_3 _at_a ms-font-m ms-font-weight-semibold'></button> </div> </div> </div> </div><div> <button type='button' class='_at_p'></button> <div class='_at_m ms-font-s ms-font-weight-regular ms-font-color-neutralSecondary'> <span class='_at_n ms-font-l ms-font-weight-semilight'></span> <span class='_at_n'></span> <span class='_at_n _at_o'></span> </div> </div><div> <span autoid=\"_at_6\"></span> </div><div> <span> <span class='_at_v'></span> <button type='button' class='_at_s ms-font-m ms-font-weight-semilight ms-font-color-neutralPrimary'></button> </span> </div><div>   <div></div> </div><div><div class='_at_w'></div></div><div> <div class='_at_r _at_x'> <span class='_at_w _at_t ms-font-m ms-font-weight-semilight ms-font-color-neutralPrimary'></span> <div autoid=\"_at_5\" class='_at_w _at_t'></div> </div> </div>";_j.i.a().appendChild(n);return n};_at.a.t=function(n){return n.V()};_at.a.be=function(n){return n.e()};_at.a.bd=function(n){return n.eu()};_at.a.bC=function(n){return n.bH.Name};_at.a.bB=function(n){return n.f()};_at.a.E=function(n){return n.m};_at.a.bj=function(n){return n.B()};_at.a.f=function(n){return n.a};_at.a.bq=function(n){return n.f};_at.a.bD=function(n){return n.bH.DisplayName};_at.a.bl=function(n){return n.g};_at.a.F=function(n){return n.b};_at.a.bk=function(n){return n.e};_at.a.bn=function(n){return n.i};_at.a.v=function(n){return n.l};_at.a.bp=function(n){return n.b};_at.a.bx=function(n){return n.bu};_at.a.u=function(n){return n.j};_at.a.bo=function(n){return n.a};_at.a.e=function(n){return n.X};_at.a.Y=function(n){return _fce.a.isInstanceOfType(n)?n.cJ():null};_at.a.Z=function(n){return _fce.a.isInstanceOfType(n)?n.cK():null};_at.a.W=function(n){return _fce.a.isInstanceOfType(n)?n.cX():null};_at.a.X=function(n){return _fce.a.isInstanceOfType(n)?n.de():null};_at.a.bm=function(n){return n.c};_at.a.C=function(n){return n.b};_at.a.bi=function(n){return n.b};_at.a.D=function(n){return n.e};_at.a.bh=function(n){return n.d};_at.a.bg=function(n){return n.g()};_at.a.o=function(n){return n.e()};_at.a.bu=function(n){return n.c};_at.a.V=function(n){return n.E()};_at.a.bt=function(n){return n.a};_at.a.z=function(n){return _fce.a.isInstanceOfType(n)?n.dI():null};_at.a.A=function(n){return _fce.a.isInstanceOfType(n)?n.dJ():null};_at.a.T=function(n){return _fce.a.isInstanceOfType(n)?n.dH():null};_at.a.U=function(n){return _fce.a.isInstanceOfType(n)?n.fy():null};_at.a.g=function(n,t){n.D(t)};_at.a.p=function(n,t){n.Q(t)};_at.a.B=function(n,t){n.a(t)};_at.a.d=function(n,t){n.a(t)};_at.a.bf=function(n,t){n.bk(t)};_at.a.b=function(n,t){n.l=t};_at.a.w=function(n,t){n.j(t)};_at.a.bw=function(n,t){n.f(t)};_at.a.br=function(n,t){n.P(t)};_at.a.G=function(n,t){n.e(t)};_at.a.bv=function(n,t){n.d(t)};_at.a.S=function(n,t){n.b(t)};_at.a.R=function(n,t){n.c(t)};_at.a.h=function(n,t){n.K(t)};_at.a.bz=function(n,t){n.cV(t)};_at.a.bs=function(n,t){n.y(t)};_at.a.by=function(n,t){n.dj(t)};_at.a.bb=function(n,t){n.cm=t};_at.a.bA=function(n,t){n.dt(t)};_at.a.y=function(n,t){n.k(t)};_at.a.s=function(n,t){n.T(t)};_at.a.O=function(n,t){n.l(t)};_at.a.N=function(n,t){n.m(t)};_at.a.L=function(n,t){n.Q(t)};_at.a.Q=function(n,t){n.f(t)};_at.a.M=function(n,t){n.c(t)};_at.a.P=function(n,t){n.e(t)};_at.a.bc=function(n,t){n.bg(t)};_at.a.ba=function(n,t){n.bl(t)};_at.a.I=function(){_at.a.l||(_at.a.l=new _at.ci);return _at.a.l};_at.a.J=function(){_at.a.m||(_at.a.m=new _at.bA);return _at.a.m};_at.a.H=function(){_at.a.j||(_at.a.j=new _fc.B);return _at.a.j};_at.a.x=function(){_at.a.k||(_at.a.k=new _fc.l);return _at.a.k};_at.a.q=function(){_at.a.i||(_at.a.i=new _fc.k);return _at.a.i};_at.a.r=function(){_at.a.n||(_at.a.n=new _at.bB);return _at.a.n};_at.a._I=function(){var f="AttachmentsFolderPickerPanelView._tid1._tid2";new _j.d(f,function(){_at.a.a[f]===undefined&&(_at.a.a[f]=[[[-1,4,null,null,null,"AriaRole",null,_at.a.g,0,null,null,0,44],[-1,1,["DataContext"],[_at.a.t],null,"AriaLabel",null,_at.a.p,1,_at.a.I(),null,null],[-1,5,["IsSelected"],[_at.a.be],null,"ms-bg-color-themeLight",null,null,1,null,null,null],[-1,5,["IsItemHoveredAndIsNotSelected"],[_at.a.bd],null,"ms-bg-color-neutralLight",null,null,1,null,null,null]],[[-1,1,["DataContext"],[_at.a.t],null,"Id",null,_at.a.B,1,_at.a.J(),null,null],[-1,5,["DataContext"],[_at.a.t],null,"_at_g",null,null,1,_at.a.H(),_gg.i,null]],[[-1,0,["Name"],[_at.a.bC],null,"Text",null,_at.a.d,1,null,null,null],[-1,0,["GetNameTitle"],[_at.a.bB],null,"Title",null,_at.a.bf,1,null,null,null]]]);var n=_at.a.c.childNodes[0].cloneNode(!0);var i=new _fc.a(_j.a.a(n,[0,0,1]));var r=new _fc.d(_j.a.a(n,[0,0,0]),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));var t=new _j.i(n.children[0]);return new _j.a(n,[t,r,i]).l({MainItemContainer:t}).c(t)},"",_gg.b,_fce.e,function(n){return new _fce.e(n)},!1,!0,!1,0,_at.a.a);var u="AttachmentsFolderPickerPanelView._tid1";new _j.d(u,function(){_at.a.a[u]===undefined&&(_at.a.a[u]=[null,null,null]);var n=_at.a.c.childNodes[1].cloneNode(!0);var i=new _fce.d(_j.a.a(n,[0,0,0]));var r=new _j.i(_j.a.a(n,[0,0]));var t=new _fce.g(n.children[0],_j.b.Instance.a(_j.p),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_j.j));t.b=!0;return new _j.a(n,[t,r,i]).l({ScrollRegion:t,ElementsCanvas:r,ListPanel:i})},"",_at.X,_b.q,function(n){return new _b.q(n,1,_j.b.Instance.a(_y.a),_j.b.Instance.a(_j.j),_j.b.Instance.a(_a.I),_j.b.Instance.a(_j.o),_j.b.Instance.a(_a.e),_j.b.Instance.a(_j.cd.$$(_j.t)))},!1,!0,!1,0,_at.a.a);var o="AttachmentsFolderPickerPanelView";new _j.d(o,function(){_at.a.a[o]===undefined&&(_at.a.a[o]=[[[-1,4,null,null,null,"AriaRole",null,_at.a.g,0,null,null,0,5],[-1,4,null,null,null,"AriaLabel",null,_at.a.p,0,null,null,null,_nbs.a.UH]],null,[[-1,0,["PanelTitleText"],[_at.a.bj],null,"Text",null,_at.a.d,1,null,null,null]],null,[[-1,0,["DataProviderFoldersViewModel","SelectedDataProvider","DisplayName"],[_at.a.f,_at.a.bq,_at.a.bD],null,"DisplayName",null,_at.a.bw,1,null,null,null],[-1,0,["DataProviderFoldersViewModel","BreadCrumbsSelectedItem"],[_at.a.f,_at.a.bl],_at.a.br,"BreadCrumbsSelectedItem",_at.a.F,_at.a.G,2,null,null,null],[-1,0,["DataProviderFoldersViewModel","BreadCrumbs"],[_at.a.f,_at.a.bk],null,"BreadCrumbs",null,_at.a.bv,1,null,null,null]],[[-1,4,null,null,null,"SpinnerSize",null,_at.a.S,0,null,null,0,0],[-1,0,["DataProviderFoldersViewModel","IsDataInProgress"],[_at.a.f,_at.a.bn],null,"IsBusy",null,_at.a.R,1,null,null,!1]],null,null,[[-1,0,["DataProviderFoldersViewModel","InfoMessage"],[_at.a.f,_at.a.v],null,"Text",null,_at.a.d,1,null,null,null],[-1,0,["DataProviderFoldersViewModel","InfoMessage"],[_at.a.f,_at.a.v],null,"IsHidden",null,_at.a.h,1,_at.a.x(),null,!0]],[[-1,0,["DataProviderFoldersViewModel","InfoMessage"],[_at.a.f,_at.a.v],null,"IsHidden",null,_at.a.h,1,new _j.r([_at.a.x(),_at.a.q()],[null,null]),null,!0]],null,[[-1,4,null,null,null,"AriaRole",null,_at.a.g,0,null,null,0,43],[-1,4,null,null,null,"AriaLabel",null,_at.a.p,0,null,null,null,_nbs.a.Cz],[-1,4,null,null,null,"SelectionMode",null,_at.a.bz,0,null,null,0,2],[-1,0,["DataProviderFoldersViewModel","SelectedAttachmentDataProviderItems"],[_at.a.f,_at.a.bp],_at.a.bs,"SelectedItems",_at.a.bx,_at.a.by,2,null,null,null],[-1,0,["SelectAttachmentDataProviderItemCommand"],[_at.a.u],null,"OnItemClickCommand",null,_at.a.bb,0,null,null,null],[-1,0,["DataProviderFoldersViewModel","ItemsTable"],[_at.a.f,_at.a.bo],null,"TableView",null,_at.a.bA,1,null,null,null]],null,null,[[-1,4,null,null,null,"Text",null,_at.a.d,0,null,null,null,_nbs.a.Vj]],[[-1,0,["DataProviderFoldersViewModel","CurrentFolder","Name"],[_at.a.f,_at.a.bm,_at.a.C],null,"Text",null,_at.a.d,1,null,null,null]],[[-1,4,null,null,null,"Text",null,_at.a.y,0,null,null,null,_nbs.a.S],[-1,0,["OnMoveButtonClickCommand"],[_at.a.bi],null,"ClickCommand",null,_at.a.s,0,null,null,null]],[[-1,4,null,null,null,"Text",null,_at.a.y,0,null,null,null,_nbs.a.RF],[-1,0,["CloseCommand"],[_at.a.E],null,"ClickCommand",null,_at.a.s,1,null,null,null]]]);var t=_at.a.c.childNodes[3].cloneNode(!0);var c=new _fc.b(_j.a.a(t,[0,4,0,2]));c.f("ms-bg-color-neutralLighter");c.c("ms-bg-color-neutralLight");c.h("_at_4");var h=new _fc.b(_j.a.a(t,[0,4,0,1]));h.h("_at_4");h.g("ms-bg-color-neutralLighter ms-font-color-neutralTertiary");h.f("ms-font-color-white");var ot=new _fc.a(_j.a.a(t,[0,4,0,0,1]));var st=new _fc.a(_j.a.a(t,[0,4,0,0,0]));var b=new _j.i(_j.a.a(t,[0,4,0]));b.A(-1);var tt=new _b.m(_j.b.Instance.a(_b.i),_j.b.Instance.a(_j.o));tt.U(_j.f.b(753,null,null,null,"Priority",null,_at.a.w,0,null,null,0));b.C([tt]);var s=new _j.i(_j.a.a(t,[0,4]));s.eK(_fce.c.a,2);s.eK(_fce.c.b,0);s.z.parentNode.removeChild(s.z);var n=new _b.q(_j.a.a(t,[0,3,1,0,0]),1,_j.b.Instance.a(_y.a),_j.b.Instance.a(_j.j),_j.b.Instance.a(_a.I),_j.b.Instance.a(_j.o),_j.b.Instance.a(_a.e),_j.b.Instance.a(_j.cd.$$(_j.t)));n.eK(_fce.c.a,4);n.A(-1);n.ck(30);n.cF(1);n.dO(!0);n.bR=!0;n.bd=!0;n.be("div");n.bs=!0;n.fM=!0;n.mc(!1);var ut=new _fc.g;var k=new _fc.c;k.W(_j.f.a(["ContextParent","SelectNextItemCommand"],[_at.a.e,_at.a.Y],null,"Command",null,_at.a.b,1));k.j("DOWNARROW");var w=new _fc.c;w.W(_j.f.a(["ContextParent","SelectPreviousItemCommand"],[_at.a.e,_at.a.Z],null,"Command",null,_at.a.b,1));w.j("UPARROW");var d=new _fc.c;d.W(_j.f.a(["ContextParent","SelectFirstItemCommand"],[_at.a.e,_at.a.W],null,"Command",null,_at.a.b,1));d.j("HOME");var g=new _fc.c;g.W(_j.f.a(["ContextParent","SelectLastItemCommand"],[_at.a.e,_at.a.X],null,"Command",null,_at.a.b,1));g.j("END");var nt=new _fc.c;nt.U(_j.f.a(["SelectAttachmentDataProviderItemCommand"],[_at.a.u],null,"Command",null,_at.a.b,1));nt.j("ENTER");var a=new _fc.c;a.U(_j.f.a(["SelectAttachmentDataProviderItemCommand"],[_at.a.u],null,"Command",null,_at.a.b,1));a.j("SPACE");ut.a([k,w,d,g,nt,a]);n.C([ut]);n.bc(function(){var t=_at.a.c.childNodes[2].cloneNode(!0).childNodes[0];var n=new _fce.e(t);n.y("AttachmentsFolderPickerPanelView._tid1._tid2");return n});n.y("AttachmentsFolderPickerPanelView._tid1");n.z.parentNode.removeChild(n.z);var l=new _fce.c(_j.a.a(t,[0,3,1,0]),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));l.b(2);var et=new _j.i(_j.a.a(t,[0,3,1]));var v=new _fc.a(_j.a.a(t,[0,3,0]));v.A(0);var f=new _j.i(_j.a.a(t,[0,3]));f.eK(_fce.c.a,4);f.A(-1);var ft=new _b.m(_j.b.Instance.a(_b.i),_j.b.Instance.a(_j.o));ft.U(_j.f.b(752,null,null,null,"Priority",null,_at.a.w,0,null,null,0));f.C([ft]);f.z.parentNode.removeChild(f.z);var e=new _j.i(_j.a.a(t,[0,2]));e.eK(_fce.c.a,2);e.eK(_fce.c.b,130);e.z.parentNode.removeChild(e.z);var y=new _fce.h(_j.a.a(t,[0,1,0,1]),_j.b.Instance.a(_j.p),_j.b.Instance.a(_ff.a));y.A(-1);y.a=1e3;var ct=new _at.bg(_j.a.a(t,[0,1,0,0]));var r=new _j.i(_j.a.a(t,[0,1]));r.eK(_fce.c.a,0);r.eK(_fce.c.b,55);r.A(-1);var it=new _b.m(_j.b.Instance.a(_b.i),_j.b.Instance.a(_j.o));it.U(_j.f.b(751,null,null,null,"Priority",null,_at.a.w,0,null,null,0));r.C([it]);r.z.parentNode.removeChild(r.z);var ht=new _fc.a(_j.a.a(t,[0,0,0]));var u=new _j.i(_j.a.a(t,[0,0]));u.eK(_fce.c.a,0);u.eK(_fce.c.b,60);u.A(-1);u.z.parentNode.removeChild(u.z);var i=new _fce.c(t.children[0],_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));i.b(2);i.A(0);var rt=new _fc.g;var p=new _fc.c;p.U(_j.f.a(["CloseCommand"],[_at.a.E],null,"Command",null,_at.a.b,1));p.j("ESC");rt.a([p]);i.C([rt]);i.a.a(u);i.a.a(r);i.a.a(e);i.a.a(f);l.a.a(n);i.a.a(s);return new _j.a(t,[i,u,ht,r,ct,y,e,f,v,et,l,n,s,b,st,ot,h,c]).l({MainPanel:i,InfoMessageLabel:v,FolderListView:n}).c(n)},"",_at.X,_at.bz,function(n){return new _at.bz(n)},!0,!1,!1,0,_at.a.a);var e="AttachmentOptionsIntroductionPeekView";new _j.d(e,function(){_at.a.a[e]===undefined&&(_at.a.a[e]=[[[-1,4,null,null,null,"ImageId",null,_at.a.O,0,null,null,null,_n.b.cB()],[-1,4,null,null,null,"HoveredImageId",null,_at.a.N,0,null,null,null,_n.b.dh()],[-1,4,null,null,null,"AriaLabel",null,_at.a.L,0,null,null,null,_u.R.Bu],[-1,0,["ShowTitle"],[_at.a.D],null,"IsHidden",null,_at.a.h,1,_at.a.q(),null,!0],[-1,0,["CloseCommand"],[_at.a.bh],null,"ClickCommand",null,_at.a.s,1,null,null,null]],[[-1,4,null,null,null,"Text",null,_at.a.d,0,null,null,null,_nbs.a.qB],[-1,0,["ShowTitle"],[_at.a.D],null,"IsHidden",null,_at.a.h,1,_at.a.q(),null,!0]],[[-1,4,null,null,null,"Text",null,_at.a.d,0,null,null,null,_nbs.a.WV]],[[-1,4,null,null,null,"Text",null,_at.a.d,0,null,null,null,_nbs.a.mE]]]);var n=_at.a.c.childNodes[4].cloneNode(!0);var r=new _fc.a(_j.a.a(n,[1,2]));var u=new _fc.a(_j.a.a(n,[1,1]));var t=new _fc.a(_j.a.a(n,[1,0]));var i=new _fc.b(n.children[0]);return new _j.a(n,[i,t,u,r])},"",_at.bd,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_at.a.a);var t="BreadCrumbsView._tid3._tid4._tid5";new _j.d(t,function(){_at.a.a[t]===undefined&&(_at.a.a[t]=[[[-1,4,null,null,null,"AriaRole",null,_at.a.g,0,null,null,0,44],[-1,0,["Name"],[_at.a.C],null,"Text",null,_at.a.d,1,null,null,null]]]);var n=_at.a.c.childNodes[5].cloneNode(!0);var i=new _fc.a(n.children[0]);return new _j.a(n,[i])},"",_at.v,_fc.b,function(n){return new _fc.b(n)},!1,!0,!1,0,_at.a.a);var n="BreadCrumbsView._tid3._tid4";new _j.d(n,function(){_at.a.a[n]===undefined&&(_at.a.a[n]=[null,[[-1,4,null,null,null,"Id",null,_at.a.B,0,null,null,null,_n.b.W()],[-1,0,["ShouldHideChevron"],[_at.a.bg],null,"IsHidden",null,_at.a.h,1,null,null,!0]],[[-1,1,["IsSelected"],[_at.a.o],null,"RestCssClass",null,_at.a.Q,1,_at.a.r(),"ms-font-color-neutralSecondary|ms-font-color-neutralPrimary",null],[-1,1,["IsSelected"],[_at.a.o],null,"HoveredCssClass",null,_at.a.M,1,_at.a.r(),"ms-font-color-neutralSecondary|ms-font-color-themePrimary",null],[-1,1,["IsSelected"],[_at.a.o],null,"PressedCssClass",null,_at.a.P,1,_at.a.r(),"ms-font-color-neutralSecondary|ms-font-color-black",null],[-1,5,["IsSelected"],[_at.a.o],null,"_at_u",null,null,1,null,null,null]]]);var i=_at.a.c.childNodes[6].cloneNode(!0);var t=new _fc.b(_j.a.a(i,[0,1]));t.A(-1);t.y("BreadCrumbsView._tid3._tid4._tid5");var u=new _fc.d(_j.a.a(i,[0,0]),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));var r=new _j.i(i.children[0]);return new _j.a(i,[r,u,t]).l({MainItemContainer:r,FocusControl:t})},"",_at.v,_fce.n,function(n){return new _fce.n(n)},!1,!0,!1,0,_at.a.a);var r="BreadCrumbsView._tid3";new _j.d(r,function(){_at.a.a[r]===undefined&&(_at.a.a[r]=[null]);var t=_at.a.c.childNodes[7].cloneNode(!0);var n=new _fce.d(t.children[0]);return new _j.a(t,[n]).l({ListPanel:n})},"",Object,_at.m,function(n){return new _at.m(n,_j.b.Instance.a(_y.a),_j.b.Instance.a(_b.i))},!1,!0,!1,0,_at.a.a);var i="BreadCrumbsView";new _j.d(i,function(){_at.a.a[i]===undefined&&(_at.a.a[i]=[[[-1,1,["DisplayName"],[_at.a.bu],null,"Text",null,_at.a.d,1,null,null,null]],[[-1,4,null,null,null,"AriaLabel",null,_at.a.p,0,null,null,null,_nbs.a.wX],[-1,4,null,null,null,"AriaRole",null,_at.a.g,0,null,null,0,43],[-1,1,["BreadCrumbsSelectedItem"],[_at.a.F],_at.a.G,"SelectedItem",_at.a.V,_at.a.bc,2,null,null,null],[-1,1,["BreadCrumbs"],[_at.a.bt],null,"DataSource",null,_at.a.ba,1,null,null,null]]]);var e=_at.a.c.childNodes[9].cloneNode(!0);var n=new _at.m(_j.a.a(e,[0,1]),_j.b.Instance.a(_y.a),_j.b.Instance.a(_b.i));n.a=!1;n.bd=!0;n.A(0);n.be("span");var h=new _fc.g;var o=new _fc.c;o.W(_j.f.a(["ContextParent","FocusOnNextItemCommand"],[_at.a.e,_at.a.z],null,"Command",null,_at.a.b,1));o.j("RIGHTARROW");var s=new _fc.c;s.W(_j.f.a(["ContextParent","FocusOnPreviousItemCommand"],[_at.a.e,_at.a.A],null,"Command",null,_at.a.b,1));s.j("LEFTARROW");var r=new _fc.c;r.W(_j.f.a(["ContextParent","FocusOnPreviousItemCommand"],[_at.a.e,_at.a.A],null,"Command",null,_at.a.b,1));r.j("UPARROW");var t=new _fc.c;t.W(_j.f.a(["ContextParent","FocusOnNextItemCommand"],[_at.a.e,_at.a.z],null,"Command",null,_at.a.b,1));t.j("DOWNARROW");var f=new _fc.c;f.W(_j.f.a(["ContextParent","FocusOnFirstItemCommand"],[_at.a.e,_at.a.T],null,"Command",null,_at.a.b,1));f.j("HOME");var u=new _fc.c;u.W(_j.f.a(["ContextParent","FocusOnLastItemCommand"],[_at.a.e,_at.a.U],null,"Command",null,_at.a.b,1));u.j("END");h.a([o,s,r,t,f,u]);n.C([h]);n.bc(function(){var t=_at.a.c.childNodes[8].cloneNode(!0).childNodes[0];var n=new _fce.n(t);n.b(!1);n.y("BreadCrumbsView._tid3._tid4");return n});n.y("BreadCrumbsView._tid3");var c=new _fc.a(_j.a.a(e,[0,0]));return new _j.a(e,[c,n])},"",Object,_at.bg,function(n){return new _at.bg(n)},!0,!1,!1,0,_at.a.a)};_at.bh.registerClass("_at.bh");_at.cl.registerClass("_at.cl",_h.fN);AttachmentsComponent.registerClass("AttachmentsComponent",null,_a.kh,_j.ce);_at.z.registerClass("_at.z",null,_y.bJ);_at.bS.registerClass("_at.bS",_h.fN,_a.fF);_at.v.registerClass("_at.v",_g.m);_at.bQ.registerClass("_at.bQ",_h.t);_at.bP.registerClass("_at.bP",_at.bQ);_at.bl.registerClass("_at.bl",_h.dZ.$$(_at.bQ));_at.k.registerClass("_at.k",null,_at.U,_db.bI);_at.q.registerClass("_at.q",null,_y.cO);_at.G.registerClass("_at.G",null,_h.du);_at.B.registerClass("_at.B",_h.fN,_a.fF);_at.bn.registerClass("_at.bn",_h.fN,_a.fF);_at.x.c.registerClass("_at.x.c");_at.f.E.registerClass("_at.f.E");_at.f.A.registerClass("_at.f.A");_at.f.z.registerClass("_at.f.z");_at.f.G.registerClass("_at.f.G");_at.f.F.registerClass("_at.f.F");_at.D.registerClass("_at.D",_h.fN,_a.fF);_at.bG.registerClass("_at.bG",_h.fN);_at.bC.registerClass("_at.bC",_h.fN,_a.fF);_at.bD.registerClass("_at.bD",_h.fN,_a.fF);_at.bE.registerClass("_at.bE",_h.fN,_a.fF);_at.bF.registerClass("_at.bF",_h.fN,_a.fF);_at.bH.registerClass("_at.bH",_h.fN);_at.bI.registerClass("_at.bI",_h.fN);_at.bJ.registerClass("_at.bJ",_h.fN);_at.o.registerClass("_at.o",_h.dx.$$(_gg.gd,_gg.fQ));_at.bK.registerClass("_at.bK",_at.o);_at.bb.registerClass("_at.bb",_h.fN,_a.fF);_at.bL.registerClass("_at.bL",_h.dx.$$(_gg.gq,_gg.gs));_at.bM.registerClass("_at.bM",_h.fN);_at.K.registerClass("_at.K",_h.dx.$$(_gg.rE,_gg.fQ));_at.bN.registerClass("_at.bN",_h.fN);_at.n.registerClass("_at.n",_h.fN);_at.co.registerClass("_at.co",_h.fN);_at.bO.registerClass("_at.bO",_at.co);_at.bk.registerClass("_at.bk",_at.co);_at.Q.registerClass("_at.Q",_at.co);_at.bc.registerClass("_at.bc",_h.fN);_at.R.registerClass("_at.R",_h.fN);_at.w.registerClass("_at.w");_at.L.registerClass("_at.L");_at.M.registerClass("_at.M");_at.E.registerClass("_at.E");_at.X.registerClass("_at.X",_a.bw,_bc.j,_bc.s,_bc.w,_a.kU,_j.bs,Sys.IDisposable,_y.br);_at.ca.registerClass("_at.ca",_a.bt);_at.bd.registerClass("_at.bd",_a.bw,_y.gp,_a.kU,_j.bs,Sys.IDisposable);_at.b.registerClass("_at.b",_a.bw,_at.bt,_y.eO,_j.bs,Sys.IDisposable);_at.b.s.registerClass("_at.b.s");_at.Y.registerClass("_at.Y");_at.cq.registerClass("_at.cq",null,_at.cu);_at.N.registerClass("_at.N",_at.cq);_at.bq.registerClass("_at.bq",_at.cq);_at.O.registerClass("_at.O",_at.cq);_at.A.registerClass("_at.A",_at.cq);_at.cs.registerClass("_at.cs",_a.bw,_a.kU,_j.bs,Sys.IDisposable);_at.br.registerClass("_at.br",_at.cs);_at.be.registerClass("_at.be",_at.cq);_at.H.registerClass("_at.H",_at.cq);_at.r.registerClass("_at.r",_at.cq);_at.P.registerClass("_at.P",_a.bw);_at.I.registerClass("_at.I",_at.cq);_at.bw.registerClass("_at.bw");_at.ct.registerClass("_at.ct");_at.bf.registerClass("_at.bf",_at.ct);_at.cc.registerClass("_at.cc",_at.b);_at.ba.registerClass("_at.ba");_at.e.registerClass("_at.e",_at.b,_at.cv);_at.cf.registerClass("_at.cf");_at.bx.registerClass("_at.bx",_at.cc);_at.by.registerClass("_at.by",null,_y.iI);_at.bY.registerClass("_at.bY",_at.cr);_at.cr.registerClass("_at.cr");_at.bT.registerClass("_at.bT",_at.cr);_at.bU.registerClass("_at.bU",_at.cr);_at.bX.registerClass("_at.bX",_at.cr);_at.bZ.registerClass("_at.bZ",_at.cr);_at.bo.registerClass("_at.bo",_at.cr);_at.bV.registerClass("_at.bV",_at.cr);_at.bW.registerClass("_at.bW",_at.cr);_at.bp.registerClass("_at.bp",_at.cr);_at.C.registerClass("_at.C",_b.P);_at.bj.registerClass("_at.bj",_b.P);_at.g.registerClass("_at.g",_b.A);_at.bz.registerClass("_at.bz",_j.c,_ff.k);_at.bg.registerClass("_at.bg",_j.c);_at.m.registerClass("_at.m",_fce.a);_at.c.registerClass("_at.c",null,_at.p);_at.c.b.registerClass("_at.c.b");_at.bA.registerClass("_at.bA",null,_j.bP);_at.ci.registerClass("_at.ci",null,_j.bP);_at.bB.registerClass("_at.bB",null,_j.bP);_at.ck.registerClass("_at.ck",null,_j.bP);AttachmentsComponent.$$cctor();_at.i.b=_g.a.a().n()?_g.a.a().n().bH.DownloadUrlBase:null;_at.i.j=String.format("{0}//{1}",window.location.protocol,window.location.hostname);_at.z.c=_a.a.c;_at.k.c=null;_at.k.d=null;_at.q.a=_a.a.c;_at.W.a=_at.W.b();_at.x.b=null;_at.l.b={};_at.l.d=null;_at.f.e=null;_at.D.a={};_at.o.a=_a.a.c;_at.K.a=_a.a.c;_at.n.a=null;_at.n.b=0;_at.b.k="b7780972f918485c8cfc32b1ba7438eb";_at.b.h=_a.G.a();_at.b.e=_a.G.a();_at.b.a=_a.a.c;_at.b.d=new _j.q([".mp3"]);_at.b.g=new _j.q([".txt",".xml",".log"]);_at.b.f=new _j.q([".msg",".eml"]);_at.b.l=new _j.q([".ics",".ical",".icalendar",".vcs"]);_at.b.m=new _j.q([".png",".gif"]);_at.b.j=new _j.q([".pdf"]);_at.b.q=new _j.q([".pdf",".doc",".docx",".odt",".rtf",".ppt",".pptx",".pptm",".potx",".potm",".pot",".ppxx",".pps",".odp"]);_at.b.i=[8,1,4,9,5,6,11,10];_at.b.c=null;_at.b.b.a=null;_at.N.a=[7,3];_at.O.a=[7,4,3];_at.A.a=new _j.q(["application/vnd.google-apps.document","application/vnd.google-apps.spreadsheet","application/vnd.google-apps.presentation"]);_at.A.b=new _j.q([]);_at.A.d=new _j.q(["application/vnd.google-apps.document","application/vnd.google-apps.spreadsheet","application/vnd.google-apps.presentation","application/vnd.google-apps.drawing","application/vnd.google-apps.file","application/vnd.google-apps.folder","application/vnd.google-apps.form","application/vnd.google-apps.fusiontable","application/vnd.google-apps.map","application/vnd.google-apps.script","application/vnd.google-apps.sites"]);_at.A.c=[8,0,7,3];_at.be.a=new Array(0);_at.H.a=[8,0,2,4,7,3,5];_at.H.b=[0,2,7,3,5];_at.r.c=[8,0,13,2,12,7,4,3,10,5];_at.r.b=[8,7,0,13,2,4,3];_at.r.d=[0,13,2,7,3];_at.r.e=[13,2,7,3];_at.r.a=null;_at.I.a=[7,3];_at.s.b=["","NOT_FOUND_ERR","SECURITY_ERR","ABORT_ERR","NOT_READABLE_ERR","ENCODING_ERR","NO_MODIFICATION_ALLOWED_ERR","INVALID_STATE_ERR","SYNTAX_ERR","INVALID_MODIFICATION_ERR","QUOTA_EXCEEDED_ERR","TYPE_MISMATCH_ERR","PATH_EXISTS_ERR"];_at.j.j=[137,80,78,71,13,10,26,10];_at.j.h=[71,73,70,56,55,97];_at.j.i=[71,73,70,56,57,97];_at.j.g=[66,77];_at.y.a=_a.a.c;_at.y.b=!1;_at.h.a=_a.a.c;_at.e.a=_a.a.c;_at.e.d="application/octet-stream";_at.e.b="application/vnd.ms-excel";_at.e.e="application/msword";_at.e.c="application/vnd.ms-powerpoint";_at.e.f={".abc":"text/vnd.abc",".acgi":"text/html",".afl":"video/animaflex",".aif":"audio/aiff",".aifc":"audio/aiff",".aiff":"audio/aiff",".aip":"text/x-audiosoft-intra",".art":"image/x-jg",".asf":"video/x-ms-asf",".asm":"text/x-asm",".asp":"text/asp",".asx":"video/x-ms-asf",".au":"audio/basic",".avi":"video/avi",".avs":"video/avs-video",".bm":"image/bmp",".bmp":"image/bmp",".c":"text/plain",".c++":"text/plain",".cat":"application/vnd.ms-pki.seccat",".cc":"text/plain",".chm":"application/vnd.ms-htmlhelp",".conf":"text/plain",".cpp":"text/x-c",".cs":"text/plain",".css":"text/css",".csv":_at.e.b,".cxx":"text/plain",".def":"text/plain",".dif":"video/x-dv",".dl":"video/dl",".doc":_at.e.e,".docm":"application/vnd.ms-word.document.macroEnabled.12",".docx":"application/vnd.openxmlformats-officedocument.wordprocessingml.document",".dot":_at.e.e,".dotm":"application/vnd.ms-word.template.macroEnabled.12",".dotx":"application/vnd.openxmlformats-officedocument.wordprocessingml.template",".dv":"video/x-dv",".dwg":"image/vnd.dwg",".dxf":"image/vnd.dwg",".el":"text/x-script.elisp",".etx":"text/x-setext",".f":"text/plain",".f77":"text/x-fortran",".f90":"text/plain",".fif":"image/fif",".fli":"video/fli",".flo":"image/florian",".flx":"text/vnd.fmi.flexstor",".fmf":"video/x-atomic3d-feature",".for":"text/x-fortran",".fpx":"image/vnd.fpx",".funk":"audio/make",".g":"text/plain",".g3":"image/g3fax",".gif":"image/gif",".gl":"video/gl",".gsd":"audio/x-gsm",".gsm":"audio/x-gsm",".h":"text/plain",".hh":"text/plain",".hlb":"text/x-script",".htc":"text/x-component",".htm":"text/html",".html":"text/html",".htmls":"text/html",".htt":"text/webviewhtml",".htx":"text/html",".hxx":"text/plain",".ico":"image/x-icon",".idc":"text/plain",".ief":"image/ief",".iefs":"image/ief",".isu":"video/x-isvideo",".it":"audio/it",".jam":"audio/x-jam",".jav":"text/plain",".java":"text/plain",".jfif":"image/jpeg",".jfif-tbnl":"image/jpeg",".jpe":"image/jpeg",".jpeg":"image/jpeg",".jpg":"image/jpeg",".jps":"image/x-jps",".jut":"image/jutvision",".kar":"audio/midi",".la":"audio/nspaudio",".lam":"audio/x-liveaudio",".list":"text/plain",".lma":"audio/nspaudio",".log":"text/plain",".lst":"text/plain",".lsx":"text/x-la-asf",".m":"text/plain",".m1v":"video/mpeg",".m2a":"audio/mpeg",".m2v":"video/mpeg",".m3u":"audio/x-mpequrl",".mar":"text/plain",".mcf":"text/mcf",".mid":"audio/midi",".midi":"audio/midi",".mjf":"audio/x-vnd.audioexplosion.mjuicemediafile",".mjpg":"video/x-motion-jpeg",".mod":"audio/mod",".moov":"video/quicktime",".mov":"video/quicktime",".movie":"video/x-sgi-movie",".mp2":"audio/mpeg",".mp3":"audio/mpeg",".mp4":"video/mp4",".mpa":"audio/mpeg",".mpe":"video/mpeg",".mpeg":"video/mpeg",".mpg":"video/mpeg",".mpga":"audio/mpeg",".mpp":"application/vnd.ms-project",".mpt":"application/vnd.ms-project",".mpv":"application/vnd.ms-project",".mpx":"application/vnd.ms-project",".mv":"video/x-sgi-movie",".my":"audio/make",".nap":"image/naplps",".naplps":"image/naplps",".nif":"image/x-niff",".niff":"image/x-niff",".ogg":"video/ogg",".ogv":"video/ogg",".p":"text/x-pascal",".pas":"text/pascal",".pbm":"image/x-portable-bitmap",".pct":"image/x-pict",".pcx":"image/x-pcx",".pdf":"application/pdf",".pfunk":"audio/make",".pgm":"image/x-portable-greymap",".pic":"image/pict",".pict":"image/pict",".pko":"application/vnd.ms-pki.pko",".pl":"text/plain",".pm":"image/x-xpixmap",".png":"image/png",".pot":_at.e.c,".potm":"application/vnd.ms-powerpoint.template.macroEnabled.12",".potx":"application/vnd.openxmlformats-officedocument.presentationml.template",".ppa":_at.e.c,".ppam":"application/vnd.ms-powerpoint.addin.macroEnabled.12",".ppm":"image/x-portable-pixmap",".pps":_at.e.c,".ppsm":"application/vnd.ms-powerpoint.slideshow.macroEnabled.12",".ppsx":"application/vnd.openxmlformats-officedocument.presentationml.slideshow",".ppt":_at.e.c,".pptm":"application/vnd.ms-powerpoint.presentation.macroEnabled.12",".pptx":"application/vnd.openxmlformats-officedocument.presentationml.presentation",".ppz":_at.e.c,".pwz":_at.e.c,".py":"text/x-script.phyton",".qcp":"audio/vnd.qcelp",".qif":"image/x-quicktime",".qt":"video/quicktime",".qtc":"video/x-qtc",".qti":"image/x-quicktime",".qtif":"image/x-quicktime",".ra":"audio/x-pn-realaudio",".ram":"audio/x-pn-realaudio",".rast":"image/cmu-raster",".rexx":"text/x-script.rexx",".rf":"image/vnd.rn-realflash",".rgb":"image/x-rgb",".rmi":"audio/mid",".rmm":"audio/x-pn-realaudio",".rmp":"audio/x-pn-realaudio",".rp":"image/vnd.rn-realpix",".rpm":"audio/x-pn-realaudio-plugin",".rt":"text/richtext",".rtf":"text/richtext",".rtx":"text/richtext",".rv":"video/vnd.rn-realvideo",".s":"text/x-asm",".s3m":"audio/s3m",".sdml":"text/plain",".sgm":"text/sgml",".sgml":"text/sgml",".shtml":"text/html",".sid":"audio/x-psid",".sldm":"application/vnd.ms-powerpoint.slide.macroEnabled.12",".sldx":"application/vnd.openxmlformats-officedocument.presentationml.slide",".snd":"audio/basic",".spc":"text/x-speech",".ssi":"text/x-server-parsed-html",".sst":"application/vnd.ms-pki.certstore",".svf":"image/vnd.dwg",".talk":"text/x-speech",".tcsh":"text/x-script.tcsh",".text":"text/plain",".tif":"image/tiff",".tiff":"image/tiff",".tsi":"audio/tsp-audio",".tsv":"text/tab-separated-values",".turbot":"image/florian",".txt":"text/plain",".uil":"text/x-uil",".uni":"text/uri-list",".unis":"text/uri-list",".uri":"text/uri-list",".uris":"text/uri-list",".uue":"text/x-uuencode",".vcs":"text/x-vcalendar",".vdo":"video/vdo",".viv":"video/vivo",".vivo":"video/vivo",".voc":"audio/voc",".vos":"video/vosaic",".vox":"audio/voxware",".vqe":"audio/x-twinvq-plugin",".vqf":"audio/x-twinvq",".vql":"audio/x-twinvq-plugin",".vsd":"application/x-visio",".vst":"application/x-visio",".vsw":"application/x-visio",".w6w":"application/msword",".wav":"audio/wav",".wbmp":"image/vnd.wap.wbmp",".webm":"video/webm",".wiz":"application/msword",".wm":"video/x-ms-wm",".wma":"audio/x-ms-wma",".wmf":"windows/metafile",".wml":"text/vnd.wap.wml",".wmls":"text/vnd.wap.wmlscript",".wmp":"video/x-ms-wmp",".wmv":"video/x-ms-wmv",".wmx":"video/x-ms-wmx",".word":"application/msword",".wsc":"text/scriplet",".wvx":"video/x-ms-wvx",".xbm":"image/x-xbitmap",".xdr":"video/x-amt-demorun",".xif":"image/vnd.xiff",".xl":"application/excel",".xla":_at.e.b,".xlam":"application/vnd.ms-excel.addin.macroEnabled.12",".xlb":_at.e.b,".xlc":_at.e.b,".xld":_at.e.b,".xlk":_at.e.b,".xll":_at.e.b,".xlm":_at.e.b,".xls":_at.e.b,".xlsb":"application/vnd.ms-excel.sheet.binary.macroEnabled.12",".xlsm":"application/vnd.ms-excel.sheet.macroEnabled.12",".xlsx":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",".xlt":_at.e.b,".xltm":"application/vnd.ms-excel.template.macroEnabled.12",".xltx":"application/vnd.openxmlformats-officedocument.spreadsheetml.template",".xlv":_at.e.b,".xlw":_at.e.b,".xm":"audio/xm",".xpm":"image/xpm",".xps":"application/vnd.ms-xpsdocument",".x-png":"image/png",".xsr":"video/x-amt-showrun",".xwd":"image/x-xwd",".zsh":"text/x-script.zsh"};_at.C.a=_a.o.a().I&&!_a.o.a().N;_at.g.c=new _a.f("Attachment",_g.Attachment,_at.g);_at.g.e=new _a.f("ParentItemId",_g.e,_at.g);_at.g.g=new _a.f("IsEnabled",Boolean,_at.g);_at.g.d=new _a.f("FileSelectedCommand",_j.P,_at.g);_at.g.b=new _a.f("UploadAttachmentCommand",_j.P,_at.g);_at.g.f=new _a.f("UploadCompletedCommand",_j.P,_at.g);_at.g.a=_a.a.c;_at.c.i=null;_at.c.a=null;_at.c.c=null;_at.c.g=null;_at.c.e=null;_at.c.f=null;_at.c.l=null;_at.c.k=null;_at.c.j=null;_at.c.h=null;_at.a.c=_at.a.K();_at.a.l=null;_at.a.m=null;_at.a.j=null;_at.a.k=null;_at.a.i=null;_at.a.n=null;_at.a.a={};_at.a.$$cctor();
window.scriptsLoaded['microsoft.owa.core.attachments.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.core.attachments.js'] = (new Date()).getTime();
