window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.o365.suiteserviceproxy.js'] = (new Date()).getTime();
if(typeof window.O365SuiteServiceProxy=="undefined"){window.O365SuiteServiceProxy={};window.O365SuiteServiceProxy.__namespace=!0}Type.registerNamespace("O365SuiteServiceProxy");O365SuiteServiceProxy.y=function(){};O365SuiteServiceProxy.y.registerInterface("O365SuiteServiceProxy.y");O365SuiteServiceProxy.p=function(){};O365SuiteServiceProxy.p.prototype={OWA:1,portal:2,tokenFactory:3,dataSharing:4};O365SuiteServiceProxy.p.registerEnum("O365SuiteServiceProxy.p",!1);O365SuiteServiceProxy.h=function(){};O365SuiteServiceProxy.h.prototype={noExoLicense:1,brs:2,tokenExpired:3,languageNotSet:4,initFailed:5,securityZoneMismatched:6,iframeLoadError:7,callerOriginNotAllowed:8,invalidMailbox:9,shardMailbox:10,shardNotDetected:11};O365SuiteServiceProxy.h.registerEnum("O365SuiteServiceProxy.h",!1);O365SuiteServiceProxy.z=function(){};O365SuiteServiceProxy.t=function(n){this.b=n};O365SuiteServiceProxy.t.prototype={b:null,a:null,c:null,f:function(n){if(this.a){var t=new Date;t-this.c<=12e4&&(n["X-TARGETSERVER"]=this.a)}},e:function(n){if(!this.a&&n["X-TARGETSERVER"]){this.a=n["X-TARGETSERVER"];this.c=new Date}},d:function(n,t){if(n["X-SUITE-ERROR"]&&n["X-SUITE-ERROR"]==="InvalidOrUnavailableMailboxException"){this.b.b(11);t(O365SuiteServiceProxy.Util.a(null,-1010,O365SuiteServiceProxy.h.toString(11)));return}else t(n)}};O365SuiteServiceProxy.REF=function(){};O365SuiteServiceProxy.REF.e=function(){return O365SuiteServiceProxy.REF.d||O365SuiteServiceProxy.REF.h()};O365SuiteServiceProxy.REF.f=function(){return O365SuiteServiceProxy.REF.a||O365SuiteServiceProxy.REF.g()};O365SuiteServiceProxy.REF.get_SI=function(){return O365SuiteServiceProxy.REF.b||O365SuiteServiceProxy.REF.j()};O365SuiteServiceProxy.REF.get_SSI=function(){return O365SuiteServiceProxy.REF.c||O365SuiteServiceProxy.REF.i()};O365SuiteServiceProxy.REF.h=function(){O365SuiteServiceProxy.d.b();if(O365SuiteServiceProxy.d.a.a){var t=String.format("{0}//{1}",window.location.protocol,window.location.host);var n=String.format("/iframe/TokenFactoryIframe?origin={0}&shsid={1}&cshver={2}&apiver={3}",encodeURIComponent(t),encodeURIComponent(O365SuiteServiceProxy.d.a.k),encodeURIComponent(O365SuiteServiceProxy.d.a.l),O365SuiteServiceProxy.d.a.m?"oneshell":"g2");O365SuiteServiceProxy.REF.d=new O365SuiteServiceProxy.RequestExecutor(3,O365SuiteServiceProxy.d.a.a,n)}return O365SuiteServiceProxy.REF.d};O365SuiteServiceProxy.REF.g=function(){O365SuiteServiceProxy.d.b();if(O365SuiteServiceProxy.d.a.b){var n;n=O365SuiteServiceProxy.d.a.i?String.format("{0}?upn={1}&{2}={3}&returnUrl={3}","SuiteServiceProxy.aspx",encodeURIComponent(O365SuiteServiceProxy.d.a.c),"suiteServiceReturnUrl",encodeURIComponent(window.location.href)):"SuiteServiceProxy.aspx";O365SuiteServiceProxy.REF.a=new O365SuiteServiceProxy.RequestExecutor(2,O365SuiteServiceProxy.d.a.b,n);O365SuiteServiceProxy.REF.a.c(O365SuiteServiceProxy.ServiceHandlers.onBeforeSendRequestAdmin)}return O365SuiteServiceProxy.REF.a};O365SuiteServiceProxy.REF.j=function(){O365SuiteServiceProxy.d.b();if(O365SuiteServiceProxy.d.a.e){var n;n=O365SuiteServiceProxy.d.a.i?String.format("{0}?suiteServiceUserName={1}&{2}={3}&returnUrl={3}","SuiteServiceProxy.aspx",encodeURIComponent(O365SuiteServiceProxy.d.a.c),"suiteServiceReturnUrl",encodeURIComponent(window.location.href)):String.format("{0}?{1}={2}&returnUrl={2}","SuiteServiceProxy.aspx","suiteServiceReturnUrl",encodeURIComponent(window.location.href));O365SuiteServiceProxy.REF.b=new O365SuiteServiceProxy.RequestExecutor(1,O365SuiteServiceProxy.d.a.e,n);O365SuiteServiceProxy.REF.b.c(O365SuiteServiceProxy.ServiceHandlers.onBeforeSendRequestSuiteService)}return O365SuiteServiceProxy.REF.b};O365SuiteServiceProxy.REF.i=function(){O365SuiteServiceProxy.d.b();O365SuiteServiceProxy.d.a.d&&(O365SuiteServiceProxy.REF.c=new O365SuiteServiceProxy.RequestExecutor(4,O365SuiteServiceProxy.d.a.d,"SuiteDataSharingProxy.aspx"));return O365SuiteServiceProxy.REF.c};O365SuiteServiceProxy.j=function(){};O365SuiteServiceProxy.j.prototype={a:null,e:null,b:null,k:!1,i:!1,d:null,g:6e4,h:null,m:null,f:null,p:null,c:null,j:null,o:null,n:!1,l:0};O365SuiteServiceProxy.o=function(){};O365SuiteServiceProxy.o.prototype={b:null,c:null,e:0,a:null,d:null};O365SuiteServiceProxy.k=function(){this.b={}};O365SuiteServiceProxy.k.prototype={i:!1,j:null,d:0,f:null,k:!1,a:null,g:null,h:null,e:null,c:null};O365SuiteServiceProxy.d=function(n,t,i,r,u,f,e,o,s,h,c,l,a){this.f=n;this.e=n.substring(0,n.lastIndexOf("/"));this.b=t;this.c=e;this.h=i;this.g=c;this.p=r;this.j=u;this.d=f;this.k=o;this.i=s;this.a=h;this.l=l;this.m=a};O365SuiteServiceProxy.d.d=function(n,t,i,r,u,f,e,o,s,h,c,l,a){O365SuiteServiceProxy.d.a=new O365SuiteServiceProxy.d(n,t,i,r,u,f,e,o,s,h,c,l,a)};O365SuiteServiceProxy.d.b=function(){if(!O365SuiteServiceProxy.d.a)throw Error.invalidOperation("SessionData not initialized");};O365SuiteServiceProxy.d.prototype={q:null,f:null,b:null,e:null,a:null,l:null,c:null,h:!1,g:!1,p:null,j:!1,k:null,d:null,i:!1,m:!1,n:null,o:null};O365SuiteServiceProxy.RequestExecutor=function(n,t,i){O365SuiteServiceProxy.a.e(t,"url","string",!0);if(O365SuiteServiceProxy.a.c(t))throw O365SuiteServiceProxy.a.f("url");var r=t.indexOf("?");if(r>=0)throw O365SuiteServiceProxy.a.f("url");r=t.indexOf("#");if(r>=0)throw O365SuiteServiceProxy.a.f("url");t.charAt(0)==="/"&&(t=O365SuiteServiceProxy.RequestExecutor.r(window.location.href,t));O365SuiteServiceProxy.a.g(t,"url");t.charCodeAt(t.length-1)==="/".charCodeAt(0)&&(t=t.substr(0,t.length-1));t=t.toLowerCase();this.h=t;this.g=O365SuiteServiceProxy.e.a(t)===O365SuiteServiceProxy.e.a(window.location.href)?1:2;this.formDigestHandlingEnabled=!1;this.iFrameSourceUrl=i;O365SuiteServiceProxy.RequestExecutor.c||(O365SuiteServiceProxy.RequestExecutor.c={});O365SuiteServiceProxy.RequestExecutor.c[this.k()]=n;_o365su.a.a(window.self,"unload",O365SuiteServiceProxy.RequestExecutor.O,!1)};O365SuiteServiceProxy.RequestExecutor.r=function(n,t){O365SuiteServiceProxy.a.g(n,"baseUrl");if(t.substr(0,8).toLowerCase()==="https://"||t.substr(0,7).toLowerCase()==="http://")return t;else if(t.charAt(0)==="/"){var i=n.indexOf("://");i=n.indexOf("/",i+3);i>0&&(n=n.substr(0,i));return n+t}else{n.charAt(n.length-1)!=="/"&&(n=n+"/");return n+t}};O365SuiteServiceProxy.RequestExecutor.j=function(n){O365SuiteServiceProxy.a.g(n,"url");return O365SuiteServiceProxy.e.a(n)};O365SuiteServiceProxy.RequestExecutor.y=function(n){return document.getElementById(n)};O365SuiteServiceProxy.RequestExecutor.H=function(n){O365.Log.WriteShellLog(403247,1,13,0,O365SuiteServiceProxy.e.a(n));switch(O365SuiteServiceProxy.RequestExecutor.c[n]){case 1:O365.Log.d("OIS",-1);break;case 2:O365.Log.d("PIS",-1);break;case 3:O365.Log.d("TIS",-1);break}var t;t=document.createElement("IFRAME");t.src=n;t.id=n;t.style.display="none";var r=function(){O365.PM.rle("I2");var t=O365SuiteServiceProxy.RequestExecutorNative.getIFrameOnloadCallback(n);t()};_o365su.a.a(t,"load",r,!1);document.body.appendChild(t);O365.PM.rle("I1");var i=window.setTimeout(function(){delete O365SuiteServiceProxy.RequestExecutor.b[n];O365SuiteServiceProxy.RequestExecutor.E(n)},15e3);O365SuiteServiceProxy.RequestExecutor.b[n]=i;return t};O365SuiteServiceProxy.RequestExecutor.I=function(n,t,i,r,u){O365SuiteServiceProxy.RequestExecutor.k||(O365SuiteServiceProxy.RequestExecutor.k={});O365SuiteServiceProxy.RequestExecutor.p||(O365SuiteServiceProxy.RequestExecutor.p={});n=n.toLowerCase();var o=new Date;if(!i||r.b.toUpperCase()==="GET"||!O365SuiteServiceProxy.a.a(O365SuiteServiceProxy.RequestExecutor.k[n])&&O365SuiteServiceProxy.RequestExecutor.k[n]>o.getTime())u(O365SuiteServiceProxy.RequestExecutor.p[n],r);else{var f=O365SuiteServiceProxy.a.i();f.open("POST",t);f.setRequestHeader("accept","application/json;odata=verbose");var s=Date.now();var e=0;r.g>0&&(e=window.setTimeout(function(){O365.Log.WriteShellLog(175263,6,13,0);f.onreadystatechange=null;try{f.abort()}catch(n){}O365SuiteServiceProxy.RequestExecutor.h(r,-1001,"Request was aborted or timed out");O365.Log.i("Query",r.b,null,r.a,-1001,-1,-1)},r.g));f.onreadystatechange=function(){if(f.readyState===4){var a=Date.now();var t=a-s;e&&window.clearTimeout(e);f.onreadystatechange=null;if(f.status!==200||!f.getResponseHeader("content-type")||f.getResponseHeader("content-type").toLowerCase().indexOf("application/json")<0){var h=String.format("Status:{0}, Content-type:{1}",f.status.toString(),f.getResponseHeader("content-type"));O365SuiteServiceProxy.RequestExecutor.h(r,-1002,h);O365.Log.WriteShellLog(175264,6,13,0,h);O365.Log.b("RequestExecutor_UnexpectedResponse",6,f.status.toString(),f.getResponseHeader("content-type"));O365.Log.i("Query",r.b,null,r.a,-1002,t,(f.responseText||"").length)}else{var i=JSON.parse(f.responseText);if(O365SuiteServiceProxy.a.a(i)){O365SuiteServiceProxy.RequestExecutor.h(r,-1002,"Unable to parse json");O365.Log.WriteShellLog(175265,6,13,0);O365.Log.b("RequestExecutor_UnableToParseJson",6,f.status.toString(),f.responseText);O365.Log.i("Query",r.b,null,r.a,-1002,t,(f.responseText||"").length)}else{var o=i.d.GetContextWebInformation.FormDigestValue;var l=i.d.GetContextWebInformation.FormDigestTimeoutSeconds;var c=+new Date+l*750;O365SuiteServiceProxy.RequestExecutor.p[n]=o;O365SuiteServiceProxy.RequestExecutor.k[n]=c;u(o,r);O365.Log.i("Query",r.b,null,r.a,f.status,t,(f.responseText||"").length)}}}};f.send("")}};O365SuiteServiceProxy.RequestExecutor.h=function(n,t,i){if(n.c){var r=new O365SuiteServiceProxy.k;r.h=n.m;r.a="";n.c(r,t,i)}else{O365.Log.WriteShellLog(400589,6,13,0);O365.Log.b("RequestExecutor_NoErrorCallback",6,t.toString(),i)}};O365SuiteServiceProxy.RequestExecutor.C=function(){var n=window.postMessage;if(O365SuiteServiceProxy.a.d(n)){O365.Log.WriteShellLog(175266,6,13,0);O365.Log.b("RequestExecutor_PostMessageNotSupported",6);throw O365SuiteServiceProxy.a.b("Browser not supported",-2003);}n=window.JSON;if(O365SuiteServiceProxy.a.d(n)||O365SuiteServiceProxy.a.d(n.stringify)||O365SuiteServiceProxy.a.d(n.parse)){O365.Log.WriteShellLog(175267,6,13,0);O365.Log.b("RequestExecutor_JsonParseNotSupported",6);throw O365SuiteServiceProxy.a.b("Browser not supported",-2003);}};O365SuiteServiceProxy.RequestExecutor.G=function(){var n=window.ArrayBuffer;if(O365SuiteServiceProxy.a.d(n)){O365.Log.WriteShellLog(175268,6,13,0);O365.Log.b("RequestExecutor_ArrayBufferNotSupported",6);throw O365SuiteServiceProxy.a.b("Binary data not supported",-2003);}n=window.Uint8Array;if(O365SuiteServiceProxy.a.d(n)){O365.Log.WriteShellLog(175269,6,13,0);O365.Log.b("RequestExecutor_Uint8ArrayNotSupported",6);throw O365SuiteServiceProxy.a.b("Binary data not supported",-2003);}if(O365SuiteServiceProxy.a.d(window.BlobBuilder)&&O365SuiteServiceProxy.a.d(window.MozBlobBuilder)&&O365SuiteServiceProxy.a.d(window.Blob)){O365.Log.WriteShellLog(175270,6,13,0);O365.Log.b("RequestExecutor_BlobBuilderNotSupported",6);throw O365SuiteServiceProxy.a.b("Binary data not supported",-2003);}};O365SuiteServiceProxy.RequestExecutor.sendPostMessage=function(n){O365SuiteServiceProxy.a.e(n.c,"requestInfo.postMessageId","string",!0);O365SuiteServiceProxy.a.e(n.b,"requestInfo.appWebProxyUrl","string",!0);var i=O365SuiteServiceProxy.RequestExecutor.y(n.b);if(!i){O365.Log.WriteShellLog(175271,6,13,0);O365.Log.b("RequestExecutor_IFrameNull",6,n.b);throw O365SuiteServiceProxy.a.b("Invalid operation",-2002);}O365SuiteServiceProxy.RequestExecutor.a||(O365SuiteServiceProxy.RequestExecutor.a={});O365SuiteServiceProxy.RequestExecutor.a[n.c]=n;var t=new O365SuiteServiceProxy.u;t.command=n.d;t.url=n.a.a;t.resource=n.a.e;t.method=n.a.b;t.body=n.a.d;t.headers=n.a.h;t.postMessageId=n.c;t.timeout=n.a.g;t.binaryStringRequestBody=n.a.k;t.binaryStringResponseBody=n.a.i;t.requestObject=n.a.j;t.getPerformanceTrace=n.a.n;var u=JSON.stringify(t);var r=n.b;n.a.l=Date.now();i.contentWindow.postMessage(u,r)};O365SuiteServiceProxy.RequestExecutor.internalProcessIFrameOnload=function(n){O365SuiteServiceProxy.RequestExecutor.i[n]=!0;if(!O365SuiteServiceProxy.a.a(O365SuiteServiceProxy.RequestExecutor.b[n])){window.clearTimeout(O365SuiteServiceProxy.RequestExecutor.b[n]);delete O365SuiteServiceProxy.RequestExecutor.b[n]}if(!O365SuiteServiceProxy.a.a(O365SuiteServiceProxy.RequestExecutor.g[n])){window.clearTimeout(O365SuiteServiceProxy.RequestExecutor.g[n]);delete O365SuiteServiceProxy.RequestExecutor.g[n]}var t=new O365SuiteServiceProxy.o;t.d="Ping";t.c=O365SuiteServiceProxy.e.c();t.b=n;var i=window.setTimeout(function(){delete O365SuiteServiceProxy.RequestExecutor.b[n];O365SuiteServiceProxy.RequestExecutor.L(t.c,n)},1e4);t.e=i;t.a=new O365SuiteServiceProxy.j;O365SuiteServiceProxy.RequestExecutor.a[t.c]=t;O365SuiteServiceProxy.RequestExecutor.g[n]=i;O365SuiteServiceProxy.RequestExecutor.sendPostMessage(t)};O365SuiteServiceProxy.RequestExecutor.L=function(n,t){var i=O365SuiteServiceProxy.RequestExecutor.a[n];if(!O365SuiteServiceProxy.a.a(i)&&!O365SuiteServiceProxy.RequestExecutor.f[t]){O365.Log.b("PingTimeout",0,O365SuiteServiceProxy.p.toString(O365SuiteServiceProxy.RequestExecutor.c[t]));O365SuiteServiceProxy.RequestExecutor.a[n]=null;delete O365SuiteServiceProxy.RequestExecutor.a[n];O365SuiteServiceProxy.RequestExecutor.E(t)}};O365SuiteServiceProxy.RequestExecutor.E=function(n){var t=O365SuiteServiceProxy.e.a(n);switch(O365SuiteServiceProxy.RequestExecutor.c[n]){case 1:O365.Log.d("OIF",-1);break;case 2:O365.Log.d("PIF",-1);break;case 3:O365.Log.d("TIF",-1);break}O365.Log.WriteShellLog(175272,1,13,0,t);if(t.toLowerCase()===O365SuiteServiceProxy.RequestExecutor.j(O365SuiteServiceProxy.d.a.f)){var r=O365SuiteServiceProxy.RequestExecutor.z()?6:7;O365SuiteServiceProxy.i.a.b(r,t)}var i=String.format("Cannot access {0}",t);O365SuiteServiceProxy.RequestExecutor.N(n,i)};O365SuiteServiceProxy.RequestExecutor.N=function(n,t){O365SuiteServiceProxy.RequestExecutor.l[n]=!0;O365SuiteServiceProxy.RequestExecutor.u||(O365SuiteServiceProxy.RequestExecutor.o=O365SuiteServiceProxy.RequestExecutor.z());O365.Log.b("RequestExecutor_IFrameLoadError",4,-1007,t,"isTrustedSite: "+O365SuiteServiceProxy.RequestExecutor.o,n);var u=O365SuiteServiceProxy.RequestExecutor.e[n];O365SuiteServiceProxy.RequestExecutor.e[n]=[];if(!O365SuiteServiceProxy.a.a(O365SuiteServiceProxy.RequestExecutor.b[n])){window.clearTimeout(O365SuiteServiceProxy.RequestExecutor.b[n]);delete O365SuiteServiceProxy.RequestExecutor.b[n]}O365SuiteServiceProxy.RequestExecutor.M(n);if(u)for(var f=0;f<u.length;f++){var i=u[f];var r=i.c;var e=O365SuiteServiceProxy.RequestExecutor.a[r];if(!O365SuiteServiceProxy.a.a(e)){O365SuiteServiceProxy.RequestExecutor.a[r]=null;delete O365SuiteServiceProxy.RequestExecutor.a[r];O365SuiteServiceProxy.a.a(i.e)||window.clearTimeout(i.e);O365SuiteServiceProxy.RequestExecutor.h(i.a,-1007,t);O365.Log.i(i.d,i.a.b,O365SuiteServiceProxy.RequestExecutor.c[n].toString(),i.a.a,-1007,-1,-1)}}};O365SuiteServiceProxy.RequestExecutor.M=function(n){var t=O365SuiteServiceProxy.RequestExecutor.y(n);t&&t.parentNode&&t.parentNode.removeChild(t);O365SuiteServiceProxy.RequestExecutor.e&&delete O365SuiteServiceProxy.RequestExecutor.e[n];O365SuiteServiceProxy.RequestExecutor.b&&delete O365SuiteServiceProxy.RequestExecutor.b[n];O365SuiteServiceProxy.RequestExecutor.i&&delete O365SuiteServiceProxy.RequestExecutor.i[n];O365SuiteServiceProxy.RequestExecutor.f&&delete O365SuiteServiceProxy.RequestExecutor.f[n];O365SuiteServiceProxy.RequestExecutor.g&&delete O365SuiteServiceProxy.RequestExecutor.g[n];O365SuiteServiceProxy.RequestExecutor.l&&delete O365SuiteServiceProxy.RequestExecutor.l[n]};O365SuiteServiceProxy.RequestExecutor.K=function(n){switch(O365SuiteServiceProxy.RequestExecutor.c[n]){case 1:O365.Log.d("OIC",-1);break;case 2:O365.Log.d("PIC",-1);break;case 3:O365.Log.d("TIC",-1);break}O365.Log.WriteShellLog(403263,1,13,0,O365SuiteServiceProxy.e.a(n));O365SuiteServiceProxy.RequestExecutor.f[n]=!0;var i=O365SuiteServiceProxy.RequestExecutor.e[n];if(i){O365SuiteServiceProxy.RequestExecutor.e[n]=[];for(var t=0;t<i.length;t++){var r=i[t];O365SuiteServiceProxy.RequestExecutor.a[r.c]&&O365SuiteServiceProxy.RequestExecutor.sendPostMessage(r)}}};O365SuiteServiceProxy.RequestExecutor.internalProcessIFrameRequestTimeoutCallback=function(n){if(!O365SuiteServiceProxy.RequestExecutor.a){O365.Log.WriteShellLog(400591,1,13,0);return}var t=O365SuiteServiceProxy.RequestExecutor.a[n];if(O365SuiteServiceProxy.a.a(t)){O365.Log.WriteShellLog(400588,1,13,0);return}if(O365SuiteServiceProxy.RequestExecutor.z()){O365.Log.b("RequestExecutor_IFrameLoadError",4,-1007,"Timeout due to trusted sites");O365.Log.WriteShellLog(175273,1,13,0)}O365SuiteServiceProxy.RequestExecutor.a[n]=null;delete O365SuiteServiceProxy.RequestExecutor.a[n];O365SuiteServiceProxy.RequestExecutor.h(t.a,-1001,"Request was aborted or timed out");O365.Log.i(t.d,t.a.b,O365SuiteServiceProxy.RequestExecutor.c[t.b].toString(),t.a.a,-1001,-1,-1);O365SuiteServiceProxy.RequestExecutor.d(t.a,null,-1001,"Request was aborted or timed out")};O365SuiteServiceProxy.RequestExecutor.internalProcessXMLHttpRequestTimeoutCallback=function(n,t){O365.Log.WriteShellLog(175274,1,13,0);n.onreadystatechange=null;try{n.abort()}catch(i){}O365SuiteServiceProxy.RequestExecutor.h(t,-1001,"Request was aborted or timed out");O365.Log.i("Query",t.b,null,t.a,-1001,-1,-1);O365SuiteServiceProxy.RequestExecutor.d(t,null,-1001,"Request was aborted or timed out")};O365SuiteServiceProxy.RequestExecutor.internalProcessXMLHttpRequestOnreadystatechange=function(n,t,i){if(n.readyState===4){var s=Date.now();i&&window.clearTimeout(i);n.onreadystatechange=null;var r=new O365SuiteServiceProxy.k;r.h=t.m;r.i=!0;r.a=t.i?O365SuiteServiceProxy.e.f(n.response):n.responseText;r.d=n.status;r.j=n.statusText;r.f=n.getResponseHeader("content-type");r.g=n.getAllResponseHeaders();r.b=O365SuiteServiceProxy.RequestExecutor.A(r.g);var o=s-t.l;if(t.n){var u=O365SuiteServiceProxy.c.e(t.a);r.c=u&&u.length>0?u[0]:null}if(n.status>=200&&n.status<300||n.status===1223){t.f&&t.f(r);O365SuiteServiceProxy.RequestExecutor.d(t,r,0,null);O365.Log.i("Query",t.b,null,t.a,r.d,o,(n.responseText||"").length)}else{var f=-1003;var e=n.statusText;O365.Log.WriteShellLog(175275,1,13,0,n.status);t.c&&t.c(r,f,e);O365SuiteServiceProxy.RequestExecutor.d(t,r,f,e);O365.Log.i("Query",t.b,null,t.a,n.status,o,(n.responseText||"").length)}}};O365SuiteServiceProxy.RequestExecutor.internalOnMessage=function(n){var w=Date.now();if(!O365SuiteServiceProxy.a.a(n)){var l=n.data;var a=n.origin;if(!O365SuiteServiceProxy.a.c(a)&&!O365SuiteServiceProxy.a.c(l)&&O365SuiteServiceProxy.RequestExecutor.a){var t=O365SuiteServiceProxy.a.k(l);if(!O365SuiteServiceProxy.a.a(t)&&!O365SuiteServiceProxy.a.c(t.postMessageId)){var i=O365SuiteServiceProxy.RequestExecutor.a[t.postMessageId];if(!O365SuiteServiceProxy.a.a(i)){var k=O365SuiteServiceProxy.RequestExecutor.j(a);var b=O365SuiteServiceProxy.RequestExecutor.j(i.b);if(k.toLowerCase()===b.toLowerCase()){var d=t.postMessageId;var s=w-i.a.l;var nt=t.command==="Query"&&!t.errorCode&&t.readyState===3;var g=t.command==="Notification"&&O365SuiteServiceProxy.a.a(t.errorMessage);if(!nt&&!g){delete O365SuiteServiceProxy.RequestExecutor.a[d];if(!O365SuiteServiceProxy.a.a(i.e)){window.clearTimeout(i.e);i.e=0;delete i.timeoutId}}if(t.command==="Ping"){var h=i.b;O365SuiteServiceProxy.RequestExecutor.K(h);O365SuiteServiceProxy.RequestExecutor.w(i.a,t);O365.Log.i(i.d,i.a.b,O365SuiteServiceProxy.RequestExecutor.c[h].toString(),O365SuiteServiceProxy.RequestExecutor.j(h),t.errorCode?t.errorCode:200,s,(t.responseText||"").length)}else if(t.command==="Query"){var r=new O365SuiteServiceProxy.k;r.i=t.responseAvailable;r.a=t.responseText;r.d=t.statusCode;r.j=t.statusText;r.f=t.contentType;r.h=i.a.m;r.g=t.allResponseHeaders;r.b=O365SuiteServiceProxy.RequestExecutor.A(t.allResponseHeaders);r.k=t.binaryStringResponseBody;O365SuiteServiceProxy.a.a(r.a)&&(r.a="");var u=0;var f=null;if(t.errorCode){u=t.errorCode;f=t.errorMessage}else if(t.statusCode>=200&&t.statusCode<300||t.statusCode===1223){u=0;f=null}else{u=-1003;f=t.statusText;O365.Log.WriteShellLog(175276,1,13,0,t.statusCode)}if(u){if(t.readyState===4||!t.readyState){r.c=t.performanceTrace;i.a.c&&i.a.c(r,u,f);O365.Log.WriteShellLog(175277,1,13,0,u,f);O365.Log.b("RequestExecutor_IFrameError",4,u,f);O365SuiteServiceProxy.RequestExecutor.d(i.a,r,u,f);O365.Log.i(i.d,i.a.b,O365SuiteServiceProxy.RequestExecutor.c[i.b].toString(),i.a.a,u,s,(t.responseText||"").length)}}else if(t.readyState===4){r.c=t.performanceTrace;i.a.f&&i.a.f(r);O365SuiteServiceProxy.RequestExecutor.d(i.a,r,0,null);O365.Log.i(i.d,i.a.b,O365SuiteServiceProxy.RequestExecutor.c[i.b].toString(),i.a.a,t.statusCode||u,s,(t.responseText||"").length)}else if(t.readyState===3&&i.a.p){var tt=r.a;i.a.p(r)}}else if(t.command==="Storage"||t.command==="UserState"){var e=new O365SuiteServiceProxy.k;e.e=t.responseObject;var o=t.errorCode;var c=t.errorMessage;if(!o&&O365SuiteServiceProxy.a.c(c)){i.a.f&&i.a.f(e);O365SuiteServiceProxy.RequestExecutor.d(i.a,e,0,null)}else{i.a.c&&i.a.c(e,o,c);O365SuiteServiceProxy.RequestExecutor.d(i.a,e,o,c)}O365.Log.i(i.d,i.a.b,O365SuiteServiceProxy.RequestExecutor.c[i.b].toString(),i.a.a,o?o:200,s,(t.responseText||"").length)}else if(t.command==="PendingGet"){if(t.errorMessage&&i.a.c){var v=new O365SuiteServiceProxy.k;var p=0;var y=t.errorMessage;i.a.c(v,p,y)}O365SuiteServiceProxy.RequestExecutor.w(i.a,t)}else if(t.command==="Notification"){O365SuiteServiceProxy.RequestExecutor.D(t.responseObject);O365SuiteServiceProxy.RequestExecutor.w(i.a,t)}}}}}}};O365SuiteServiceProxy.RequestExecutor.J=function(){return!!document.body||O365SuiteServiceProxy.RequestExecutor.B};O365SuiteServiceProxy.RequestExecutor.F=function(n,t){O365SuiteServiceProxy.RequestExecutor.n||(O365SuiteServiceProxy.RequestExecutor.n=[]);O365SuiteServiceProxy.RequestExecutor.m||(O365SuiteServiceProxy.RequestExecutor.m=[]);O365SuiteServiceProxy.RequestExecutor.n.push(n);O365SuiteServiceProxy.RequestExecutor.m.push(t)};O365SuiteServiceProxy.RequestExecutor.internalProcessWindowLoad=function(){O365SuiteServiceProxy.RequestExecutor.B=!0;var t=O365SuiteServiceProxy.RequestExecutor.n;O365SuiteServiceProxy.RequestExecutor.n=null;var u=O365SuiteServiceProxy.RequestExecutor.m;O365SuiteServiceProxy.RequestExecutor.m=null;if(t)for(var n=0;n<t.length;n++){var r=t[n];var i=u[n];r.a(i)}};O365SuiteServiceProxy.RequestExecutor.O=function(){O365SuiteServiceProxy.RequestExecutor.q=!1};O365SuiteServiceProxy.RequestExecutor.z=function(){if(!O365SuiteServiceProxy.RequestExecutor.u){if(_j.G.a().I){var t=window.status;var n=window.status+ +new Date;window.status=n;O365SuiteServiceProxy.RequestExecutor.o=window.status===n;window.status=t}O365SuiteServiceProxy.RequestExecutor.u=!0}return O365SuiteServiceProxy.RequestExecutor.o};O365SuiteServiceProxy.RequestExecutor.A=function(n){var e={};if(!O365SuiteServiceProxy.a.c(n))for(var s=new RegExp("\r?\n"),o=n.split(s),f=0;f<o.length;f++){var t=o[f];if(!O365SuiteServiceProxy.a.c(t)){var r=t.indexOf(":");if(r>0){var i=t.substr(0,r);var u=t.substr(r+1);i=O365SuiteServiceProxy.RequestExecutorNative.trim(i);u=O365SuiteServiceProxy.RequestExecutorNative.trim(u);e[i.toUpperCase()]=u}}}return e};O365SuiteServiceProxy.RequestExecutor.P=function(n){if(O365SuiteServiceProxy.a.a(n))throw O365SuiteServiceProxy.a.f("requestInfo");O365SuiteServiceProxy.a.e(n.a,"requestInfo.url","string",!0);O365SuiteServiceProxy.a.e(n.d,"requestInfo.body","string",!1);O365SuiteServiceProxy.a.e(n.f,"requestInfo.success","function",!1);O365SuiteServiceProxy.a.e(n.c,"requestInfo.error","function",!1);O365SuiteServiceProxy.a.e(n.g,"requestInfo.timeout","number",!1);O365SuiteServiceProxy.a.e(n.b,"requestInfo.method","string",!1);O365SuiteServiceProxy.a.e(n.k,"requestInfo.BinaryRequestBody","boolean",!1);O365SuiteServiceProxy.a.e(n.i,"requestInfo.BinaryResponseBody","boolean",!1);n.b=O365SuiteServiceProxy.a.c(n.b)?"GET":n.b.toUpperCase();O365SuiteServiceProxy.a.a(n.g)&&(n.g=6e4);if(n.g<0)throw O365SuiteServiceProxy.a.f("requestInfo.timeout");if(O365SuiteServiceProxy.a.c(n.a))throw O365SuiteServiceProxy.a.f("requestInfo.url");};O365SuiteServiceProxy.RequestExecutor.x=function(n){if(O365SuiteServiceProxy.RequestExecutor.v){O365SuiteServiceProxy.RequestExecutor.t++;n.dataRequestId=O365SuiteServiceProxy.RequestExecutor.t;O365SuiteServiceProxy.RequestExecutor.v(O365SuiteServiceProxy.RequestExecutor.t,n)}};O365SuiteServiceProxy.RequestExecutor.w=function(n,t){if(O365SuiteServiceProxy.RequestExecutor.s){var i=new O365SuiteServiceProxy.k;i.a=t.responseText;i.i=t.responseAvailable;i.d=t.statusCode;i.j=t.statusText;i.f=t.contentType;i.g=t.allResponseHeaders;i.b=O365SuiteServiceProxy.RequestExecutor.A(t.allResponseHeaders);i.k=t.binaryStringResponseBody;i.e=t.responseObject;i.h=n.m;i.c=t.performanceTrace;O365SuiteServiceProxy.RequestExecutor.d(n,i,t.errorCode,t.errorMessage)}};O365SuiteServiceProxy.RequestExecutor.d=function(n,t,i,r){if(O365SuiteServiceProxy.RequestExecutor.s&&"dataRequestId"in n){var u=n.dataRequestId;O365SuiteServiceProxy.RequestExecutor.s(u,t,i,r)}};O365SuiteServiceProxy.RequestExecutor.prototype={i:null,h:null,g:0,r:function(){return this.formDigestHandlingEnabled},s:function(){return this.iFrameSourceUrl},k:function(){return O365SuiteServiceProxy.RequestExecutor.r(this.h,this.s())},a:function(n){this.m(n,!1);return this.l(n)},d:function(n){this.m(n,!0);return this.l(n)},PI:function(){return!!O365SuiteServiceProxy.RequestExecutor.f&&O365SuiteServiceProxy.RequestExecutor.f[this.k()]},b:function(n){if(this.g===2)this.j("Storage",n);else if(this.g===1)try{var i=n.j;var f=this;var r=function(t){var i=new O365SuiteServiceProxy.k;i.e=t;O365SuiteServiceProxy.RequestExecutor.x(n);n.f&&n.f(i);O365SuiteServiceProxy.RequestExecutor.d(n,i,0,null)};i.requestType===1?O365SuiteServiceProxy.f.i(i,r):O365SuiteServiceProxy.f.h(i,r)}catch(u){n.c&&n.c(new O365SuiteServiceProxy.k,0,u.message);var t=u.errorCode;t||(t=0);O365SuiteServiceProxy.RequestExecutor.d(n,new O365SuiteServiceProxy.k,t,u.message)}},e:function(n){this.g===2&&this.j("UserState",n)},j:function(n,t){O365SuiteServiceProxy.RequestExecutor.C();this.n();O365SuiteServiceProxy.RequestExecutor.x(t);t.o=O365SuiteServiceProxy.e.c();O365SuiteServiceProxy.RequestExecutor.J()?this.o(n,this.k(),t):O365SuiteServiceProxy.RequestExecutor.F(this,t)},o:function(n,t,i){var r=new O365SuiteServiceProxy.o;r.d=n;r.c=i.o;r.b=t;r.a=i;O365SuiteServiceProxy.RequestExecutor.e||(O365SuiteServiceProxy.RequestExecutor.e={});O365SuiteServiceProxy.RequestExecutor.b||(O365SuiteServiceProxy.RequestExecutor.b={});O365SuiteServiceProxy.RequestExecutor.i||(O365SuiteServiceProxy.RequestExecutor.i={});O365SuiteServiceProxy.RequestExecutor.f||(O365SuiteServiceProxy.RequestExecutor.f={});O365SuiteServiceProxy.RequestExecutor.g||(O365SuiteServiceProxy.RequestExecutor.g={});O365SuiteServiceProxy.RequestExecutor.l||(O365SuiteServiceProxy.RequestExecutor.l={});O365SuiteServiceProxy.RequestExecutor.a||(O365SuiteServiceProxy.RequestExecutor.a={});var u=O365SuiteServiceProxy.RequestExecutor.e[t];if(!u){u=[];O365SuiteServiceProxy.RequestExecutor.e[t]=u}O365SuiteServiceProxy.RequestExecutor.a[r.c]=r;if(r.a.g>0){var e=O365SuiteServiceProxy.RequestExecutorNative.getIFrameRequestTimeoutCallback(r.c);r.e=window.setTimeout(e,r.a.g)}var f=O365SuiteServiceProxy.RequestExecutor.y(t);if(f)O365SuiteServiceProxy.RequestExecutor.i[t]&&O365SuiteServiceProxy.RequestExecutor.f[t]?O365SuiteServiceProxy.RequestExecutor.sendPostMessage(r):u.push(r);else{u.push(r);f=O365SuiteServiceProxy.RequestExecutor.H(t)}},q:function(n,t){var i=O365SuiteServiceProxy.a.i();var u=O365SuiteServiceProxy.a.h(t.a);i.open(t.b,u);var o=!1;if(t.h){var s=t.h;for(var h in s){var r={key:h,value:s[h]};if(!O365SuiteServiceProxy.a.c(r.key)){i.setRequestHeader(r.key,r.value);r.key.toLowerCase()==="x-requestdigest"&&(o=!0)}}}o||O365SuiteServiceProxy.a.c(n)||i.setRequestHeader("X-RequestDigest",n);t.i&&O365SuiteServiceProxy.e.i(i);var e=0;t.g>0&&(e=window.setTimeout(O365SuiteServiceProxy.RequestExecutorNative.getXMLHttpRequestTimeoutCallback(i,t),t.g));i.onreadystatechange=O365SuiteServiceProxy.RequestExecutorNative.getXMLHttpRequestOnreadystatechangeCallback(i,t,e);var f=t.d;t.k&&(f=O365SuiteServiceProxy.e.g(t.d));this.i&&this.i(i,null,null);if(!O365SuiteServiceProxy.ServiceHandlers.IsAllowedApi(u)){O365.Log.WriteShellLog(175262,6,13,0);O365SuiteServiceProxy.RequestExecutor.h(t,-1009,"Access denied");O365.Log.i("Query",t.b,null,u,-1009,-1,-1);return}O365SuiteServiceProxy.RequestExecutor.x(t);t.l=Date.now();i.send(f)},p:function(n){var t=O365SuiteServiceProxy.RequestExecutor.r(this.h,"_api/contextinfo");t=O365SuiteServiceProxy.a.h(t);var i=this;O365SuiteServiceProxy.RequestExecutor.I(this.h,t,this.r(),n,function(n,t){i.q(n,t)})},c:function(n){this.i=n},f:function(n){this.j("TokenPrefetch",n)},n:function(){if(!O365SuiteServiceProxy.RequestExecutor.q){var n=window.O365SuiteServiceProxy.RequestExecutor.internalOnMessage;if(O365SuiteServiceProxy.a.d(window.addEventListener))if(O365SuiteServiceProxy.a.d(window.attachEvent)){O365.Log.WriteShellLog(175278,6,13,0);throw O365SuiteServiceProxy.a.b("Invalid operation",-2002);}else{window.attachEvent("onmessage",n);O365SuiteServiceProxy.RequestExecutor.q=!0}else{window.addEventListener("message",n,!1);O365SuiteServiceProxy.RequestExecutor.q=!0}}},l:function(n){if(this.g===2)this.j("Query",n);else{O365SuiteServiceProxy.RequestExecutor.C();this.p(n)}return n.o},m:function(n,t){O365SuiteServiceProxy.RequestExecutor.P(n);if(O365SuiteServiceProxy.a.j(n.a)){if(!t&&O365SuiteServiceProxy.RequestExecutor.j(n.a).toLowerCase()!==O365SuiteServiceProxy.RequestExecutor.j(this.h).toLowerCase())throw O365SuiteServiceProxy.a.f("requestInfo.url");}else n.a=O365SuiteServiceProxy.RequestExecutor.r(this.h,n.a);(n.k||n.i)&&O365SuiteServiceProxy.RequestExecutor.G()}};O365SuiteServiceProxy.i=function(){this.o=new Array(0);this.j=[]};O365SuiteServiceProxy.i.prototype={p:!1,l:null,m:null,h:null,k:!1,i:null,d:function(){return this.k},a:function(){return!!this.h},x:function(){return!this.k&&!O365SuiteServiceProxy.d.a.j},CallSuiteServiceAction:function(n,t,i,r){this.CallSuiteServiceActionWithAdditionalHeaders(n,t,null,i,r)},CallO365SuiteServiceAction:function(n,t,i,r,u){_o365su.b.ThrowOnNullOrEmpty(n,"resourceUrl");_o365su.b.ThrowOnUndefined(i,"method");_o365su.b.ThrowOnNullOrUndefined(r,"successCallback");_o365su.b.ThrowOnNullOrUndefined(u,"errorCallback");this.i||O365SuiteServiceProxy.d.a.h||!O365SuiteServiceProxy.d.a.g||(this.i=new O365SuiteServiceProxy.t(this));i===2&&_o365su.b.ThrowOnUndefined(t,"data");var f=null;if(O365SuiteServiceProxy.d.a.c){f={};f["X-UpnAnchorMailbox"]=O365SuiteServiceProxy.d.a.c}var s=O365SuiteServiceProxy.d.a.f;var h=s.replace("owa/service.svc",n);this.i&&this.i.f(f);var e=u;if(this.i){var o=this;e=function(n){o.i.d(n,u)}}var c=this;this.r(h,f,t,i,function(n){r(_o365su.f.b(n))},e)},CallSuiteServiceActionWithAdditionalHeaders:function(n,t,i,r,u){_o365su.b.ThrowOnNullOrEmpty(n,"action");_o365su.b.ThrowOnUndefined(t,"data");_o365su.b.ThrowOnNullOrUndefined(r,"successCallback");_o365su.b.ThrowOnNullOrUndefined(u,"errorCallback");var f=O365SuiteServiceProxy.d.a.f;var s=f.toLowerCase().endsWith("suiteservice.svc")?"{0}/?action={1}":"{0}?action={1}";var o=this.y(n)?n:n+"&UA=0";var e=String.format(s,f,o);i||(i={});i.Action=n;var h=this;this.r(e,i,t,1,function(n){r(_o365su.f.b(n))},u)},r:function(n,t,i,r,u,f){var e={};if(t){var v=t;for(var b in v){var y={key:b,value:v[b]};e[y.key]=y.value}}e.Accept="application/json";e["Content-type"]="application/json; charset=utf-8";var d=O365SuiteServiceProxy.d.a.q;var g=O365SuiteServiceProxy.d.a.k;var w=d||g;var o=O365SuiteServiceProxy.Util.e(w);e["X-OWA-CorrelationId"]=o;var c=_o365su.f.a(i);var h=O365SuiteServiceProxy.REF.get_SI();if(!h){O365.Log.WriteShellLog(402540,4,13,0,n);this.n(t,f,O365SuiteServiceProxy.Util.a(null,-1011,"SuiteService"));return}var l=!1;if(!this.p){l=!0;this.p=!0;O365.PM.rle("D1")}var p=this;var a=_o365su.h.b(function(n,t){t&&O365.PM.rle("D2");p.i&&p.i.e(n.b);u(n.a)},l);var s=this;var k=_o365su.h.b(function(i,u){u&&O365.PM.rle("D2");if(i.HttpStatus===449)s.q(h,n,c,e,r,a,function(n){s.n(t,f,n)});else if(i["X-SUITE-ERROR"]&&i["X-SUITE-ERROR"]==="WrongServerException"){o=O365SuiteServiceProxy.Util.e(w);e["X-OWA-CorrelationId"]=o;O365.Log.WriteShellLog(420705,1,13,0,o);s.q(h,n,c,e,r,function(n){O365.Log.b("RequestExecuter_WrongServerException_RetrySucceeded",4,o);O365.Log.WriteShellLog(420732,1,13,0);a(n)},function(n){O365.Log.a("RequestExecuter_WrongServerException_RetryFailed",6,n,o);O365.Log.WriteShellLog(417844,4,13,0,o,n);s.n(t,f,n)})}else s.n(t,f,i)},l);this.q(h,n,c,e,r,a,k)},CallAdminServiceGenericFunction:function(n,t,i,r,u,f,e){var s=String.format("{0}{1}",O365SuiteServiceProxy.d.a.b,n.startsWith("/")?n.substr(1):n);i||(i={});"Content-Type"in i||(i["Content-Type"]="application/json;charset=UTF-8");"Accept"in i||(i.Accept="application/json");var o=new O365SuiteServiceProxy.j;o.b=t;o.a=s;o.d=_o365su.f.a(r);o.h=i;o.n=e;var c=this;o.f=function(n){if(_o365su.f.d(n.b,"error")==="error"){f(O365SuiteServiceProxy.Util.a(null,-1003,"AdminGeneric"));return}e&&(n.c?O365.Log.WriteShellLog(410521,1,1,0,s,t,O365SuiteServiceProxy.c.c(n.c)):O365.Log.WriteShellLog(410522,4,1,0,s,t));try{var i=_o365su.f.b(n.a);u(i)}catch(r){f(O365SuiteServiceProxy.Util.a(null,-1002,"AdminGeneric"));return}};var l=this;o.c=function(n,i,r){f(O365SuiteServiceProxy.Util.a(n,i,r));e&&(n.c?O365.Log.WriteShellLog(410680,1,1,0,s,t,O365SuiteServiceProxy.c.c(n.c)):O365.Log.WriteShellLog(410681,4,1,0,s,t))};var h=O365SuiteServiceProxy.REF.f();h?h.a(o):f(O365SuiteServiceProxy.Util.a(null,-1011,"AdminGeneric"))},CallWebClientShellServiceFunction:function(n,t,i,r,u,f){var o=String.format("{0}/{1}",O365SuiteServiceProxy.d.a.a,n.startsWith("/")?n.substr(1):n);i||(i={});"Content-Type"in i||(i["Content-Type"]="application/json;charset=UTF-8");"Accept"in i||(i.Accept="application/json");var e=new O365SuiteServiceProxy.g;e.b=t;e.a=o;e.e=O365SuiteServiceProxy.d.a.a;e.d=_o365su.f.a(r);e.h=i;this.CallEndpointWithOauthToken(e,u,f)},PrefetchAccessToken:function(n,t){var i=new O365SuiteServiceProxy.j;i.a=n;i.e=t;var r=O365SuiteServiceProxy.REF.e();r&&r.f(i)},CallEndpointWithOauthToken:function(n,t,i){_o365su.b.ThrowOnNullOrUndefined(t,"successCallback");_o365su.b.ThrowOnNullOrUndefined(i,"errorCallback");O365SuiteServiceProxy.a.a(n.d)&&(n.d="");O365SuiteServiceProxy.a.a(n.b)&&(n.b="GET");var u=this;n.f=function(n){try{var r="";O365SuiteServiceProxy.a.a(n.f)||(r=n.f.indexOf("application/json")>-1?_o365su.f.b(n.a):n.a);t(r)}catch(u){i(Error.create("Invalid response format."));return}};var f=this;n.c=function(n,t,r){i(O365SuiteServiceProxy.Util.a(n,t,r))};var r=O365SuiteServiceProxy.REF.e();r?r.d(n):i(O365SuiteServiceProxy.Util.a(null,-1011,"OauthTokenFactoryIframe"))},c:function(n,t,i){_o365su.b.ThrowOnNullOrUndefined(t,"successCallback");_o365su.b.ThrowOnNullOrUndefined(i,"errorCallback");var e=String.format("{0}{1}.model?format=json",O365SuiteServiceProxy.d.a.b,n);var u={};u.Accept="*/*";u["Content-Type"]="application/json";var r=new O365SuiteServiceProxy.j;r.b="POST";r.a=e;r.d="";r.h=u;var o=this;r.f=function(n){if(_o365su.f.d(n.b,"error")==="error"){i(Error.create("Failed to retrieve alerts."));return}try{var r=_o365su.f.b(n.a);t(r)}catch(u){i(Error.create("Invalid alerts response format."));return}};var s=this;r.c=function(n,t,r){i(O365SuiteServiceProxy.Util.a(n,t,r))};var f=O365SuiteServiceProxy.REF.f();f?f.a(r):i(O365SuiteServiceProxy.Util.a(null,-1011,"Admin"))},SessionStorageRequest:function(n,t,i){_o365su.b.ThrowOnUndefined(n,"data");_o365su.b.ThrowOnNullOrUndefined(t,"successCallback");_o365su.b.ThrowOnNullOrUndefined(i,"errorCallback");if(this.v(4)){i(O365SuiteServiceProxy.Util.a(null,-1010,this.h));return}var r=new O365SuiteServiceProxy.j;r.a=O365SuiteServiceProxy.d.a.e;r.j=n;r.g=3e4;var f=this;r.f=function(n){t(n.e)};var e=this;r.c=function(n,t,r){i(Error.invalidOperation(r))};var u=O365SuiteServiceProxy.REF.get_SI();u?u.b(r):i(O365SuiteServiceProxy.Util.a(null,-1011,"SuiteService"))},SuiteDataSharingRequest:function(n,t,i){_o365su.b.ThrowOnUndefined(n,"data");_o365su.b.ThrowOnNullOrUndefined(t,"successCallback");_o365su.b.ThrowOnNullOrUndefined(i,"errorCallback");var r=new O365SuiteServiceProxy.j;r.j=n;r.g=3e4;var f=this;r.f=function(n){t(n.e)};var e=this;r.c=function(n,t,r){i(Error.invalidOperation(r))};var u=null;if(O365SuiteServiceProxy.d.a.d){r.a=O365SuiteServiceProxy.d.a.d;u=O365SuiteServiceProxy.REF.get_SSI()}else if(!this.a()){r.a=O365SuiteServiceProxy.d.a.e;u=O365SuiteServiceProxy.REF.get_SI()}u?u.b(r):i(O365SuiteServiceProxy.Util.a(null,-1011,"SuiteDataSharing"))},ProxyIdentityProviderRequest:function(n,t,i){if(this.h){i(O365SuiteServiceProxy.Util.a(null,-1010,this.h));return}var r=new O365SuiteServiceProxy.j;r.j=n;r.g=6e4;var f=this;r.f=function(n){t(n.e)};var e=this;r.c=function(n,t,r){i(Error.invalidOperation(r))};var u=O365SuiteServiceProxy.REF.get_SI();u?u.e(r):i(O365SuiteServiceProxy.Util.a(null,-1011,"SuiteService"))},f:function(n){this.l=n},g:function(n){this.m=n},e:function(n){this.k||O365SuiteServiceProxy.d.a.j?n():this.o.push(n)},b:function(n){for(var t=[],i=1;i<arguments.length;++i)t[i-1]=arguments[i];if(!this.h||n===11){this.h=O365SuiteServiceProxy.h.toString(n);O365.Log.b("RequestExecuter_SuiteServiceCallsBlocked",4,O365SuiteServiceProxy.h.toString(n));var r=this;_j.e.l(function(n,t,i,r,u,f,e,o,s,h){});n===5?O365.Log.WriteShellLog.apply(null,[400954,1,13,0].concat(t)):n===7?O365.Log.WriteShellLog.apply(null,[400955,1,13,0].concat(t)):n===6?O365.Log.WriteShellLog.apply(null,[400392,1,13,0].concat(t)):n===3?O365.Log.WriteShellLog.apply(null,[400957,1,13,0].concat(t)):n===1?O365.Log.WriteShellLog.apply(null,[400211,1,13,0].concat(t)):n===4?O365.Log.WriteShellLog.apply(null,[402499,1,13,0].concat(t)):n===2?O365.Log.WriteShellLog.apply(null,[402498,1,13,0].concat(t)):n===8?O365.Log.WriteShellLog.apply(null,[403710,1,13,0].concat(t)):n===9?O365.Log.WriteShellLog.apply(null,[419140,1,13,0].concat(t)):n===10?O365.Log.WriteShellLog.apply(null,[419141,1,13,0].concat(t)):n===11?O365.Log.WriteShellLog.apply(null,[421003,1,13,0].concat(t)):O365.Log.WriteShellLog.apply(null,[402497,4,13,0,n].concat(t))}},q:function(n,t,i,r,u,f,e){_o365su.b.ThrowOnNullOrUndefined(t,"url");_o365su.b.ThrowOnNullOrUndefined(f,"successCallback");_o365su.b.ThrowOnNullOrUndefined(e,"errorCallback");if(this.v(this.t(t))){e(O365SuiteServiceProxy.Util.a(null,-1010,this.h));return}var c=null;var o=new O365SuiteServiceProxy.j;o.h=r;o.a=t;o.b=_o365su.e.toString(u);u&&(o.d=i);var l=this;o.f=function(n){var t=O365SuiteServiceProxy.Util.f(n.b);if(t){l.s(t);e(O365SuiteServiceProxy.Util.a(n,n.d,t));return}_o365su.h.a(f,n);c&&c()};var h=this;o.c=function(n,t,i){var r=O365SuiteServiceProxy.Util.f(n.b);r&&h.s(r);if(n.d===440||n.d===401){h.b(3,t,i);h.l&&h.l()}e(O365SuiteServiceProxy.Util.a(n,t,i))};if(this.x())if(this.u(r)){var s=this;c=function(){s.k=!0;for(var n=0;n<s.j.length;n++)_o365su.h.a(function(n){n.b.a(n.c)},s.j[n]);Array.clear(s.j);c=null;s.w()}}else if(this.t(o.a)===2){Array.add(this.j,new O365SuiteServiceProxy.i.d(n,o,e));return}n.a(o)},t:function(n){if(n){var t=O365SuiteServiceProxy.e.d(n);if(t.startsWith("O365SuiteService/api/"))return 3;else if(t.startsWith("owa/service.svc"))return 2}return 1},s:function(n){if(n.indexOf("OwaInvalidUserLanguageException")>-1){this.b(4,n);this.m&&this.m()}else n==="InvalidMailbox"?this.b(9,n):n==="ShardMailbox"&&this.b(10,n)},u:function(n){var t=O365SuiteServiceProxy.d.a.p;return!!t&&t===_o365su.f.d(n,"Action")},y:function(n){return Array.contains(O365SuiteServiceProxy.i.c,n.toLowerCase())?!0:!1},n:function(n,t,i){O365.Log.a("RequestExecuter_ExecuteErrorCallback",4,i);_o365su.h.a(t,i);if(!this.k&&this.u(n)){var u=O365SuiteServiceProxy.Util.d(i);var e=u===-1005?8:5;this.b(e,u,i.message);for(var f=O365SuiteServiceProxy.Util.a(null,-1010,"App initialization failed, call canceled",u,i.message),r=0;r<this.j.length;r++){var o=this;_o365su.h.a(function(n){n.a(f)},this.j[r])}Array.clear(this.j)}},v:function(n){return!!this.h&&!(n!==2&&Array.contains(O365SuiteServiceProxy.i.b,this.h))},w:function(){for(var i=this.o,r=i.length,n=0;n<r;++n){var t=i[n];t&&t()}Array.clear(this.o)}};O365SuiteServiceProxy.i.d=function(n,t,i){this.b=n;this.c=t;this.a=i};O365SuiteServiceProxy.i.d.prototype={b:null,c:null,a:null};O365SuiteServiceProxy.l=function(n){this.a=n};O365SuiteServiceProxy.l.b=function(){var n=+new Date;O365SuiteServiceProxy.l.a=O365SuiteServiceProxy.l.a===99?0:O365SuiteServiceProxy.l.a+1;return new O365SuiteServiceProxy.l(n*100+O365SuiteServiceProxy.l.a)};O365SuiteServiceProxy.l.prototype={a:0};O365SuiteServiceProxy.g=function(){O365SuiteServiceProxy.g.initializeBase(this)};O365SuiteServiceProxy.Util=function(){};O365SuiteServiceProxy.Util.NoOpErrorCallbackIfNullOrUndefined=function(n){return n?n:function(n){}};O365SuiteServiceProxy.Util.a=function(n,t,i){for(var e=[],r=3;r<arguments.length;++r)e[r-3]=arguments[r];var f=O365SuiteServiceProxy.Util.i(n);f.errorCode=t;t===-1003;for(var s=0,o=e,c=o.length,u=0;u<c;++u){var h=o[u];f["arg"+s.toString()]=h;s++}return Error.create(i,f)};O365SuiteServiceProxy.Util.d=function(n){var i=0;var t=n.errorCode;t&&(i=t);return i};O365SuiteServiceProxy.Util.b=function(n){return O365SuiteServiceProxy.Util.c(n["X-OWA-CORRELATIONID"],n)};O365SuiteServiceProxy.Util.c=function(n,t){var u=t["X-OWA-ERROR"];var r=null;u?r=u:t["X-SUITE-ERROR"]?r=t["X-SUITE-ERROR"]:t&&(r=t.message);var e=t["X-FESERVER"];var f=t["X-BESERVER"];var i=new Array(3);i[0]=n||null;i[1]=e&&f?String.format("FE_{0}_BE_{1}",e,f):null;i[2]=r||null;return i};O365SuiteServiceProxy.Util.e=function(n){var t=O365SuiteServiceProxy.l.b().a.toString();return n+"_"+t};O365SuiteServiceProxy.Util.h=function(){return String.format("FE_{0}_BE_{1}",O365SuiteServiceProxy.d.a.o,O365SuiteServiceProxy.d.a.n)};O365SuiteServiceProxy.Util.f=function(n){if(!n)return null;var t=n["X-FESERVER"];t&&(O365SuiteServiceProxy.d.a.o=t);t=n["X-BESERVER"];t&&(O365SuiteServiceProxy.d.a.n=t);t=n["X-OWA-ERROR"];return t?t:null};O365SuiteServiceProxy.Util.i=function(n){var r={};if(n){r.HttpStatus=n.d;if(n.b)for(var u=O365SuiteServiceProxy.Util.g,f=u.length,t=0;t<f;++t){var i=u[t];n.b[i]&&(r[i]=n.b[i])}}return r};O365SuiteServiceProxy.t.registerClass("O365SuiteServiceProxy.t");O365SuiteServiceProxy.j.registerClass("O365SuiteServiceProxy.j");O365SuiteServiceProxy.o.registerClass("O365SuiteServiceProxy.o");O365SuiteServiceProxy.k.registerClass("O365SuiteServiceProxy.k");O365SuiteServiceProxy.RequestExecutor.registerClass("O365SuiteServiceProxy.RequestExecutor",null,O365SuiteServiceProxy.y);O365SuiteServiceProxy.i.d.registerClass("O365SuiteServiceProxy.i.d");O365SuiteServiceProxy.g.registerClass("O365SuiteServiceProxy.g",O365SuiteServiceProxy.j);O365SuiteServiceProxy.REF.d=null;O365SuiteServiceProxy.REF.a=null;O365SuiteServiceProxy.REF.b=null;O365SuiteServiceProxy.REF.c=null;O365SuiteServiceProxy.d.a=null;O365SuiteServiceProxy.d.c=!1;O365SuiteServiceProxy.RequestExecutor.D=null;O365SuiteServiceProxy.RequestExecutor.e=null;O365SuiteServiceProxy.RequestExecutor.i=null;O365SuiteServiceProxy.RequestExecutor.f=null;O365SuiteServiceProxy.RequestExecutor.g=null;O365SuiteServiceProxy.RequestExecutor.b=null;O365SuiteServiceProxy.RequestExecutor.l=null;O365SuiteServiceProxy.RequestExecutor.a=null;O365SuiteServiceProxy.RequestExecutor.c=null;O365SuiteServiceProxy.RequestExecutor.q=!1;O365SuiteServiceProxy.RequestExecutor.o=!1;O365SuiteServiceProxy.RequestExecutor.u=!1;O365SuiteServiceProxy.RequestExecutor.p=null;O365SuiteServiceProxy.RequestExecutor.k=null;O365SuiteServiceProxy.RequestExecutor.B=!1;O365SuiteServiceProxy.RequestExecutor.n=null;O365SuiteServiceProxy.RequestExecutor.m=null;O365SuiteServiceProxy.RequestExecutor.t=0;O365SuiteServiceProxy.RequestExecutor.v=null;O365SuiteServiceProxy.RequestExecutor.s=null;O365SuiteServiceProxy.i.a=new O365SuiteServiceProxy.i;O365SuiteServiceProxy.i.b=[O365SuiteServiceProxy.h.toString(4),O365SuiteServiceProxy.h.toString(5),O365SuiteServiceProxy.h.toString(9),O365SuiteServiceProxy.h.toString(10)];O365SuiteServiceProxy.i.c=["getowauserconfiguration"];O365SuiteServiceProxy.l.a=-1;O365SuiteServiceProxy.Util.g=["X-OWA-CORRELATIONID","X-FESERVER","X-BESERVER","X-OWA-ERROR","X-SUITE-ERROR"];var _requestExecutorNative=function(){};var _o365SuiteServiceProxy=window.O365SuiteServiceProxy;_requestExecutorNative.getIFrameOnloadCallback=function(n){return function(){_o365SuiteServiceProxy.RequestExecutor.internalProcessIFrameOnload(n)}};_requestExecutorNative.getXMLHttpRequestOnreadystatechangeCallback=function(n,t,i){return function(){_o365SuiteServiceProxy.RequestExecutor.internalProcessXMLHttpRequestOnreadystatechange(n,t,i)}};_requestExecutorNative.getXMLHttpRequestTimeoutCallback=function(n,t){return function(){_o365SuiteServiceProxy.RequestExecutor.internalProcessXMLHttpRequestTimeoutCallback(n,t)}};_requestExecutorNative.getIFrameRequestTimeoutCallback=function(n){return function(){_o365SuiteServiceProxy.RequestExecutor.internalProcessIFrameRequestTimeoutCallback(n)}};_requestExecutorNative.emptyCallback=function(){};_requestExecutorNative.trim=function(n){return n.replace(/^\s+|\s+$/g,"")};_o365SuiteServiceProxy.RequestExecutorNative=_requestExecutorNative;window.document.addEventListener?window.addEventListener("load",_o365SuiteServiceProxy.RequestExecutor.internalProcessWindowLoad,!1):window.document.attachEvent&&window.attachEvent("onload",_o365SuiteServiceProxy.RequestExecutor.internalProcessWindowLoad);typeof Sys!="undefined"&&Sys&&Sys.Application&&Sys.Application.notifyScriptLoaded();typeof NotifyScriptLoadedAndExecuteWaitingJobs=="function"&&NotifyScriptLoadedAndExecuteWaitingJobs("O365SuiteServiceProxy.requestexecutor.js");
window.scriptsLoaded['microsoft.o365.suiteserviceproxy.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.o365.suiteserviceproxy.js'] = (new Date()).getTime();
