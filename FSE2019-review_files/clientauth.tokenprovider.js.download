window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['clientauth.tokenprovider.js'] = (new Date()).getTime();
window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['clientauth.tokenProvider.js'] = (new Date()).getTime();window.ClientAuth=window.ClientAuth||{},window.ClientAuth.tokenProvider=function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="","undefined"!=typeof window&&window.bootstrapOptions&&window.bootstrapOptions.scriptBaseUrl&&(n.p=window.bootstrapOptions.scriptBaseUrl),n(n.s=16)}([function(e,t,n){"use strict";n.r(t),n.d(t,"__extends",function(){return o}),n.d(t,"__assign",function(){return i}),n.d(t,"__rest",function(){return u}),n.d(t,"__decorate",function(){return a}),n.d(t,"__param",function(){return c}),n.d(t,"__metadata",function(){return s}),n.d(t,"__awaiter",function(){return l}),n.d(t,"__generator",function(){return f}),n.d(t,"__exportStar",function(){return d}),n.d(t,"__values",function(){return p}),n.d(t,"__read",function(){return v}),n.d(t,"__spread",function(){return h}),n.d(t,"__await",function(){return y}),n.d(t,"__asyncGenerator",function(){return g}),n.d(t,"__asyncDelegator",function(){return _}),n.d(t,"__asyncValues",function(){return m}),n.d(t,"__makeTemplateObject",function(){return b});
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};function o(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e};function u(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&(n[r[o]]=e[r[o]])}return n}function a(e,t,n,r){var o,i=arguments.length,u=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(u=(i<3?o(u):i>3?o(t,n,u):o(t,n))||u);return i>3&&u&&Object.defineProperty(t,n,u),u}function c(e,t){return function(n,r){t(n,r,e)}}function s(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function l(e,t,n,r){return new(n||(n=Promise))(function(o,i){function u(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(u,a)}c((r=r.apply(e,t||[])).next())})}function f(e,t){var n,r,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,r&&(o=r[2&i[0]?"return":i[0]?"throw":"next"])&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[0,o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,r=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!(o=(o=u.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}function d(e,t){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}function p(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}function v(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),u=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)u.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return u}function h(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(v(arguments[t]));return e}function y(e){return this instanceof y?(this.v=e,this):new y(e)}function g(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,o=n.apply(e,t||[]),i=[];return r={},u("next"),u("throw"),u("return"),r[Symbol.asyncIterator]=function(){return this},r;function u(e){o[e]&&(r[e]=function(t){return new Promise(function(n,r){i.push([e,t,n,r])>1||a(e,t)})})}function a(e,t){try{!function(e){e.value instanceof y?Promise.resolve(e.value.v).then(c,s):l(i[0][2],e)}(o[e](t))}catch(e){l(i[0][3],e)}}function c(e){a("next",e)}function s(e){a("throw",e)}function l(e,t){e(t),i.shift(),i.length&&a(i[0][0],i[0][1])}}function _(e){var t,n;return t={},r("next"),r("throw",function(e){throw e}),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,o){e[r]&&(t[r]=function(t){return(n=!n)?{value:y(e[r](t)),done:"return"===r}:o?o(t):t})}}function m(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator];return t?t.call(e):p(e)}function b(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o={baseUrl:null,isServer:!1,isFeatureEnabled:function(e){return!1},actionProxyEndpoints:{ApplyConversationAction:"messaging"}},i=o;t.initializeServiceRequest=function(e){i=r.__assign({},o,e)},t.getConfig=function(){return i},t.setTimezone=function(e){i.timezone=e},t.setUseJsonNetSerializer=function(e){i.useJsonNetSerializer=e},t.actionProxyPath=function(e){var t=i.actionProxyEndpoints[e];return t||null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(19),i=n(6),u=n(3),a=n(22),c=1,s=7200,l=null;function f(e){return r.__awaiter(this,void 0,void 0,function(){var t,n;return r.__generator(this,function(r){switch(r.label){case 0:return[4,a.default(e)];case 1:return null!=(t=r.sent())&&0==t.TokenResultCode&&null!=t.AccessTokenExpiry&&(n=i(t.AccessTokenExpiry,Date.now())-s)>0&&p().put(e,t,n,function(e,t){f(e)}),[2,t]}})})}function d(e,t){var n=e.get(t),r=null;null!=n&&null!=n.AccessTokenExpiry&&(o(n.AccessTokenExpiry,c)>new Date(Date.now())&&(r=n));return r}function p(){return null==l&&(l=new u.Cache),l}t.initializeTokenProvider=function(e){l=e},t.getAccessTokenforResource=function(e){return r.__awaiter(this,void 0,void 0,function(){var t;return r.__generator(this,function(n){switch(n.label){case 0:return null!=(t=d(p(),e))?[3,2]:[4,f(e)];case 1:t=n.sent(),n.label=2;case 2:return[2,null!=t?t.AccessToken:null]}})})},t.getAccessTokenforResourceAsLazy=function(e){var t=d(p(),e);return null!=t?[t.AccessToken,null]:[null,f(e).then(function(e){return e.AccessToken})]},t.fetchAndCacheTokenFromServer=f,t.getCachedToken=d},function(e,t,n){"use strict";function r(){var e=Object.create(null),t=0,n=0,r=0,o=!1;function i(t){r--,delete e[t]}this.put=function(t,n,u,a){if(o&&console.log("caching: %s = %j (@%s)",t,n,u),void 0!==u&&("number"!=typeof u||isNaN(u)||u<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==a&&"function"!=typeof a)throw new Error("Cache timeout callback must be a function");var c=e[t];c?clearTimeout(c.timeout):r++;var s={value:n,expire:u+Date.now()};return isNaN(s.expire)||(s.timeout=setTimeout(function(){i(t),a&&a(t,n)}.bind(this),u)),e[t]=s,n},this.del=function(t){var n=!0,r=e[t];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(n=!1)):n=!1,n&&i(t),n},this.clear=function(){for(var i in e)clearTimeout(e[i].timeout);r=0,e=Object.create(null),o&&(t=0,n=0)},this.get=function(i){var u=e[i];if(void 0!==u){if(isNaN(u.expire)||u.expire>=Date.now())return o&&t++,u.value;o&&n++,r--,delete e[i]}else o&&n++;return null},this.size=function(){return r},this.memsize=function(){var t,n=0;for(t in e)n++;return n},this.debug=function(e){o=e},this.hits=function(){return t},this.misses=function(){return n},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var n in e){var r=e[n];t[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,n){var r=JSON.parse(t),i=Date.now(),u=n&&n.skipDuplicates;for(var a in r)if(r.hasOwnProperty(a)){if(u)if(e[a]){o&&console.log("Skipping duplicate imported key '%s'",a);continue}var c=r[a],s=c.expire-i;if(s<=0){this.del(a);continue}s=s>0?s:void 0,this.put(a,c.value,s)}return this.size()}}e.exports=new r,e.exports.Cache=r},function(e,t,n){var r=n(5);e.exports=function(e,t){var n=r(e).getTime(),o=Number(t);return new Date(n+o)}},function(e,t,n){var r=n(21),o=36e5,i=6e4,u=2,a=/[T ]/,c=/:/,s=/^(\d{2})$/,l=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],f=/^(\d{4})/,d=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],p=/^-(\d{2})$/,v=/^-?(\d{3})$/,h=/^-?(\d{2})-?(\d{2})$/,y=/^-?W(\d{2})$/,g=/^-?W(\d{2})-?(\d{1})$/,_=/^(\d{2}([.,]\d*)?)$/,m=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,b=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,w=/([Z+-].*)$/,O=/^(Z)$/,C=/^([+-])(\d{2})$/,k=/^([+-])(\d{2}):?(\d{2})$/;function A(e,t,n){t=t||0,n=n||0;var r=new Date(0);r.setUTCFullYear(e,0,4);var o=7*t+n+1-(r.getUTCDay()||7);return r.setUTCDate(r.getUTCDate()+o),r}e.exports=function(e,t){if(r(e))return new Date(e.getTime());if("string"!=typeof e)return new Date(e);var n=(t||{}).additionalDigits;n=null==n?u:Number(n);var x=function(e){var t,n={},r=e.split(a);if(c.test(r[0])?(n.date=null,t=r[0]):(n.date=r[0],t=r[1]),t){var o=w.exec(t);o?(n.time=t.replace(o[1],""),n.timezone=o[1]):n.time=t}return n}(e),T=function(e,t){var n,r=l[t],o=d[t];if(n=f.exec(e)||o.exec(e)){var i=n[1];return{year:parseInt(i,10),restDateString:e.slice(i.length)}}if(n=s.exec(e)||r.exec(e)){var u=n[1];return{year:100*parseInt(u,10),restDateString:e.slice(u.length)}}return{year:null}}(x.date,n),j=T.year,P=function(e,t){if(null===t)return null;var n,r,o,i;if(0===e.length)return(r=new Date(0)).setUTCFullYear(t),r;if(n=p.exec(e))return r=new Date(0),o=parseInt(n[1],10)-1,r.setUTCFullYear(t,o),r;if(n=v.exec(e)){r=new Date(0);var u=parseInt(n[1],10);return r.setUTCFullYear(t,0,u),r}if(n=h.exec(e)){r=new Date(0),o=parseInt(n[1],10)-1;var a=parseInt(n[2],10);return r.setUTCFullYear(t,o,a),r}if(n=y.exec(e))return i=parseInt(n[1],10)-1,A(t,i);if(n=g.exec(e)){i=parseInt(n[1],10)-1;var c=parseInt(n[2],10)-1;return A(t,i,c)}return null}(T.restDateString,j);if(P){var R,S=P.getTime(),U=0;return x.time&&(U=function(e){var t,n,r;if(t=_.exec(e))return(n=parseFloat(t[1].replace(",",".")))%24*o;if(t=m.exec(e))return n=parseInt(t[1],10),r=parseFloat(t[2].replace(",",".")),n%24*o+r*i;if(t=b.exec(e)){n=parseInt(t[1],10),r=parseInt(t[2],10);var u=parseFloat(t[3].replace(",","."));return n%24*o+r*i+1e3*u}return null}(x.time)),x.timezone?R=function(e){var t,n;return(t=O.exec(e))?0:(t=C.exec(e))?(n=60*parseInt(t[2],10),"+"===t[1]?-n:n):(t=k.exec(e))?(n=60*parseInt(t[2],10)+parseInt(t[3],10),"+"===t[1]?-n:n):0}(x.timezone):(R=new Date(S+U).getTimezoneOffset(),R=new Date(S+U+R*i).getTimezoneOffset()),new Date(S+U+R*i)}return new Date(e)}},function(e,t,n){var r=n(5);e.exports=function(e,t){var n=r(e),o=r(t);return n.getTime()-o.getTime()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"TokenRequest:#Exchange"},e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9),o=n(1),i=n(25),u=n(26),a=n(27),c=n(35),s=n(36),l=2048;t.makeServiceRequest=function(e,t,n){var r=o.getConfig(),f=u.default(),d=o.actionProxyPath(e),p=null!=d&&r.isFeatureEnabled("fwk-proxyActionsToOwsGateway")&&null!=r.getAuthTokenAsync,v=p?r.primeUrl?r.primeUrl+"/"+d+"/service.svc?action=":"/ows/messaging/service.svc?action=":r.baseUrl?r.baseUrl+"/service.svc?action=":"/owa/service.svc?action=";n&&(f=s.default(f,n)),void 0!==r.isUserIdle&&r.isUserIdle()&&(f.isUserActivity=!1);var h=f.headers;h.append("Content-Type","application/json; charset=utf-8"),h.append("Action",e);var y=v+e;void 0!==f.isUserActivity&&0==f.isUserActivity&&(y+="&UA=0");var g=JSON.stringify(t),_=encodeURIComponent(g);if(_.length>l?f.body=g:(y+="&EP=1",h.append("X-OWA-UrlPostData",_),f.body=null),!h.has(i.correlationVectorHeaderName)){var m=i.getCorrelationVector();m&&h.append(i.correlationVectorHeaderName,m)}if(r.appName&&(y+="&app="+r.appName),p){var b=r.getAuthTokenAsync(c.default()),w=b[0],O=b[1];return w?(h.append("Authorization","Bearer "+w),a.default(y,1,f)):O.then(function(e){return h.append("Authorization","Bearer "+e),a.default(y,1,f)})}return a.default(y,1,f)},t.getActionUrl=function(e,t){var n="";return t&&(n="",Object.keys(t).map(function(e){n+=e+"="+t[e]+"&"})),"service.svc/s/"+e+"?"+n+"X-OWA-CANARY="+r.getOwaCanaryCookie()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(10);t.getOwaCanaryCookie=function(){var e=r.getCookie("targetServer"),t="X-OWA-CANARY"+(e?"_"+e.toLocaleLowerCase():""),n=r.getCookie(t);return n&&0!=n.length?n:t+"_cookie_is_null_or_empty"},t.getOwaCanaryDebugCookie=function(){var e=r.getCookie("targetServer"),t="X-OWA-CANARY-DEBUG"+(e?"_"+e.toLocaleLowerCase():"");return r.getCookie(t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(24);t.getCookie=function(e){return r.getConfig().cookies?r.getConfig().cookies[e]:o.get(e)},t.getCookieHeaderValue=function(){var e;if(e=r.getConfig().cookies?r.getConfig().cookies:o.get()){var t=Object.keys(e);if(t&&t.length>0)return t.map(function(t){return t+"="+e[t]}).join("; ")}return null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9);t.default=function(e){e.set("X-OWA-CANARY",r.getOwaCanaryCookie());var t=r.getOwaCanaryDebugCookie();t&&e.set("X-OWA-CANARY-DEBUG",t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8);t.default=function(e){return r.makeServiceRequest("GetAuthenticationUrl",{},e)}},function(e,t,n){"use strict";t.decode=t.parse=n(38),t.encode=t.stringify=n(39)},,,function(e,t,n){e.exports=n(17)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(18);t.registerTokenProvider=r.default;var o=n(2);t.getAccessTokenforResource=o.getAccessTokenforResource;var i=n(2);t.getAccessTokenforResourceAsLazy=i.getAccessTokenforResourceAsLazy;var u=n(37);t.getDelegationToken=u.getDelegationToken,t.getDelegationTokenForOwa=u.getDelegationTokenForOwa;var a=n(42);t.bootstrap=a.bootstrap},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),o=n(2);t.default=function(e){o.initializeTokenProvider(new r.Cache),o.getAccessTokenforResource(e.location.origin)}},function(e,t,n){var r=n(20);e.exports=function(e,t){var n=Number(t);return r(e,-n)}},function(e,t,n){var r=n(4),o=6e4;e.exports=function(e,t){var n=Number(t);return r(e,n*o)}},function(e,t){e.exports=function(e){return e instanceof Date}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(7),i=n(23);t.default=function(e){return r.__awaiter(this,void 0,void 0,function(){var t;return r.__generator(this,function(n){return t={isUserActivity:!1},[2,i.default(o.default({Resource:e}),t)]})})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(8),o=n(7);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("GetAccessTokenforResource",e,t)}},function(e,t,n){var r,o;
/*!
 * JavaScript Cookie v2.1.3
 * https://github.com/js-cookie/js-cookie
 *
 * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
 * Released under the MIT license
 */!function(i){if(void 0===(o="function"==typeof(r=i)?r.call(t,n,t,e):r)||(e.exports=o),!0,e.exports=i(),!!0){var u=window.Cookies,a=window.Cookies=i();a.noConflict=function(){return window.Cookies=u,a}}}(function(){function e(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var r in n)t[r]=n[r]}return t}return function t(n){function r(t,o,i){var u;if("undefined"!=typeof document){if(arguments.length>1){if("number"==typeof(i=e({path:"/"},r.defaults,i)).expires){var a=new Date;a.setMilliseconds(a.getMilliseconds()+864e5*i.expires),i.expires=a}try{u=JSON.stringify(o),/^[\{\[]/.test(u)&&(o=u)}catch(e){}return o=n.write?n.write(o,t):encodeURIComponent(String(o)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=(t=(t=encodeURIComponent(String(t))).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent)).replace(/[\(\)]/g,escape),document.cookie=[t,"=",o,i.expires?"; expires="+i.expires.toUTCString():"",i.path?"; path="+i.path:"",i.domain?"; domain="+i.domain:"",i.secure?"; secure":""].join("")}t||(u={});for(var c=document.cookie?document.cookie.split("; "):[],s=/(%[0-9A-Z]{2})+/g,l=0;l<c.length;l++){var f=c[l].split("="),d=f.slice(1).join("=");'"'===d.charAt(0)&&(d=d.slice(1,-1));try{var p=f[0].replace(s,decodeURIComponent);if(d=n.read?n.read(d,p):n(d,p)||d.replace(s,decodeURIComponent),this.json)try{d=JSON.parse(d)}catch(e){}if(t===p){u=d;break}t||(u[p]=d)}catch(e){}}return u}}return r.set=r,r.get=function(e){return r.call(r,e)},r.getJSON=function(){return r.apply({json:!0},[].slice.call(arguments))},r.defaults={},r.remove=function(t,n){r(t,"",e(n,{expires:-1}))},r.withConverter=t,r}(function(){})})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.correlationVectorHeaderName="MS-CV";var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o={maxCorrelationVectorLength:127,baseLength:22,validationPattern:new RegExp("^["+r+"]{22}(.[0-9]+)+$")},i="",u=0;function a(){return i.concat(".",u.toString())}function c(){return!!s(a())&&function(e){return e<=o.maxCorrelationVectorLength}(i.length+1+(u+1+"").length)}function s(e){return o.validationPattern.test(e)&&e.length<=o.maxCorrelationVectorLength}t.isCorrelationVectorValid=s,t.getCorrelationVector=function(){return s(a())?c()?(u+=1,a()):null:(i=function(){for(var e="",t=0;t<o.baseLength;t++)e+=r.charAt(Math.floor(Math.random()*r.length));return e}(),u=0,function(){var e=a();return s(e)?e:""}())}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(11),o=n(10),i=n(1);t.default=function(){var e=new Headers;r.default(e);var t=i.getConfig();if(t.getAuthToken){var n=t.getAuthToken();n&&e.append("Authorization","Bearer "+n)}if(t.appName&&e.append("X-Req-Source",t.appName),t.useJsonNetSerializer&&e.append("X-UseJsonNetSerializer","1"),t.isServer){var u=o.getCookieHeaderValue();u&&e.append("Cookie",u)}return{method:"POST",credentials:"include",headers:e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(28),o=n(30),i=n(33),u=n(34),a=2,c=5e3,s=0,l={};t.registerCreateServiceResponseCallback=function(e){var t=s++;return l[t]=e,function(){delete l[t]}},t.default=function e(t,n,s){for(var f=r.default(t,s),d=Object.keys(l),p=0;p<d.length;p++)l[d[p]](f,t,n,s);return f.then(function(r){return i.default(r.status)&&n<a?(u.default(++n,s.headers),e(t,n,s)):s.returnFullResponseOnSuccess?o.fetchFullResponseHandler(r,s):o.fetchJsonHandler(r,s)},function(r){if(r.retriable&&n<a)return new Promise(function(r,o){setTimeout(function(){u.default(++n,s.headers),r(e(t,n,s))},c)});throw r})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(29),o=[],i=!1;t.default=function(e,t){return r.isInPrefetchMode()?new Promise(function(n,r){o.push({url:e,init:t,resolve:n,reject:r}),function e(){if(!i&&o.length){i=!0;var t=o.shift();fetch(t.url,t.init).then(function(n){i=!1,t.resolve(n),e()},function(n){i=!1,t.reject(n),e()})}}()}):fetch(e,t).catch(function(t){return t.message&&(t.message=t.message+". URL: "+e),t.retriable=!0,t.fetchErrorType="RequestNotComplete",Promise.reject(t)})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=!1;t.default=function(e){if(r)throw new Error("Calls to prefetch() may not be nested.");try{r=!0,e()}finally{r=!1}},t.isInPrefetchMode=function(){return r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(31),i=n(32);function u(e,t){if(401==e.status||440==e.status){if(r.getConfig().onAuthNeeded&&!i.default(t))return r.getConfig().onAuthNeeded(),!1}else if(!e.ok){if(412==e.status&&r.getConfig().onHipChallengeNeeded&&r.getConfig().onHipChallengeNeeded(e.headers))return!1;var n=a(e.statusText);throw n.response=e,n}return null!=e.headers.get("X-OWA-STO")&&o.tryBackgroundAuth(window),!0}function a(e){var t=new Error(""+e);return t.fetchErrorType="ServerFailure",t.knownError=!0,t}t.fetchJsonHandler=function(e,t){return u(e,t)?e.json().catch(function(e){throw a(e)}):null},t.fetchFullResponseHandler=function(e,t){return u(e,t)?Promise.resolve(e):null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(12),i=828e5,u=6e4,a="backgroundauth",c=null,s=null,l=null;function f(e){e.origin==l.location.origin&&e.data&&e.data.split&&("backgroundAuthResponse"==e.data.split(":")[0]&&d())}function d(){l.document.body.removeChild(c),c=null,l.document.removeEventListener("message",f)}t.tryBackgroundAuth=function(e){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(t){return null!=c?[2]:null!=s&&Date.now()-s<i?[2]:(s=Date.now(),(c=(l=e).document.createElement("iframe")).setAttribute("id",a),c.style.display="none",o.default().then(function(e){0==e.ResultCode&&null!=e.AuthenticationUrl&&""!=e.AuthenticationUrl?(l.document.body.appendChild(c),l.addEventListener("message",f,!1),c.src=e.AuthenticationUrl,setTimeout(function(){null!=c&&d()},u)):c=null}).catch(function(e){c=null}),[2])})})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(e){var t=e.headers;if(t&&null!=t.get("X-OWA-ExplicitLogonUser"))return!0}return!1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return 449==e||408==e||502==e||e<100||e>599}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(11),o="X-OWA-Attempt";t.default=function(e,t){r.default(t),t.set(o,""+e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return window.location.origin}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o={method:!0,headers:!0,returnFullResponseOnSuccess:!0,isUserActivity:!0};function i(e,t){return e&&o[t]}t.default=function(e,t){var n=r.__assign({},e);if(t.headers){var o=new Headers(t.headers),u=new Headers(n.headers);o.forEach(function(e,t){u.set(t,e)}),n.headers=u}if(t.returnFullResponseOnSuccess&&(n.returnFullResponseOnSuccess=t.returnFullResponseOnSuccess),void 0!==t.isUserActivity&&(n.isUserActivity=t.isUserActivity),n.method=t.method||n.method,!Object.keys(t).reduce(i,!0))throw"Only headers and method are allowed to be overridden";return n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(6),i=n(3),u=n(13),a=n(12),c=n(2),s=n(40),l=null;function f(e){return r.__awaiter(this,void 0,void 0,function(){var t,n;return r.__generator(this,function(r){switch(r.label){case 0:return t=e.client_id+e.scope,null!=(n=c.getCachedToken(p(),t))?[3,2]:[4,s.fetchDelegationAccessTokenFromMsa(e)];case 1:n=r.sent(),d(t,n),r.label=2;case 2:return[2,0==n.TokenResultCode?n.AccessToken:null]}})})}function d(e,t){if(t&&0==t.TokenResultCode&&t.AccessTokenExpiry){var n=o(t.AccessTokenExpiry,Date.now());n>0&&p().put(e,t,n)}}function p(){return null==l&&(l=new i.Cache),l}t.getDelegationTokenForOwa=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,o,i;return r.__generator(this,function(r){switch(r.label){case 0:return t={scope:e,client_id:"",authorization_uri:"",redirect_uri:""},n=null,[4,a.default()];case 1:return 0!=(o=r.sent()).ResultCode||null==o.ImplicitGrantAuthorizationUrl||""==o.ImplicitGrantAuthorizationUrl?[2,n]:(i=u.parse(o.ImplicitGrantAuthorizationUrl.split("?")[1]||"")).client_id&&i.redirect_uri?(t.client_id=i.client_id,t.authorization_uri=o.ImplicitGrantAuthorizationUrl.split("?")[0],t.redirect_uri=i.redirect_uri,[4,f(t)]):[3,3];case 2:n=r.sent(),r.label=3;case 3:return[2,n]}})})},t.getDelegationToken=f,t.cacheToken=d,t.initializeTokenProvider=function(e){l=e}},function(e,t,n){"use strict";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,n,i){t=t||"&",n=n||"=";var u={};if("string"!=typeof e||0===e.length)return u;var a=/\+/g;e=e.split(t);var c=1e3;i&&"number"==typeof i.maxKeys&&(c=i.maxKeys);var s=e.length;c>0&&s>c&&(s=c);for(var l=0;l<s;++l){var f,d,p,v,h=e[l].replace(a,"%20"),y=h.indexOf(n);y>=0?(f=h.substr(0,y),d=h.substr(y+1)):(f=h,d=""),p=decodeURIComponent(f),v=decodeURIComponent(d),r(u,p)?o(u[p])?u[p].push(v):u[p]=[u[p],v]:u[p]=v}return u};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,n){"use strict";var r=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,n,a){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?i(u(e),function(u){var a=encodeURIComponent(r(u))+n;return o(e[u])?i(e[u],function(e){return a+encodeURIComponent(r(e))}).join(t):a+encodeURIComponent(r(e[u]))}).join(t):a?encodeURIComponent(r(a))+n+encodeURIComponent(r(e)):""};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function i(e,t){if(e.map)return e.map(t);for(var n=[],r=0;r<e.length;r++)n.push(t(e[r],r));return n}var u=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(41),i=n(13),u={};function a(e){var t=i.parse(e),n={};return t.access_token?(n.AccessToken=t.access_token,n.AccessTokenExpiry=o(Date.now(),parseInt(t.expires_in)).toISOString(),n.TokenResultCode=0):"login_required"==t.error||"interaction_required"==t.error||"consent_required"==t.error?n.TokenResultCode=3:n.TokenResultCode=2,n}function c(e){var t={response_type:"token",prompt:"none",redirect_uri:e.redirect_uri,scope:e.scope,client_id:e.client_id};return e.authorization_uri+"?"+i.stringify(t)}t.fetchDelegationAccessTokenFromMsa=function(e){return r.__awaiter(this,void 0,void 0,function(){var t,n,o;return r.__generator(this,function(i){switch(i.label){case 0:t=e.client_id+e.scope,n=encodeURIComponent(t),o={},i.label=1;case 1:return i.trys.push([1,3,4,5]),[4,function(e,t){return r.__awaiter(this,void 0,void 0,function(){var n,o,i;return r.__generator(this,function(r){return n=encodeURIComponent(e.client_id+e.scope),o=c(e),i=null,null==t.document.getElementById(n)?((i=t.document.createElement("iframe")).src=o.toString(),i.style.display="none",i.id=n,t.document.body.appendChild(i),[2,new Promise(function(e,r){u[n]=function(n){var o={};try{this.contentWindow.location.origin==t.location.origin&&(o=a(this.contentWindow.location.hash.substring(1)))}catch(e){o.TokenResultCode=2,r(o)}e(o)},i.addEventListener("load",u[n],!1)})]):[2,{TokenResultCode:2}]})})}(e,window)];case 2:return o=i.sent(),[3,5];case 3:return i.sent(),o.TokenResultCode=2,[3,5];case 4:return function(e,t){var n=t.document.getElementById(e);null!=n&&(n.removeEventListener("load",u[e]),t.document.body.removeChild(n),delete u[e])}(n,window),[7];case 5:return[2,o]}})})},t.ParseHashParam=a,t.getAuthenticationUrl=c},function(e,t,n){var r=n(4);e.exports=function(e,t){var n=Number(t);return r(e,1e3*n)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(43),o=!1;t.bootstrap=function(e){o||(r.bootstrapServiceRequest(e),o=!0)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n(44);t.bootstrapServiceRequest=function(e){var t=o.getIndexedPath("/owa",e);r.initializeServiceRequest({baseUrl:t})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getIndexedPath=function(e,t){var n=e;if(t){var r=t.split("/").filter(function(e){return e.length});if(r.length>=2){var o=parseInt(r[1]);isNaN(o)||(n+="/"+o)}}return n}}]);
//# sourceMappingURL=clientauth.tokenProvider.js.map
window.scriptsLoaded['clientauth.tokenProvider.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['clientauth.tokenProvider.js'] = (new Date()).getTime();
window.scriptsLoaded['clientauth.tokenprovider.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['clientauth.tokenprovider.js'] = (new Date()).getTime();
