window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.core.curatedkeypoints.js'] = (new Date()).getTime();
Type.registerNamespace("Microsoft.Owa.Core.CuratedKeyPoints");Microsoft.Owa.Core.CuratedKeyPoints.b=function(n,t,i){this.c=n;this.d=t;this.e=i};Microsoft.Owa.Core.CuratedKeyPoints.b.a=function(n){var i=null;try{var t=JsonParser.deserialize(n);t&&(i=new Microsoft.Owa.Core.CuratedKeyPoints.b(t.c,t.d,t.e))}catch(r){r.stack.indexOf("SyntaxError")!==-1?i=new Microsoft.Owa.Core.CuratedKeyPoints.b(n,-1,null):_j.e.d(_a.a.C,r,r.message)}return i};Microsoft.Owa.Core.CuratedKeyPoints.b.prototype={c:null,b:function(){return this.c},e:null,a:function(){return this.e},d:0};function CuratedKeyPointsComponent(){}CuratedKeyPointsComponent.$$cctor=function(){_a.t.a().a(CuratedKeyPointsComponent)};CuratedKeyPointsComponent.prototype={b:function(n,t,i){var r=this;n.b(CuratedKeyPointsFactory,function(){return new CuratedKeyPointsFactory}).b(_mco.ba).a()},a:function(){return null}};Microsoft.Owa.Core.CuratedKeyPoints.d=function(n,t){this.l=Function.createDelegate(this,this.v);this.m=Function.createDelegate(this,this.w);this.n=Function.createDelegate(this,this.x);this.h=new _a.j;this.i=n;this.o=t;this.u()};Microsoft.Owa.Core.CuratedKeyPoints.d.prototype={i:null,o:null,g:null,j:null,d:function(n){this.j||(this.j=new _j.R);this.j.b(n)},c:function(n){this.j&&this.j.c(n)},p:!1,b:function(){return this.p},k:null,a:function(){return this.k},q:null,f:function(n){for(var i=0;i<this.h.b();i++){var t=this.h.a(i);if(t.c===n){if(t.d===-1){this.h.k(t);Array.remove(this.k,t)}else this.h.a(i).c="";break}}this.t()},e:function(n){var t=new Microsoft.Owa.Core.CuratedKeyPoints.b(n,-1,_a.C.a());this.h.c(t);this.k||(this.k=new Array(0));Array.add(this.k,t);this.t();return t},dispose:function(){this.i=null;this.o=null;if(this.g){this.g.U(this.n);this.g.T(this.m);this.g.n(this.l);this.g=null}this.q=null;this.k=null;this.j=null;if(this.h){var n=this;this.h.n(function(n){n=null});this.h.m();this.h=null}},t:function(){for(var t=new _a.j,n=0;n<this.h.b();n++)t.c(JsonParser.serialize(this.h.a(n)));this.i.hU(t);var i=new Microsoft.Owa.Core.CuratedKeyPoints.c(this.i);_a.g.a.a(i)},s:function(){this.p=!0;this.j&&this.j.d()&&this.j.a()},u:function(){var t=Microsoft.Owa.Core.CuratedKeyPoints.a.a(this.i);if(t&&!this.g){this.g=new Microsoft.Owa.Core.CuratedKeyPoints.a(this.i);this.g.c(this.n);this.g.b(this.m);this.g.a(this.l);this.o.a(this.g)}else{var n=this.i.ek();n&&this.r(n);this.s()}},x:function(n){Microsoft.Owa.Core.CuratedKeyPoints.a.isInstanceOfType(n)&&this.i&&this.i.ek()&&this.r(this.i.ek())},w:function(n){Microsoft.Owa.Core.CuratedKeyPoints.a.isInstanceOfType(n)&&this.i&&_j.e.b(_a.a.C,"GetCuratedKeyPointsDataAction failed")},v:function(n){this.s();this.g.U(this.n);this.g.T(this.m);this.g.n(this.l);this.g=null},r:function(n){if(n.b()>0){var i=new Array(0);var t=new Array(0);var r=this;n.n(function(n){var u=Microsoft.Owa.Core.CuratedKeyPoints.b.a(n);if(u){r.h.c(u);Array.add(u.d===-1?i:t,u)}});this.k=i.length>0?i:null;this.q=t.length>0?t:null}}};function CuratedKeyPointsFactory(){}CuratedKeyPointsFactory.prototype={a:function(n,t){return new Microsoft.Owa.Core.CuratedKeyPoints.d(n,t)}};Microsoft.Owa.Core.CuratedKeyPoints.a=function(n){Microsoft.Owa.Core.CuratedKeyPoints.a.initializeBase(this);this.e=n;this.f=new _g.bz(this.L)};Microsoft.Owa.Core.CuratedKeyPoints.a.a=function(n){return!n.ek()&&!n.bH.PropertyExistence||!n.ek()&&!!n.bH.PropertyExistence&&n.bH.PropertyExistence.UserHighlightData};Microsoft.Owa.Core.CuratedKeyPoints.a.prototype={e:null,f:null,K:function(n){var t;var i=new _g.bv((t=new _g.V,t.BaseShape="IdOnly",t.AdditionalProperties=this.j(),t));if(i.ItemShape.AdditionalProperties.length){i.ItemIds=[_g.e.a(this.e.bH.ItemId)];var r=new _g.bu(this.M(),i);n.a(r,this.f,this.I,this.H)}},cJ:function(n){var t=n.Items[0];if(t){var i=_h.d.a().a(t.ItemId.Id);if(i&&t.ExtendedProperty&&t.ExtendedProperty.length>0){i.hU(new _a.j(t.ExtendedProperty[0].Values));_h.c.g(i)}}},j:function(){var n=new Array(0);this.e.ek()||Array.add(n,_g.c.bJ());return n}};Microsoft.Owa.Core.CuratedKeyPoints.c=function(n){Microsoft.Owa.Core.CuratedKeyPoints.c.initializeBase(this,[2]);this.k=n;this.r="UpdateCuratedKeyPointsData"};Microsoft.Owa.Core.CuratedKeyPoints.c.a=function(n,t,i,r){var f=new _g.s(i);var u=new _g.J;r(u,t);f.Item=u;Array.add(n,f)};Microsoft.Owa.Core.CuratedKeyPoints.c.prototype={k:null,m:null,l:!1,cJ:function(n){if(this.l)throw Error.invalidOperation("Expected only one response message.");this.l=!0;this.s||(this.m=n.Items[0].ItemId)},t:function(){var n=new _g.bm;var r=this.k.bH.ItemId;n.ItemId=new _g.e(r.Id);n.ItemId.ChangeKey=r.ChangeKey;var i=[];if(_g.i.isInstanceOfType(this.k)&&this.k.bV()){var u=this;Microsoft.Owa.Core.CuratedKeyPoints.c.a(i,this.k,new _g.d("UserHighlightData"),function(n,t){n.UserHighlightData=t.ek().e()})}n.Updates=new Array(i.length);for(var t=0;t<i.length;t++)n.Updates[t]=i[t];return[n]}};Microsoft.Owa.Core.CuratedKeyPoints.b.registerClass("Microsoft.Owa.Core.CuratedKeyPoints.b",null,_b.ck);CuratedKeyPointsComponent.registerClass("CuratedKeyPointsComponent",null,_a.kh,_j.ce);CuratedKeyPointsFactory.registerClass("CuratedKeyPointsFactory",null,_mco.ba);Microsoft.Owa.Core.CuratedKeyPoints.a.registerClass("Microsoft.Owa.Core.CuratedKeyPoints.a",_h.dx.$$(_g.ez,_g.dE));Microsoft.Owa.Core.CuratedKeyPoints.c.registerClass("Microsoft.Owa.Core.CuratedKeyPoints.c",_h.cK);CuratedKeyPointsComponent.$$cctor();
window.scriptsLoaded['microsoft.owa.core.curatedkeypoints.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.core.curatedkeypoints.js'] = (new Date()).getTime();
