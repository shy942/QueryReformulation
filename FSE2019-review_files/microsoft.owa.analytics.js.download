window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.analytics.js'] = (new Date()).getTime();
Type.registerNamespace("_analytics");function AnalyticsComponent(){}AnalyticsComponent.$$cctor=function(){_a.t.a().a(AnalyticsComponent)};AnalyticsComponent.prototype={b:function(n,t,i){var f=this;n.b(_y.hL,function(){return new _analytics.f(n.a(_j.j))}).a();var r=!!i.e()&&i.e().a().F().Enabled;var u=this;n.b(_analytics.c,function(){return r?new _analytics.c(n.a(_j.j),i):null}).a()},a:function(){return[new _j.y(_analytics.c,2,1)]}};_analytics.f=function(n){this.b=n};_analytics.f.prototype={b:null,a:function(n){this.b.a(_analytics.d,new _analytics.d(n))}};_analytics.e=function(n){this.j=Function.createDelegate(this,this.n);this.k=n;n.b(_analytics.d,this.j)};_analytics.e.a=function(n){for(var r={},t=0;t<n.Keys.length;t++){if(n.Keys[t]==="cd"){for(var c=n.Values[t],o=c.split("|"),s=o.length,u=0;u<s;++u){var h=o[u];var i=_analytics.e.b(h);if(i&&!_j.h.a(i[1])){for(var e=0,f=i[0];f in r;){f=i[0]+e;e++}r[f]=i[1]}}continue}r[n.Keys[t]]=n.Values[t]}return r};_analytics.e.b=function(n){var t=null;var i=n.indexOf("_");if(i>0){t=new Array(2);t[0]=n.substr(0,i);t[1]=n.substr(i+1)}return t};_analytics.e.prototype={k:null,n:function(n){for(var r=n.a,f=r.length,t=0;t<f;++t){var i=r[t];if(i.Id==="PerfTraceCTQ"){var u=_analytics.e.a(i);this.l(u.S,u)}}}};_analytics.c=function(n,t){t.a()!=="Mouse"||t.b().f()||(this.a=_analytics.b.a(n))};_analytics.c.prototype={a:null};_analytics.d=function(n){this.a=n};_analytics.d.prototype={a:null};_analytics.a=function(n,t){this.f=this.c=_analytics.a.b();this.e=t;this.a=new _j.q;this.a.c(new _analytics.a.c(n,this));window.performance&&window.performance.memory&&_a.cM.a(window.performance.memory)&&this.a.c(new _analytics.a.d(n,this));_a.g.h().a&&this.a.c(new _analytics.a.f(n,this));this.a.c(new _analytics.a.e(n,this));this.b=!0};_analytics.a.b=function(){return window.performance?window.performance.now():Date.now()};_analytics.a.prototype={f:0,c:0,d:0,a:null,e:null,g:function(){for(var t=0,i=this.a.i(),u=i.length,n=0;n<u;++n){var r=i[n];r.g&&t++}return t},b:!1,h:function(){var n=_analytics.a.b();this.d++;if(n>=this.c+1e3){for(var i=n-this.c,r=this.a.d.length,t=0;t<r;t++)this.a.d[t].f(this.d,i);this.d=0;this.c=n}this.f=n}};_analytics.a.c=function(n,t){_analytics.a.c.initializeBase(this,[n,t,17,"fps","#AABBFF","FPS","Frames per second. The higher the better. The graph shows the number of frames lost",-1,!1,"",5,3,10])};_analytics.a.c.prototype={f:function(n,t){var i=Math.round(n*1e3/t);var r=Math.max(0,Math.max(this.e,30)-i);this.n(i);this.m(r/80)}};_analytics.a.d=function(n,t){_analytics.a.d.initializeBase(this,[n,t,15,"mb","#F38181","MB","Allocated JS heap memory. The lower the better.",-1,!1,"Sudden increase of memory was detected. Please click the graph to send a report to OWA SWAT.",5,3,10])};_analytics.a.d.prototype={f:function(n,t){var r=window.performance.memory;var i=r.usedJSHeapSize;this.n(Math.round(i/1048576));this.m(i/r.jsHeapSizeLimit)},v:function(n){return n>=this.H()+20}};_analytics.a.f=function(n,t){_analytics.a.f.initializeBase(this,[n,t,13,"tasks","#2BE5A6","TPS","Tasks per second. The lower the better.",15,!1,"",5,3,10])};_analytics.a.f.prototype={f:function(n,t){var r=_a.g.h().a;if(r){var u=r.d();var i=Math.round(u*1e3/t);this.n(i);this.m(i/300)}}};_analytics.a.e=function(n,t){_analytics.a.e.initializeBase(this,[n,t,14,"requests","#FCCEAA","RPS","Requests per second. The lower the better.",1,!1,"",5,3,10])};_analytics.a.e.prototype={f:function(n,t){var r=_a.g.f();if(r){var u=r.i();var i=Math.round(u*1e3/t);this.n(i);this.m(i/20)}}};_analytics.a.a=function(n,t,i,r,u,f,e,o,s,h,c,l,a){this.u=Function.createDelegate(this,this.y);this.j=Number.POSITIVE_INFINITY;_analytics.a.a.initializeBase(this,[_analytics.a.a.b(r)]);this.d=t;this.z.title=e;this.s=i;this.h=s;this.p=h;this.o=c;this.r=l;this.q=a;this.k=o;this.l=_analytics.a.a.a("div",r+"Text","margin-left:5px;font-family:Helvetica,Arial,sans-serif;white-space:nowrap;font-size:9px;font-weight:bold;line-height:20px;color:"+u);this.z.appendChild(this.l);this.b=_analytics.a.a.a("div",r+"Graph","width:"+74+"px;height:"+30+"px;margin-left:3px;background:"+u);this.z.appendChild(this.b);for(var v=0;v<74;v++)this.b.appendChild(_analytics.a.a.a("span","","width:1px;height:"+30+"px;float:left;background:black"));this.t=f;n.appendChild(this.z);this.bf("click",this.u,"PanelClick");if(this.h){this.c=new _a.bG(this.o);this.bn(4)}};_analytics.a.a.a=function(n,t,i){var r=document.createElement(n);_j.h.b(t)||(r.id=t);r.style.cssText=i;return r};_analytics.a.a.b=function(n){return _analytics.a.a.a("div",n,"width:"+80+"px;cursor:pointer;text-align:left;position:relative;"+"display:inline-block;background:"+"rgba(0,0,0,0.65)"+";border-bottom:1px solid "+"rgba(0,0,0,0.65)")};_analytics.a.a.prototype={l:null,b:null,t:null,h:!1,p:null,o:0,r:0,q:0,c:null,a:null,i:0,e:0,d:null,k:0,s:0,H:function(){if(this.c){for(var t=0,i=this.c.a.length,n=0;n<i;n++)t+=this.c.f(n);return t/i}return 0},g:!1,B:function(){return _analytics.a.b()<this.i+this.r*1e3},E:function(){return _analytics.a.b()<this.i+this.q*1e3},n:function(n){this.j=Math.min(this.j,n)|0;this.e=Math.max(this.e,n)|0;var t=this.e;var i="";var r=n|0;if(t>1e6){t=t/1e6;i="M"}else if(t>1e3){t=t/1e3;i="K"}this.l.innerHTML=String.format("{0} {1} ({2}-{3}{4})",(r<10?"&nbsp;":"")+r,this.t,this.j,t|0,i);this.w(n);this.x(n)},w:function(n){if(this.h){if(this.c.a.length===this.o)if(this.d.b&&this.v(n)){this.i=_analytics.a.b();this.b.className="blink"}else this.d.b&&(_j.h.a(this.b.className)||this.B())||(this.b.className="");this.c.b(n)}},x:function(n){if(!(this.k<=0)&&!this.g&&n<=this.k){this.g=!0;if(this.d.g()>=2){var i=_a.d.get_utcNow().e(_y.c.a.z());window.self.perfSteadyState=i;var t=_a.b.b(_a.a.R,"owaperfsteadystate",!1,null);t.m=_a.l.b("v",i);_a.b.a(t)}}},y:function(n){this.d.e.a(_y.cf,new _y.cf(this.s))},m:function(n){var i=this.b.appendChild(this.b.firstChild);var t;t=n<=0?30:n>=1?1:Math.round(30-n*30);i.style.height=t+"px"},v:function(n){return!1},cY:function(n){if(this.E()){if(!this.a){this.a=_analytics.a.a.a("div","","position:absolute;top:50px;right:0;width:150px;background:white;padding:3px");this.a.className="ms-font-color-red";this.a.innerHTML=this.p;this.z.appendChild(this.a)}this.a.style.display="block"}_j.i.prototype.cY.call(this,n)},cr:function(n){this.a&&(this.a.style.display="none");_j.i.prototype.cr.call(this,n)}};_analytics.b=function(n,t){this.j=Function.createDelegate(this,this.n);this.i=Function.createDelegate(this,this.s);this.h=Function.createDelegate(this,this.r);_analytics.b.initializeBase(this,[n]);this.g=t;this.c=!0;this.d=this.q(this.z);this.a=new _analytics.a(this.d.z,this.g);this.f=80*this.a.a.d.length;n.style.marginLeft=this.f/-2+"px";this.b=this.o(this.z);this.b.T(new _j.g(this.h,_a.a.bB));this.b.bn(1);this.e=this.p(n);this.n();this.T(new _j.g(this.i,_a.a.bB));this.c=!1;this.bn(1)};_analytics.b.a=function(n){var t=_analytics.b.b();window.document.body.appendChild(t);return new _analytics.b(t,n)};_analytics.b.b=function(){var n=window.document.createElement("div");n.className="ms-font-mi";n.style.position="absolute";n.style.left="50%";n.style.marginLeft="-120px";n.style.zIndex=999;n.style.overflow="hidden";n.style.top="-2px";_j.k.a(n,"box-shadow","0 -3px 6px 3px rgba(0,0,0,0.65)");return n};_analytics.b.prototype={g:null,a:null,c:!1,b:null,e:null,d:null,f:0,r:function(){if(!this.c){this.c=!0;if(this.k(this.d)){this.a=null;this.z.innerHTML="";window.document.body.removeChild(this.z)}else{var n=this;_j.m.a().d(_a.a.bB,"StatsView.HideOrTerminateGraphs",function(){n.l(n.d);_j.k.a(n.z,"box-shadow","none");n.a.b=!1;n.m(n.e);n.b.z.innerHTML="x";n.b.z.style.right=n.f-120+"px";n.c=!1})}}},s:function(){if(!this.c&&this.a&&this.k(this.d)){this.l(this.e);this.m(this.d);_j.k.a(this.z,"box-shadow","0 -3px 6px 3px rgba(0,0,0,0.65)");this.a.b=!0;this.b.z.innerHTML="-";this.b.z.style.right="0"}},n:function(){if(this.a){this.a.h();window.requestAnimationFrame(this.j)}},q:function(n){var t=window.document.createElement("div");t.id="perfStatsContainer";t.style.display="inline-block";n.appendChild(t);return new _j.i(t)},p:function(n){var t=window.document.createElement("div");t.innerHTML="Show graphs";t.className="link";t.style.backgroundColor="rgba(0,0,0,0.65)";t.style.color="#888";t.style.width="100px";t.style.cursor="pointer";t.style.position="absolute";t.style.top="0";t.style.visibility="hidden";t.style.height="17px";t.style.textAlign="center";n.appendChild(t);return new _j.i(t)},o:function(n){var t=window.document.createElement("div");t.innerHTML="-";t.style.color="white";t.style.cursor="pointer";t.style.height="17px";t.style.width="10px";t.style.position="absolute";t.style.right="0";t.style.top="0";t.title="Collapse the graphs. Click again to terminate them, when the graphs are collapsed.";n.appendChild(t);return new _j.i(t)},k:function(n){return n.z.style.visibility==="hidden"},m:function(n){n.z.style.visibility="visible"},l:function(n){n.z.style.visibility="hidden"}};AnalyticsComponent.registerClass("AnalyticsComponent",null,_a.kh,_j.ce);_analytics.e.registerClass("_analytics.e");_analytics.c.registerClass("_analytics.c");_analytics.d.registerClass("_analytics.d");_analytics.a.a.registerClass("_analytics.a.a",_j.i);_analytics.a.c.registerClass("_analytics.a.c",_analytics.a.a);_analytics.a.d.registerClass("_analytics.a.d",_analytics.a.a);_analytics.a.f.registerClass("_analytics.a.f",_analytics.a.a);_analytics.a.e.registerClass("_analytics.a.e",_analytics.a.a);_analytics.b.registerClass("_analytics.b",_j.i);AnalyticsComponent.$$cctor();
window.scriptsLoaded['microsoft.owa.analytics.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.analytics.js'] = (new Date()).getTime();
