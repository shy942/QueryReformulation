window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.core.imageloader.js'] = (new Date()).getTime();
Type.registerNamespace("Microsoft.Owa.Core.ImageLoader");Microsoft.Owa.Core.ImageLoader.j=function(n,t,i,r){this.a=this.b;Microsoft.Owa.Core.ImageLoader.j.initializeBase(this,[n]);this.k=t;this.j=r;this.f=i;this.i=new Microsoft.Owa.Core.ImageLoader.c(this.f)};Microsoft.Owa.Core.ImageLoader.j.prototype={k:null,f:null,j:null,i:null,b:function(n,t){var i=n;var s=this.d(i,"data-custom");if(_j.h.a(s))return!1;if(n.onerror&&n.onload)return!0;var o=Microsoft.Owa.Core.ImageLoader.a.b();var f=new _g.bi(decodeURIComponent(s));var u=this.d(i,"explicitLogon");var h=null;var e=null;if(this.f.a().jr().Enabled){h=_g.C.f()+"&animation=true";e=_g.C.d()+"&animation=true"}var r=this;this.j.c(function(s){var c=s.a(u);if(r.f.a().cv().Enabled){i.setAttribute("data-downloadImage",c.c(f,!1,!0,_g.C.a(),u));i.setAttribute("data-thumbnailImage",c.c(f,!1,!1,e,u))}var l=c.c(f,!1,!1,h,u);_j.h.b(l)?r.e(o,i,"NullAttachmentUrl",null,t,null,null,null,!1,!1):r.c(n,l,t,function(){r.k.a(_a.cT,new _a.cT("II"));!r.d(i,"width")&&_j.h.a(i.style.width)&&_j.k.a(i,"max-width","100%")},null,o,!0)},!1);return!0},c:function(n,t,i,r,u,f,e){var c=f||Microsoft.Owa.Core.ImageLoader.a.b();var y=this.i.a(t);var l=y?"CrossDomain":"SameDomain";var s=y?this.i.b(n,t):null;var a=_j.h.a(s)?"NoCors":s;var h=n;var o=this.d(h,"data-imagetype");_j.h.a(o)&&(o="AttachmentByCid");var p=this,v=this;this.h(h,t,function(){p.e(c,h,n.naturalWidth>0?"":"ZeroNaturalWidth",o,i,l,_j.h.a(s)?"NoCors":s,null,!1,!1);r&&r()},function(){var p="OnError";var f=!y||!_j.h.a(s)&&s.toLowerCase()==="use-credentials";var w=v.q(h);if(w)v.p(t,f,function(s){var b=Microsoft.Owa.Core.ImageLoader.c.a;var w=Microsoft.Owa.Core.ImageLoader.c.c(t);var y=v.d(h,"originalSrc");if(e&&s.a===200&&s.c)Microsoft.Owa.Core.ImageLoader.f.b().k(n,t,new Microsoft.Owa.Core.ImageLoader.k(o,l,i,a,y,b,w,f,s,c),r,u);else if(s.b!=="ImageMismatch"||_j.h.a(s.g)){u&&u();p=_j.h.a(s.b)?s.a.toString():s.b;c&&Microsoft.Owa.Core.ImageLoader.a.c(c,p,o,l,i,a,null);Microsoft.Owa.Core.ImageLoader.a.a(o,l,p,s.a.toString(),i,a,y,s.d,b,w,s.e,s.f,s.c.toString(),null)}else Microsoft.Owa.Core.ImageLoader.d.c().c(n,t,new Microsoft.Owa.Core.ImageLoader.k(o,l,i,a,y,b,w,f,s,c),r,u)});else{u&&u();v.e(c,h,"DOMDetached",o,i,l,a,t,!1,f)}});return!0}};Microsoft.Owa.Core.ImageLoader.l=function(n,t,i){this.j=Function.createDelegate(this,this.r);Microsoft.Owa.Core.ImageLoader.l.initializeBase(this,[n]);this.a=t;this.i=i;this.c=new Array(0);this.f=!1;this.t()};Microsoft.Owa.Core.ImageLoader.l.prototype={a:null,i:null,c:null,f:!1,b:function(n,t){if(this.f)return!1;var r=n;var i=this.d(r,"data-custom");if(_j.h.a(i))return!1;this.g(n);this.n(n,i);return!0},n:function(n,t){if(this.k()){var i=this;this.s(decodeURIComponent(t),function(r){if(r)n.src=r.getUri();else{i.i.b(t,n);i.i.a()}})}else Array.add(this.c,new Microsoft.Owa.Core.ImageLoader.l.a(n,t))},k:function(){return this.a.d()&&this.a.b().t()},t:function(){var t=this;this.a.a(function(n){n.r(t.j)});var n=this;_j.m.a().a(_a.a.W,"SubscribeItemStore_OnAvailable",function(){n.a.d()&&n.o(n.a.b());n.f=!n.k();n.m()},1e4)},o:function(n){n.w(this.j)},r:function(n){this.o(n);this.m()},s:function(n,t){var i=null;var r=this,f=this,u=this;this.a.b().n("InlineImageLoader.LoadImageFromStore",function(t){r.a.b().bindIn(t,r.a.b().j().b(n),function(n){i=n},null)},function(){t(i)},function(){t(i)})},m:function(){for(var i=this.c,r=i.length,n=0;n<r;++n){var t=i[n];this.n(t.b,t.a)}this.c=new Array(0)}};Microsoft.Owa.Core.ImageLoader.l.a=function(n,t){this.b=n;this.a=t};Microsoft.Owa.Core.ImageLoader.l.a.prototype={b:null,a:null};Microsoft.Owa.Core.ImageLoader.m=function(n,t,i,r,u,f){Microsoft.Owa.Core.ImageLoader.m.initializeBase(this,[!1]);this.a=new Array(0);n.a()&&this.a.push(new Microsoft.Owa.Core.ImageLoader.l(!1,t,i));this.a.push(new Microsoft.Owa.Core.ImageLoader.j(!0,r,u,f));this.a.push(new Microsoft.Owa.Core.ImageLoader.o(!1));this.a.push(new Microsoft.Owa.Core.ImageLoader.e(!1))};Microsoft.Owa.Core.ImageLoader.m.prototype={a:null,b:function(n,t){if(_a.o.a().K){this.f(n,t,0);return!0}else return this.c(n,t)},f:function(n,t,i){if(this.i(n))if(i<=10){i++;var e=this;_j.m.a().a(_a.a.cg,"Retry loading inline image",function(){e.f(n,t,i)},100*i)}else{var r=n;var o=Microsoft.Owa.Core.ImageLoader.a.b();var u=this.d(r,"originalSrc");var f=this.d(r,"data-imagetype");this.e(o,r,"ErrorProjectionTimeout",f,t,"","",u,!1,!1);this.g(r);r.src=_j.h.a(u)?"":u}else this.c(n,t)},c:function(n,t){for(var r=!1,i=0;i<this.a.length;i++)if(r=this.a[i].b(n,t))break;return r},i:function(n){var i=this;var t=_j.i.c(n,function(n){return n.className==="projectionConductorsContainer"});return!!t}};Microsoft.Owa.Core.ImageLoader.c=function(n){this.c=this.d(n?n.a().jn():null)};Microsoft.Owa.Core.ImageLoader.c.c=function(n){var t=_j.h.a(n)?null:n.match(Microsoft.Owa.Core.ImageLoader.c.b);return t&&t.length>1?t[1].toLowerCase():""};Microsoft.Owa.Core.ImageLoader.c.prototype={c:null,b:function(n,t){var i=n&&this.c&&t&&this.a(t)?this.c:null;i&&(n.crossOrigin=i);return i},a:function(n){var t=_j.h.a(n)?null:n.match(Microsoft.Owa.Core.ImageLoader.c.b);return!!t&&t.length>1&&t[1].toLowerCase()!==Microsoft.Owa.Core.ImageLoader.c.a},d:function(n){var t=n&&n.CrossOrigin?n.CrossOrigin.toLowerCase():null;if(t)switch(t){case"anonymous":case"use-credentials":break;default:t=null;break}return t}};Microsoft.Owa.Core.ImageLoader.a=function(){};Microsoft.Owa.Core.ImageLoader.a.b=function(){return _a.b.b(_a.a.cg,"InlineImageLoad",!1,null)};Microsoft.Owa.Core.ImageLoader.a.c=function(n,t,i,r,u,f,e){if(n){var o=new _a.l;o.a("TP",_j.h.d(i)?"":i);o.a("LDR",_j.h.d(r)?"":r);o.a("CTX",_j.h.d(u)?"":u);o.a("LDRC",_j.h.d(f)?"":f);o.a("F1",_j.h.d(e)?"":e);_j.h.a(t)||(n.n=t);n.m=o.toString();_a.b.a(n)}};Microsoft.Owa.Core.ImageLoader.a.a=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){var p=_a.b.b(_a.a.cg,"InlineImageLoadError",!1,null);var y=new _a.l;y.a("TP",_j.h.d(n)?"":n);y.a("LDR",_j.h.d(t)?"":t);y.a("SC",_j.h.d(r)?"":r);y.a("CTX",_j.h.d(u)?"":u);y.a("LDRC",_j.h.d(f)?"":f);y.a("OSRC",_j.h.d(e)?"":e);y.a("CT",_j.h.d(o)?"":o);y.a("F1",_j.h.d(s)?"":s);y.a("F2",_j.h.d(h)?"":h);y.a("F3",_j.h.d(c)?"":c);y.a("F4",_j.h.d(l)?"":l);y.a("F5",_j.h.d(a)?"":a);y.a("F6",_j.h.d(v)?"":v);_j.h.a(i)||(p.n=i);p.m=y.toString();_a.b.a(p)};Microsoft.Owa.Core.ImageLoader.e=function(n){Microsoft.Owa.Core.ImageLoader.e.initializeBase(this,[n])};Microsoft.Owa.Core.ImageLoader.e.prototype={b:function(n,t){if(n.onerror&&n.onload)return!0;var i=n;var o=Microsoft.Owa.Core.ImageLoader.a.b();var e=this.d(i,"data-imageerror");var r=this.d(i,"originalSrc");var u=this.d(i,"data-imagetype");if(!_j.h.a(e)){var f=e;if(!_j.h.a(r)&&Microsoft.Owa.Core.ImageLoader.e.a.test(r))f="CidTildeWrd";else if(e==="AttNotFound"){var l=this.d(i,"data-outlook-trace");var s=this.a(l);_j.h.a(s)||(f=String.format("{0}_{1}","AttNotFound",s))}this.e(o,i,f,u,t,"","",r,!1,!1);this.g(i);i.src=_j.h.a(r)?"":r;return!0}var c=this,h=this;this.h(i,r,function(){c.e(o,i,null,u,t,"","",r,!1,!1)},function(){h.e(o,i,"OnError",u,t,"","",r,!0,!1)});return!0},a:function(n){var i="";if(_j.h.a(n))i="NoTrace";else{var u=Microsoft.Owa.Core.ImageLoader.e.b.exec(n);var f=Microsoft.Owa.Core.ImageLoader.e.c.exec(n);if(u&&u.length===2&&f&&f.length===2){var t=parseInt(u[1]);var r=parseInt(f[1]);isNaN(t)||isNaN(r)||(t?t>0&&(t<r?i="MidEWS":t===r&&(i="PostEWS")):i="PreEWS")}}return i}};function ImageLoaderComponent(){}ImageLoaderComponent.$$cctor=function(){_a.t.a().a(ImageLoaderComponent)};ImageLoaderComponent.prototype={b:function(n,t,i){var f=this;n.b(_y.cB,function(){return new Microsoft.Owa.Core.ImageLoader.c(n.a(_a.e))}).b(_y.cB).a();var u=this;n.b(_y.gu,function(){return new Microsoft.Owa.Core.ImageLoader.m(n.a(_h.Y),n.d(_bc.F),n.a(_b.bP),n.a(_j.j),n.a(_a.e),n.d(_y.bJ))}).b(_y.gu).a();var r=this;n.b(_y.cm,function(){return new Microsoft.Owa.Core.ImageLoader.j(!1,n.a(_j.j),n.a(_a.e),n.d(_y.bJ))}).b(_y.cm).a()},a:function(){return null}};Microsoft.Owa.Core.ImageLoader.b=function(n,t,i,r){this.c=n;this.a=t;this.d=i;this.b=r};Microsoft.Owa.Core.ImageLoader.b.prototype={c:null,a:null,d:null,b:null};Microsoft.Owa.Core.ImageLoader.g=function(){};Microsoft.Owa.Core.ImageLoader.g.b=function(n){for(var r=0;r<Microsoft.Owa.Core.ImageLoader.g.a.length;r++)for(var i=Microsoft.Owa.Core.ImageLoader.g.a[r],t=0;t<i.a.length;t++)if(i.a[t]!==n[t])break;else if(t===i.a.length-1)return i;return null};Microsoft.Owa.Core.ImageLoader.i=function(n,t,i,r,u,f,e){this.b=n;this.a=t;this.d=i;this.e=r;this.f=u;this.c=f;this.g=e};Microsoft.Owa.Core.ImageLoader.i.prototype={b:null,a:0,d:null,e:null,f:null,c:!1,g:null};Microsoft.Owa.Core.ImageLoader.q=function(n){this.l=n};Microsoft.Owa.Core.ImageLoader.q.prototype={l:!1,b:function(n,t){return!1},h:function(n,t,i,r){var u=null;if(this.l){u=Microsoft.Owa.Core.ImageLoader.h.b(n);u.d()}var f=n;var o=this;f.onload=function(){o.g(n);if(u){u.c();u.dispose()}i()};var e=this;f.onerror=function(){e.g(n);if(u){u.c();u.dispose()}r()};n.src=t},p:function(n,t,i){var r=new XMLHttpRequest;var f=this;r.onreadystatechange=function(){if(r.readyState===4){var c=r.status;var n=r.getResponseHeader("Content-Type")||"";if(n.length>0){var l=n.indexOf(";");l>0&&(n=n.substr(0,l))}var t="";var h=null;var s="";var o=!1;var a=null;if(c===200){var u=r.response;if(u&&u.byteLength)if(u.byteLength<10)t="ImageInvalidLength";else{s="Unknown";h=new Uint8Array(u,0,10);var e=Microsoft.Owa.Core.ImageLoader.g.b(h);if(e){s=e.c;o=!_j.h.a(n)&&e.d.test(n);if(!o){t="ImageMismatch";a=e.b}}}else t="ImageZeroBytes";i(new Microsoft.Owa.Core.ImageLoader.i(t,c,n,s,f.u(h),o,a))}}};var e=this;r.ontimeout=function(){i(new Microsoft.Owa.Core.ImageLoader.i("RequestTimeout",0,"","","",!1,""))};var s=this;r.onerror=function(){i(new Microsoft.Owa.Core.ImageLoader.i("RequestError",0,"","","",!1,""))};var o=this;r.onabort=function(){i(new Microsoft.Owa.Core.ImageLoader.i("RequestAbort",0,"","","",!1,""))};var u=r;t&&(u.withCredentials=!0);r.open("GET",n,!0);u.responseType="arraybuffer";r.send(null)},d:function(n,t){var i=n;return i.hasAttribute(t)?i.getAttribute(t):null},e:function(n,t,i,r,u,f,e,o,s,h){var c=_j.h.a(r)?this.d(t,"data-imagetype"):r;n&&Microsoft.Owa.Core.ImageLoader.a.c(n,i,c,f,u,e,null);if(!_j.h.a(i)){var v=Microsoft.Owa.Core.ImageLoader.c.a;var a=Microsoft.Owa.Core.ImageLoader.c.c(o);var l=this.d(t,"originalSrc");if(!_j.h.b(o)&&s){var y=this;this.p(o,h,function(n){Microsoft.Owa.Core.ImageLoader.a.a(c,f,i,n.a.toString(),u,e,l,n.d,v,a,n.e,n.f,n.c.toString(),null)})}else Microsoft.Owa.Core.ImageLoader.a.a(c,f,i,"",u,e,l,"",v,a,null,null,null,null)}},g:function(n){var t=n;n.removeAttribute("onload");n.removeAttribute("onerror");t.onload=t.onerror=null},q:function(n){if(n){var t=_j.x.a(n);return!!t&&t.documentElement.contains(n)}return!1},u:function(n){for(var i="",t=0;t<n.length;t++)i+=String.fromCharCode(n[t]);return window.btoa(i)}};Microsoft.Owa.Core.ImageLoader.n=function(n,t){this.b=n;this.a=t};Microsoft.Owa.Core.ImageLoader.n.prototype={b:null,a:null,d:function(){if(this.b&&this.a){this.a.parentNode.insertBefore(this.b,this.a);_j.k.y(this.a)}},c:function(){if(this.b&&this.a){_j.k.f(this.b);_j.k.A(this.a)}},dispose:function(){this.b=null;this.a=null}};Microsoft.Owa.Core.ImageLoader.p=function(n,t,i,r,u){this.c=n;this.g=t;this.f=i;this.e=r;this.d=u;this.b=0;this.h=_a.d.a();this.a=0};Microsoft.Owa.Core.ImageLoader.p.prototype={c:null,g:null,f:null,b:0,h:null,a:0,e:null,d:null};Microsoft.Owa.Core.ImageLoader.f=function(){this.a=new Array(0);Microsoft.Owa.Core.ImageLoader.f.initializeBase(this,[!1])};Microsoft.Owa.Core.ImageLoader.f.b=function(){Microsoft.Owa.Core.ImageLoader.f.a||(Microsoft.Owa.Core.ImageLoader.f.a=new Microsoft.Owa.Core.ImageLoader.f);return Microsoft.Owa.Core.ImageLoader.f.a};Microsoft.Owa.Core.ImageLoader.f.prototype={c:null,k:function(n,t,i,r,u){var f=new Microsoft.Owa.Core.ImageLoader.p(n,t,i,r,u);this.i(f);this.a.push(f);this.n()},i:function(n){n.a=0;n.c.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAEALAAAAAABAAEAAAIBTAA7"},n:function(){if(!this.c){var n=this;this.c=_j.m.a().a(_a.a.cg,"Retry loading inline image",function(){n.j()},1e3)}},j:function(){if(this.a.length>0){for(var s=_a.d.a(),r=new Array(0),t=new Array(0),e=new Array(0),u=this.a,h=u.length,i=0;i<h;++i){var n=u[i];if(n.a!==2)if(s.e(n.h)>2e4)this.f(n,!1,"RetryTimedOut");else if(n.a===1){e.push(n);r.push(n)}else if(!n.a){t.push(n);r.push(n)}}var f=4-e.length;f>0&&t.length>0&&this.m(t.slice(0,Math.min(f,t.length)));this.a=r}if(this.a.length>0){var o=this;this.c=_j.m.a().a(_a.a.cg,"Retry loading inline image",function(){o.j()},1e3)}else this.c=null},m:function(n){if(n&&n.length>0)for(var u=n,f=u.length,i=0;i<f;++i){var t=u[i];t.b=t.b+1;t.a=1;if(this.q(t.c)){var e=this,r=this;this.h(t.c,t.g,function(){e.f(t,!0,"")},function(){t.b>=3?r.f(t,!1,""):r.i(t)})}else this.f(t,!1,String.format("{0}_R{1}","DOMDetached",t.b))}},f:function(n,t,i){if(n.a!==2){t?n.e&&n.e():n.d&&n.d();var u="";var r=n.f;t||(u=_j.h.a(i)?_j.h.a(r.a.b)?r.a.a.toString():r.a.b:i);r.c&&Microsoft.Owa.Core.ImageLoader.a.c(r.c,u,r.e,r.d,r.b,r.f,n.b.toString());t||Microsoft.Owa.Core.ImageLoader.a.a(r.e,r.d,u,r.a.a.toString(),r.b,r.f,r.h,r.a.d,r.i,r.g,r.a.e,r.a.f,r.a.c.toString(),n.b.toString());n.a=2}}};Microsoft.Owa.Core.ImageLoader.o=function(n){Microsoft.Owa.Core.ImageLoader.o.initializeBase(this,[n])};Microsoft.Owa.Core.ImageLoader.o.prototype={b:function(n,t){var i=n;var r=this.d(i,"data-imageproxysrc");if(_j.h.a(r))return!1;if(n.onerror&&n.onload)return!0;var e=this.d(i,"data-imageproxyid");var h=this.d(i,"originalSrc");var u=this.d(i,"data-imagetype");var f=Microsoft.Owa.Core.ImageLoader.a.b();var o=this,s=this;this.h(i,r,function(){o.e(f,i,null,u,t,"Proxy",e,r,!1,!1)},function(){s.e(f,i,"OnError",u,t,"Proxy",e,r,!0,!1)});return!0}};Microsoft.Owa.Core.ImageLoader.d=function(){Microsoft.Owa.Core.ImageLoader.d.initializeBase(this,[!1])};Microsoft.Owa.Core.ImageLoader.d.c=function(){Microsoft.Owa.Core.ImageLoader.d.a||(Microsoft.Owa.Core.ImageLoader.d.a=new Microsoft.Owa.Core.ImageLoader.d);return Microsoft.Owa.Core.ImageLoader.d.a};Microsoft.Owa.Core.ImageLoader.d.prototype={c:function(n,t,i,r,u){var f=new XMLHttpRequest;var s=f;var o=this;f.onload=function(){var t=new FileReader;t.onloadend=function(){if(!_j.h.a(t.result)){var f=t.result.replace(Microsoft.Owa.Core.ImageLoader.d.b,"data:"+i.a.g+";");o.h(n,f,function(){o.a(n,i,!0,r,u,null)},function(){o.a(n,i,!1,r,u,"DataUri_OnError")})}};t.readAsDataURL(s.response)};var h=this;var e=function(){h.a(n,i,!1,r,u,"DataUri_RequestFailed")};f.onabort=e;f.onerror=e;f.ontimeout=e;i.j&&(s.withCredentials=!0);f.open("GET",t,!0);s.responseType="blob";f.send(null)},a:function(n,t,i,r,u,f){i?r&&r():u&&u();var e="";i||(e=_j.h.a(f)?_j.h.a(t.a.b)?t.a.a.toString():t.a.b:f);t.c&&Microsoft.Owa.Core.ImageLoader.a.c(t.c,e,t.e,t.d,t.b,t.f,i?"DataUri_Success":"");i||Microsoft.Owa.Core.ImageLoader.a.a(t.e,t.d,e,t.a.a.toString(),t.b,t.f,t.h,t.a.d,t.i,t.g,t.a.e,t.a.f,t.a.c.toString(),null)}};Microsoft.Owa.Core.ImageLoader.k=function(n,t,i,r,u,f,e,o,s,h){this.e=n;this.d=t;this.b=i;this.f=r;this.h=u;this.i=f;this.g=e;this.j=o;this.a=s;this.c=h};Microsoft.Owa.Core.ImageLoader.k.prototype={e:null,d:null,b:null,f:null,h:null,i:null,g:null,j:!1,a:null,c:null};Microsoft.Owa.Core.ImageLoader.h=function(){};Microsoft.Owa.Core.ImageLoader.h.b=function(n){var t=n;var r=t.height<=1||t.width<=1?Microsoft.Owa.Core.ImageLoader.h.a:Microsoft.Owa.Core.ImageLoader.h.c(n);var i=_j.k.v(r)[0];return new Microsoft.Owa.Core.ImageLoader.n(i,n)};Microsoft.Owa.Core.ImageLoader.h.c=function(n){var r=n;var i=r.height;var t=r.width;var u=r.name;var e=t>160&&i>120?_b.l.t().c:_b.l.s().c;var f=String.format('<div style="background-image: url(\'{0}\'); padding-bottom: {1};  background-repeat: no-repeat; background-position: center; width: 100%; position: relative; -moz-user-select: none; -webkit-user-select: none; -ms-user-select: none;" unselectable="on"{2}></div>',_y.c.a.o(e),(i/t*100).toString()+"%",_j.h.a(u)?"":String.format(' title="{0}"',u));return String.format('<div class="ms-border-color-themePrimary" id="{0}"style="width: {1}px; height: {2}px; box-sizing: border-box; overflow: hidden; border-width: 1px; border-style: dashed; display: inline-block; -moz-user-select: none; -webkit-user-select: none; -ms-user-select: none;" unselectable="on">{3}</div>',"OWATemporaryImageDivContainer",t.toString(),i.toString(),f)};Microsoft.Owa.Core.ImageLoader.q.registerClass("Microsoft.Owa.Core.ImageLoader.q",null,_y.gu);Microsoft.Owa.Core.ImageLoader.j.registerClass("Microsoft.Owa.Core.ImageLoader.j",Microsoft.Owa.Core.ImageLoader.q,_y.cm);Microsoft.Owa.Core.ImageLoader.l.registerClass("Microsoft.Owa.Core.ImageLoader.l",Microsoft.Owa.Core.ImageLoader.q);Microsoft.Owa.Core.ImageLoader.l.a.registerClass("Microsoft.Owa.Core.ImageLoader.l.a");Microsoft.Owa.Core.ImageLoader.m.registerClass("Microsoft.Owa.Core.ImageLoader.m",Microsoft.Owa.Core.ImageLoader.q);Microsoft.Owa.Core.ImageLoader.e.registerClass("Microsoft.Owa.Core.ImageLoader.e",Microsoft.Owa.Core.ImageLoader.q);ImageLoaderComponent.registerClass("ImageLoaderComponent",null,_a.kh,_j.ce);Microsoft.Owa.Core.ImageLoader.b.registerClass("Microsoft.Owa.Core.ImageLoader.b");Microsoft.Owa.Core.ImageLoader.n.registerClass("Microsoft.Owa.Core.ImageLoader.n",null,Sys.IDisposable);Microsoft.Owa.Core.ImageLoader.p.registerClass("Microsoft.Owa.Core.ImageLoader.p");Microsoft.Owa.Core.ImageLoader.f.registerClass("Microsoft.Owa.Core.ImageLoader.f",Microsoft.Owa.Core.ImageLoader.q);Microsoft.Owa.Core.ImageLoader.o.registerClass("Microsoft.Owa.Core.ImageLoader.o",Microsoft.Owa.Core.ImageLoader.q);Microsoft.Owa.Core.ImageLoader.d.registerClass("Microsoft.Owa.Core.ImageLoader.d",Microsoft.Owa.Core.ImageLoader.q);Microsoft.Owa.Core.ImageLoader.c.b=new RegExp("^https?://([^/]*)/.*","i");Microsoft.Owa.Core.ImageLoader.c.a=window.location.hostname.toLowerCase();Microsoft.Owa.Core.ImageLoader.e.a=new RegExp("^cid:\\s?~WRD","i");Microsoft.Owa.Core.ImageLoader.e.b=new RegExp("f:([0-9]+)","i");Microsoft.Owa.Core.ImageLoader.e.c=new RegExp("t:([0-9]+)","i");ImageLoaderComponent.$$cctor();Microsoft.Owa.Core.ImageLoader.g.a=[new Microsoft.Owa.Core.ImageLoader.b("JPEG",new Uint8Array([255,216,255,224]),new RegExp("^image\\/p?jpe?g$","i"),"image/jpeg"),new Microsoft.Owa.Core.ImageLoader.b("EXIF",new Uint8Array([255,216,255,225]),new RegExp("^image\\/p?jpe?g$","i"),null),new Microsoft.Owa.Core.ImageLoader.b("SPIFF",new Uint8Array([255,216,255,232]),new RegExp("^image\\/p?jpe?g$","i"),null),new Microsoft.Owa.Core.ImageLoader.b("CannonEOS",new Uint8Array([255,216,255,226]),new RegExp("^image\\/p?jpe?g$","i"),null),new Microsoft.Owa.Core.ImageLoader.b("SamsungD500",new Uint8Array([255,216,255,227]),new RegExp("^image\\/p?jpe?g$","i"),null),new Microsoft.Owa.Core.ImageLoader.b("PNG",new Uint8Array([137,80,78,71,13,10,26,10]),new RegExp("^image\\/png$","i"),"image/png"),new Microsoft.Owa.Core.ImageLoader.b("GIF",new Uint8Array([71,73,70,56]),new RegExp("^image\\/gif$","i"),"image/gif"),new Microsoft.Owa.Core.ImageLoader.b("TIFF1",new Uint8Array([73,32,73]),new RegExp("^image\\/(x-)?tiff$","i"),null),new Microsoft.Owa.Core.ImageLoader.b("TIFF2",new Uint8Array([73,73,42,0]),new RegExp("^image\\/(x-)?tiff$","i"),null),new Microsoft.Owa.Core.ImageLoader.b("TIFF3",new Uint8Array([77,77,0,42]),new RegExp("^image\\/(x-)?tiff$","i"),null),new Microsoft.Owa.Core.ImageLoader.b("TIFF4",new Uint8Array([77,77,0,43]),new RegExp("^image\\/(x-)?tiff$","i"),null),new Microsoft.Owa.Core.ImageLoader.b("BMP",new Uint8Array([66,77]),new RegExp("^image\\/bmp$","i"),null)];Microsoft.Owa.Core.ImageLoader.f.a=null;Microsoft.Owa.Core.ImageLoader.d.a=null;Microsoft.Owa.Core.ImageLoader.d.b=new RegExp("^data:[a-z]+\\/[a-z-]+;","i");Microsoft.Owa.Core.ImageLoader.h.a=String.format('<div><img src="{0}"><br><p/></div>',_y.c.a.o("inlineimageplaceholder.png"));
window.scriptsLoaded['microsoft.owa.core.imageloader.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.core.imageloader.js'] = (new Date()).getTime();
