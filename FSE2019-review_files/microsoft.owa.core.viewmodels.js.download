window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.core.viewmodels.js'] = (new Date()).getTime();
Type.registerNamespace("_d");_d.X=function(){};_d.X.prototype={sendStarted:0,sendSucceeded:1,sendFailed:2,sendResumedOnNewSendFailure:3,sendResumedOnFailedResume:4,sendResumeSucceeded:5,browserClosing:6,quickComposeReSendTrigerred:7,quickComposeSendFailed:8};_d.X.registerEnum("_d.X",!1);_d.a=function(){};_d.a.prototype={inBoxRuleFrom:0,inBoxRuleTo:1,deliveryReportTo:2,deliveryReportFrom:3,groupsOwners:4,groupsMembers:5,groupsGroupModerators:6,groupsSenders:7,groupsAllowedSenders:8,voiceMailOptionsAmong:9,voiceMailOptionsTo:10,teamMailbox:11};_d.a.registerEnum("_d.a",!1);_d.bG=function(){};_d.bG.registerInterface("_d.bG");_d.bI=function(){};_d.bI.prototype={FifteenMinutesBeforeStart:-15,TenMinutesBeforeStart:-10,FiveMinutesBeforeStart:-5,ZeroMinutesBeforeStart:0,FiveMinutes:5,TenMinutes:10,FifteenMinutes:15,ThirtyMinutes:30,OneHour:60,TwoHours:120,FourHours:240,EightHours:480,halfDay:720,OneDay:1440,TwoDays:2880,ThreeDays:4320,FourDays:5760,OneWeek:10080,TwoWeeks:20160};_d.bI.registerEnum("_d.bI",!1);var IInlineExploreListViewModelFactory=function(){};IInlineExploreListViewModelFactory.registerInterface("IInlineExploreListViewModelFactory");var IInlineExploreListViewModel=function(){};IInlineExploreListViewModel.registerInterface("IInlineExploreListViewModel");_d.bF=function(){};_d.bF.prototype={Minutes:0,Hours:1,Days:2,Weeks:3};_d.bF.registerEnum("_d.bF",!1);_d.bH=function(){};_d.bH.registerInterface("_d.bH");_d.bc=function(){};_d.bc.registerInterface("_d.bc");_d.w=function(){};_d.w.c=function(){return _fm.b.a(_fm.a.D,_fm.WebfontSizes.a.f,"ms-fcl-ns-b")};_d.w.a=function(){return _fm.b.a(_fm.a.c,"ms-fcl-ns-b","ms-bcl-ns-b ms-bg-transparent ms-icon-font-circle",_fm.WebfontSizes.b.b)};_d.w.b=function(){return _fm.b.a(_fm.a.i,_fm.WebfontSizes.a.d,"ms-fcl-tp-b")};_d.w.d=function(){return _fm.b.a(_fm.a.H,_fm.WebfontSizes.a.d,"ms-fcl-tp-b")};_d.w.e=function(){return _fm.b.a(_fm.a.s,_fm.WebfontSizes.a.b,"ms-fcl-tp-b")};function CoreViewModelsComponent(){}CoreViewModelsComponent.$$cctor=function(){_a.t.a().a(CoreViewModelsComponent)};CoreViewModelsComponent.prototype={b:function(n,t,i){var d=this;n.b(_d.P,function(){return new _d.P(n.a(_d.O),n.a(_j.j),n.a(_a.E),n.a(_h.bj),n.a(_j.o),n.a(_g.a),n.a(_a.e))}).a();var g=this;n.b(_d.W,function(){return new _d.W(n.a(_y.a),n.a(_bc.a),n.a(_a.q),n.a(_y.t),n.a(_j.o))}).b(_y.fU).a();var nt=this;n.b(_d.bo,function(){return new _d.bo(n.a(_a.E),n.a(_y.cO))}).b(_y.fT).a();var w=this;n.b(_d.bf,function(){return new _d.bf(n.a(_a.q),n.a(_pcf.b),n.c(_y.iv))}).b(_y.fS).a();var b=this;n.b(_d.O,function(){return new _d.O(n.a(_y.a))}).a();var k=this;n.b(_y.bi,function(){return new _d.l(n.a(_y.c),n.a(_a.e))});var ut=this;n.b(_d.c,function(){return new _d.c(n.a(_y.a),n.a(_g.h),n.a(_j.j),n.c(_y.be),n.a(_a.e),n.d(_y.bS))}).b(_y.cd);var ft=this;n.b(_d.bm,function(){return new _d.bm(n.a(_y.a),n.a(_g.h),n.a(_j.j),n.c(_y.be),n.a(_a.e),n.d(_y.bS))}).b(_y.cF).a();var et=this;n.b(_d.E,function(){return new _d.E(n.a(_y.a),n.a(_g.h),n.a(_j.j),n.c(_y.be),n.a(_a.e),n.d(_y.bS))}).b(_y.fp);var tt=this;n.b(_d.bi,function(){return new _d.bi(n.a(_h.n))}).b(_y.fs).a();var it=this;n.b(_d.bp,function(){return new _d.bp}).b(_y.iK).a();if(i.a()==="Mouse"){var rt=this;n.b(_d.bl,function(){return new _d.bl(n.a(_j.j),n.a(_j.v),n.a(_y.a))}).b(_y.dR).a();var p=this;n.b(_d.bk,function(){return new _d.bk(n.a(_j.j),n.a(_j.v),n.a(_y.a),n.a(_y.V))}).b(_y.dm).a()}var e=this;n.b(_d.bg,function(){return new _d.bg(n.a(_cm.k),n.a(_ff.a),n.a(_a.z))}).b(_y.iw);n.e(_a.dX).a();var o=this;n.b(_y.ey,function(){return new _d.bw(n.a(_y.a),n.a(_g.h),n.a(_j.j),n.a(_h.s),n.c(_h.n),n.d(_y.bp),n.a(_y.q),n.a(_a.x),n.d(_j.t),n.d(_h.T))}).a();var s=this;n.b(_d.bb,function(){var t=n.a(_g.E);return new _d.bb(t.bH.HelpUrl,t.bH.IsBposUser,n.a(_a.Z),n.a(_d.M),n.a(_y.j),i.a(),n.a(_y.a),n.a(_y.G))}).b(_y.cc).a();var r=this;n.b(_d.M,function(){return new _d.M(n.a(_h.bj),n.a(_y.a),n.a(_g.a).bH.PolicySettings.AllowOfflineOn,n.a(_j.j))}).b(_y.dz).a();var u=this;n.b(_y.hX,function(){return new _d.bx(n.a(_a.q),n.a(_bc.f))}).a();var f=this;n.b(_d.J,function(){return new _d.J(n.a(_fp.d),n.a(_a.q))}).b(_y.hT);var a=this;n.b(_d.N,function(){return new _d.N(n.a(_j.j),n.a(_fp.d))}).b(_y.fh);var v=this;n.b(_d.i,function(){return new _d.i(n.a(_fp.d),n.a(_a.q))}).b(_y.gy);var y=this;n.b(_d.bd,function(){return new _d.bd(n.a(_j.j))}).b(_y.bp).a();var h=this;n.b(_d.r,function(){return new _d.r(n.a(_j.j),n.a(_j.v),n.a(_y.a),n.d(_h.T),n.d(_j.t),n.a(_a.q))}).b(_y.hZ);var c=this;n.b(_d.V,function(){return new _d.V(n.d(_y.bL),i.a())}).a();var l=this;n.b(_y.gw,function(){return new _d.L})},a:function(){return[new _j.y(_y.fy,1,13),new _j.y(_d.P,2,9),new _j.y(_a.bp,2,1),new _j.y(_d.V,1,1)]}};_d.ba=function(n,t){_d.ba.initializeBase(this);_a.c.b(n,"personaViewModelFactory");_a.c.b(t,"flowConversationItem");this.b=n;this.a=t};_d.ba.prototype={b:null,a:null,c:function(){for(var t="",n=0;n<this.a.Participants.length;n++)t+=this.a.Participants[n].Name+"; ";return t},d:function(){return _a.d.b(this.a.ReceivedTimeUtc)},f:function(){return this.a.UnReadCount>0?_j.h.c("({0})",this.a.UnReadCount):""},e:function(){var n=new _g.g;n.EmailAddress=this.a.SenderPhotoEmailAddress;n.MailboxType="Mailbox";return this.b.a(_h.j.a(n,!1),2,!1,4,!1,!1,!1)}};_d.K=function(n,t){this.c=Function.createDelegate(this,this.d);_d.K.initializeBase(this);this.b=t;this.a=new _j.l;var i=new _c.w(_g.l.a(_g.l.d("inbox")),20);i.c(this.c);n.a(i)};_d.K.prototype={b:null,a:null,d:function(n){var i=n;var r=new _j.q;if(i.e)for(var t=0;t<i.e.length;t++)r.c(new _d.ba(this.b,i.e[t]));this.a.j(r.i())}};_d.bx=function(n,t){_a.c.b(n,"actionSubmitter");_a.c.b(t,"personaViewModelFactory");this.b=n;this.c=t};_d.bx.prototype={b:null,c:null,a:function(){return new _d.K(this.b,this.c)}};_d.bf=function(n,t,i){this.b=n;this.d=t;this.c=i};_d.bf.prototype={b:null,d:null,c:null,a:function(n){return new _d.k(n,this.b,this.d.c(new _bc.h,1,null,!1),this.c)}};_d.bq=function(n,t,i){_d.bq.initializeBase(this,[1,"AsyncSendDatapoint"]);this.a.ET=_d.X.toString(n);this.a.SC=t.toString();this.a.FC=i.toString()};_d.g=function(){};_d.g.i=function(n){_d.g.a(0,n,-1)};_d.g.c=function(n){_d.g.a(2,-1,n)};_d.g.d=function(n){_d.g.a(8,-1,n)};_d.g.j=function(n){_d.g.a(1,n,-1)};_d.g.g=function(n){_d.g.a(3,-1,n)};_d.g.f=function(n){_d.g.a(4,-1,n)};_d.g.h=function(n){_d.g.a(5,-1,n)};_d.g.e=function(n){_d.g.a(7,-1,n)};_d.g.b=function(n){_d.g.a(6,-1,n)};_d.g.a=function(n,t,i){var r=new _d.bq(n,t,i);_a.A.b.b()&&_a.A.b.a(r)};_d.bk=function(n,t,i,r){this.f=Function.createDelegate(this,this.y);this.o=Function.createDelegate(this,this.B);this.p=Function.createDelegate(this,this.C);this.u=Function.createDelegate(this,this.A);this.t=Function.createDelegate(this,this.z);this.w=Function.createDelegate(this,this.E);this.v=Function.createDelegate(this,this.D);n.b(ISendFailedEvent,this.v);n.b(_y.he,this.w);n.b(IQuickComposeSendFailedEvent,this.t);n.b(IQuickComposeSendFailureRemoveEvent,this.u);this.s=t;this.e=i;this.d=n;this.q=r};_d.bk.prototype={s:null,e:null,d:null,j:null,n:null,b:0,c:0,h:!1,m:!1,l:!1,q:null,i:null,a:function(){return this.b},x:function(n){if(this.b===n)return n;var t=!this.b;var i=this.b<n;this.b=n;!this.b!==t&&(this.c||(this.b?this.e.m(this.f):this.e.l(this.f)));i?!this.b!==t?this.d.a(ISendFailedO365Event,new _mcp.T(!0,this.p,!0,this.i)):this.d.a(ISendFailedO365Event,new _mcp.T(!1,this.p,!0,this.i)):!this.b!==t&&this.d.a(ISendFailureRemoveO365Event,new _mcp.bw(!0));return n},r:function(n){if(this.c===n)return n;var t=!this.c;var i=this.c<n;this.c=n;!this.c!==t&&(this.b||(this.c?this.e.m(this.f):this.e.l(this.f)));i?!this.c!==t?this.d.a(ISendFailedO365Event,new _mcp.T(!0,this.o,!1,"")):this.d.a(ISendFailedO365Event,new _mcp.T(!1,this.o,!1,"")):!this.c!==t&&this.d.a(ISendFailureRemoveO365Event,new _mcp.bw(!1));return n},k:function(){this.j||(this.j={});return this.j},g:function(){this.n||(this.n={});return this.n},D:function(n){_d.g.c(this.b);var t=n.a().a();this.i=t.w();this.k()[t.d()]=n.a();this.x(this.b+1);this.h=!1},C:function(){this.h?_d.g.f(this.b):_d.g.g(this.b);if(this.m){_j.e.a(_a.a.a,"skipping resuming messages failed to send since another resume is currently in progress");return}this.m=!0;try{_j.e.a(_a.a.a,"resuming messages failed to send per user request");var i=this.k();for(var r in i){var u={key:r,value:i[r]};var t=u.value.a();t.ej(!0);var n=this.q.a(t,null,null);n.P(!1);n.U(!1);this.e.f(n,0,!0)}}finally{this.h=!0;this.m=!1}},E:function(n){_d.g.h(this.b);var t=this.k()[n.a];var i=this;this.s.f(_a.a.a,"Clean up on SendFailure failed",function(){t.v(!0);t.dispose()});delete this.k()[n.a];this.x(this.b-1);this.h=!1},z:function(n){_d.g.d(this.c);var t=n.a();this.g()[t.e()]=t;this.r(this.c+1)},B:function(){_j.e.a(_a.a.x,"resend failed message for quick compose via global header");if(this.l){_j.e.a(_a.a.x,"skipping resending messages failed to send since another resend is currently in progress");return}this.l=!0;try{var i=this.g();for(var t in i){var r={key:t,value:i[t]};_d.g.e(this.c);var n=r.value;n.b().c();delete this.g()[n.e()];this.r(this.c-1)}}finally{this.l=!1}},A:function(n){var t=n.a();if(t.e()in this.g()){delete this.g()[t.e()];this.r(this.c-1)}},y:function(n){_d.g.b(this.b);n.a(_nbs.a.uo)}};_d.bl=function(n,t,i){this.d=Function.createDelegate(this,this.j);this.g=Function.createDelegate(this,this.l);this.h=Function.createDelegate(this,this.m);this.f=Function.createDelegate(this,this.k);n.b(ISendEvent,this.f);n.b(ISendSucceededEvent,this.h);n.b(ISendFailedEvent,this.g);this.e=t;this.c=i};_d.bl.prototype={e:null,c:null,b:0,a:function(){return this.b},k:function(n){_d.g.i(this.b);this.b++;this.b===1&&this.c.m(this.d)},m:function(n){_d.g.j(this.b);var t=n.a();var i=this;this.e.f(_a.a.a,"Clean up on send succeeded",function(){t.dispose()});this.i()},l:function(n){this.i()},i:function(){this.b--;this.b||this.c.l(this.d)},j:function(n){n.a(_nbs.a.Xc)}};_d.bp=function(){this.h=Function.createDelegate(this,this.o);this.g=Function.createDelegate(this,this.n);this.f=Function.createDelegate(this,this.m);this.d=Function.createDelegate(this,this.k);this.e=Function.createDelegate(this,this.l);_d.bp.initializeBase(this);this.c=new _c.m;this.j=new _j.g(this.e,_a.a.F);this.i=new _j.g(this.d,_a.a.F);_j.m.a().c(_a.a.F,"UserOofNotificationProvider::ctor",this.f)};_d.bp.prototype={c:null,j:null,i:null,m:function(){var n=new _c.A(this.c);n.c(this.g);_a.g.a.a(n)},n:function(n){this.c.a()},b:function(n){this.c=n;!this.c.a()},a:function(){return new _c.m},l:function(){},k:function(){this.c.b(!1);var n=new _c.N(this.c);n.b(this.h);_a.g.a.a(n)},o:function(n){_a.D.a(_nbs.a.Pz,0)}};_d.C=function(){};_d.C.c=function(n){for(var r=[],t=0;t<n.b();++t){var i={};i.DisplayName=n.c(t).bH.Mailbox.Name;i.SmtpAddress=n.c(t).bH.Mailbox.EmailAddress;i.RoutingType=n.c(t).bH.Mailbox.RoutingType;Array.add(r,JsonParser.serialize(i))}return JsonParser.serialize(r)};_d.C.a=function(n){var i=JsonParser.deserialize(n.Properties);var t=new _j.l;Array.forEach(i,function(n){var r=JsonParser.deserialize(n);var u=new _dg.d;var i=new _g.g;i.Name=r.DisplayName;i.EmailAddress=r.SmtpAddress;i.RoutingType=r.RoutingType;u.j(i);t.a(u)});return t};_d.C.d=function(n){for(var r=[],t=0;t<n.x.length;++t){var i={};i.DisplayName=n.x[t].a().c();i.SmtpAddress=n.x[t].a().a().EmailAddress;i.RoutingType=n.x[t].a().a().RoutingType;i.GALContactGuid=n.x[t].a().k();Array.add(r,JsonParser.serialize(i))}return JsonParser.serialize(r)};_d.C.b=function(n){var i=JsonParser.deserialize(n.Properties);var t=new _j.l;Array.forEach(i,function(n){var r=JsonParser.deserialize(n);var i=new _g.g;i.Name=r.DisplayName;i.EmailAddress=r.SmtpAddress;i.RoutingType=r.RoutingType;t.a(i)});return t};_d.h=function(n,t,i){this.u=Function.createDelegate(this,this.E);this.t=Function.createDelegate(this,this.D);_d.h.initializeBase(this,[_d.h.f(),_d.h.h(),_d.h.i(),_d.h.g(t,i),n,null,t,i]);this.l=_d.h.c("AllowMultipleSelection");this.m=new _j.g(this.t,_a.a.b);this.n=new _j.g(this.u,_a.a.b);var r=this.G();this.H(_y.k.a(null,r,null));this.g.T(!1);this.A()};_d.h.d=function(){var n=_d.h.a;if(!n){n={};n[_d.a.toString(0)]=_nbs.a.UT;n[_d.a.toString(1)]=_nbs.a.z;n[_d.a.toString(2)]=_nbs.a.z;n[_d.a.toString(3)]=_nbs.a.UT;n[_d.a.toString(4)]=_nbs.a.my;n[_d.a.toString(6)]=_nbs.a.KO;n[_d.a.toString(5)]=_nbs.a.QV;n[_d.a.toString(7)]=_nbs.a.BF;n[_d.a.toString(8)]=_nbs.a.PJ;n[_d.a.toString(9)]=_nbs.a.ue;n[_d.a.toString(10)]=_nbs.a.ue;n[_d.a.toString(11)]=_nbs.a.ue;_d.h.a=n}return _d.h.a};_d.h.e=function(){var n=_d.h.b;if(!n){n={};n[_d.a.toString(0)]=_nbs.a.Sy;n[_d.a.toString(1)]=_nbs.a.bA;n[_d.a.toString(2)]=_nbs.a.bA;n[_d.a.toString(3)]=_nbs.a.Sy;n[_d.a.toString(4)]=_nbs.a.Fm;n[_d.a.toString(6)]=_nbs.a.sQ;n[_d.a.toString(5)]=_nbs.a.pb;n[_d.a.toString(7)]=_nbs.a.Cs;n[_d.a.toString(8)]=_nbs.a.Ql;n[_d.a.toString(9)]=_nbs.a.JD;n[_d.a.toString(10)]=_nbs.a.JD;n[_d.a.toString(11)]=_nbs.a.JD;_d.h.b=n}return _d.h.b};_d.h.f=function(){var n=window.dialogArguments;return _d.C.a(n)};_d.h.c=function(n){var i=window.dialogArguments;var t=JsonParser.deserialize(i.Metadata);return t[n]};_d.h.h=function(){var i=window.dialogArguments;var t=JsonParser.deserialize(i.Metadata);var n=t.PickerCallerType;return _d.h.d()[_d.a.toString(n)]};_d.h.i=function(){var i=window.dialogArguments;var t=JsonParser.deserialize(i.Metadata);var n=t.PickerCallerType;return _d.h.e()[_d.a.toString(n)]};_d.h.g=function(n,t){var r=window.dialogArguments;var f=JsonParser.deserialize(r.Metadata);var u=f.PickerCallerType;var i=null;switch(u){case 4:case 6:case 5:case 7:case 8:case 10:case 11:i=_fp.b.C;break;case 0:case 1:case 2:case 3:case 9:default:i=_fp.b.h;break}return new _fp.c(i,_fp.b.c(),n,t,_d.h.c("AllowAddAsSmtpAddress"),null,null,null,null,null,null,0,null,null,"",null,"")};_d.h.prototype={m:null,n:null,g:null,l:!1,H:function(n){if(this.g!==n){this.g=n;this.eJ("ApplicationBarViewModel")}return n},p:function(n){return this.l?!0:n.b()>=1?!1:!0},s:function(n){n.g(1,new Array(0),n.ca.a().EmailAddress)},q:function(n){return this.f.f(_pe.c.a,n)},D:function(){var n=window.dialogArguments;n.Properties=_d.C.c(this.a);window.close()},E:function(){window.close()},G:function(){var n=new Array(2);n[0]=new _y.h(_y.b.k(),_y.b.l(),_u.W.BP,this.m);n[1]=_y.h.a(_u.n.Pi,this.n);return n}};_d.bg=function(n,t,i){this.e=n;this.d=t;this.c=i};_d.bg.prototype={e:null,d:null,c:null,b:function(n,t,i){return new _d.h(this.e,this.d,this.c)},a:function(n,t,i){return new _d.h(this.e,this.d,this.c)}};_d.q=function(n){this.h=Function.createDelegate(this,this.m);this.i=Function.createDelegate(this,this.n);_d.q.initializeBase(this);this.e=n;this.c=new _j.g(this.i,_a.a.N);this.j()};_d.q.a=function(n){return n.b()!==5};_d.q.prototype={e:null,b:null,c:null,a:null,f:function(){if(!this.b){this.b=this.e.a(_fp.b.ba,_fp.b.c(),!1,"PersonaDetailedView",2,_d.q.a,null,0,null);this.b.cj();this.b.L(!0);this.b.D(!0);this.b.o(!1);this.b.T(this.h);this.b.cJ(100);this.b.E(0)}return this.b},g:function(n){if(this.a!==n){this.a=n;this.j();this.eN("Persona","RemoveRecipientText")}return n},l:function(){return!this.a||!this.a.a()?String.format(_u.P.s,""):String.format(_u.P.s,this.a.a().c())},d:function(){this.g(null);this.f().g("")},m:function(n,t){var i=n.K();i&&this.g(i)},n:function(){this.g(null);this.f().k(!0)},j:function(){this.c.c(!!this.a)}};_d.by=function(){this.$$d_onActivateFolderPickerSelectionCommand=Function.createDelegate(this,this.onActivateFolderPickerSelectionCommand);this.$$d_remove=Function.createDelegate(this,this.remove);this.$$d_openFolderPicker=Function.createDelegate(this,this.openFolderPicker);_d.by.initializeBase(this);_a.c.a(folderPickerContainer,"folderPickerContainer shouldn't be null");_a.c.a(owaShell,"owaShell shouldn't be null");_a.c.a(passFolderCheck,"passFolderCheck shouldn't be null");_a.c.a(conductor,"conductor shouldn't be null");this.c=folderPickerContainer;this.owaShell=owaShell;this.set_folderName(folderName);this.set_folderId(folderId);this.passFolderCheck=passFolderCheck;this.conductor=conductor;this.a=new _j.g(this.$$d_openFolderPicker,_a.a.bx);this.d=new _j.g(this.$$d_remove,_a.a.bx)};_d.by.prototype={c:null,b:null,a:null,d:null};_d.r=function(n,t,i,r,u,f){this.m=Function.createDelegate(this,this.p);this.i=Function.createDelegate(this,this.o);_d.r.initializeBase(this);this.e=n;this.f=t;this.l=i;this.g=r;this.h=u;this.j=f};_d.r.prototype={e:null,f:null,l:null,g:null,h:null,j:null,d:null,c:null,k:null,a:function(){return this.c},n:function(n){if(n!==this.c){this.c=n;this.eJ("FolderPickerDialog")}return n},b:function(){if(this.t()){this.n(new _y.df(new _y.de(this.e,this.d,_g.a.a(),this.l,null,null,!0,!1,!1,null,null,null,this.g,this.h,this.j,null,null,null,null,null,!1)));this.f.a(_d.r.a,"RemovePickerDialog",this.i,9e5)}},t:function(){var n=_h.a.b("msgfolderroot");var t=n.j||_g.j.a("msgfolderroot");if(n&&t){this.d=new _j.l;var i=new _y.Y(this.e,"msgfolderroot",t,n,_g.a.a(),this.g,this.h,null,null,!1,!1,!1,null,!1,null,null,null);this.d.a(i);return!0}else{this.s();return!1}},o:function(){this.c&&this.c.r?this.f.a(_d.r.a,"RemovePickerDialog",this.i,9e5):this.q()},p:function(){_j.e.a(_d.r.a,"FolderPickerContainer.RemoveFolderPickerScreen");this.k.c?this.f.a(_d.r.a,"RemoveFolderPickerScreen",this.m,9e5):this.r()},q:function(){this.d=null;this.n(null)},r:function(){this.d=null;this.k=null},s:function(){var n=new _a.u([_nbs.a.Pp],0,null,0,!1,_bcs.D.D,null,_nbs.a.FY);this.e.a(_a.u,n)}};_d.Z=function(){this.c=timeRange;this.isDueDate=isDueDate;this.d=flagStatus;this.e=this.getHeader()};_d.Z.prototype={e:null,c:null,d:"NotFlagged",a:function(){return this.e},b:function(n){var t=n;return t?this.c.d(t):!1},toString:function(){return this.e},C:function(n){if(_d.Z.isInstanceOfType(n)){var t=n;if(this.d===this.d)return this.c?this.c.C(t.c):!t.c}return!1}};_d.bb=function(n,t,i,r,u,f,e,o){this.f=t;this.e="";this.j=i;this.l=r;this.h=u;this.k=f;this.n=e;this.i=o;this.g=n};_d.bb.prototype={g:null,i:null,f:!1,j:null,l:null,e:null,h:null,k:0,n:null,c:function(n){this.e=_j.h.b(n)?"":n.startsWith("&")?n:"&"+n;return n},b:function(){if(this.i.q())this.a(this.i.s());else{var t=0;this.h&&this.h.a()&&(t=this.h.a().a);var n=0;switch(t){case 0:n=0;break;case 1:n=1;break;case 2:n=2;break;case 3:n=3;break;case 4:n=5;break;default:break}this.a(n)}},a:function(n){this.q(n)},d:function(n,t){var r=this.o(n,t);var i=this.f?"MicrosoftOffice365Help":"OWAPremiumHelp";this.j.a(r,i,this.m(),!0)},r:function(n){var t=this.p(n);if(t){var i=this.f?"MicrosoftOffice365Help":"OWAPremiumHelp";this.j.a(t,i,this.m(),!0)}},p:function(n){var t=null;if(this.g){t=n!==119?String.format(this.g,_j.u.c(_y.js,n)):this.g;this.f&&(t+=this.e)}return t},o:function(n,t){var i=null;i=_j.h.c("https://office.microsoft.com/client/15/help/results?ShowNav=true&lcid=1033&ns=OLWAO365E&ver=15&mode=Desktop&helpid=ms.exch.owap.{0}&qu={1}",n,t);this.f&&(i+=this.e);return i},m:function(){return this.k==="Mouse"?"width=400,height=500,menubar=no,status=no,scrollbars=no,titlebar=no,toolbar=no,resizable=yes":""},q:function(n){this.l.c(_g.k.a)||this.r(n)}};_d.N=function(n,t){this.h=Function.createDelegate(this,this.j);_d.N.initializeBase(this);this.g=n;this.d=new _d.q(t);this.i()};_d.N.prototype={g:null,f:null,e:null,d:null,a:function(){return this.e},l:function(n){if(this.e!==n){this.e=n;this.eJ("DialogViewModel")}return n},c:function(){this.d.d();this.e.f(!0)},eL:function(){var n;_a.h.a(n={val:this.f}),this.f=n.val;_a.gd.prototype.eL.call(this)},b:function(n){_j.h.a(n)||this.g.a(_y.ec,new _y.ec(n))},j:function(){if(this.d.a){this.g.a(_y.ec,new _y.ec(this.d.a.a().a().EmailAddress));this.e.q.a()}},i:function(){var n=new _bc.n;n.s(_nbs.a.tU);n.t(this);var t=this;this.f=new _j.w(this.h,_a.a.eM,this.d,"Persona",function(){return!!t.d.a});n.p.a(new _ff.d(this.f,_nbs.a.ll,null,!0,!1));n.p.a(new _ff.d(n.q,_u.R.Ff,null,!1,!1));this.l(n)}};_d.M=function(n,t,i,r){this.i=Function.createDelegate(this,this.l);this.j=Function.createDelegate(this,this.n);_a.c.b(n,"offlineSettings");_a.c.b(t,"owaShell");_a.c.b(r,"eventAggregator");this.d=n;this.g=t;this.e=i;r.b(_j.ba,this.j);var u=this;this.h=new _j.J(function(){return new _y.iO})};_d.M.prototype={d:null,g:null,h:null,e:0,f:function(){return this.h.e()},k:function(){return!this.d.c()&&this.d.i(this.e,!1)},c:function(n){if(n&&!n.n.a){if(this.d.c()){this.m();return!0}if(this.k()){this.l();return!0}}return!1},a:function(n){this.k()&&!n.h(9600)&&n.c(9600,null,_nbs.a.h,this.i)},b:function(n){n.b(9600)},m:function(){this.f().f(!1);this.g.d(this.f())},l:function(){this.f().f(!0);this.g.d(this.f())},n:function(n){var t=n.a;this.e=t.bH.PolicySettings.AllowOfflineOn}};_d.n=function(n,t){this.g=Function.createDelegate(this,this.j);_d.n.initializeBase(this);this.b=t;this.a=n;this.c=_d.n.b();this.h=new _j.g(this.g,_a.a.A);this.l();switch(this.a.e()){case 0:case 1:break;default:throw Error.invalidOperation(String.format("Invalid value {0} for reminder group",this.a.e()));}};_d.n.a=function(n,t){_a.c.b(n,"object1");_a.c.b(t,"object2");var r=n.a;var i=t.a;return r.a().a(i.a())};_d.n.b=function(){var n=_a.d.a();return new _a.d(n.g(),n.f(),n.j(),n.m(),n.q(),0)};_d.n.prototype={b:null,h:null,a:null,c:null,f:!1,d:null,e:null,i:function(){var n="";this.a.e()?this.a.e()===1&&(n=this.a.b().b(18)):n=_a.d.h(this.a.a(),this.c)&&_a.d.h(this.a.a(),this.a.f())?String.format(_nbs.a.fi,this.a.a().b(18),this.a.f().b(18)):String.format(_nbs.a.QW,this.a.a().b(18),this.a.a().b(3));return n},eL:function(){this.a&&this.a.dispose();_a.gd.prototype.eL.call(this)},l:function(){var i=null;this.a.e()?this.a.e()===1&&(i=this.a.b()):i=this.a.a();var n=Math.floor(i.e(this.c)/1e3);var t=_a.d.bY(n<0?-n:n,!0,!0);this.f=n<0;if(n&&t.length){this.d=t[1];this.e=t[0]}else{this.d=_nbs.a.QJ;this.e=""}this.eV("TimeToItemStartUnit","TimeToItemStartValue","IsReminderOverdue")},j:function(){var n=this.a.i();if((n&1)==1){var i=new _db.p;i.b(this.a.c());var r=(n&4)==4?_db.bm:_db.n;this.b.r(r,null,i.a,_bc.d.a())}else if(n===2){var t={};t.ItemID=this.a.c().Id;this.b.r(_y.fp,null,t,_bc.d.a())}}};_d.O=function(n){_d.O.initializeBase(this);this.a=n};_d.O.prototype={a:null,b:function(n){return new _d.n(n,this.a)}};_d.P=function(n,t,i,r,u,f,e){this.v=Function.createDelegate(this,this.H);this.y=Function.createDelegate(this,this.N);this.x=Function.createDelegate(this,this.L);this.l=Function.createDelegate(this,this.K);this.u=Function.createDelegate(this,this.G);this.w=Function.createDelegate(this,this.I);this.t=Function.createDelegate(this,this.E);_d.P.initializeBase(this);_a.c.b(i,"nativeBridge");_a.c.b(r,"offlineSettings");_a.c.b(u,"userAgent");this.r=n;this.d=new _h.cm;this.e={};this.q=r;this.h=u;this.b=f;this.m=e;this.a=new _a.dg(this.t);this.a.d(this.w);this.c=new _a.dg(this.u);this.j=i;if(t){t.d(_h.dl,new _h.dl);var o=this;t.b(_j.O,function(n){n.a&&o.M()})}};_d.P.prototype={q:null,r:null,h:null,b:null,m:null,a:null,c:null,j:null,d:null,e:null,g:null,i:null,f:null,n:!0,p:!1,M:function(){if(!this.z()){this.b.a().apcl("EnableReminders",this.l);this.p=!0;_j.e.a(_a.a.A,"Disabling reminders entirely. EnableReminders:{0}, IsPalEnabled:{1} Seg.Calendar:{2} Seg.Tasks:{3}",this.b.a().bH.EnableReminders,this.h.c(),this.b.e().bH.Calendar,this.b.e().bH.Tasks);return}this.C();if(this.q.a())_j.e.a(_a.a.A,"Fetch reminders on OwaStarted event skipped as offline is enabled.");else{_j.e.a(_a.a.A,"Fetch reminders on OwaStarted event.");this.o(0,null)}},o:function(n,t){_j.e.a(_a.a.A,"Calling GetReminders. ReminderType = {0}",n);n&&n!==1||this.s(null);this.f=_j.m.a().b(this.f);var u=!this.h.c()||this.m.a().D().Enabled;var i=new _h.dC(u,this.b.e());i.f=n;i.p(this.h.a()?64:200);var r=_a.d.a();switch(n){case 0:i.e=r.c(10);break;case 1:i.h=r.l(-864e5);i.e=i.e=r.c(10);break;case 2:i.e=r.l(-864e5);break}i.c(this.x);if(t){var f=this;i.a(function(n){t()})}_a.g.a.a(i)},D:function(n){for(var i=[],t,f,e,r=this.c.x.length-1;r>=0;r--){t=this.c.x[r];f=this.r.b(t);if(t.b().o().a(n)<=0){var u=t.d()?t.d().Id:"";if(this.e[u]){e=this.e[u];this.a.p(e,!0);e.dispose();this.e[u]=f}Array.add(i,f)}else break}if(i.length>0){this.a.j(i);this.c.r(this.c.x.length-i.length,i.length)}this.A(n)},C:function(){_j.e.a(_a.a.A,"Subscribe for reminders notifications.");var n=new _g.S;n.NotificationType="ReminderNotification";var t=new _h.K(n);t.n(_a.a.A,"ReminderNotification",this.y,0)},G:function(n,t){return _h.cm.a(t,n)},E:function(n,t){return _d.n.a(t,n)},I:function(n,t){this.n&&this.eW("ActiveRemindersChanged",n,t)},N:function(n){_a.c.a(n,"notification");if(n.id!=="ReminderNotification")throw Error.argument("notification","Notification Id must be ReminderNotification");_j.e.a(_a.a.A,"Received reminder notification");var i=n;if(i.shouldGetReminders){this.f&&(this.f=_j.m.a().b(this.f));var t=this;this.f=_j.m.a().a(_a.a.A,"ReminderNotification",function(){t.o(0,null)},8e3)}},L:function(n){var t=n;_j.e.a(_a.a.A,"GetReminders succeeded. Received {0} reminders",t.k.x.length);this.O(t)||this.P(t)},P:function(n){this.eW("BeforeRemindersRefresh",this,null);this.g=_j.m.a().b(this.g);this.c.g();this.n=!1;var h=this.d;this.d=n.k;for(var s=this.a.x.length,u=0;u<s;u++){var l=this.a.x[u];l&&l.dispose()}this.a.g();this.e={};for(var c=_a.d.get_utcNow(),t,r=-1,i=!1,f=this.d.x.length-1;f>=0;f--){t=this.d.x[f];if(t.b().o().a(c)>0)this.c.a(t);else{this.a.x.length||(r=h.m(t));var e=!!t.d();if(!e||!(t.d().Id in this.e)){var o=this.r.b(t);this.a.a(o);e&&(this.e[t.d().Id]=o);if(i)continue;i=r<0||!h.x[r].C(t)}r--}}i=!!(i|s!==this.a.x.length);i&&this.eW("ActiveRemindersChanged",this.a,new _j.V(4,0,[],[]));this.c.x.length>0&&this.A(c);this.s(n);this.n=!0;this.eW("AfterRemindersRefresh",this,null)},O:function(n){_j.e.a(_a.a.A,"Scheduling reminders in PAL...");if(!this.j.b(this.j.j()))return!1;for(var i=n.N.Body.Reminders,h=this.m.a().D().Enabled,u=new Array(0),f=i,c=f.length,r=0;r<c;++r){var t=f[r];!t.ReminderGroup&&_a.d.b(t.EndDate).a(_a.d.a())>=0?Array.add(u,t):t.ReminderGroup===1&&h&&Array.add(u,t)}i=u;_j.e.a(_a.a.A,"Serializing {0} reminders...",i.length);var s=JsonParser.serialize(i);_j.e.a(_a.a.A,"Scheduling {0} reminders on PAL...",i.length);var o=this,e=this;this.j.j().b(s,function(){_j.e.a(_a.a.A,"Schedule reminders on PAL succeeded.");o.s(n)},function(t){_j.e.c(_a.a.A,"Failed to schedule reminders on PAL : {0}",t.message);e.s(n)});return!0},s:function(n){this.i&&(this.i=_j.m.a().b(this.i));if(this.q.a()){_j.e.a(_a.a.A,"Offline is enabled and so no need to schedule reminders timer");return}if(n){if(!n.f||n.f===1){var r=_a.d.get_utcNow();var i=null;this.d.x.length===n.j&&this.d.x.length>=1&&(i=this.d.x[this.d.x.length-1].b().o());var u=r.l(288e5);var t=288e5;if(i)if(i.a(r)<=0)t=6e5;else if(i.a(u)<0){t=i.e(r);t=Math.max(t,6e5)}this.B(t)}}else this.B(6e5)},B:function(n){_j.e.a(_a.a.A,"Scheduling next GetReminers call to happen in {0} milliseconds",n);this.i=_j.m.a().a(_a.a.A,"GetReminders",this.v,n)},H:function(){_j.e.a(_a.a.A,"GetReminers timer expired");this.o(0,null)},A:function(n){this.g=_j.m.a().b(this.g);if(this.c.x.length){var r=this.c.x[this.c.x.length-1];var i=r.b().o().e(n);var t=this;this.g=_j.m.a().a(_a.a.A,"ActivateReminders",function(){t.D(_a.d.get_utcNow())},i)}},z:function(){var i=this.b.a().bH.EnableReminders;var t=this.b.e().bH.Calendar;var n=this.b.e().bH.Tasks;return this.h.c()?this.b.e().bH.Calendar:i&&(t||n)},K:function(n,t){if(this.z()){this.C();this.o(0,null);this.b.a().rpcl("EnableReminders",this.l);this.p=!1}},eL:function(){this.p&&this.b.a().rpcl("EnableReminders",this.l);_a.gd.prototype.eL.call(this)}};_d.x=function(){this.$$d_openSelectedReminder=Function.createDelegate(this,this.openSelectedReminder);this.$$d_updateCalculatedProperties=Function.createDelegate(this,this.updateCalculatedProperties);this.$$d_dismissAllReminders=Function.createDelegate(this,this.dismissAllReminders);this.$$d_dismissSelectedReminders=Function.createDelegate(this,this.dismissSelectedReminders);this.$$d_onSnoozeReminderButtonPressed=Function.createDelegate(this,this.onSnoozeReminderButtonPressed);this.$$d_onSelectedRemindersCountChanged=Function.createDelegate(this,this.onSelectedRemindersCountChanged);this.$$d_onAfterRemindersRefresh=Function.createDelegate(this,this.onAfterRemindersRefresh);this.$$d_onBeforeRemindersRefresh=Function.createDelegate(this,this.onBeforeRemindersRefresh);this.$$d_onActiveRemindersChanged=Function.createDelegate(this,this.onActiveRemindersChanged);_d.x.initializeBase(this);this.f=remindersManager;remindersManager.a.d(this.$$d_onActiveRemindersChanged);remindersManager.add_beforeRemindersRefresh(this.$$d_onBeforeRemindersRefresh);remindersManager.add_afterRemindersRefresh(this.$$d_onAfterRemindersRefresh);this.c=new _j.l;this.c.apcl("Count",this.$$d_onSelectedRemindersCountChanged);this.previouslySelectedReminders=[];this.snoozeRemindersCommand=new _j.g(this.$$d_onSnoozeReminderButtonPressed,_d.x.a,this.get_canActOnSelectedReminders());this.dismissRemindersCommand=new _j.g(this.$$d_dismissSelectedReminders,_d.x.a,this.get_canActOnSelectedReminders());this.dismissAllRemindersCommand=new _j.g(this.$$d_dismissAllReminders,_d.x.a);this.g=new _j.g(this.$$d_updateCalculatedProperties,_d.x.a);this.e=new _j.g(this.$$d_openSelectedReminder,_d.x.a);this.a=new _j.l;this.generateDefaultSnoozeOptions();this.m(!1);if(_y.c.a.a()!=="Mouse"){var n=[new _y.h(_y.b.v(),_y.b.w(),_nbs.a.cH,this.snoozeRemindersCommand),new _y.h(_y.b.m(),_y.b.n(),_u.n.UQ,this.dismissRemindersCommand)];this.ff(_y.k.b(this,n,null))}};_d.x.prototype={g:null,f:null,b:null,c:null,a:null,d:0,e:null,n:function(){return _y.c.a.a()!=="Mouse"?_y.lJ.prototype.n.call(this):0},h:function(n){if(this.b!==n){this.b=n;this.eJ("SelectedReminder");this.m(!0)}return n},j:function(n){if(n!==this.d){this.d=n;this.eJ("SelectedSnoozeTime")}return n},i:function(n){this.c!==n&&(this.c=n);return n},m:function(n){var t=[];if(this.b&&this.c.x.length===1){var r=_a.d.a();var u=this.b.a.a().p(-15);r.a(u)<=0&&Array.add(t,-15);r.a(u.p(5))<=0&&Array.add(t,-10);r.a(u.p(10))<=0&&Array.add(t,-5);r.a(this.b.a.a())<=0&&Array.add(t,0)}if(!t.length||t[0]!==this.a.x[0]){for(var i=0;i<this.a.x.length;i++)if(this.a.x[i]===5)break;this.a.r(0,i);t.length>0&&this.a.s(0,t)}(this.d<this.a.x[0]||n)&&this.j(this.a.x[0])}};_d.bj=function(n,t,i,r){this.a=this.$$gta["_d.bj"].T===Number||Type.isEnum(this.$$gta["_d.bj"].T)?0:this.$$gta["_d.bj"].T===Boolean?!1:null;if(!t)throw Error.argumentNull("isSameSelection");if(!i)throw Error.argumentNull("setSelection");if(!r)throw Error.argumentNull("undoSelection");this.a=n;this.b=t;this.c=i;this.d=r};_d.bj.$$=function(n){var u=_d.__tc=_d.__tc||{};var t="bj"+"$"+n.getName().replace(/\./g,"_");if(!u[t]){var r=u[t]=function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];_d.bj.apply(this,t)};r.registerClass("_d.__tc."+t);var o={"_d.bj":{T:n},ctor:_d.bj};r.prototype.$$gta=o;var e=_d.bj.prototype;for(var f in e){var i={key:f,value:e[f]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return u[t]};_d.bj.prototype={b:null,c:null,d:null,e:function(n){if(!this.b(this.a)){var t=this;n.h(function(n){n?t.a=t.c():t.d(t.a)})}}};_d.bw=function(n,t,i,r,u,f,e,o,s,h){this.h=Function.createDelegate(this,this.r);this.e=n;this.g=t;this.j=i;this.o=r;this.l=u;this.n=f;this.k=e;this.f=o;this.m=s;this.i=h};_d.bw.prototype={o:null,l:null,n:null,e:null,g:null,j:null,k:null,f:null,m:null,i:null,d:null,b:function(n,t,i){var u=n.IsArchive.toString()==="true";var r=new _y.D(this.e,this.g,null,null);r.L(2);var e=new _d.I(this.e,this.g,this.j,this.o,this.l,this.n,this.k,this.f,n.FilterContacts.toString()==="1",n.IsConsumer.toString()==="1",this.m,this.i);this.d=new _d.B(e,r,this.f);if(u&&!_g.b.a.nameToId("archiverecoverableitemsdeletions"))this.q();else{var f=u?_g.j.a("archiverecoverableitemsdeletions"):_g.j.a("recoverableitemsdeletions");this.p(f)}return this.d},a:function(n,t,i){throw Error.notImplemented("Creating from context is not supported");},c:function(n,t,i){var r={};r.IsArchive=n;r.FilterContacts=t?1:0;r.IsConsumer=i?1:0;this.e.r(_y.ey,null,r,_bc.d.d())},q:function(){var t="archiverecoverableitemsdeletions";var n=new _h.bp("GetFolderAction_DumpsterPopOutViewModelFactory_"+t,!1);n.j=new _h.bu;n.f=[new _g.r(t)];n.a(this.h);_a.g.a.a(n)},r:function(n){var t=n;t.n(this.h);if(t.G){this.d.a.dq(11);return}var i=t.j.x[0];this.p(i)},p:function(n){this.d.b.a.b().R(n);this.d.a.eA(n,null);this.d.a.Y(0,null)}};_d.A=function(n,t,i,r,u,f,e,o){this.g=Function.createDelegate(this,this.P);this.x=Function.createDelegate(this,this.I);this.A=Function.createDelegate(this,this.O);this.z=Function.createDelegate(this,this.N);this.B=Function.createDelegate(this,this.Q);this.y=Function.createDelegate(this,this.M);_d.A.initializeBase(this);_a.c.a(n,"message");this.c=n;this.i=t;this.p=f;this.m=i;this.e=r;this.v=u;this.s=e;this.w=o||_a.o.a();this.h=new _j.g(this.y,_a.a.cK);this.j=new _j.g(this.B,_a.a.cK);this.q=new _j.g(this.z,_a.a.cK);this.r=new _j.g(this.A,_a.a.cK);this.o=new _j.g(this.x,_a.a.cK);this.d=this.C(!0);this.f=this.C(!1);this.d||(this.n=this.h);this.f||(this.u=this.j);this.H();this.c.apcl("LastVerbExecuted",this.g);this.c.H().apcl("IsUndecidedApprovalRequest",this.g)};_d.A.prototype={c:null,e:null,s:null,p:null,m:null,h:null,j:null,q:null,r:null,n:null,u:null,o:null,v:null,i:!1,w:null,d:null,f:null,l:!1,t:null,E:!1,R:function(n){if(n!==this.l){this.l=n;this.eJ("ShowApproveRejectButtons")}return n},L:function(){return this.w.d().e()},b:function(n){this.t=n;return n},a:function(n){this.E=n;return n},eL:function(){this.t=null;this.c.rpcl("LastVerbExecuted",this.g);this.c.H().rpcl("IsUndecidedApprovalRequest",this.g);var t;_a.h.a(t={val:this.d}),this.d=t.val;var n;_a.h.a(n={val:this.f}),this.f=n.val;_a.gd.prototype.eL.call(this)},H:function(){this.R(!!this.c.H()&&this.c.H().c()&&this.c.bG()!==1&&this.c.bG()!==2)},P:function(n,t){this.H()},C:function(n){var i=n?0:1;if(this.c.bH.VotingInformation&&this.c.bH.VotingInformation.UserOptions&&this.c.bH.VotingInformation.UserOptions.length>=i&&this.c.bH.VotingInformation.UserOptions[i].SendPrompt==="Send")return null;var t=[new _fm.c(_u.W.U,null,n?this.q:this.r),new _fm.c(_u.W.BB,null,n?this.h:this.j)];this.e.a()==="TouchNarrow"&&Array.add(t,new _fm.c(_nbs.a.na,null,this.o));return new _fm.e(t)},M:function(){this.G(!0)},Q:function(){this.G(!1)},G:function(n){if(!this.i){var t=new _mcp.N(this.c,null,n,1);this.m.a(t);this.K()}},N:function(){this.D(!0)},O:function(){this.D(!1)},D:function(n){if(!this.i){var t=this.s.a(!1,!1);t.e(n?9:10);t.f(!0);t.p(this.e.a()==="Mouse"?1:2);t.S(this.c);this.p().a(t)}},I:function(){},K:function(){switch(this.e.a()){case"TouchNarrow":this.v.d();break;case"TouchWide":break;case"Mouse":if(!this.e.b()){var n=window.self;_j.m.a().c(_a.a.z,"ApprovalRequestHeaderViewModel.PopOutClose",n.$$d_close||(n.$$d_close=Function.createDelegate(n,n.close)))}break}}};_d.W=function(n,t,i,r,u){this.d=n;this.e=t;this.b=i;this.c=r;this.f=u};_d.W.prototype={d:null,e:null,b:null,c:null,f:null,a:function(n,t,i){t||(t=_y.bs.a);return new _d.A(n,i,this.b,this.d,this.e,t,this.c,this.f)}};_d.B=function(n,t,i){this.h=Function.createDelegate(this,this.m);this.i=Function.createDelegate(this,this.o);_d.B.initializeBase(this);this.a=n;var f=this;this.f=new _j.g(function(){f.a.dJ()},_a.a.bH);var e=this;this.e=new _j.g(function(){e.a.dI()},_a.a.bH);var r=this;this.a.apcl("SelectedItemsCount",function(n,t){r.p(r.a.h()>0);r.q(r.d&&!r.a.ct)});var u=this;this.a.apcl("CurrentTableLoaded",function(n,t){u.eJ("DumpsterDescription")});this.r(new _y.bh("Mouse",null,new _db.b(null,null,null),null,null,null));this.b.a.o(!1);this.b.a.D(!0);this.b.a.E(1);this.b.a.w(!0);this.b.a.C(!1);this.b.a.Z(t);this.b.a.s(new _j.g(this.i,_a.a.bH));this.b.a.t(new _j.g(this.h,_a.a.bH));this.c=new _fm.k;this.c.a(new _fm.f(this.f,_nbs.a.dh,null,0,null,null,!1,!1,!1,!1,null));this.c.a(new _fm.f(this.e,_nbs.a.Zl,null,0,null,null,!1,!1,!1,!1,null))};_d.B.prototype={b:null,d:!1,g:!1,c:null,a:null,f:null,e:null,q:function(n){if(this.g!==n){this.g=n;this.eJ("IsPurgeButtonEnabled")}return n},p:function(n){if(this.d===n)return n;this.d=n;this.eJ("AreActionCommandsEnabled");return n},j:function(){return this.a.bv?String.format(_nbs.a.KN,this.a.eH.b()):_nbs.a.tA},r:function(n){if(this.b!==n){this.b=n;this.eJ("SearchControllerViewModel")}return n},o:function(){if(!_j.h.a(this.b.a.a())&&this.b.a.a().trim().length>0){this.b.a.n(!0);this.a.cl(this.b.a,!0)}},m:function(){this.b.a.N();if(this.a.eI){this.a.dm(!0);var n=this;_j.m.a().c(_a.a.bH,"LoadItemsOnCancelSearch",function(){n.a.Y(0,null)})}}};_d.I=function(n,t,i,r,u,f,e,o,s,h,c,l){this.dB=Function.createDelegate(this,this.fw);this.dC=Function.createDelegate(this,this.fB);_d.I.initializeBase(this,[n,t,i,u,r,null,f,null,null,o,null,null,null,e,null,null,null,null,null,null,c,null,l,null,null,null,!1]);this.bv=s;this.cs=h;this.mf();this.ex(new _h.q(_g.D.c,"Descending"));this.lz=this.dK();this.dz=!!o&&o.a().dn().Enabled};_d.I.prototype={cs:!1,dz:!1,ct:0,bv:!1,fw:function(n,t){var i=this;this.dH(n,function(){i.fY("HardDelete",i.m())})},fB:function(n,t){var i=this;this.dH(n,function(){var n=i.fj.f();i.dz?i.fE(n):i.gq(n)})},dJ:function(){if(this.h()){var t=this.eG();var n=new _a.u(t,1,this.dC,1,!1,_u.P.X,_u.R.BG,_u.n.Tm);this.fb.a(_a.u,n)}},dI:function(){if(this.h()){var n=new _a.u([_u.R.Jy],1,this.dB,1,!1,_u.P.X,_u.R.BG,_nbs.a.uC);this.fb.a(_a.u,n)}},ko:function(n,t){if(this.cs)if(t.c){if(t.c===2)for(var i=0;i<t.b.length;i++){var u=t.b[i].bH.ItemClass;(u==="IPM.DistList"||u==="IPM.Contact")&&this.ct--}}else for(var r=0;r<t.a.length;r++){var f=t.a[r].bH.ItemClass;(f==="IPM.DistList"||f==="IPM.Contact")&&this.ct++}this.eJ("SelectedItemsCount")},mf:function(){var n=[];var i=this;Array.add(n,new _fm.c(_nbs.a.dh,null,new _j.g(function(){i.dJ()},_a.a.bH)));var t=this;Array.add(n,new _fm.c(_nbs.a.Zl,null,new _j.g(function(){t.dI()},_a.a.bH)));this.eu(new _fm.e(n))},lF:function(){return!1},eG:function(){if(this.bv&&this.cs)return[_nbs.a.Wv];else{var n=this.dz?_u.n.IJ:_nbs.a.eo;return[n,_u.n.Pv,_u.n.QP,_u.n.Uf,_u.n.Id]}},gq:function(n){for(var f=[],e=[],o=[],u=[],t=null,i=0;i<n.length;i++){var r=n[i];switch(r.bH.ItemClass){case"IPM.Appointment":t=f;break;case"IPM.DistList":case"IPM.Contact":t=u;break;case"IPM.Task":t=o;break;case"IPM.Note":default:t=e;break}Array.add(t,r)}this.cu(e,_g.j.a("inbox"));this.cu(f,_g.j.a("calendar"));this.cu(o,_g.j.a("tasks"));this.cu(u,_g.j.a("contacts"))},dH:function(n,t){if(n&&!(this.h()<=0)){t();this.de()}},cu:function(n,t){if(!(n.length<=0)){var i=new _h.bb(n,t.bH.FolderId,0);_a.g.a.a(i)}},fE:function(n){var t=this;this.gr.a(function(t){var i=t.f(n);_a.g.a.a(i)})},dK:function(){if(this.cs&&this.bv){var t=this.bv?new _g.ba:new _gg.ev;var n=this.bv?new _g.ba:new _gg.ev;var i=this.bv?new _gg.bl:new _gg.du;t=this.dG(t,"IPM.Contact");n=this.dG(n,"IPM.DistList");i.Items=[t,n];return new _g.bf(i)}return null},dG:function(n,t){n.Item=new _g.d("ItemClass");var r;var u=(r=new _g.Y,r.Value=t,r);var i;n.FieldURIOrConstant=(i=new _g.Z,i.Item=u,i);return n}};_d.L=function(){this.g=Function.createDelegate(this,this.i);this.f=Function.createDelegate(this,this.h);_d.L.initializeBase(this);this.c=new _j.g(this.f,_a.a.o);this.e=new _j.g(this.g,_a.a.o)};_d.L.prototype={bz:function(){return!0},bx:function(){return 1},x:function(){return null},b:null,y:function(){return this.b},o:function(n){this.b=n;return n},c:null,e:null,d:null,a:function(n){this.d=n;return n},i:function(){window.print()},h:function(){this.b&&this.b()}};_d.bd=function(n){this.b=n};_d.bd.prototype={b:null,a:function(n){if(n){if(_h.bE.isInstanceOfType(n)){var i=n;var t=_h.a.a(i.e);if(!t||!t.b)return}_h.dH.isInstanceOfType(n)&&this.c(n.h())}},c:function(n){switch(n){case"ErrorAccessDenied":case"ErrorMoveCopyFailed":case"ErrorCannotDeleteObject":case"ErrorFolderSavePropertyError":case"ErrorApplyConversationActionFailed":this.d();return;case"ErrorFolderExists":this.e();return}},e:function(){var n=new _a.u([_u.R.DV],0,null);this.b.a(_a.u,n)},d:function(){var n=new _a.u([_u.R.Gu],0,null,0,!1,null,null,_u.R.Et);this.b.a(_a.u,n)}};_d.be=function(n,t){this.h=Function.createDelegate(this,this.i);this.g=Function.createDelegate(this,this.j);_d.be.initializeBase(this);this.a=new _d.q(n);this.d=t};_d.be.prototype={b:null,f:null,d:null,a:null,c:null,e:function(){this.b||this.l();return this.b},m:function(n){if(this.b!==n){this.b=n;this.eJ("DialogViewModel")}return n},l:function(){var n=new _bc.n;n.s(_nbs.a.Zi);n.t(this);var u=this;this.c=new _j.w(this.g,_a.a.v,this.a,"Persona",function(){return!!u.a.a});var t=new _j.g(this.h,_a.a.v);n.B(t);var r=new _ff.d(this.c,_nbs.a.Eb,null,!0,!1);var i=new _ff.d(t,_u.R.BG,null,!1,!1);n.p.a(r);n.p.a(i);this.m(n)},eL:function(){var i;_a.h.a(i={val:this.c}),this.c=i.val;var t;_a.h.a(t={val:this.b}),this.b=t.val;var n;_a.h.a(n={val:this.f}),this.f=n.val;_a.gd.prototype.eL.call(this)},j:function(){if(this.a.a){var n=new _g.eV;n.DisplayName=this.a.a.a().c();n.PrimarySmtpAddress=this.a.a.a().a().EmailAddress;n.DistinguishedUser="None";this.i();this.d(n)}},i:function(){this.e().f(!1);this.a.d()}};_d.i=function(n,t){this.bc=Function.createDelegate(this,this.bx);this.bd=Function.createDelegate(this,this.bz);this.Y=Function.createDelegate(this,this.bh);this.bb=Function.createDelegate(this,this.bw);this.Z=Function.createDelegate(this,this.bu);this.ba=Function.createDelegate(this,this.bv);_d.i.initializeBase(this);this.t(this);this.C(!0);this.Q=t;this.W=new _j.g(this.ba,_d.i.a);this.S=new _j.g(this.Z,_d.i.a);this.X=new _j.g(this.bb,_d.i.a);this.l=new _j.l;this.V=new _db.j;this.N=new _d.be(n,this.Y);var r=new _ff.d(this.W,_nbs.a.XX,null,!0,!1);var i=new _ff.d(this.q,_nbs.a.vZ,null,!1,!1);this.v(new _j.l);this.p.a(r);this.p.a(i);this.s(_nbs.a.kV)};_d.i.$$cctor=function(){_d.i.b=["PermissionLevel","ReadAccess","DeleteAccess","CanCreateItems","CanCreateSubfolders","EditOwn","EditAll","IsFolderOwner","IsFolderContact","IsFolderVisible"]};_d.i.prototype={Q:null,W:null,S:null,X:null,N:null,O:null,l:null,n:null,j:null,V:null,U:null,L:!1,u:!1,w:!1,M:!1,I:function(){this.O||(this.O=new _bc.b);return this.O},bs:function(){if(!this.n){this.n=new _j.l;this.n.a("Owner");this.n.a("PublishingEditor");this.n.a("Editor");this.n.a("PublishingAuthor");this.n.a("Author");this.n.a("NoneditingAuthor");this.n.a("Reviewer");this.n.a("Contributor");this.n.a("None")}return this.n},P:function(n){if(this.j===n)return n;this.j=n;this.eJ("SelectedItem");this.bg();return n},br:function(){return this.j.a()},bM:function(n){if(this.j.a()!==n){this.j.g(n);this.m(!0);this.j.v();this.eJ("PermissionLevel");this.bg()}return n},bt:function(){return this.j.r()},bN:function(n){if(this.j.r()!==n){this.j.n(n);this.m(!0);this.o();this.eJ("ReadAccess")}return n},bj:function(){return this.j.o()},bD:function(n){if(this.j.o()!==n){this.j.k(n);this.m(!0);this.o();this.eJ("DeleteAccess")}return n},bB:function(n){if(this.j.bH.CanCreateItems!==n){this.j.h(n);this.m(!0);this.o();this.eJ("CanCreateItems")}return n},bC:function(n){if(this.j.bH.CanCreateSubFolders!==n){this.j.j(n);this.m(!0);this.o();this.eJ("CanCreateSubfolders")}return n},bl:function(){return this.j.b()==="Owned"||this.j.b()==="All"},bF:function(n){if(n){if(this.j.b()==="None"){this.j.e("Owned");this.m(!0);this.o();this.eN("EditOwn","EditAll")}}else if(this.j.b()==="None"){this.m(!0);this.o();this.eN("EditOwn","EditAll")}else this.j.b()==="All"&&this.eJ("EditOwn");this.T();return n},bG:function(n){if(this.w!==n){this.w=n;this.eJ("EditOwnEnabled")}return n},bk:function(){return this.j.b()==="All"},bE:function(n){if(n){(this.j.b()==="None"||this.j.b()==="Owned")&&this.j.e("All");this.m(!0);this.o();this.eN("EditOwn","EditAll")}else if(this.j.b()==="All"){this.m(!0);this.j.e("None");this.o();this.eN("EditOwn","EditAll")}this.T();return n},bK:function(n){if(this.j.bH.IsFolderOwner!==n){this.j.m(n);this.m(!0);this.o();this.eJ("IsFolderOwner")}return n},bm:function(){return this.j.q()},bI:function(n){if(this.j.q()!==n){this.j.c(n);this.m(!0);this.o();this.eJ("IsFolderContact")}return n},bJ:function(n){if(this.M!==n){this.M=n;this.eJ("IsFolderContactEnabled")}return n},bL:function(n){if(this.j.bH.IsFolderVisible!==n){this.j.f(n);this.m(!0);this.o();this.eJ("IsFolderVisible")}return n},bH:function(n){if(this.l!==n){this.l=n;this.eJ("FolderPermissionList")}return n},h:function(){return this},m:function(n){if(this.L!==n){this.L=n;this.eJ("IsDIrty")}return n},i:function(n,t){this.U=n;this.s(String.format(_nbs.a.kV,n.bH.DisplayName));this.l.g();this.l.j(t.a().e());this.P(this.l.x[0]);this.m(!1);this.u=!1;this.f(!0)},bh:function(n){var r=this;var i=this.l.k(function(t){return t.y(n)});if(i!==this.l.x.length){this.I().h(0,String.format(_nbs.a.CL,n.DisplayName),null);return}var t=_g.v.g().p();t.s(n);this.l.a(t);this.m(!0);this.P(this.l.x[this.l.x.length-1])},bA:function(){var n=this.l.m(this.j);if(n!==-1){if(this.bf(this.j.bH.UserId)){this.I().h(0,_nbs.a.us,null);return}var i=n===this.l.x.length-1?n-1:n;this.l.p(this.j,!0);this.m(!0);var t=this.l.x[i];this.P(t)}},o:function(){var n=this.j.w();if(n!==this.j.a()){this.j.g(n);this.eJ("PermissionLevel")}},bv:function(){if(!this.u)if(this.L){this.bO();this.u=!0}else this.be()},bO:function(){var n=new _db.ec;n.f=new _g.cR;n.f.c(new(_a.fT.$$(_g.v,_g.cM)));for(var t=0;t<this.l.x.length;t++){var r=this.l.x[t];var i=r.p();i.s(this.bi(r.bH.UserId));n.f.a().c(i)}n.e=this.U;n.a(this.bd);n.b(this.bc);this.Q.a(n)},bi:function(n){var t=new _g.eV;t.DistinguishedUser=n.DistinguishedUser;t.ExternalUserIdentity=n.ExternalUserIdentity;t.PrimarySmtpAddress=n.PrimarySmtpAddress;t.SID=n.SID;return t},bu:function(){this.N.e().f(!0)},bw:function(){this.bA()},bg:function(){if(this.j){for(var n=0;n<_d.i.b.length;n++)this.eJ(_d.i.b[n]);this.T()}},T:function(){if(this.j){this.bG(this.j.b()!=="All");this.bJ(!this.bf(this.j.bH.UserId))}},bf:function(n){return n.DistinguishedUser==="Anonymous"||n.DistinguishedUser==="Default"},bz:function(n){this.u=!1;n.G||this.be()},be:function(){this.l.g();this.m(!1);this.q.a()},bx:function(n){this.u=!1;var t=n.e.bH.DisplayName;this.I().h(0,String.format(_nbs.a.Fa,t),null)}};_d.k=function(n,t,i,r){this.x=Function.createDelegate(this,this.K);this.y=Function.createDelegate(this,this.L);this.z=Function.createDelegate(this,this.M);this.u=Function.createDelegate(this,this.G);this.v=Function.createDelegate(this,this.H);this.w=Function.createDelegate(this,this.I);_d.k.initializeBase(this);_a.c.a(n,"message");_a.c.a(i,"personaCardFacade");this.m=t;this.d=n;this.j=i;this.h=!0;this.i=!1;if(r){var u=this;r.a(function(n){u.s=n;u.E()})}this.O()};_d.k.prototype={j:null,d:null,m:null,g:null,h:!1,i:!1,l:null,s:null,q:null,t:null,A:!1,f:null,e:null,o:null,n:null,p:null,N:function(n){if(this.l!==n){this.l=n;this.eJ("ProcessMembershipCommand")}return n},c:function(){return new Array(0)},C:function(n){if(this.h!==n){this.h=n;this.eJ("HideProcessMembershipButton")}return n},B:function(n){if(this.q!==n){this.q=n;this.eJ("ErrorMessage")}return n},D:function(n){if(this.i!==n){this.i=n;this.eJ("IsLoading")}return n},b:function(n){this.t=n;return n},a:function(n){this.A=n;return n},eL:function(){this.t=null;_a.gd.prototype.eL.call(this)},E:function(){if(!this.l){var n=this.s.a(this.d.bH.ItemId);n.c(this.w);n.b(this.v);n.a(this.u);this.D(!0);this.m.a(n);this.N(new _j.g(this.z,_d.k.c))}},G:function(n){this.D(!1)},H:function(n){this.C(!0);this.B(_nbs.a.rO)},I:function(n){var t=n;this.g=_pc.a.c(t.e().GroupPersona,2);this.B("");this.C(!t.e().IsOwner||this.d.bH.From.Mailbox.EmailAddress===_g.a.a().c().bH.UserEmailAddress);if(!this.h){this.f=this.r(t.e().RequestedMembers);this.e=this.r(t.e().ApprovedMembers)}},r:function(n){if(!n||!n.length)return null;for(var u=new Array(0),r=n,f=r.length,i=0;i<f;++i){var e=r[i];var t=_pc.a.c(e,2);if(t.a()){t.fQ([t.a()]);t.cb(new(_pc.t.$$(_g.g)));t.q().e(t.a(),"0")}Array.add(u,t)}return u},M:function(){if(_g.f.f(this.d)){var i=new _xs.f;var n=null;n=this.f&&this.f.length===1?this.f[0]:this.e&&this.e.length===1?this.e[0]:_pc.a.a(this.d.bH.From.Mailbox,!1);i.m=[n];this.j.t(this.g,i)}else if(_g.f.h(this.d)){var t=this.s.a(this.d.bH.ItemId);t.c(this.y);t.a(this.x);this.m.a(t)}else{var r=new _xs.f;this.j.t(this.g,r)}},K:function(n){var t=new _xs.f;t.m=this.f;t.n=this.e;t.l=2;t.o=this.d;this.j.t(this.g,t)},L:function(n){var t=n;this.g=_pc.a.c(t.e().GroupPersona,2);this.f=this.r(t.e().RequestedMembers);this.e=this.r(t.e().ApprovedMembers)},O:function(){if(_g.f.f(this.d)){this.o=_d.k.d;this.n=_d.k.e;this.p=_nbs.a.pA}else if(_g.f.h(this.d)){this.o=_d.k.a;this.n=_d.k.b;this.p=_nbs.a.sz}}};_d.J=function(n,t){this.o=Function.createDelegate(this,this.w);this.p=Function.createDelegate(this,this.x);this.r=Function.createDelegate(this,this.y);this.s=Function.createDelegate(this,this.z);this.q=Function.createDelegate(this,this.t);this.n=Function.createDelegate(this,this.v);_d.J.initializeBase(this);this.g=new _d.q(n);this.m=t};_d.J.prototype={f:null,h:null,m:null,g:null,l:null,a:function(){if(!this.f){this.f=new _bc.n;this.f.s(_nbs.a.vt);this.f.t(this);var r=this;this.l=new _j.w(this.n,_a.a.v,this.g,"Persona",function(){return!!r.g.a});var n=new _j.g(this.q,_a.a.v);this.f.B(n);var i=new _ff.d(this.l,_nbs.a.gk,null,!0,!1);var t=new _ff.d(n,_u.R.BG,null,!1,!1);this.f.p.a(i);this.f.p.a(t)}return this.f},b:function(){this.h||(this.h=new _bc.b);return this.h},i:null,d:function(n){this.i=n;return n},j:null,e:function(n){this.j=n;return n},c:function(n){if(n){var t=new _c.G(n);t.c(this.s);t.b(this.r);this.m.a(t)}},eL:function(){this.i=null;this.j=null;var i;_a.h.a(i={val:this.l}),this.l=i.val;var t;_a.h.a(t={val:this.f}),this.f=t.val;var n;_a.h.a(n={val:this.h}),this.h=n.val;_a.gd.prototype.eL.call(this)},v:function(){if(this.g.a){var t=this.g.a.a().c();var i=this.g.a.a().a().EmailAddress;var n=new _c.r(t,i);n.c(this.p);n.b(this.o);this.m.a(n);this.t()}},t:function(){this.a().f(!1);this.g.d()},w:function(n){this.u()},x:function(n){if(this.i){var t=n;this.i(t.e,t.f)}},y:function(n){this.u()},u:function(){this.b().h(0,_u.R.Et,null,!1,null,null,_nbs.a.ix)},z:function(n){if(this.j){var t=n;this.j(t.e)}}};_d.bz=function(n,t,i,r,u,f){_d.bz.initializeBase(this,[n,i,r,u,f,t,!1,!1,null,null,null]);this.i=t};_d.bz.prototype={i:null,bQ:!1,bs:!1,R:!1,V:!1,Q:!1,bP:null,bO:null,bN:null,bY:function(){this.y.g();this.B.g();var f=this.g.a()==="TouchNarrow";var n=new _ph.bc;n.g=_h.a.b("msgfolderroot");for(var r=null,u=new _ph.g(this.g,this.i,null,n,_nbs.a.cc,f,!0,!1,null,!1,null,null),i=null,e=new _ph.g(this.g,this.i,null,n,_nbs.a.GD,!0,!0,!1,null,!1,null,null),o=0;o<this.r.x.length;o++){var t=this.r.x[o];if(t.a===1){r=new _ph.g(this.g,this.i,t,n,null,f,!0,!1,null,!1,null,null);this.y.a(t);continue}if(t.a>=1e3)if(t.a===1e3){i||(i=new _ph.g(this.g,this.i,null,n,_nbs.a.dH,!0,!0,!1,null,!1,null,null));this.cJ()&&i.c.a(new _ph.g(this.g,this.i,t,n,null,!0,!0,!1,null,!1,null,null))}else this.dy(t,n,this.g)&&e.c.a(new _ph.g(this.g,this.i,t,n,null,!0,!0,!1,null,!1,null,null));else if(t.e()){r.c.a(new _ph.g(this.g,this.i,t,n,null,f,!0,!1,null,!1,null,null));this.y.a(t)}else{u.c.a(new _ph.g(this.g,this.i,t,n,null,f,!0,!1,null,!1,null,null));this.B.a(t)}}if(r&&!this.bs){n.j(r);n.d.a(r);r.f(!1);r.d(!0);n.l(u);r.c.a(u);r.c.d(this.bT);u.c.d(this.bV);u.f(!0)}if(i&&!this.bQ){n.d.a(i);if(this.cJ()){i.c.a(e);e.f(!0)}else{this.bP&&i.c.a(this.bP);this.bN&&i.c.a(this.bN);this.bO&&i.c.a(this.bO)}this.dt(i)}this.ce(n);this.dg(!this.B.x.length)},cJ:function(){return!(this.R||this.V||this.Q)},dy:function(n,t,i){if((this.R||this.Q)&&n.b.h===1002){this.bP=new _ph.g(i,this.i,n,t,null,!0,!0,!1,null,!1,null,null);return!1}if(this.R&&!this.Q&&n.b.h===1004){this.bN=new _ph.g(i,this.i,n,t,null,!0,!0,!1,null,!1,null,null);return!1}if((this.V||this.Q)&&n.b.h===1003){this.bO=new _ph.g(i,this.i,n,t,null,!0,!0,!1,null,!1,null,null);return!1}return this.R||this.V||this.Q?!1:!0},dt:function(n){this.bs&&n.m&&this.t(n.c.x[0].b)}};_d.t=function(n){this.i=Function.createDelegate(this,this.m);_d.t.initializeBase(this);this.h=n;this.g=new _j.g(this.i,_d.t.a);this.a=new _j.l};_d.t.prototype={h:null,a:null,g:null,f:null,n:function(n){if(this.f!==n){this.f=n;this.eJ("TotalResultsInRecipientCache")}return n},du:function(){this.a.g();for(var t=_fp.b.c(),n=0;n<t.bx.x.length;n++)this.a.a(this.j(t.bx.x[n]));this.n(String.format(_nbs.a.xL,t.bx.x.length))},dw:function(){},dv:function(){},dx:function(){},j:function(n){var t=this.h.h(n,_pe.c.a,!1,8,0,!0);var i=[1];t.g(1,i,"");return t},m:function(){console.log(this.l("\r\n"))},l:function(n){var t=new Sys.StringBuilder;t.append("Name,Main Email,Secondary Email"+n);for(var i=0;i<this.a.x.length;i++){var r=this.a.x[i];t.append("Name: "+r.d()+",");t.append("Email: "+r.Q());t.append(n)}return t.toString()}};_d.V=function(n,t){if(t==="Mouse"){var i=this;n.c(function(n){n.a(_d.f,"TaskReadingPaneContext")},!1)}};_d.Q=function(n){this.f=Function.createDelegate(this,this.h);_d.Q.initializeBase(this);this.b=n;this.g()};_d.Q.prototype={c:null,a:null,b:null,d:function(n){if(this.b!==n){this.b=n;this.e()}return n},e:function(){var n=new _cc.P;if(this.b&&!1){this.a[0].a=_u.c.Cf;this.a[0].b="TaskFolderCharmPickerTemplates.UseCalendarCharmMenuItemTemplate";this.a[0].d=n.a("None",null)}else{this.a[0].a=_cc.v.b()[0];this.a[0].b="CalendarCharmPickerTemplates.NoneCharmMenuItemTemplate"}this.a[Array.indexOf(_cc.v.a,this.b?this.b.o:"None")].g()},g:function(){this.a=new Array(0);for(var t=new _cc.P,n=0;n<_cc.v.a.length;n++)this.a[n]=new _cc.V(_cc.v.b()[n],t.a(_cc.v.a[n],null),_cc.v.a[n],"CalendarCharmPickerTemplates.CharmMenuItemTemplate");if(this.b&&!1){this.a[0].a=_u.c.Cf;this.a[0].b="TaskFolderCharmPickerTemplates.UseCalendarCharmMenuItemTemplate";this.a[0].d=t.a("None",null)}else{this.a[0].a=_cc.v.b()[0];this.a[0].b="CalendarCharmPickerTemplates.NoneCharmMenuItemTemplate"}this.c=new _cc.cD(this.f,this.a,this.a[Array.indexOf(_cc.v.a,this.b?this.b.o:"None")])},h:function(n){this.b&&this.b.bp(n)}};_d.H=function(n,t,i){this.l=Function.createDelegate(this,this.n);_d.H.initializeBase(this,[n,t,i]);this.e=new _d.bA};_d.H.prototype={e:null,i:null,v:function(n){if(this.i!==n){this.i=n;this.by("FilterByButtonLabel")}return n},s:function(){this.r(new _fm.e(new Array(0)));this.w();this.m();this.c.p.a(new _fm.i);this.u();this.j();this.c.p.a(new _fm.i);this.t();this.by("SortByContextMenu")},m:function(){this.v(this.e.a.b)},w:function(){this.c.p.a(new _fm.n(_u.R.BI));for(var t=0;t<this.e.b.x.length;t++){var n=this.e.b.x[t];var i=new(_a.gl.$$(_d.y))(n,this.l);this.c.p.a(new _fm.g(n.b,null,new _j.g(i.a,_d.F.a),n.c,!1,null,null,"ViewFilter_"+n.a))}},n:function(n,t){if(this.e.a.a===n.a){this.f("ViewFilter_"+n.a,!0);return}this.f("ViewFilter_"+this.e.a.a,!1);this.e.c(n);this.f("ViewFilter_"+n.a,!0);this.h.b(this.x(this.e.a.a));this.m()},x:function(n){switch(n){case"TaskActive":return 1;case"TaskOverdue":return 2;case"TaskCompleted":return 3;default:return 0}}};_d.s=function(){this.s=Function.createDelegate(this,this.u);this.p=Function.createDelegate(this,this.x);this.q=Function.createDelegate(this,this.y);this.r=Function.createDelegate(this,this.z);_d.s.initializeBase(this);this.h=new _bc.b;this.c=new _j.l;this.c.a(new _ff.d(new _j.g(this.r,_d.s.a),_nbs.a.lG,null,!1,!1));this.c.a(new _ff.d(new _j.g(this.q,_d.s.a),_nbs.a.hi,null,!1,!1));this.c.a(new _ff.d(new _j.g(this.p,_d.s.a),_bcs.D.A,null,!0,!1))};_d.s.prototype={j:null,c:null,i:!1,h:null,n:null,e:null,b:null,d:null,a:0,g:null,f:null,o:0,l:function(n){if(this.i!==n){this.i=n;this.eJ("RecurrenceDeletionDialogIsShow")}return n},B:function(n){if(this.j!==n){this.j=n;this.eJ("RecurrenceDialogMessage")}return n},m:function(n,t,i,r){if(!this.a){if(this.A(n)){_a.D.a(_u.R.Qh,1);return}this.e=n;this.n=t;this.g=i;this.f=r;var o=n.x.length;if(o){var u=0;if(n.x.length===1){var e=n.x[0];_pc.a.isInstanceOfType(e)?u=4:_dg.n.isInstanceOfType(e)||(u=2)}else for(var f=0;f<o;f++){var s=n.x[f];_dg.n.isInstanceOfType(s)||(u=8)}if(u&&(u&_g.a.a().a().v())===u){this.C(u);return}this.u(!0,!1)}}},A:function(n){for(var t=0;t<n.x.length;t++){var i=n.x[t];if(_dg.n.isInstanceOfType(i)&&i.v())return!0}return!1},C:function(n){var t="";n===2?t=_nbs.a.oE:n===4?t=_nbs.a.gp:n===8&&(t=_nbs.a.kS);this.o=n;this.h.h(2,t,this.s,!0,_bcs.D.C,_bcs.D.J,_u.n.FR)},u:function(n,t){if(t){var i;(i=_g.a.a().a()).x(i.v()&~this.o);_h.f.a(_g.a.a().a().u,_a.g.a)}if(n){this.b=[];this.d=[];this.a=0;this.w()}},w:function(){while(this.a<this.e.x.length){var n=this.e.x[this.a];if(_dg.n.isInstanceOfType(n)&&n.O()){this.B(String.format(_nbs.a.RX,n.bH.Subject));this.l(!0);return}Array.add(this.b,n);this.a++}this.b.length>0&&this.v(this.b,0,!this.d.length);this.d.length>0&&this.v(this.d,1,!0);this.a=0},z:function(){this.t(this.d)},y:function(){this.t(this.b)},t:function(n){var t=this.e.x[this.a];Array.add(n,t);this.l(!1);this.a++;this.w()},x:function(){this.l(!1)},v:function(n,t,i){var r=_h.N.a(n,"MoveToDeletedItems",0);r.N=t;r.e=this.n;r.t=1;if(i){var u=this;r.a(function(n){u.f&&u.f()})}_a.g.a.a(r);i&&this.g&&this.g()}};_d.R=function(n,t,i,r){this.e=new _fm.f(t,_nbs.a.WS,_d.w.b(),0,null,null,!1,!1,!1,!1,null);this.d=new _fm.f(i,_u.n.Pi,null,0,null,null,!1,!1,!1,!1,null);this.g=new _fm.f(n,_nbs.a.xJ,_d.w.e(),0,null,null,!1,!1,!1,!1,null);this.f=new _fm.f(r,null,_d.w.d(),0,null,null,!0,!1,!1,!1,null)};_d.R.prototype={g:null,e:null,d:null,f:null,b:null,c:null,a:null,h:function(n,t,i){_j.e.a(_d.R.a,"Initializing task edit commanding bar");if(!this.a){this.a=new _fm.k;this.a.ba=!0;this.a.L=!0;this.a.a(this.g);this.a.a(this.e);this.b=n;this.a.a(this.b);this.c=t;this.a.a(this.c);this.a.a(this.d);this.a.a(this.f)}this.c.b(!0);this.b.b(!i);return this.a}};_d.y=function(n,t){_d.y.initializeBase(this);_a.c.a(n,"contextMenuDisplayName");_a.c.a(t,"viewFilter");this.b=n;this.a=t};_d.y.prototype={a:"All",b:null,c:!1,d:function(n){if(this.c!==n){this.c=n;this.eJ("IsSelected")}return n}};_d.bA=function(){_d.bA.initializeBase(this);this.b=new _j.l;this.d();this.c(this.b.x[1])};_d.bA.prototype={b:null,a:null,c:function(n){_a.c.a(n,"filterOption");this.a&&this.a.a!==n.a&&this.a.d(!1);this.a=n;this.a.d(!0)},d:function(){this.b.a(new _d.y(_nbs.a.Vc,"All"));this.b.a(new _d.y(_nbs.a.ir,"TaskActive"));this.b.a(new _d.y(_nbs.a.nC,"TaskOverdue"));this.b.a(new _d.y(_nbs.a.lY,"TaskCompleted"))}};_d.D=function(n,t){this.m=Function.createDelegate(this,this.w);_d.D.initializeBase(this);this.t(this);this.C(!0);this.h=new _d.S(n,t,!1,!0);this.h.f();this.h.apcl("SelectedTreeNode",this.m)};_d.D.prototype={h:null,l:null,i:null,j:null,n:function(){return this.h.c()?this.l?!_g.l.b(this.l,this.h.c().bH.FolderId)&&this.h.c().a()!=="todosearch":!1:!1},I:function(n,t,i,r){var e=this,f=this;var u=new _j.w(function(){n.a();e.f(!1)},_d.D.a,this,"CanExecuteAction",function(){return f.n()});this.v(new _j.l);this.p.a(this.o(u,i));this.p.a(this.u());this.s(t);this.l=r;this.eJ("CanExecuteAction");this.h.f();this.f(!0)},w:function(n,t){this.eJ("CanExecuteAction")},u:function(){this.j||(this.j=new _ff.d(this.q,_u.R.BG,null,!1,!1));return this.j},o:function(n,t){this.i?this.i.b!==n&&this.i.k(n):this.i=new _ff.d(n,t,null,!0,!1);return this.i}};_d.bB=function(n,t){_d.bB.initializeBase(this,[n])};_d.bB.prototype={t:function(){return!0},u:function(){return!1}};_d.z=function(n){_d.z.initializeBase(this);_a.c.a(n,"parentTaskFolderPicker");this.b=new _j.l;this.d=n;this.x=n.h};_d.z.prototype={q:null,m:null,l:null,z:null,s:null,A:0,b:null,o:!1,C:!1,w:!1,y:null,x:null,a:!1,r:null,d:null,v:!1,h:function(n){if(n!==this.w){this.w=n;this.eJ("IsEdit")}return n},T:function(){return this.b.x.length>0},p:function(n){if(this.o!==n){this.o=n;this.eJ("IsSelected")}return n},M:function(n){if(n!==this.C){this.C=n;this.eJ("DisableSelection")}return n},g:function(n){if(n!==this.A){this.A=n;this.eJ("TreeNodeMode")}return n},N:function(n){if(n!==this.y){this.y=n;this.eJ("NewNodeViewModel")}return n},V:function(n){if(n!==this.s){this.s=n;this.eJ("CreateCommand")}return n},Z:function(n){if(n!==this.z){this.z=n;this.eJ("RenameCommand")}return n},W:function(n){if(n!==this.l){this.l=n;this.eJ("DeleteTaskFolderPromptCommand")}return n},X:function(n){if(n!==this.m){this.m=n;this.eJ("InitiateRenameTaskFolderCommand")}return n},U:function(n){if(n!==this.q){this.q=n;this.eJ("CancelRenameCommand")}return n},Y:function(n){if(n!==this.v){this.v=n;this.eJ("IsCollapsed")}return n},D:function(n){this.x.h(0,n,null,!1,null,null,_nbs.a.rt)}};_d.S=function(n,t,i,r){this.m=Function.createDelegate(this,this.o);this.r=_g.b.a.nameToId("tasks");_d.S.initializeBase(this);this.g=r;this.j=i;this.h=new _bc.b;this.d=t;this.b=n;this.b.m(this.m);this.f()};_d.S.prototype={h:null,g:!1,j:!1,d:null,e:null,a:null,i:null,p:null,b:null,q:function(n){if(this.a!==n){this.a=n;this.eJ("SelectedTreeNode")}return n},c:function(){if(!this.a||!this.b.b)return null;var n=this.a;return this.b.j(n.f.bH.TaskFolderId)},s:function(n){if(n!==this.i){this.i=n;this.eJ("RootTreeNode")}return n},f:function(){this.b.b&&this.o(this.b)},o:function(n){for(var i=null,e=null,c=n.c,o=new _d.bB(this,this.d),t,f,r,u,s=0;s<c.x.length;s++){t=c.x[s];if(t){f=new _d.u(t,this,this.d);if(t.a()){for(var h=0;h<t.a().b();h++){u=t.a().a(h);r=new _d.m(u,f,this,this.d);if(u.b()===1){e=r;if(this.j)i=r;else continue}u.bH.TaskFolderId.Id!==this.r.Id||this.j||(i=r);f.b.a(r)}o.b.a(f)}}}if(!o.b.x.length)throw Error.invalidOperation("Unable to get task folders");if(!i&&e){o.b.x[0].b.t(0,e);i=e}if(!i)throw Error.argumentNull("Couldn't get default task folder");this.s(o);this.e=i;this.e.p(!0)}};_d.m=function(n,t,i,r){this.G=Function.createDelegate(this,this.bd);this.E=Function.createDelegate(this,this.bc);this.I=Function.createDelegate(this,this.bi);this.H=Function.createDelegate(this,this.bh);this.O=Function.createDelegate(this,this.ba);this.S=Function.createDelegate(this,this.bg);this.P=Function.createDelegate(this,this.bb);this.Q=Function.createDelegate(this,this.be);this.R=Function.createDelegate(this,this.bf);_d.m.initializeBase(this,[i]);this.f=n;this.e=t;this.c=n.bH.FolderName;this.g(1);this.X(new _j.g(this.R,_d.m.a));this.W(new _j.g(this.Q,_d.m.a));this.K=new _j.g(this.P,_d.m.a);if(n.b()){this.m.c(!1);this.l.c(!1)}this.Z(new _j.g(this.S,_d.m.a));this.U(new _j.g(this.O,_d.m.a));this.d.g||(this.r=new _fm.e([new _fm.c(_u.R.MT,null,this.m),new _fm.c(_u.R.FM,null,this.l)]))};_d.m.prototype={j:null,i:null,K:null,n:0,f:null,c:null,e:null,L:!1,B:function(n){if(n!==this.c){this.c=n;this.eJ("FolderName")}return n},t:function(){return!1},u:function(){return!1},bf:function(){if(!this.a){this.N(this);this.h(!0);this.g(4)}},ba:function(){this.h(!1);this.B(this.f.bH.FolderName);this.g(1)},bg:function(){if(_j.h.b(this.c)){this.B(this.f.bH.FolderName);this.h(!1);return}if(this.c.trim()===this.f.bH.FolderName){this.h(!1);return}if(this.j){this.j.T(this.H);this.j.U(this.I);this.j=null}var n=this.j=new _c.H(this.f,this.c,this.d.b);n.b(this.H);n.c(this.I);this.a=!0;_a.g.a.a(n);this.h(!1)},bi:function(n){this.a=!1},bh:function(n){this.a=!1;this.B(this.f.bH.FolderName);this.D(this.j.G.message)},be:function(){var n=this;this.x.h(1,String.format(_u.R.Dg,this.c),function(t,i){t&&n.K.a()},!1,null,null,_u.R.Fi)},bb:function(){if(!this.a){if(this.i){this.i.T(this.E);this.i.U(this.G);this.i=null}var n=this.i=new _c.t(this.f,this.e.f,this.d.b);n.b(this.E);n.c(this.G);this.a=!0;this.e.a=!0;_a.g.a.a(n);this.L=this.o;this.p(!1);this.n=this.e.b.m(this);this.n>=0&&this.e.b.n(this.n)}},bd:function(n){this.e.a=!1;this.a=!1;this.L&&this.d.e.p(!0)},bc:function(n){this.n>=0&&this.e.b.t(this.n,this);this.e.a=!1;this.a=!1;this.D(this.i.G.message)}};_d.u=function(n,t,i){this.i=Function.createDelegate(this,this.K);this.j=Function.createDelegate(this,this.L);this.G=Function.createDelegate(this,this.O);this.E=Function.createDelegate(this,this.I);_d.u.initializeBase(this,[t]);this.f=n;this.B=n.bH.GroupName;this.n=i;this.V(new _j.g(this.E,_d.u.a));var r=new _j.g(this.G,_d.u.a);this.M(!0);this.g(1);if(!this.d.g){this.H=new _fm.c(null,_d.w.a(),r);this.r=new _fm.e([new _fm.c(_u.R.DS,null,r)])}};_d.u.prototype={f:null,n:null,H:null,e:null,c:null,B:null,t:function(){return!0},u:function(){return!0},O:function(){if(!this.a){if(this.c){this.c.U(this.j);this.c.T(this.i);this.c=null}this.c=new _c.s(this.f,this.d.b);this.c.c(this.j);this.c.b(this.i);var n=new _d.m(this.c.e,this,this.d,this.n);n.h(!0);n.M(!0);this.N(this.e=n);this.g(3)}},I:function(){if(!_j.h.b(this.e.c)){this.e.h(!1);this.e.g(2);this.c.l(this.e.c);this.a=!0;_a.g.a.a(this.c);this.b.a(this.e);_a.b.c(_d.u.a,"Tasks.FolderCreate")}},K:function(n){this.b.p(this.e,!0);this.a=!1;this.D(this.c.j)},L:function(n){this.e.g(1);this.a=!1}};_d.bC=function(){_d.bC.initializeBase(this,[displayName,order])};_d.o=function(n,t,i,r,u,f,e,o,s,h){this.dH=Function.createDelegate(this,this.dK);this.dB=Function.createDelegate(this,this.eG);this.dI=Function.createDelegate(this,this.fw);this.dG=Function.createDelegate(this,this.dJ);_d.o.initializeBase(this,[n,t,i,r,u,null,f,null,e,null,null,null,null,o,null,null,null,null,null,null,h,null,null,null,null,null,!1]);this.ct=new _j.g(this.dG,_d.o.a);this.dC=new _j.g(this.dI,_d.o.a);this.dz=new _d.s;this.cs=new _d.Q(null)};_d.o.prototype={ct:null,dC:null,cu:null,dz:null,cs:null,bv:null,fR:function(){_lv.j.prototype.fR.call(this);if(this.eY&&_dg.n.isInstanceOfType(this.eY)){this.fz&&!this.fz.p.w(this.cs.c)&&this.fz.p.a(this.cs.c);this.fB(new _d.U(this.eY,null,this.fi,!1));this.cs.d(this.bv)}else{this.fz&&this.fz.p.w(this.cs.c)&&this.fz.p.p(this.cs.c,!0);this.cs.d(null)}},fB:function(n){if(this.bv!==n){this.bv&&this.bv.rpcl("Charm",this.dB);this.bv=n;this.bv&&this.bv.apcl("Charm",this.dB)}return n},dN:function(){return!0},gY:function(n,t,i){if((n&1)==1)throw Error.notImplemented();var f=new _c.S(this.j(),this.fN,this.fp);var e=this;var r=_h.c.b(f,_h.h.a(),function(n){return new _c.q(n)});var u=new _h.o(0,this.gv());u.c=1;r.k(u,null,null);this.fA=!1;return r},lF:function(){return!1},gd:function(n){this.bl(!0);var i=new _y.cq;var t=new _y.by;switch(this.fp.a){case"TaskStartDate":var e=this;return new _y.bm(i,function(n){if(_dg.n.isInstanceOfType(n)&&n.m())return n.m();else if(n.bX())return n.bX().c();return null},n,null,!0);case"TaskDueDate":var o=this;return new _y.bm(i,function(n){if(_dg.n.isInstanceOfType(n)&&n.f())return n.f();else if(n.bX())return n.bX().b();return null},n,null,!0);case"ItemClass":var s=this,r=this;return new _y.bu(t,function(n){return n.bH.ItemClass},function(n){return n?n.startsWith("IPM.Note")?_nbs.a.BZ:n.startsWith("IPM.Task")?_nbs.a.Ys:_nbs.a.Rp:""},_u.R.Rw);case"TaskStatus":var u=this,f=this;return new _y.bu(t,function(n){if(_dg.n.isInstanceOfType(n))return n.b();else if(n.bX())return n.bX().e()?"Completed":"NotStarted";return null},function(n){var t=new _d.bu;return t.a(n,!0)},_u.R.Rw);default:return _lv.j.prototype.gd.call(this,n)}},fY:function(n,t){var i=this;this.dz.m(this.fj,this.j(),function(){i.de()},null)},jW:function(n,t){if(this.fh){if(!_g.l.b(this.eH.e(),this.fh)){var i=n;if(i&&i.length>0){var r=new _h.bb(i,this.fh,0);_a.g.a.a(r)}}this.de()}},kz:function(){if(this.eY)if(_dg.n.isInstanceOfType(this.eY)){var n=this.eY;var t=n.b()==="Completed"?"Today":"MarkComplete";this.hN(t,[n])}else _lv.b.prototype.kz.call(this)},hN:function(n,t){if(t){var s=t.length;if(!s)return;for(var e=[],f=[],o=0;o<s;o++){var i=t[o];if(_dg.n.isInstanceOfType(i)){if(i.v()){_a.D.a(_u.R.Qh,1);return}Array.add(e,i)}else Array.add(f,i)}if(e.length>0){var r=new _c.n(n,this.j(),this.fG());r.q(e);this.jJ=r;r.a(this.dH);_a.g.a.a(r);n==="MarkComplete"?_h.g.a(_a.a.cA,"Tasks.MarkComplete",-1,0,null):_h.g.a(_a.a.cA,"Tasks.SetFlag",-1,0,null)}if(f.length){var u=new _h.bt(n,this.j());u.q(f);u.p=this.fG();this.jJ=u;_a.g.a.a(u);n==="MarkComplete"?_h.g.a(_a.a.cA,"Tasks.MessagesMarkComplete",-1,0,null):_h.g.a(_a.a.cA,"Tasks.MessagesSetFlag",-1,0,null);this.ge()}else this.ge()}},gu:function(n){return n.d(this)},me:function(){_lv.b.prototype.me.call(this);var n=this;this.fJ.apcl("IsShown",function(t,i){if(n.fJ.q()&&n.eY){var r=n.fJ.p.x[n.fJ.p.x.length-1];r.a(_dg.n.isInstanceOfType(n.eY))}})},dJ:function(){var n=this.m();n&&this.hN("MarkComplete",n)},fw:function(){var n=this.m();n&&this.hN("Today",n)},dK:function(n){this.cu&&this.cu.d()},eG:function(n,t){if(this.bv.z().a("Charm")){var i=new _c.e(this.bv.z());_a.g.a.a(i)}}};_d.T=function(n,t,i,r,u,f,e,o,s,h){this.i=n;this.j=t;this.a=i;this.e=r;this.h=u;this.g=f;this.b=e;this.d=o;this.c=s;this.f=h};_d.T.prototype={i:null,j:null,a:null,h:null,e:null,g:null,b:null,d:null,f:null,c:null,k:function(){return new _d.o(this.i,this.j,this.a,this.e,this.h,this.g,this.b,this.d,this.c,this.f)}};_d.v=function(n,t,i){_d.v.initializeBase(this);this.f(!1);this.g=t;this.e=i;this.d=_y.bg.b};_d.v.prototype={e:null,c:0,b:!1,h:null,a:null,g:null,d:!1,f:function(n){if(this.b!==n){this.b=n;this.eJ("IsExpanded")}this.j(this.b?_d.v.b:_d.v.a);return n},j:function(n){if(this.c!==n){this.c=n;this.eJ("Width")}return n},i:function(){this.a=new _d.S(this.g,this.e,!0,!1);this.a.f()}};_d.bD=function(){_d.bD.initializeBase(this,[2])};_d.bD.prototype={j:function(n){var t=this.d.n;return new _h.q(t,this.f)},s:function(){this.e.a(new _d.p(_nbs.a.eV,_nbs.a.VA,_u.R.Qr,_u.R.Lq,"Ascending",11,"TaskDueDate",!0));this.e.a(new _d.p(_nbs.a.oH,_nbs.a.Vt,_u.R.Qr,_u.R.Lq,"Ascending",10,"TaskStartDate",!0));this.e.a(new _d.p(_nbs.a.BC,_nbs.a.vf,_nbs.a.eq,_nbs.a.tY,"Ascending",12,"TaskStatus",!0));this.e.a(new _d.p(_u.R.Tw,_u.R.Mt,_u.R.PW,_u.R.LL,"Ascending",8,"Subject",!0));this.e.a(new _d.p(_u.R.Km,_u.R.o,_u.R.LJ,_u.R.Ug,"Descending",4,"HasAttachments",!0));this.e.a(new _d.p(_u.n.EI,_u.n.Ir,_u.R.E,_u.R.HD,"Descending",5,"Importance",!0));this.e.a(new _d.p(_u.R.Sx,_u.R.z,_u.R.Iu,_u.R.QM,"Ascending",6,"ItemClass",!0))}};_d.F=function(n,t,i){this.o=Function.createDelegate(this,this.z);this.p=Function.createDelegate(this,this.A);_d.F.initializeBase(this);this.q=n;this.h=t;this.g=i};_d.F.prototype={q:null,k:null,c:null,d:null,h:null,g:null,a:function(){return this.c},r:function(n){if(this.c!==n){this.c=n;this.by("SortByContextMenu")}return n},y:function(n){if(this.k!==n){this.k=n;this.by("SortByButtonLabel")}return n},b:function(n){this.d=new _d.bD;this.d.i=n.c;this.d.q(n.f);this.d.r(n.g);this.s();this.g.ex(this.d.j(!1))},s:function(){this.r(new _fm.e(new Array(0)));this.u();this.c.p.a(new _fm.i);this.t();this.j();this.by("SortByContextMenu")},j:function(){this.y(String.format(_u.R.IL,_u.R.Ce,this.d.d.h()))},A:function(n){if(this.d.d.a()===n.i){this.f("ColumnId_"+n.i,!0);return}this.f("ColumnId_"+this.d.d.a(),!1);this.d.p(n);this.f("ColumnId_"+n.i,!0);this.B();this.g.ex(this.d.j(!1));this.g.Y(4,null);this.h.a(this.d);this.j()},f:function(n,t){for(var i=0;i<this.c.p.x.length;i++)if(_fm.g.isInstanceOfType(this.c.p.x[i])&&this.c.p.x[i].m===n){this.c.p.x[i].d(t);this.c.p.x[i].i(t);break}},u:function(){this.c.p.a(new _fm.n(_u.R.Rv));for(var t=0;t<this.d.e.x.length;t++){var n=this.d.e.x[t];if(n.m){var i=new(_a.gl.$$(_d.p))(n,this.p);this.c.p.a(new _fm.g(n.l,null,new _j.g(i.a,_d.F.a),n.j,!1,null,null,"ColumnId_"+n.i))}}},t:function(){this.c.p.a(new _fm.n(_u.R.Ln));for(var t=0;t<this.d.g.x.length;t++){var n=this.d.g.x[t];var i=new(_a.gl.$$(_d.bC))(n,this.o);this.c.p.a(new _fm.g(n.b,null,new _j.g(i.a,_d.F.a),n.a===this.d.f,!1,null,null,"Order_"+n.a))}},B:function(){for(var n=0;n<this.c.p.x.length;n++)if(_fm.n.isInstanceOfType(this.c.p.x[n])&&this.c.p.x[n].i===_u.R.Ln){this.c.p.x[n+1].Q("Order_"+this.d.g.x[0].a);this.c.p.x[n+1].n(this.d.g.x[0].b);this.c.p.x[n+1].i(!0);this.c.p.x[n+1].d(!0);this.c.p.x[n+2].Q("Order_"+this.d.g.x[1].a);this.c.p.x[n+2].n(this.d.g.x[1].b);this.c.p.x[n+2].i(!1);this.c.p.x[n+2].d(!1);break}},z:function(n){if(n.a===this.d.f){this.f("Order_"+n.a,!0);return}this.f("Order_"+this.d.f,!1);this.f("Order_"+n.a,!0);this.d.l(n.a);this.g.ex(this.d.j(!1));this.h.a(this.d);this.g.Y(4,null)}};_d.bE=function(n,t){this.b=n};_d.bE.prototype={b:null,a:function(n,t){return new _d.H(this.b,n,t)}};_d.p=function(n,t,i,r,u,f,e,o){_d.p.initializeBase(this,[n,t,i,r,u,f,e,e,o]);this.n=e};_d.p.prototype={n:"FolderId"};_d.f=function(){_d.f.resolveInheritance();this.eF=this.fa;this.eE=this.fo;_d.f.initializeBase(this)};_d.f.prototype={b:function(){return this.eM(_d.f.c)},j:function(n){this.eK(_d.f.c,n);return n},c:function(){return this.eM(_d.f.d)},e:function(n){this.eK(_d.f.d,n);return n},g:function(){return this.eM(_d.f.a)},h:function(n){this.eK(_d.f.a,n);return n},d:function(){return this.eM(_d.f.f)},f:function(n){this.eK(_d.f.f,n);return n},a:function(){return this.eM(_d.f.b)},i:function(n){this.eK(_d.f.b,n);return n},be:function(){return this.c()?null:[this.d()]},ch:function(){return null},bD:function(){return null},cS:function(){return this.eM(_d.f.e)},bE:function(n){this.eK(_d.f.e,n);return n}};_d.c=function(n,t,i,r,u,f){this.bX=Function.createDelegate(this,this.cM);this.bq=Function.createDelegate(this,this.cL);this.bu=Function.createDelegate(this,this.cN);this.bL=Function.createDelegate(this,this.cb);this.Y=Function.createDelegate(this,this.cI);this.bp=Function.createDelegate(this,this.cH);this.bV=Function.createDelegate(this,this.cJ);this.bW=Function.createDelegate(this,this.cK);this.bs=Function.createDelegate(this,this.cj);this.bo=Function.createDelegate(this,this.cG);this.bZ=Function.createDelegate(this,this.bk);this.bO=Function.createDelegate(this,this.cp);this.bS=Function.createDelegate(this,this.cz);this.bM=Function.createDelegate(this,this.cn);this.bP=Function.createDelegate(this,this.cs);this.bT=Function.createDelegate(this,this.cF);this.bK=Function.createDelegate(this,this.cm);this.bY=Function.createDelegate(this,this.cO);this.bN=Function.createDelegate(this,this.co);this.ca=Function.createDelegate(this,this.bG);this.bQ=Function.createDelegate(this,this.ct);this.h=this.c;_d.c.initializeBase(this);this.A=n;this.K=t;this.bc=i||null;this.bv=r;this.bf=u;this.bd=f;this.bA=new _j.g(this.bQ,_d.c.a);this.W=new _j.g(this.ca,_d.c.a);this.O=new _j.g(this.bN,_d.c.a);this.V=new _j.g(this.bY,_d.c.a);this.Z=new _j.g(this.bK,_d.c.a);this.bE=new _j.g(this.bT,_d.c.a);this.bb=new _j.g(this.bP,_d.c.a);this.bw=new _j.g(this.bM,_d.c.a);this.D=new _j.g(this.bS,_d.c.a);this.by=new _d.R(this.W,this.Z,this.O,this.V);this.G=new _bc.b;this.X=new _d.s;this.w()&&this.cg();this.A.m(this.bO);this.A.h(this.bZ)};_d.c.prototype={bc:null,bf:null,bd:null,A:null,K:null,v:null,t:!1,bi:!1,q:null,r:null,U:!1,bh:!0,s:!1,bn:!1,T:!1,bA:null,W:null,O:null,V:null,Z:null,bE:null,bb:null,bw:null,bD:null,B:null,H:null,C:null,G:null,D:null,bg:null,L:null,Q:null,z:null,X:null,bJ:null,bF:null,R:!1,bj:!1,S:!1,N:null,E:null,bv:null,be:null,bB:null,by:null,i:function(n){this.eO("NewTaskClosed",n)},cl:function(n){this.eO("TaskDelete",n)},j:function(n){this.eO("TaskEditing",n)},cf:function(){return this.K.h()},cd:function(){return this.q?this.q.c:null},bl:function(n){if(this.S!==n){this.S=n;this.eJ("IsSaving")}return n},M:function(n){if(this.U!==n){this.U=n;this.eN("Loading","HideTaskForm")}return n},ck:function(n){if(this.bh!==n){this.bh=n;this.eJ("HideTaskForm")}return n},cv:function(){return this.U||!this.bh},b:function(){return this.s},I:function(n){if(this.s!==n){this.s=n;this.eJ("IsEditMode");this.eW("TaskEditing",this,n);if(this.s){this.bi&&this.bk();this.q&&(this.bJ=new _a.dR(this.q))}}return n},f:function(n){if(this.t!==n){this.t=n;this.eJ("IsNewTask");if(this.t){this.r=null;this.ci();this.I(!0)}}return n},bI:function(n){if(this.T!==n){this.T=n;this.eJ("IsShowDetails");this.bk()}return n},a:function(n){if(this.r!==n){_a.p.b(_d.c.a,"TasksOpen.ItemOpen");this.r&&this.r.remove_onCacheOperation(this.bo);this.r=n;this.eJ("CurrentTask");this.r&&this.r.add_onCacheOperation(this.bo);this.f(!1);this.ci()}return n},bm:function(n){if(this.q!==n){this.q&&this.q.a.rpcl("Charm",this.bs);this.q=n;if(this.q){this.q.a.apcl("Charm",this.bs);this.cj(this.q.a,"Charm")}this.E&&this.E.d(this.q);this.eN("TaskViewModel","IsReadOnly")}return n},bH:function(n){this.bB=n;this.eJ("EditorCallContext");return n},cc:function(){if(!this.bg){var n=this;this.bg=new _j.g(function(){n.bH(new _cmc.P)},_d.c.a)}return this.bg},cy:function(){if(!this.B){this.B=new _j.l;this.B.a("NotStarted");this.B.a("InProgress");this.B.a("Completed");this.B.a("WaitingOnOthers");this.B.a("Deferred")}return this.B},cx:function(){if(!this.H){this.H=new _j.l;this.H.a("High");this.H.a("Normal");this.H.a("Low")}return this.H},cu:function(){if(!this.C){this.C=new _j.l;this.C.a(0);this.C.a(1);this.C.a(2);this.C.a(3)}return this.C},w:function(){return!this.A.b()},d:function(n){if(this.R!==n){this.R=n;this.eJ("IsDiscoveryMode");this.eJ("IsReadOnly")}return n},e:function(n){if(this.bj!==n){this.bj=n;this.eJ("IsItemAttachment");this.eJ("IsReadOnly")}return n},bC:function(){var n=!1;this.q&&this.q.a&&this.q.a.v()&&(n=!0);return this.R||n||this.bj},cw:function(){return!this.w()},y:function(){return this.v},o:function(n){this.v=n;return n},bz:function(){return!1},cP:function(n){if(this.z!==n){this.z=n;this.eJ("ComposeRecurrenceViewModel")}return n},bx:function(){return 1},x:function(){return null},ce:function(){if(this.s){this.D&&this.D.a();return this.bJ.c.length>0||this.q.i.b()!==this.q.a.t()||this.q.j.b()!==this.q.a.y()||!_g.K.a(this.q.r.b(),this.q.a.H())||this.q.d.bS()||this.q.m}else return!1},g:function(n){this.bF=n;return n},c:function(n){if(!this.G.r)if(this.ce()){var t=this;this.G.h(2,_nbs.a.Qo,function(i,r){if(i){t.w()&&(t.bn=!0);t.P()}n&&n(i)},!1,_u.n.Pi,_nbs.a.ub,_nbs.a.FO)}else if(n){this.s&&this.P();n(!0)}},p:function(n){this.bD=n;this.cg()},m:function(){var n=new _c.c(500,[this.r.bH.ItemId],0,this.R);n.c(this.bW);n.b(this.bV);this.M(!0);_a.g.a.a(n)},du:function(){_y.lJ.prototype.du.call(this);this.bi=!0;this.t&&this.bk()},dv:function(){_y.lJ.prototype.dv.call(this);this.bi=!1},cB:function(n,t){return this.by.h(n,t,this.t)},cA:function(){var n={};if(this.r.a()&&this.r.a().b()>0){var t=this.r.a().e();n["Tasks reading pane item categories"]=t}return n},ci:function(){this.M(!1);this.I(!1);this.t?this.ba():this.r?!this.r.x()&&this.r.ck()&&this.r.ck().bH.Value?this.ba():this.m():this.bm(null)},cG:function(n,t){var i=t;i.a!=="NeedsUpdate"||this.s||this.m()},cJ:function(n){this.M(!1);this.ck(!1);var t=[_nbs.a.uO,n.G.message];_a.D.b(t,0,this.v)},cK:function(n){var t=n;if(this.r&&t.k.length===1&&t.k[0].Id===this.r.bH.ItemId.Id){var i=_h.d.a().a(this.r.bH.ItemId.Id);this.r=i;this.r.q(!1);this.ba();this.M(!1);this.ck(!0)}},ba:function(){this.bm(new _d.U(this.r,this.bv,this.A,!1));this.bI(this.q.V());this.q.apcl("DueDate",this.bp);this.q.apcl("Status",this.bp);this.q.apcl("ReminderIsSet",this.Y);this.q.apcl("ReminderDueBy",this.Y);this.q.apcl("IsPrivate",this.Y);this.cD();this.t?_a.p.a("TasksCompose.New"):_a.p.a("TasksOpen.ItemOpen")},cI:function(n,t){this.bC()||this.s||this.bG()},cH:function(n,t){this.q.ba()},cC:function(){this.N=new _y.da(this.cf(),this.bL,this.bw,this.bD)},cn:function(){this.cb(null,null,!0,null)},cz:function(){this.bH(new _cmc.k(!1))},cb:function(n,t,i,r){var f=_g.bc.a(this.r.a(),i,t?t.bH.Name:null,n?n.bH.Name:null);if(f){var u=new _db.bF([f],null,null,null);u.q([this.r]);_a.g.a.a(u);_h.g.a(_d.c.a,"Tasks.Categorize",-1,0,null)}},ct:function(){this.I(!0)},bG:function(){if(this.q.be())if(this.S){_j.e.a(_d.c.a,"TaskReadingPaneViewModel.SaveTask has been called while a save operation is in progress. Ignoring...");return}else this.bl(!0);else{this.G.h(0,this.q.l,null);return}this.D&&this.D.a();this.t&&!this.q.m?this.cq():this.cR(this.q.m)},cq:function(){var i=this.q.z();var t=new _c.i(i,this.bF);this.ch(i,!0);var n=this;t.c(function(i){n.bm(null);n.I(!1);n.f(!1);n.bl(!1);n.M(!0);n.w()?n.v&&n.v():n.eW("NewTaskClosed",n,t.f)});t.b(this.bu);_a.g.a.a(t)},cR:function(n){var r=this.q.z();var i=new _c.e(r);this.ch(r,n);var t=this;i.c(function(i){t.I(!1);t.bl(!1);t.M(!0);if(t.w()){t.r&&_h.c.a(t.r,"NeedsUpdate",t.r.x(),!0,function(n,t){n.q(t)});t.v&&t.v()}else if(n){var r=t.q?t.q.a.bH.ItemId:null;t.eW("NewTaskClosed",t,r)}else t.m()});i.b(this.bu);_a.g.a.a(i)},cN:function(n){var t=n;if(t&&t.G){this.cd().f(this.q.W());var i=_db.j.c(t.G,41,51,63,700,88,89,42,41);this.cd().a(i);this.bl(!1)}},co:function(){var n=this;this.c(function(t){t&&n.P()})},P:function(n){this.I(!1);if(this.q&&this.q.m&&!n){var t=new _j.l;t.a(this.q.a);this.X.m(t,null,null,null)}if(this.t){this.bm(null);this.eW("NewTaskClosed",this,null)}else this.ba();this.f(!1);this.w()&&this.v&&this.v()},cO:function(){if(this.q.d.l()){this.G.h(0,_nbs.a.Kk,null);return}_h.g.a(_d.c.a,"Tasks.PopOut",-1,0,null);var t={};this.t||(t.ItemID=this.r.bH.ItemId);var n=new _d.f;n.f(this.r);n.j(this.s);n.e(this.t);if(this.s){this.D&&this.D.a();n.h(this.q.bn());n.i(this.q.m);if(n.a()){n.e(!1);n.f(this.q.a)}}this.A.g(_y.fp,null,t,_bc.d.a(),n,!1);this.P(!0)},cm:function(){if(this.bf&&this.bf.a().be().Enabled&&this.K&&this.K.f()&&this.K.f().AttachmentDataProviderAvailable){var n=_a.b.b(_a.a.c,"AttachmentsFilePickerPanelOpen",!1,null);_j.e.a(_a.a.n,"Opening OWA's file picker from calendar compose");this.cQ(n)}else{_j.e.a(_a.a.a,"Opening OS's file picker");this.q.d.g(!1,null,null,null)}_h.g.a(_d.c.a,"Tasks.AddAttachment",-1,0,null)},cQ:function(n){if(this.bd){var t=this;this.bd.a(function(i){t.be=i;if(t.be){var r=t.A;t.be.a(t.q.d,n,!0,r.v||(r.v=Function.createDelegate(r,r.d)),null,!1,!1,0)}})}},cF:function(){_h.g.a(_d.c.a,"Tasks.MarkComplete",-1,0,null);this.q.D(_a.d.a().d());this.bG()},cg:function(){this.cC();this.E=new _d.Q(this.q);this.L=new _fm.e([new _fm.c(_u.R.FM,null,this.bb),this.N.c(),this.E.c]);this.w()||this.L.p.a(new _fm.c(_u.n.Ly,null,this.V));this.Q=new _fm.e([new _fm.c(_u.R.FM,null,this.bb),this.N.c(),new _fm.c(_nbs.a.ax,null,this.bE)]);this.L.apcl("IsShown",this.bq);this.Q.apcl("IsShown",this.bq)},cL:function(n,t){(this.L.q()||this.Q.q())&&this.N.a(this.cA(),1)},cs:function(){if(!this.bC())if(this.w()){var n=new _j.l;n.a(this.r);this.X.m(n,this.r.e(),null,this.v)}else this.eW("TaskDelete",this,this.r)},cD:function(){this.cP(new _cm.j(this.q.r,this.K.a().w().bH.WorkDays,new _bc.b,this.A));this.z.apcl("RecurrenceSelected",this.bX);this.z.f(!1)},cM:function(n,t){this.z.j&&!_cc.w.isInstanceOfType(this.z.j)&&this.z.f(!0)},cp:function(n){if(!this.bn&&this.ce()){n.a(_nbs.a.Qo);!this.w()&&this.bc&&this.bc.a(_y.p,new _y.p(3,null))}else this.bn=!1},bk:function(){this.cc()&&this.cc().a()},cj:function(n,t){this.E&&this.E.e()},ch:function(n,t){if(this.cE(n,t)){_h.g.a(_d.c.a,"Tasks.MarkComplete",-1,0,null);return}var i=new _a.l;var o=n.e();var u=n.d;i.c("edt",!t);for(var f=o,s=f.length,r=0;r<s;++r){var e=f[r];switch(e){case"Importance":u.bg()!=="Normal"&&i.c("imp",!0);break;case"ReminderDueBy":i.c("rem",!0);break;case"DueDate":i.c("due",!0);break;case"Recurrence":i.c("rec",!0);break;case"StartDate":i.c("std",!0);break;case"Sensitivity":i.c("sen",!0);break;case"CompleteDate":i.c("cmd",!0);break;case"TotalWork":i.c("twk",!0);break;case"ActualWork":i.c("awk",!0);break;case"PercentComplete":u.bH.PercentComplete!=="0"&&i.c("pct",!0);break;case"Mileage":i.c("mil",!0);break;case"BillingInformation":i.c("bil",!0);break;case"Companies":i.c("cmp",!0);break;case"Charm":u.n()!=="None"&&i.c("chm",!0);break}}_a.b.c(_d.c.a,"Tasks.Save",i.toString(),0)},cE:function(n,t){if(t)return!1;var i=n.e();return i.length!==2?!1:i[0]==="CompleteDate"&&i[1]==="Body"||i[0]==="Body"&&i[1]==="CompleteDate"?!0:!1}};_d.bm=function(n,t,i,r,u,f){this.f=n;this.g=t;this.c=i;this.b=r;this.e=u;this.d=f};_d.bm.prototype={f:null,g:null,c:null,b:null,e:null,d:null,a:function(){return new _d.c(this.f,this.g,this.c,this.b,this.e,this.d)}};_d.E=function(n,t,i,r,u,f){this.g=n;this.h=t;this.d=i;this.c=r;this.f=u;this.e=f};_d.E.prototype={g:null,h:null,d:null,c:null,f:null,e:null,b:function(n,t,i){var e=n.ItemID;var r=new _d.c(this.g,this.h,this.d,this.c,this.f,this.e);if(e){var l=new _g.e(e);var u=new _dg.n;u.cc(l);_h.d.a().b(e,u);r.a(u)}else r.f(!0);var c=n.DiscoveryMode;c&&Boolean.parse(c)&&r.d(!0);var s=n.Source;if(!_j.h.b(s)){var o=_a.b.b(_d.E.a,"TasksOpen.ItemOpenFromSource",!1,null);var f=new _a.l;f.a("SR",s);var h=n.Reason;_j.h.b(h)||f.a("RS",h);o.m=f.toString();_a.b.a(o)}return r},a:function(n,t,i){var u=n;var r=new _d.c(this.g,this.h,this.d,this.c,this.f,this.e);var f=this;r.apcl("TaskViewModel",function(n,t){if(u.b()&&r.q){r.I(u.b());r.q.bm(u.g());r.q.m=u.a();r.bI(r.q.V())}});r.a(u.d());r.f(u.c());return r}};_d.U=function(n,t,i,r){this.Q=Function.createDelegate(this,this.bj);this.O=Function.createDelegate(this,this.bh);this.R=Function.createDelegate(this,this.bk);this.N=Function.createDelegate(this,this.bg);this.P=Function.createDelegate(this,this.bi);this.S=Function.createDelegate(this,this.bl);this.M=Function.createDelegate(this,this.bf);_d.U.initializeBase(this);this.I=i;this.B=r;this.a=n?n:_d.U.a();this.bb(this.a);this.bs(new _db.j);this.ba();this.x=new _a.dR(this.a);if(t){var u=this;t.a(function(n){if(r)u.K(n.a(u.a.bH.ItemId,u.a.bi()?u.a.bi().f:new _j.l,!1,!0,null,!0,u.c,null,!1));else{u.H=n.a(u.a.bH.ItemId,u.a.bi()?u.a.bi().f:new _j.l,!0,!0,null,!0,null,null,!1);u.K(n.c(u.a.bH.ItemId,u.a.bi()?u.a.bi().f:new _j.l,!1,3,!0,null,!0,new _db.j,null,null,!1))}u.d.v(u.M)})}this.apcl("Status",this.S);this.apcl("PercentComplete",this.P);this.apcl("CompleteDate",this.N);this.apcl("StartDate",this.R);this.apcl("DueDate",this.O);this.apcl("ReminderIsSet",this.Q)};_d.U.a=function(){var n=new _dg.n;n.em("Normal");n.da(new _g.y(new _g.t("Text","")));return n};_d.U.prototype={I:null,B:!1,m:!1,u:null,p:null,t:null,w:null,n:null,s:!1,v:!1,e:null,g:null,q:"Low",h:"NotStarted",f:null,T:null,b:null,a:null,j:null,i:null,y:null,G:null,c:null,H:null,d:null,r:null,l:null,U:null,o:"None",C:null,x:null,bx:function(n){if(this.y!==n){this.y=n;this.eJ("Subject")}return n},bs:function(n){if(this.c!==n){this.c=n;this.eJ("InfoBarViewModel")}return n},bp:function(n){if(this.o!==n){this.o=n;this.eJ("Charm")}return n},Y:function(n){if(!_a.d.c(this.b,n)){this.b=n;this.eJ("DueDate")}return n},Z:function(n){if(!_a.d.c(this.f,n)){this.f=n;this.eJ("StartDate")}return n},A:function(n){if(this.h!==n){this.h=n;this.eJ("Status")}return n},br:function(n){if(this.q!==n){this.q=n;this.eJ("Importance")}return n},D:function(n){if(!_a.d.c(this.g,n)){this.g=n;this.eJ("CompleteDate")}return n},L:function(n){if(this.e!==n){this.e=n;this.eJ("PercentComplete")}return n},bt:function(n){if(this.v!==n){this.v=n;this.eJ("IsPrivate")}return n},bw:function(n){if(this.s!==n){this.s=n;this.eJ("ReminderIsSet")}return n},E:function(n){if(!_a.d.c(this.n,n)){this.n=n;this.eJ("ReminderDueBy")}return n},bu:function(n){if(this.w!==n){this.w=n;this.eJ("Mileage")}return n},bo:function(n){if(this.t!==n){this.t=n;this.eJ("BillingInformation")}return n},bq:function(n){if(this.p!==n){this.p=n;this.eJ("Companies")}return n},X:function(n){if(this.u!==n){this.u=n;this.eJ("Body")}return n},bv:function(n){this.C!==n&&(this.C=n);return n},V:function(){return!!this.f||this.h!=="NotStarted"||this.q!=="Normal"||!!this.g||_a.bI.a(this.e)>0||this.v||this.s||!!this.n||this.j.b()>0||this.i.b()>0||!_j.h.a(this.w)||!_j.h.a(this.t)||!_j.h.a(this.p)||!!this.r.b()},be:function(){var t=!0;if(this.d.l()){this.l=_nbs.a.Kk;return!1}if(_j.h.b(this.y)){this.l=_nbs.a.Yj;return!1}if(this.b&&this.f&&this.f.a(this.b)>0){this.l=_nbs.a.VB;return!1}var n=_a.bI.a(this.e);if(isNaN(n)||n<0||n>100){this.l=_nbs.a.SU;return!1}if(isNaN(_a.bI.a(this.j.a))||_a.bI.a(this.j.a)<0){this.l=_nbs.a.fS;return!1}if(isNaN(_a.bI.a(this.i.a))||_a.bI.a(this.i.a)<0){this.l=_nbs.a.Kz;return!1}if(this.j.b()>1525252319){this.l=_nbs.a.JA;return!1}if(this.i.b()>1525252319){this.l=_nbs.a.oa;return!1}return t},z:function(){this.bc(this.a);return this.x},K:function(n){if(this.d!==n){this.d=n;this.eJ("EditAttachmentWellViewModel")}return n},bn:function(){var n=this.a.K();this.bc(n);return n},bm:function(n){this.bb(n)},W:function(){this.G||(this.G=[41,42,51,63,700,88,89,10020,10030,10040,10050,10060,10070,10080,10010]);return this.G},ba:function(){this.c.f(this.W());if(!this.B){this.a.v()&&this.c.a(10010);if(this.h==="Completed")this.c.a(10080,this.g.b(1));else if(this.b){var t=_a.bV.a(_a.d.a().d(),this.b.d()).a/864e5;var n=Math.floor(t);n?n===1?this.c.a(10040):n>1&&n<15?this.c.a(10050,n.toString()):n===-1?this.c.a(10030):n<-1&&n>-15?this.c.a(10070,Math.abs(n).toString()):n<-14&&this.c.a(10060):this.c.a(10020)}}},bb:function(n){this.y=n.bH.Subject;this.T=n.L()?n.L().u():null;this.b=n.f()?n.f().u():null;this.f=n.m()?n.m().u():null;this.h=n.b();this.q=n.bg();this.g=n.h()?n.h().u():null;this.e=n.bH.PercentComplete?n.bH.PercentComplete:"0";isNaN(_a.bI.a(this.e))&&(this.e="0");this.v=n.cp()==="Private";this.s=n.bH.ReminderIsSet;this.n=n.fw()?n.fw().u():null;this.w=n.bH.Mileage;this.t=n.bH.BillingInformation;this.bv(n.A());var t="";if(n.X()){t=n.X().bH.Value;_j.h.a(t)||n.X().a()!=="Text"||(t=_a.B.b(t))}_j.h.a(t)&&!this.B&&(t="<html><head></head></html>");if(this.B){var u;var f,e;e=_a.B.h(t,f={val:u}),u=f.val,e;t=u.trim()}this.X(t);var r=new Sys.StringBuilder;if(n.g())for(var i=0;i<n.g().b();i++){r.append(n.g().a(i));i!==n.g().b()-1&&r.append(" ")}this.p=r.toString();this.j=new _d.G(n.y());this.i=new _d.G(n.t());this.r=new _cc.dn(n.K(),new _gg.EE,_a.d.a(),null);this.o=n.n()},bc:function(n){n.cW(this.y);_a.d.c(n.f(),this.b)||n.P(this.b);_a.d.c(n.m(),this.f)||n.T(this.f);n.b()!==this.h&&n.z(this.h);n.bg()!==this.q&&n.em(this.q);_a.d.c(n.h(),this.g)||n.I(this.g);n.bH.PercentComplete!==this.e&&n.R(this.e);var r=this.v?"Private":"Normal";n.cp()!==r&&n.dY(r);n.dX(this.s);_a.d.c(n.fw(),this.n)||n.jw(this.n);n.bm(this.w);n.bb(this.t);n.bn(this.C);if(n.X()&&n.X().bH.Value!==this.u){var i;i=this.I.a()!=="Mouse"?new _g.t("Text",this.u):new _g.t("HTML",this.u);var u=new _g.y(i);n.da(u)}var t=new _a.j;_j.h.a(this.p)||t.c(this.p);this.bd(n.g(),t)||n.bj(t);n.y()!==this.j.b()&&n.bq(this.j.b());n.t()!==this.i.b()&&n.ba(this.i.b());n.b()!=="Completed"&&this.x.b("CompleteDate");if(this.x.a("CompleteDate")){this.x.b("Status");this.x.b("PercentComplete")}_g.K.a(n.H(),this.r.b())||n.bG(this.r.b());n.bc(this.o)},bd:function(n,t){if(n)if(t){if(n.b()!==t.b())return!1}else return!n.b();else return!t||!t.b();for(var i=0;i<n.b();i++)if(n.a(i)!==t.a(i))return!1;return!0},bl:function(n,t){if(this.h==="Completed"){this.g||this.D(_a.d.a().d());this.L("100")}else{this.D(null);(this.h==="NotStarted"||_a.bI.a(this.e)===100)&&this.L("0")}},bi:function(n,t){var i=_a.bI.a(this.e);i?i>0&&i<100?this.A("InProgress"):i===100&&this.A("Completed"):this.A("NotStarted")},bg:function(n,t){this.g?this.A("Completed"):this.A("NotStarted")},bk:function(n,t){this.f&&(!this.b||this.b.a(this.f)<0)&&this.Y(this.f)},bh:function(n,t){this.b||this.Z(null)},bj:function(n,t){if(this.s&&!this.n){var i=_a.d.a();this.b?this.b.k(i)<=0?this.E(new _a.d(i.g(),i.f(),i.j(),8,0,0)):this.E(new _a.d(this.b.g(),this.b.f(),this.b.j(),8,0,0)):this.E(new _a.d(i.g(),i.f(),i.j(),8,0,0).c(1))}},bf:function(){if(this.a.bH.ItemId)this.m&&this.d&&this.d.h(this.a.bH.ItemId,this.a.bi().f,null);else{var i=new _a.dR(this.a);var t=new _c.i(i,this.U);var n=this;t.a(function(i){n.a.cc(t.f);n.m=!0;n.d&&n.d.h(n.a.bH.ItemId,n.a.bi()?n.a.bi().f:new _j.l,null)});_a.g.a.a(t)}}};_d.G=function(n){_d.G.initializeBase(this);this.d(n)};_d.G.prototype={c:0,a:null,e:function(n){if(this.a!==n){this.a=n;this.by("WorkAmount")}return n},f:function(n){if(this.c!==n){this.c=n;this.by("WorkUnit")}return n},b:function(){var n=_a.bI.a(this.a);switch(this.c){case 1:n*=60;break;case 2:n*=480;break;case 3:n*=2400;break}return Math.floor(n)},toLocaleString:function(){var n=new _d.Y;var t=_a.bI.a(this.a)===1?n.a(this.c,1):n.a(this.c,2);return String.format(_nbs.a.SH,this.a,t)},C:function(n){if(!n||!_d.G.isInstanceOfType(n))return!1;var t=n;return this.b()===t.b()},d:function(n){this.a=n.toString();this.c=0;if(n){if(n>0){for(var r=[1,60,480,2400],f=[10,4],t=0;t<r.length-1&&n>=r[t+1];)t++;while(t>0){for(var i=0;i<f.length;i++)for(var u=1;u<=f[i];u++)if(!(n%(r[t]*u/f[i]))){this.a=(n/r[t]).toString();this.c=t;return}t--}}}else this.c=1}};_d.b=function(n){this.i=Function.createDelegate(this,this.u);this.j=Function.createDelegate(this,this.v);this.h=Function.createDelegate(this,this.s);this.o=Function.createDelegate(this,this.H);this.l=Function.createDelegate(this,this.E);this.n=Function.createDelegate(this,this.q);this.m=Function.createDelegate(this,this.G);_d.b.initializeBase(this);this.e=n;this.L(new _j.g(this.m,_d.b.a));this.M(new _j.g(this.n,_d.b.a));this.K(new _j.g(this.l,_d.b.a));this.c=new _bc.b;this.r(_g.a.a().c().bH.PlayOnPhoneDialString);this.f()};_d.b.prototype={a:null,e:null,c:null,B:function(){return this.eM(_d.b.h)},L:function(n){this.eK(_d.b.h,n);return n},C:function(){return this.eM(_d.b.i)},M:function(n){this.eK(_d.b.i,n);return n},A:function(){return this.eM(_d.b.f)},K:function(n){this.eK(_d.b.f,n);return n},w:function(){return this.eM(_d.b.b)},g:function(n){this.eK(_d.b.b,n);return n},x:function(){return this.eM(_d.b.d)},d:function(n){this.eK(_d.b.d,n);return n},z:function(){return this.eM(_d.b.g)},I:function(n){this.eK(_d.b.g,n);return n},p:function(){return this.eM(_d.b.c)},r:function(n){this.eK(_d.b.c,n);return n},y:function(){return this.eM(_d.b.e)},b:function(n){this.eK(_d.b.e,n);return n},t:function(){this.a&&this.q()},H:function(n){if(n.EventType!=="Reload"){var t=n;this.b(this.D(t.callState));(t.callState==="Disconnected"||t.callState==="Idle")&&this.f()}},N:function(){var n=new _g.S;n.NotificationType="PlayOnPhoneNotification";n.CallId=this.a;var t=new _h.K(n);t.n(_d.b.a,"PlayOnPhoneNotification",this.o,1)},O:function(){var n=new _g.S;n.NotificationType="PlayOnPhoneNotification";n.CallId=this.a;var t=new _h.K(n);t.p()},G:function(){this.b(_nbs.a.Td);var n=new _c.B(this.e.bH.ItemId.Id,this.p());this.d(!0);n.c(this.h);n.b(this.j);_a.g.a.a(n)},q:function(){var n=new _c.C(this.a);this.b(_nbs.a.Lp);n.a(this.i);_a.g.a.a(n)},E:function(){this.I(!0)},s:function(n){this.a=n.j.PhoneCallId.Id;this.g(!1);this.N()},v:function(n){var i=n;var t=_nbs.a.Kc;if(i.N&&i.N.Body){var r=i.N.Body.ResponseCode;switch(r){case"ErrorInvalidId":case"ErrorInvalidIdMalformed":t=_nbs.a.ol;break;case"ErrorPhoneNumberNotDialable":t=_nbs.a.Gb;break;case"ErrorIPGatewayNotFound":t=_nbs.a.Lh;break;case"ErrorInvalidPhoneNumber":case"ErrorInvalidSIPUri":t=_nbs.a.VV;break}}this.b("");this.c.h(0,t,null);this.g(!0);this.d(!1)},D:function(n){switch(n){case"Idle":case"Disconnected":return"";case"Connecting":return _nbs.a.Td;case"Connected":return _nbs.a.cl;default:throw Error.invalidOperation("Invalid Call State.");}},u:function(n){this.f()},f:function(){if(this.a){this.O();this.a=""}this.g(!0);this.b("");this.d(!1)}};_d.j=function(n,t,i){_d.j.initializeBase(this);_a.c.b(t,"nativeBridge");this.u(n);this.e=!1;this.m=_g.a.a().c().bH.IsRequireProtectedPlayOnPhone;this.h=t;this.i=i;this.v(new _d.b(n));this.y()};_d.j.prototype={m:!1,h:null,i:null,e:!1,o:!1,f:null,n:null,r:!1,d:function(){return this.eM(_d.j.a)},u:function(n){this.eK(_d.j.a,n);return n},t:function(){return this.eM(_d.j.c)},x:function(n){this.eK(_d.j.c,n);return n},p:function(){return this.eM(_d.j.b)},v:function(n){this.eK(_d.j.b,n);return n},l:function(){var n=!1;this.j()&&this.e&&!this.g()&&(this.s()||this.h.b(this.h.n()))&&(n=!0);return n},q:function(){return!this.g()&&this.j()&&!this.l()&&!1},c:function(){return this.f},j:function(){return _g.f.B(this.d().bH.ItemClass)},w:function(n){this.o=n;this.eJ("SignalCleanup");return n},g:function(){return this.m&&_g.f.m(this.d().bH.ItemClass)},b:function(n){this.n=n;return n},a:function(n){this.r=n;return n},s:function(){return _a.o.a().bg},eL:function(){this.n=null;this.w(!0);this.p().t();_a.gd.prototype.eL.call(this)},y:function(){if(this.d().bi())for(var t=0;t<this.d().bi().b();t++){var n=this.d().bi().a(t);if(n.bH.Name===this.d().v()){if(!this.g()){var i=this.i.a(n.bH.AttachmentId,!1,null,null,!1);this.x(new _d.bn(n,i,this.d().bH.ItemId.Id));this.e=_g.f.m(this.d().bH.ItemClass)?!0:n.bH.ContentType==="audio/mp3"?!0:!1}if(this.l()||this.q()){this.f=new Array(1);this.f[0]=n.bH.AttachmentId.Id}break}}}};_d.bo=function(n,t){this.c=n;this.b=t};_d.bo.prototype={c:null,b:null,a:function(n){return new _d.j(n,this.c,this.b)}};_d.bi=function(n){this.c=n};_d.bi.prototype={c:null,a:function(n,t,i){return new _d.d(n,t,i,this.c,_g.a.a().c().bH.UserEmailAddress,!0,!1)},b:function(n,t,i,r){return new _d.d(t,i,r,this.c,n,!1,!0)}};_d.bh=function(n,t,i,r,u,f,e,o,s,h){this.bb=Function.createDelegate(this,this.bI);_d.bh.initializeBase(this,[n,t,i,r,u,e,o,s,h,!1]);this.bc=f};_d.bh.prototype={bc:!1,bj:function(n,t){var i=n.a(2,_bc.e.a,t,!1,!1,null,null,0,0,!1,!0);var r=i.H();r?r.A(!1):i.apcl("FindRecipientViewModel",this.bb);return i},T:function(){this.h().bx();_ph.j.prototype.T.call(this)},X:function(n){this.bc||this.h().q();_ph.j.prototype.X.call(this,n)},bI:function(n,t){var i=n;var r=i.H();r.A(!1);i.rpcl("FindRecipientViewModel",this.bb)}};_d.d=function(n,t,i,r,u,f,e){this.bf=Function.createDelegate(this,this.bK);this.bk=Function.createDelegate(this,this.bQ);this.v=Function.createDelegate(this,this.ca);this.w=Function.createDelegate(this,this.cb);this.T=Function.createDelegate(this,this.bV);this.S=Function.createDelegate(this,this.bp);this.bg=Function.createDelegate(this,this.ba);this.be=Function.createDelegate(this,this.bJ);this.bo=Function.createDelegate(this,this.bZ);this.bh=Function.createDelegate(this,this.bN);this.bj=Function.createDelegate(this,this.bP);this.bd=Function.createDelegate(this,this.L);this.bn=Function.createDelegate(this,this.bD);this.bl=Function.createDelegate(this,this.bS);this.bm=Function.createDelegate(this,this.bT);this.bi=Function.createDelegate(this,this.bO);_d.d.initializeBase(this);if(_j.h.a(u))throw Error.argumentNull("emailAddress");this.O=n;this.r=t;this.i=i;this.bb=r;this.ff(this.bI());this.W=u.toLocaleLowerCase();this.t=_d.d.b(u);this.I=f;this.V=e;this.Q(this.t)};_d.d.b=function(n){n=n.toLowerCase();var t=String.format("service.svc/s/GetPersonaPhoto?email={0}",encodeURIComponent(n));t+="&size="+String.format("HR{0}x{1}",240,240);return t};_d.d.prototype={O:null,r:null,i:null,t:null,z:null,E:null,N:null,B:null,j:0,q:!1,p:0,C:null,W:null,I:!1,V:!1,P:null,K:null,M:null,s:null,H:!1,A:!1,bb:null,b:function(n){this.eO("UploadPhotoClosed",n)},g:function(n){this.eP("UploadPhotoClosed",n)},bH:function(n){this.eO("UploadPhotoSucceeded",n)},bY:function(n){this.eP("UploadPhotoSucceeded",n)},bG:function(n){this.eO("UploadPhotoFailed",n)},bX:function(n){this.eP("UploadPhotoFailed",n)},a:function(){return this.V||_g.a.a().e().bH.SetPhoto&&this.bA()},Z:function(){return this.O.a()==="Mouse"},bB:function(){return this.O.a()==="TouchNarrow"},G:function(){this.N||(this.N=new _bc.b);return this.N},bw:function(){return!this.Y()&&_a.o.a().S&&(!this.i.b(this.i.f())||!this.i.f().a().a())?!0:!1},R:function(n){if(this.H!==n){this.H=n;this.eJ("IsDiscardChangesDialogShown")}return n},m:function(n){if(this.q!==n){this.q=n;this.eJ("IsWorking")}return n},bL:function(){return this.by()&&_g.a.a().e().bH.SetPhoto?new _j.g(this.bi,_d.d.a):null},bC:function(){return this.bA()&&_g.a.a().e().bH.SetPhoto?new _j.g(this.bm,_d.d.a):null},bF:function(n){this.B=n;this.eJ("OpenPhotoPickerCommand");return n},bq:function(){return new _j.g(this.bl,_d.d.a)},bE:function(n){this.E=n;this.eJ("Files");return n},n:function(){return this.Z()?0:1},f:function(){this.P||(this.P=new _j.g(this.bn,_d.d.a));return this.P},bv:function(){this.K||(this.K=new _j.g(this.bd,_d.d.a));return this.K},X:function(){this.M||(this.M=new _j.g(this.bj,_d.d.a));return this.M},c:function(){return new _y.h(_y.b.J(),_y.b.K(),_nbs.a.xJ,this.f())},d:function(){return new _y.h(_y.b.m(),_y.b.n(),_u.R.UM,this.X())},bx:function(){return this.Z()?2:0},x:function(){return this.bh},U:null,y:function(){return this.U},o:function(n){this.U=n;return n},bz:function(){return!0},e:function(){return this.j===1||this.j===2},bc:function(n){if(this.j!==n){this.j=n;this.eJ("CurrentState")}return n},bs:function(){return _y.h.a(_nbs.a.vc,this.bv())},Y:function(){return this.I&&this.i.b(this.i.f())&&this.i.f().a().e()},by:function(){return this.I&&this.i.b(this.i.f())&&this.i.f().a().c()},bA:function(){return this.Y()||this.by()||_a.o.a().S},Q:function(n){this.z=n!==""?n+String.format("&sc={0}",+new Date):n;this.eJ("ImageSource");return n},bu:function(){if(!this.s){this.s=new _j.l;this.s.a(new _ff.d(new _j.g(this.bo,_d.d.a),_u.P.U,null,!0,!1));this.s.a(new _ff.d(new _j.g(this.be,_d.d.a),_u.n.MH,null,!1,!1));this.s.a(new _ff.d(new _j.g(this.bg,_d.d.a),_bcs.D.A,null,!1,!1))}return this.s},dv:function(){_y.lJ.prototype.dv.call(this);this.h()},h:function(){this.bc(0);this.p=0;this.m(!1);this.Q(this.t);this.C=this.z;this.A=!1},bI:function(){var n;n=this.a()?[this.c(),this.d(),this.bs()]:[this.bs()];return _y.k.a(this,n,null)},bT:function(){if(this.Y()){_j.e.a(_d.d.a,"Call to get photo from gallery");this.i.f().c(!1,this.S,this.T);return}if(this.i.b(this.i.f())&&this.i.f().a().a()){_j.e.a(_d.d.a,"Call to native file picker");var t=this,n=this;this.i.f().d(!1,"*",1,function(n){n.length>0&&t.bp(n[0])},function(t){n.bM(t)});return}_a.o.a().S&&this.B&&this.B.a()},D:function(n,t,i){return new _phu.a(n,t,i,this.W,!this.I)},bO:function(){_j.e.a(_d.d.a,"Call to get photo from camera");this.i.f().b(!1,this.S,this.T)},bS:function(){this.bW(this.E.b(0))},bp:function(n){var t=this.D(1,null,n);t.c(this.w);t.b(this.v);this.p=1;this.C=this.t+"&isPreview=true";this.m(!0);this.r.a(t)},bW:function(n){var t=new _at.G;t.a(n,this.bk,this.bf,_d.d.a,!1)},bQ:function(n,t,i,r){var u=this.D(1,n,null);u.c(this.w);u.b(this.v);this.p=1;this.C=this.t+"&isPreview=true";this.m(!0);this.r.a(u)},cb:function(n){this.m(!1);this.Q(this.C);this.bc(this.p);if(this.p===3){this.A=!0;this.eS("UploadPhotoClosed");this.eS("UploadPhotoSucceeded");this.L();this.bb.bP()}},ca:function(n){this.m(!1);var t=n.G.message;_j.h.a(t)&&(t=_nbs.a.Dx);this.G().h(0,t,null);this.p===3&&this.eS("UploadPhotoFailed")},bD:function(){if(!this.q)switch(this.j){case 0:this.L();break;case 1:var t=this.D(0,"",null);t.c(this.w);t.b(this.v);this.p=3;this.m(!0);this.r.a(t);break;case 2:var n=this.D(2,"",null);n.c(this.w);n.b(this.v);this.p=3;this.m(!0);this.r.a(n);break}},bP:function(){if(!this.q)switch(this.j){case 0:this.Q("");this.bc(2);break;case 1:var n=this.D(3,"",null);n.c(this.w);n.b(this.v);this.p=0;this.C=this.t;this.m(!0);this.r.a(n);break;case 2:break}},bN:function(n,t,i){if(this.q)return!0;if(this.A)return!1;if(this.j){this.R(!0);return!0}return!1},bM:function(n){var t=null;switch(n){case 1:t=_nbs.a.cy;break;case 0:t=_nbs.a.uh;break;default:break}_j.h.a(t)||this.G().h(0,t,null)},bV:function(n){_j.e.c(_d.d.a,n.message)},bK:function(){this.G().h(0,"Error when reading the file",null)},L:function(){this.bU()&&this.bU().a()===this&&this.fD()},bZ:function(){this.A=!0;this.ba();this.bD()},bJ:function(){this.A=!0;this.ba();this.L();this.bB()&&this.eS("UploadPhotoClosed")},ba:function(){this.R(!1)}};_d.bs=function(){};_d.bs.prototype={singular:1,plural:2};_d.bs.registerEnum("_d.bs",!1);_d.br=function(){};_d.br.prototype={a:function(n,t){var u=new Sys.StringBuilder;var e="{0}; ";if(!n)return"";if(!_j.l.isInstanceOfType(n))throw Error.argumentType("value",Object.getType(n),_j.l,"Value must be an ObservableCollection");if(!n.x.length)return"";for(var f=n,i=null,r=0;r<f.x.length;r++){i=f.x[r];i.c()||u.append(_j.h.c(e,i.a().bH.Name))}return u.toString()},b:function(n,t){throw Error.notImplemented();}};_d.Y=function(){};_d.Y.prototype={a:function(n,t){var i="";if(Number.isInstanceOfType(n)){var r=_j.u.d(_d.bs,t.toString());switch(n){case 0:i=r===1?_nbs.a.Vm:_nbs.a.JP;break;case 1:i=r===1?_nbs.a.KM:_nbs.a.Yu;break;case 2:i=r===1?_nbs.a.IS:_nbs.a.Lr;break;case 3:i=r===1?_nbs.a.Jh:_nbs.a.NS;break}}return i},b:function(n,t){throw Error.notImplemented();}};_d.bt=function(){};_d.bt.prototype={a:function(n,t){var r=n;var i=null;switch(r){case"Normal":i=_nbs.a.kB;break;case"Personal":i=_nbs.a.XP;break;case"Private":i=_nbs.a.XZ;break;case"Confidential":i=_nbs.a.x;break;default:i=_nbs.a.kB;break}return i},b:function(n,t){throw Error.notImplemented();}};_d.bu=function(){};_d.bu.prototype={a:function(n,t){if(n){var i=t?t:!1;switch(n){case"NotStarted":return i?_u.n.TX:_u.R.MY;case"InProgress":return i?_u.n.IN:_u.R.PB;case"Completed":return i?_u.n.QE:_u.R.MC;case"Deferred":return i?_u.n.PA:_u.R.BF;case"WaitingOnOthers":return i?_u.n.Nc:_u.R.Dv;default:return""}}else return""},b:function(n,t){throw Error.notImplemented();}};_d.bv=function(){};_d.bv.prototype={a:function(n,t){var i=n;return i?i.toLocaleString():""},b:function(n,t){throw Error.notImplemented();}};_d.e=function(n,t){this.m=Function.createDelegate(this,this.s);this.n=Function.createDelegate(this,this.t);_d.e.initializeBase(this);this.h=n;this.i=t};_d.e.prototype={c:!1,h:null,b:null,a:null,i:null,d:!1,e:!1,o:function(){return this.e&&_d.e.b},g:function(n){if(this.e!==n){this.e=n;this.eJ("IsEnabled")}return n},j:function(n){if(this.d!==n){this.d=n;this.eJ("IsLoading")}return n},l:function(n){if(this.b!==n){this.b=n;this.eJ("SelectedCulture")}this.o()&&(this.c=!0);return n},u:function(n){if(_d.e.b!==n){_d.e.b=n;this.eJ("IsInitialized")}return n},p:function(){if(_d.e.b){this.f(_g.a.a().c().bH.UserCulture);this.g(!0)}else{this.j(!0);this.f(_g.a.a().c().bH.UserCulture);this.r()}},q:function(n){if(!_d.e.b){var t;this.a=(t=new _dg.bn,t.LCID=n,t);return}var r=this;var i=_d.e.a.k(function(t){return t.LCID===n});i<_d.e.a.x.length&&this.l(_d.e.a.x[i])},f:function(n){if(!_d.e.b){var t;this.a=(t=new _dg.bn,t.Name=n,t);return}var r=this;var i=_d.e.a.k(function(t){return t.Name===n});i<_d.e.a.x.length&&this.l(_d.e.a.x[i])},r:function(){var n=new _c.x;n.c(this.n);n.b(this.m);this.h.a(n);this.c=!1},s:function(n){this.j(!1)},t:function(n){_d.e.a=new _j.l;for(var i=n.f,t=0;t<i.length;t++)_d.e.a.a(i[t]);this.u(!0);this.j(!1);if(this.a){_j.h.a(this.a.Name)?this.a.LCID>0&&this.q(this.a.LCID):this.f(this.a.Name);this.a=null}this.g(!0)}};_d.l=function(n,t){_d.l.initializeBase(this);this.j=n;this.s=t};_d.l.prototype={j:null,s:null,o:null,p:null,e:null,g:!1,i:null,f:null,h:null,r:null,m:null,a:function(){return this.e},v:function(n){if(n===this.e)return n;this.e=n;this.eJ(_d.l.a);return n},b:function(n){this.m=n;return n},q:function(n){if(n===this.h)return n;this.h=n;this.eJ(_d.l.b);return n},t:function(n){if(n===this.i)return n;this.i=n;this.eJ(_d.l.c);return n},n:function(){return this.j.a()==="TouchNarrow"?_y.lJ.prototype.n.call(this):0},du:function(){_j.e.a(_a.a.o,"UIRPVM ->PostTransitionIn");_y.lJ.prototype.du.call(this)},dv:function(){_y.lJ.prototype.dv.call(this);this.m&&this.m.N(!1)},c:function(n,t){this.o=n;this.p=t},d:function(n,t){if(!n)throw Error.argumentNull("item");if(n!==this.e){this.v(n);this.g=t;var i=this.e.bE();this.f=_h.a.a(i);this.f?this.t(String.format(_nbs.a.m,this.f.bH.DisplayName)):this.t(_u.n.Sm);this.e.bU()?this.e.bU()===3&&this.g?this.q(_nbs.a.BX):this.q(_nbs.a.qD):this.q(_nbs.a.eQ);this.w()}},w:function(){if(this.j.a()==="TouchNarrow"){var n=_y.k.a(this);n.m(new _j.g(this.kK,_a.a.o));this.ff(n)}}};_d.bn=function(n,t,i){this.a=n;this.b=t;this.c=i};_d.bn.prototype={a:null,b:null,c:null};CoreViewModelsComponent.registerClass("CoreViewModelsComponent",null,_a.kh,_j.ce);_d.ba.registerClass("_d.ba",_a.bw);_d.K.registerClass("_d.K",_a.bw);_d.bf.registerClass("_d.bf",null,_y.fS);_d.bq.registerClass("_d.bq",_a.bt);_d.bk.registerClass("_d.bk",null,_y.dm);_d.bl.registerClass("_d.bl",null,_y.dR);_d.bp.registerClass("_d.bp",_j.S,_y.iK);_d.h.registerClass("_d.h",_cm.Y);_d.bg.registerClass("_d.bg",null,_y.iw,_bc.bm);_d.q.registerClass("_d.q",_a.bw);_d.by.registerClass("_d.by",_a.bw);_d.r.registerClass("_d.r",_a.gd,_y.hZ);_d.Z.registerClass("_d.Z",null,_y.ig,_j.L);_d.bb.registerClass("_d.bb",null,_y.cc);_d.N.registerClass("_d.N",_a.bw,_y.fh);_d.M.registerClass("_d.M",null,_y.dz);_d.n.registerClass("_d.n",_a.bw);_d.O.registerClass("_d.O",_a.bw);_d.P.registerClass("_d.P",_a.bw);_d.x.registerClass("_d.x",_y.lJ);_d.A.registerClass("_d.A",_a.bw,_y.la,Sys.IDisposable);_d.W.registerClass("_d.W",null,_y.fU);_d.B.registerClass("_d.B",_y.lJ);_d.I.registerClass("_d.I",_lv.j);_d.L.registerClass("_d.L",_y.lJ,_y.gw,_bc.j,_bc.s,_bc.w,_a.kU,_j.bs,Sys.IDisposable);_d.bd.registerClass("_d.bd",null,_y.bp);_d.be.registerClass("_d.be",_a.bw);_d.i.registerClass("_d.i",_bc.n,_y.gy);_d.k.registerClass("_d.k",_a.bw,_y.ln,Sys.IDisposable);_d.J.registerClass("_d.J",_a.bw,_y.hT,Sys.IDisposable);_d.bz.registerClass("_d.bz",_ph.i);_d.t.registerClass("_d.t",_a.bw,_y.br);_d.V.registerClass("_d.V");_d.Q.registerClass("_d.Q",_a.bw);_d.F.registerClass("_d.F",_j.S,_d.bH);_d.H.registerClass("_d.H",_d.F);_d.s.registerClass("_d.s",_a.bw);_d.y.registerClass("_d.y",_a.bw);_d.bA.registerClass("_d.bA",_a.bw);_d.D.registerClass("_d.D",_bc.n);_d.z.registerClass("_d.z",_a.bw);_d.bB.registerClass("_d.bB",_d.z);_d.S.registerClass("_d.S",_y.lJ);_d.m.registerClass("_d.m",_d.z);_d.u.registerClass("_d.u",_d.z);_d.bC.registerClass("_d.bC",_lv.u);_d.o.registerClass("_d.o",_lv.j);_d.T.registerClass("_d.T");_d.v.registerClass("_d.v",_y.lJ);_d.bD.registerClass("_d.bD",_lv.v);_d.p.registerClass("_d.p",_lv.m);_d.f.registerClass("_d.f",_a.ec,_bc.bT);_d.c.registerClass("_d.c",_y.lJ,_bc.j,_bc.s,_bc.w,_a.kU,_j.bs,Sys.IDisposable,_d.bG,_y.cd);_d.bm.registerClass("_d.bm",null,_y.cF);_d.E.registerClass("_d.E",null,_y.fp,_bc.bm);_d.U.registerClass("_d.U",_a.bw);_d.G.registerClass("_d.G",_j.S,_j.L);_d.b.registerClass("_d.b",_a.bw);_d.j.registerClass("_d.j",_a.bw,_y.ln,Sys.IDisposable);_d.bo.registerClass("_d.bo",null,_y.fT);_d.bi.registerClass("_d.bi",null,_y.fs);_d.bh.registerClass("_d.bh",_ph.j);_d.d.registerClass("_d.d",_y.lJ,_bc.j,_bc.s,_bc.w,_a.kU,_j.bs,Sys.IDisposable,_y.lD);_d.br.registerClass("_d.br",null,_j.bP);_d.Y.registerClass("_d.Y",null,_j.bP);_d.bt.registerClass("_d.bt",null,_j.bP);_d.bv.registerClass("_d.bv",null,_j.bP);_d.e.registerClass("_d.e",_a.bw);_d.l.registerClass("_d.l",_y.lJ,_y.bi);_d.bn.registerClass("_d.bn");CoreViewModelsComponent.$$cctor();_d.h.a=null;_d.h.b=null;_d.r.a=_a.a.v;_d.x.a=_a.a.A;_d.i.a=_a.a.v;_d.i.b=null;_d.i.$$cctor();_d.k.c=_a.a.ea;_d.k.d=_fm.b.a(_fm.a.br,_fm.WebfontSizes.a.a,"ms-fcl-ns-b");_d.k.e=_fm.b.a(_fm.a.br,_fm.WebfontSizes.a.a,"ms-fcl-nd-b");_d.k.a=_fm.b.a(_fm.a.dA,_fm.WebfontSizes.a.a,"ms-fcl-ns-b");_d.k.b=_fm.b.a(_fm.a.dA,_fm.WebfontSizes.a.a,"ms-fcl-nd-b");_d.t.a=_a.a.bk;_d.s.a=_a.a.bX;_d.R.a=_a.a.bX;_d.D.a=_a.a.bX;_d.m.a=_a.a.bX;_d.u.a=_a.a.bX;_d.o.a=_a.a.cA;_d.v.a=47;_d.v.b=200;_d.F.a=_a.a.bX;_d.f.f=new _a.f("Task",_dg.n,_d.f);_d.f.a=new _a.f("EditedTask",_dg.n,_d.f);_d.f.d=new _a.f("IsNewTask",Boolean,_d.f);_d.f.c=new _a.f("IsEditMode",Boolean,_d.f);_d.f.b=new _a.f("IsDraft",Boolean,_d.f);_d.f.e=new _a.f("PopoutPerfContext",_a.bN,_d.f);_d.c.a=_a.a.bX;_d.E.a=_a.a.bX;_d.b.a=_a.a.fr;_d.b.b=new _a.f("CanDial",Boolean,_d.b,!0);_d.b.g=new _a.f("PlayOnPhoneActive",Boolean,_d.b,!1);_d.b.c=new _a.f("DialString",String,_d.b,"");_d.b.e=new _a.f("MessageText",String,_d.b,"");_d.b.h=new _a.f("PlayOnPhoneCommand",_j.P,_d.b);_d.b.i=new _a.f("PlayOnPhoneDisconnectCommand",_j.P,_d.b);_d.b.f=new _a.f("PlayOnPhoneActiveCommand",_j.P,_d.b);_d.b.d=new _a.f("IsPhoneCallActive",Boolean,_d.b,!1);_d.j.a=new _a.f("Item",_g.cj,_d.j);_d.j.c=new _a.f("Source",_d.bn,_d.j,null);_d.j.b=new _a.f("PlayOnPhoneViewModel",_d.b,_d.j);_d.d.a=_a.a.dF;_d.e.a=null;_d.e.b=!1;_d.l.a="CurrentItem";_d.l.b="ItemNotSupported";_d.l.c="MoveButtonText";
window.scriptsLoaded['microsoft.owa.core.viewmodels.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.core.viewmodels.js'] = (new Date()).getTime();
